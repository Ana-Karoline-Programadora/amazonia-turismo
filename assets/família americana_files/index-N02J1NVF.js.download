const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["app_assets/index-D0sGnqN2.js","app_assets/mui-I0gwHxu3.js","app_assets/lodash-D2vRzWmy.js","app_assets/i18next-B04SMkt3.js","app_assets/InputFieldWithMaxLength-SCRztPPZ.js","app_assets/FieldError-Ce6W9Cnq.js","app_assets/ErrorCircleIcon-CQS0WSsh.js","app_assets/firebase-B4FsIiCH.js","app_assets/amplitude-DOY3PvDI.js","app_assets/react-helmet-CQwkECck.js","app_assets/moment-C5S46NFB.js","app_assets/tanstack-dxxlS1yS.js","app_assets/react-zoom-pan-pinch-Dy5ePhgO.js","app_assets/react-easy-crop-lw9TQXyj.js","app_assets/dragselect-Kg-0Oatv.js","app_assets/index-DyXaKhdw.js","app_assets/EditProfileModalContent-C2nEOnLh.js","app_assets/ProfileHeaderState-CQz6dPer.js","app_assets/index-CNE0KrKr.js","app_assets/SearchIcon-bHJneE2-.js","app_assets/FilterIcon-4XAFZeIl.js","app_assets/GenerationProgress-CyaZnOw3.js","app_assets/index-7hJG_jAH.js","app_assets/OptionsIcon-CFqLRMKb.js","app_assets/LoginPage-DF0PUR-Q.js","app_assets/index-DVQHcyoJ.js","app_assets/CardIcon-BCasy7TH.js","app_assets/NotificationsPage-Ce484bdf.js","app_assets/index-Cy5V2TLW.js","app_assets/index-tpoRgakq.js","app_assets/index-BGRKHBNP.js","app_assets/index-wcSO3IJ7.js","app_assets/TosUpdatePopup-CvYR5-L6.js"])))=>i.map(i=>d[i]);
var Qx=Object.defineProperty;var Zx=(t,e,n)=>e in t?Qx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ke=(t,e,n)=>Zx(t,typeof e!="symbol"?e+"":e,n);import{a as ev,r as l,b as tv,j as r,u as nv,i as pn,T as Ca,s as b,B as gt,c as le,C as Hf,d as we,e as xe,f as C,I as Yo,g as ov,h as rv,M as So,D as Wn,R as tt,S as rr,G as qf,k as co,l as _a,m as ri,n as Ia,o as Sa,p as Co,F as xr,L as iv,q as ii,t as Vs,v as Uc,w as Gc,x as sv,y as av,z as lv,A as cv,E as ql,H as Ra,J as Ir,K as Hc,N as dv,O as qc,Q as Ni,U as Wc,V as Wf,W as uv,X as Jr,Y as hv,Z as $f,_ as pv,$ as fv,a0 as gv}from"./mui-I0gwHxu3.js";import{G as mv,O as xv,s as vv,k as Mu,l as yv,g as $c,b as xt,_ as Qe,a as Je,d as yo,c as Bo,f as Xr,m as wv,n as bv,o as Cv,p as _v,q as Iv}from"./firebase-B4FsIiCH.js";import{i as Sv,E as Rv,t as Vc,I as Tv,s as Vf,a as Ev,S as Wl,L as kv,b as $l,F as Av,C as jv,g as _o,c as Pv,B as Mv,d as Ou,e as Ov,r as Bu,f as Bv,h as Tr,j as Lu,k as Nu}from"./amplitude-DOY3PvDI.js";import{H as Kf}from"./react-helmet-CQwkECck.js";import{h as Ta}from"./moment-C5S46NFB.js";import{u as Ve,a as wo,Q as Lv,b as Nv}from"./tanstack-dxxlS1yS.js";import{l as Ut,a as Dv,_ as es,c as vo,g as Jf}from"./lodash-D2vRzWmy.js";import{u as Kc,T as Qo,i as Fv,a as zv}from"./i18next-B04SMkt3.js";import{T as Uv,a as Gv}from"./react-zoom-pan-pinch-Dy5ePhgO.js";import{C as Hv}from"./react-easy-crop-lw9TQXyj.js";import{D as qv}from"./dragselect-Kg-0Oatv.js";function Wv(t,e){for(var n=0;n<e.length;n++){const o=e[n];if(typeof o!="string"&&!Array.isArray(o)){for(const i in o)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(o,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>o[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var Vl={},Du=ev;Vl.createRoot=Du.createRoot,Vl.hydrateRoot=Du.hydrateRoot;const Xf=l.createContext(null),nl={didCatch:!1,error:null};class $v extends l.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=nl}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var n,o,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];(n=(o=this.props).onReset)===null||n===void 0||n.call(o,{args:a,reason:"imperative-api"}),this.setState(nl)}}componentDidCatch(e,n){var o,i;(o=(i=this.props).onError)===null||o===void 0||o.call(i,e,n)}componentDidUpdate(e,n){const{didCatch:o}=this.state,{resetKeys:i}=this.props;if(o&&n.error!==null&&Vv(e.resetKeys,i)){var a,s;(a=(s=this.props).onReset)===null||a===void 0||a.call(s,{next:i,prev:e.resetKeys,reason:"keys"}),this.setState(nl)}}render(){const{children:e,fallbackRender:n,FallbackComponent:o,fallback:i}=this.props,{didCatch:a,error:s}=this.state;let c=e;if(a){const d={error:s,resetErrorBoundary:this.resetErrorBoundary};if(typeof n=="function")c=n(d);else if(o)c=l.createElement(o,d);else if(i===null||l.isValidElement(i))c=i;else throw s}return l.createElement(Xf.Provider,{value:{didCatch:a,error:s,resetErrorBoundary:this.resetErrorBoundary}},c)}}function Vv(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.length!==e.length||t.some((n,o)=>!Object.is(n,e[o]))}function Kv(t){if(t==null||typeof t.didCatch!="boolean"||typeof t.resetErrorBoundary!="function")throw new Error("ErrorBoundaryContext not found")}function Yf(){const t=l.useContext(Xf);Kv(t);const[e,n]=l.useState({error:null,hasError:!1}),o=l.useMemo(()=>({resetBoundary:()=>{t.resetErrorBoundary(),n({error:null,hasError:!1})},showBoundary:i=>n({error:i,hasError:!0})}),[t.resetErrorBoundary]);if(e.hasError)throw e.error;return o}/**
 * @remix-run/router v1.19.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Di(){return Di=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Di.apply(this,arguments)}var Jo;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Jo||(Jo={}));const Fu="popstate";function Jv(t){t===void 0&&(t={});function e(o,i){let{pathname:a,search:s,hash:c}=o.location;return Kl("",{pathname:a,search:s,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(o,i){return typeof i=="string"?i:Zf(i)}return Yv(e,n,null,t)}function qt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Qf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Xv(){return Math.random().toString(36).substr(2,8)}function zu(t,e){return{usr:t.state,key:t.key,idx:e}}function Kl(t,e,n,o){return n===void 0&&(n=null),Di({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?si(e):e,{state:n,key:e&&e.key||o||Xv()})}function Zf(t){let{pathname:e="/",search:n="",hash:o=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),o&&o!=="#"&&(e+=o.charAt(0)==="#"?o:"#"+o),e}function si(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let o=t.indexOf("?");o>=0&&(e.search=t.substr(o),t=t.substr(0,o)),t&&(e.pathname=t)}return e}function Yv(t,e,n,o){o===void 0&&(o={});let{window:i=document.defaultView,v5Compat:a=!1}=o,s=i.history,c=Jo.Pop,d=null,u=h();u==null&&(u=0,s.replaceState(Di({},s.state,{idx:u}),""));function h(){return(s.state||{idx:null}).idx}function p(){c=Jo.Pop;let y=h(),_=y==null?null:y-u;u=y,d&&d({action:c,location:x.location,delta:_})}function g(y,_){c=Jo.Push;let w=Kl(x.location,y,_);u=h()+1;let I=zu(w,u),R=x.createHref(w);try{s.pushState(I,"",R)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;i.location.assign(R)}a&&d&&d({action:c,location:x.location,delta:1})}function m(y,_){c=Jo.Replace;let w=Kl(x.location,y,_);u=h();let I=zu(w,u),R=x.createHref(w);s.replaceState(I,"",R),a&&d&&d({action:c,location:x.location,delta:0})}function v(y){let _=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof y=="string"?y:Zf(y);return w=w.replace(/ $/,"%20"),qt(_,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,_)}let x={get action(){return c},get location(){return t(i,s)},listen(y){if(d)throw new Error("A history only accepts one active listener");return i.addEventListener(Fu,p),d=y,()=>{i.removeEventListener(Fu,p),d=null}},createHref(y){return e(i,y)},createURL:v,encodeLocation(y){let _=v(y);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:g,replace:m,go(y){return s.go(y)}};return x}var Uu;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Uu||(Uu={}));function Qv(t,e,n){return n===void 0&&(n="/"),Zv(t,e,n,!1)}function Zv(t,e,n,o){let i=typeof e=="string"?si(e):e,a=ng(i.pathname||"/",n);if(a==null)return null;let s=eg(t);ey(s);let c=null;for(let d=0;c==null&&d<s.length;++d){let u=uy(a);c=cy(s[d],u,o)}return c}function eg(t,e,n,o){e===void 0&&(e=[]),n===void 0&&(n=[]),o===void 0&&(o="");let i=(a,s,c)=>{let d={relativePath:c===void 0?a.path||"":c,caseSensitive:a.caseSensitive===!0,childrenIndex:s,route:a};d.relativePath.startsWith("/")&&(qt(d.relativePath.startsWith(o),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(o.length));let u=pr([o,d.relativePath]),h=n.concat(d);a.children&&a.children.length>0&&(qt(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),eg(a.children,e,h,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:ay(u,a.index),routesMeta:h})};return t.forEach((a,s)=>{var c;if(a.path===""||!((c=a.path)!=null&&c.includes("?")))i(a,s);else for(let d of tg(a.path))i(a,s,d)}),e}function tg(t){let e=t.split("/");if(e.length===0)return[];let[n,...o]=e,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(o.length===0)return i?[a,""]:[a];let s=tg(o.join("/")),c=[];return c.push(...s.map(d=>d===""?a:[a,d].join("/"))),i&&c.push(...s),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function ey(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:ly(e.routesMeta.map(o=>o.childrenIndex),n.routesMeta.map(o=>o.childrenIndex)))}const ty=/^:[\w-]+$/,ny=3,oy=2,ry=1,iy=10,sy=-2,Gu=t=>t==="*";function ay(t,e){let n=t.split("/"),o=n.length;return n.some(Gu)&&(o+=sy),e&&(o+=oy),n.filter(i=>!Gu(i)).reduce((i,a)=>i+(ty.test(a)?ny:a===""?ry:iy),o)}function ly(t,e){return t.length===e.length&&t.slice(0,-1).every((o,i)=>o===e[i])?t[t.length-1]-e[e.length-1]:0}function cy(t,e,n){let{routesMeta:o}=t,i={},a="/",s=[];for(let c=0;c<o.length;++c){let d=o[c],u=c===o.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=pt({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},h),g=d.route;if(!p&&u&&n&&!o[o.length-1].route.index&&(p=pt({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),s.push({params:i,pathname:pr([a,p.pathname]),pathnameBase:xy(pr([a,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(a=pr([a,p.pathnameBase]))}return s}function pt(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,o]=dy(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let a=i[0],s=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:o.reduce((u,h,p)=>{let{paramName:g,isOptional:m}=h;if(g==="*"){let x=c[p]||"";s=a.slice(0,a.length-x.length).replace(/(.)\/+$/,"$1")}const v=c[p];return m&&!v?u[g]=void 0:u[g]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:s,pattern:t}}function dy(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Qf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let o=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,c,d)=>(o.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(o.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),o]}function uy(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qf(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function ng(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,o=t.charAt(n);return o&&o!=="/"?null:t.slice(n)||"/"}function hy(t,e){e===void 0&&(e="/");let{pathname:n,search:o="",hash:i=""}=typeof t=="string"?si(t):t;return{pathname:n?n.startsWith("/")?n:py(n,e):e,search:vy(o),hash:yy(i)}}function py(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function ol(t,e,n,o){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function fy(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function gy(t,e){let n=fy(t);return e?n.map((o,i)=>i===n.length-1?o.pathname:o.pathnameBase):n.map(o=>o.pathnameBase)}function my(t,e,n,o){o===void 0&&(o=!1);let i;typeof t=="string"?i=si(t):(i=Di({},t),qt(!i.pathname||!i.pathname.includes("?"),ol("?","pathname","search",i)),qt(!i.pathname||!i.pathname.includes("#"),ol("#","pathname","hash",i)),qt(!i.search||!i.search.includes("#"),ol("#","search","hash",i)));let a=t===""||i.pathname==="",s=a?"/":i.pathname,c;if(s==null)c=n;else{let p=e.length-1;if(!o&&s.startsWith("..")){let g=s.split("/");for(;g[0]==="..";)g.shift(),p-=1;i.pathname=g.join("/")}c=p>=0?e[p]:"/"}let d=hy(i,c),u=s&&s!=="/"&&s.endsWith("/"),h=(a||s===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(u||h)&&(d.pathname+="/"),d}const pr=t=>t.join("/").replace(/\/\/+/g,"/"),xy=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),vy=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,yy=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function wy(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const og=["post","put","patch","delete"];new Set(og);const by=["get",...og];new Set(by);/**
 * React Router v6.26.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fi(){return Fi=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Fi.apply(this,arguments)}const Jc=l.createContext(null),Cy=l.createContext(null),Ea=l.createContext(null),ka=l.createContext(null),Sr=l.createContext({outlet:null,matches:[],isDataRoute:!1}),rg=l.createContext(null);function Aa(){return l.useContext(ka)!=null}function Rn(){return Aa()||qt(!1),l.useContext(ka).location}function ig(t){l.useContext(Ea).static||l.useLayoutEffect(t)}function ja(){let{isDataRoute:t}=l.useContext(Sr);return t?By():_y()}function _y(){Aa()||qt(!1);let t=l.useContext(Jc),{basename:e,future:n,navigator:o}=l.useContext(Ea),{matches:i}=l.useContext(Sr),{pathname:a}=Rn(),s=JSON.stringify(gy(i,n.v7_relativeSplatPath)),c=l.useRef(!1);return ig(()=>{c.current=!0}),l.useCallback(function(u,h){if(h===void 0&&(h={}),!c.current)return;if(typeof u=="number"){o.go(u);return}let p=my(u,JSON.parse(s),a,h.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:pr([e,p.pathname])),(h.replace?o.replace:o.push)(p,h.state,h)},[e,o,s,a,t])}function an(){let{matches:t}=l.useContext(Sr),e=t[t.length-1];return e?e.params:{}}function Iy(t,e){return Sy(t,e)}function Sy(t,e,n,o){Aa()||qt(!1);let{navigator:i}=l.useContext(Ea),{matches:a}=l.useContext(Sr),s=a[a.length-1],c=s?s.params:{};s&&s.pathname;let d=s?s.pathnameBase:"/";s&&s.route;let u=Rn(),h;if(e){var p;let y=typeof e=="string"?si(e):e;d==="/"||(p=y.pathname)!=null&&p.startsWith(d)||qt(!1),h=y}else h=u;let g=h.pathname||"/",m=g;if(d!=="/"){let y=d.replace(/^\//,"").split("/");m="/"+g.replace(/^\//,"").split("/").slice(y.length).join("/")}let v=Qv(t,{pathname:m}),x=Ay(v&&v.map(y=>Object.assign({},y,{params:Object.assign({},c,y.params),pathname:pr([d,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?d:pr([d,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),a,n,o);return e&&x?l.createElement(ka.Provider,{value:{location:Fi({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Jo.Pop}},x):x}function Ry(){let t=Oy(),e=wy(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return l.createElement(l.Fragment,null,l.createElement("h2",null,"Unexpected Application Error!"),l.createElement("h3",{style:{fontStyle:"italic"}},e),n?l.createElement("pre",{style:i},n):null,null)}const Ty=l.createElement(Ry,null);class Ey extends l.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?l.createElement(Sr.Provider,{value:this.props.routeContext},l.createElement(rg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ky(t){let{routeContext:e,match:n,children:o}=t,i=l.useContext(Jc);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),l.createElement(Sr.Provider,{value:e},o)}function Ay(t,e,n,o){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),o===void 0&&(o=null),t==null){var a;if(!n)return null;if(n.errors)t=n.matches;else if((a=o)!=null&&a.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let s=t,c=(i=n)==null?void 0:i.errors;if(c!=null){let h=s.findIndex(p=>p.route.id&&(c==null?void 0:c[p.route.id])!==void 0);h>=0||qt(!1),s=s.slice(0,Math.min(s.length,h+1))}let d=!1,u=-1;if(n&&o&&o.v7_partialHydration)for(let h=0;h<s.length;h++){let p=s[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:g,errors:m}=n,v=p.route.loader&&g[p.route.id]===void 0&&(!m||m[p.route.id]===void 0);if(p.route.lazy||v){d=!0,u>=0?s=s.slice(0,u+1):s=[s[0]];break}}}return s.reduceRight((h,p,g)=>{let m,v=!1,x=null,y=null;n&&(m=c&&p.route.id?c[p.route.id]:void 0,x=p.route.errorElement||Ty,d&&(u<0&&g===0?(v=!0,y=null):u===g&&(v=!0,y=p.route.hydrateFallbackElement||null)));let _=e.concat(s.slice(0,g+1)),w=()=>{let I;return m?I=x:v?I=y:p.route.Component?I=l.createElement(p.route.Component,null):p.route.element?I=p.route.element:I=h,l.createElement(ky,{match:p,routeContext:{outlet:h,matches:_,isDataRoute:n!=null},children:I})};return n&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?l.createElement(Ey,{location:n.location,revalidation:n.revalidation,component:x,error:m,children:w(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):w()},null)}var sg=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(sg||{}),Ks=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Ks||{});function jy(t){let e=l.useContext(Jc);return e||qt(!1),e}function Py(t){let e=l.useContext(Cy);return e||qt(!1),e}function My(t){let e=l.useContext(Sr);return e||qt(!1),e}function ag(t){let e=My(),n=e.matches[e.matches.length-1];return n.route.id||qt(!1),n.route.id}function Oy(){var t;let e=l.useContext(rg),n=Py(Ks.UseRouteError),o=ag(Ks.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[o]}function By(){let{router:t}=jy(sg.UseNavigateStable),e=ag(Ks.UseNavigateStable),n=l.useRef(!1);return ig(()=>{n.current=!0}),l.useCallback(function(i,a){a===void 0&&(a={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Fi({fromRouteId:e},a)))},[t,e])}function Kt(t){qt(!1)}function Ly(t){let{basename:e="/",children:n=null,location:o,navigationType:i=Jo.Pop,navigator:a,static:s=!1,future:c}=t;Aa()&&qt(!1);let d=e.replace(/^\/*/,"/"),u=l.useMemo(()=>({basename:d,navigator:a,static:s,future:Fi({v7_relativeSplatPath:!1},c)}),[d,c,a,s]);typeof o=="string"&&(o=si(o));let{pathname:h="/",search:p="",hash:g="",state:m=null,key:v="default"}=o,x=l.useMemo(()=>{let y=ng(h,d);return y==null?null:{location:{pathname:y,search:p,hash:g,state:m,key:v},navigationType:i}},[d,h,p,g,m,v,i]);return x==null?null:l.createElement(Ea.Provider,{value:u},l.createElement(ka.Provider,{children:n,value:x}))}function Ny(t){let{children:e,location:n}=t;return Iy(Jl(e),n)}new Promise(()=>{});function Jl(t,e){e===void 0&&(e=[]);let n=[];return l.Children.forEach(t,(o,i)=>{if(!l.isValidElement(o))return;let a=[...e,i];if(o.type===l.Fragment){n.push.apply(n,Jl(o.props.children,a));return}o.type!==Kt&&qt(!1),!o.props.index||!o.props.children||qt(!1);let s={id:o.props.id||a.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(s.children=Jl(o.props.children,a)),n.push(s)}),n}/**
 * React Router DOM v6.26.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xl(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let o=t[n];return e.concat(Array.isArray(o)?o.map(i=>[n,i]):[[n,o]])},[]))}function Dy(t,e){let n=Xl(t);return e&&e.forEach((o,i)=>{n.has(i)||e.getAll(i).forEach(a=>{n.append(i,a)})}),n}const Fy="6";try{window.__reactRouterVersion=Fy}catch{}const zy="startTransition",Hu=tv[zy];function Uy(t){let{basename:e,children:n,future:o,window:i}=t,a=l.useRef();a.current==null&&(a.current=Jv({window:i,v5Compat:!0}));let s=a.current,[c,d]=l.useState({action:s.action,location:s.location}),{v7_startTransition:u}=o||{},h=l.useCallback(p=>{u&&Hu?Hu(()=>d(p)):d(p)},[d,u]);return l.useLayoutEffect(()=>s.listen(h),[s,h]),l.createElement(Ly,{basename:e,children:n,location:c.location,navigationType:c.action,navigator:s,future:o})}var qu;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(qu||(qu={}));var Wu;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Wu||(Wu={}));function ts(t){let e=l.useRef(Xl(t)),n=l.useRef(!1),o=Rn(),i=l.useMemo(()=>Dy(o.search,n.current?null:e.current),[o.search]),a=ja(),s=l.useCallback((c,d)=>{const u=Xl(typeof c=="function"?c(i):c);n.current=!0,a("?"+u,d)},[a,i]);return[i,s]}var nn=[];for(var rl=0;rl<256;++rl)nn.push((rl+256).toString(16).slice(1));function Gy(t,e=0){return(nn[t[e+0]]+nn[t[e+1]]+nn[t[e+2]]+nn[t[e+3]]+"-"+nn[t[e+4]]+nn[t[e+5]]+"-"+nn[t[e+6]]+nn[t[e+7]]+"-"+nn[t[e+8]]+nn[t[e+9]]+"-"+nn[t[e+10]]+nn[t[e+11]]+nn[t[e+12]]+nn[t[e+13]]+nn[t[e+14]]+nn[t[e+15]]).toLowerCase()}var vs,Hy=new Uint8Array(16);function qy(){if(!vs&&(vs=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!vs))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return vs(Hy)}var Wy=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const $u={randomUUID:Wy};function lg(t,e,n){if($u.randomUUID&&!e&&!t)return $u.randomUUID();t=t||{};var o=t.random||(t.rng||qy)();return o[6]=o[6]&15|64,o[8]=o[8]&63|128,Gy(o)}const $y="https://api.ideogram.ai".replace(/\/+$/,"");let cg=class{constructor(e={}){this.configuration=e}set config(e){this.configuration=e}get basePath(){return this.configuration.basePath!=null?this.configuration.basePath:$y}get fetchApi(){return this.configuration.fetchApi}get middleware(){return this.configuration.middleware||[]}get queryParamsStringify(){return this.configuration.queryParamsStringify||dg}get username(){return this.configuration.username}get password(){return this.configuration.password}get apiKey(){const e=this.configuration.apiKey;if(e)return typeof e=="function"?e:()=>e}get accessToken(){const e=this.configuration.accessToken;if(e)return typeof e=="function"?e:async()=>e}get headers(){return this.configuration.headers}get credentials(){return this.configuration.credentials}};const Vy=new cg;var hr;let Ky=(hr=class{constructor(e=Vy){ke(this,"fetchApi",async(e,n)=>{let o={url:e,init:n};for(const a of this.middleware)a.pre&&(o=await a.pre({fetch:this.fetchApi,...o})||o);let i;try{i=await(this.configuration.fetchApi||fetch)(o.url,o.init)}catch(a){for(const s of this.middleware)s.onError&&(i=await s.onError({fetch:this.fetchApi,url:o.url,init:o.init,error:a,response:i?i.clone():void 0})||i);if(i===void 0)throw a instanceof Error?new Qy(a,"The request failed and the interceptors did not return an alternative response"):a}for(const a of this.middleware)a.post&&(i=await a.post({fetch:this.fetchApi,url:o.url,init:o.init,response:i.clone()})||i);return i});this.configuration=e,this.middleware=e.middleware}withMiddleware(...e){const n=this.clone();return n.middleware=n.middleware.concat(...e),n}withPreMiddleware(...e){const n=e.map(o=>({pre:o}));return this.withMiddleware(...n)}withPostMiddleware(...e){const n=e.map(o=>({post:o}));return this.withMiddleware(...n)}isJsonMime(e){return e?hr.jsonRegex.test(e):!1}async request(e,n){const{url:o,init:i}=await this.createFetchParams(e,n),a=await this.fetchApi(o,i);if(a&&a.status>=200&&a.status<300)return a;throw new Yy(a,"Response returned an error code")}async createFetchParams(e,n){let o=this.configuration.basePath+e.path;e.query!==void 0&&Object.keys(e.query).length!==0&&(o+="?"+this.configuration.queryParamsStringify(e.query));const i=Object.assign({},this.configuration.headers,e.headers);Object.keys(i).forEach(h=>i[h]===void 0?delete i[h]:{});const a=typeof n=="function"?n:async()=>n,s={method:e.method,headers:i,body:e.body,credentials:this.configuration.credentials},c={...s,...await a({init:s,context:e})};let d;Xy(c.body)||c.body instanceof URLSearchParams||Jy(c.body)?d=c.body:this.isJsonMime(i["Content-Type"])?d=JSON.stringify(c.body):d=c.body;const u={...c,body:d};return{url:o,init:u}}clone(){const e=this.constructor,n=new e(this.configuration);return n.middleware=this.middleware.slice(),n}},ke(hr,"jsonRegex",new RegExp("^(:?application/json|[^;/ 	]+/[^;/ 	]+[+]json)[ 	]*(:?;.*)?$","i")),hr);function Jy(t){return typeof Blob<"u"&&t instanceof Blob}function Xy(t){return typeof FormData<"u"&&t instanceof FormData}let Yy=class extends Error{constructor(n,o){super(o);ke(this,"name","ResponseError");this.response=n}},Qy=class extends Error{constructor(n,o){super(o);ke(this,"name","FetchError");this.cause=n}},il=class extends Error{constructor(n,o){super(o);ke(this,"name","RequiredError");this.field=n}};function dg(t,e=""){return Object.keys(t).map(n=>ug(n,t[n],e)).filter(n=>n.length>0).join("&")}function ug(t,e,n=""){const o=n+(n.length?`[${t}]`:t);if(e instanceof Array){const i=e.map(a=>encodeURIComponent(String(a))).join(`&${encodeURIComponent(o)}=`);return`${encodeURIComponent(o)}=${i}`}if(e instanceof Set){const i=Array.from(e);return ug(t,i,n)}return e instanceof Date?`${encodeURIComponent(o)}=${encodeURIComponent(e.toISOString())}`:e instanceof Object?dg(e,o):`${encodeURIComponent(o)}=${encodeURIComponent(String(e))}`}let ir=class{constructor(e,n=o=>o){this.raw=e,this.transformer=n}async value(){return this.transformer(await this.raw.json())}},Vu=class{constructor(e){this.raw=e}async value(){}};function Zy(t){return ew(t)}function ew(t,e){return t==null?t:{termsId:t.terms_id,termsUrl:t.terms_url}}function tw(t){return nw(t)}function nw(t,e){return t==null?t:{redactedApiKey:t.redacted_api_key,creationTime:new Date(t.creation_time),apiKeyId:t.api_key_id}}function ow(t){return rw(t)}function rw(t,e){return t==null?t:{currentApiKeys:t.current_api_keys==null?void 0:t.current_api_keys.map(tw)}}function iw(t){return sw(t)}function sw(t,e){return t==null?t:{apiTerms:Zy(t.api_terms)}}function aw(t){return lw(t)}function lw(t,e){return t==null?t:{stripeSubscriptionUrl:t.stripe_subscription_url==null?void 0:t.stripe_subscription_url,stripeBillingUrl:t.stripe_billing_url==null?void 0:t.stripe_billing_url}}function cw(t){return dw(t)}function dw(t,e){return t==null?t:{invoicesIframeUrl:t.invoices_iframe_url==null?void 0:t.invoices_iframe_url,invoicesIframeDarkModeUrl:t.invoices_iframe_dark_mode_url==null?void 0:t.invoices_iframe_dark_mode_url,creditsIframeUrl:t.credits_iframe_url==null?void 0:t.credits_iframe_url,creditsIframeDarkModeUrl:t.credits_iframe_dark_mode_url==null?void 0:t.credits_iframe_dark_mode_url}}function Ku(t){return uw(t)}function uw(t,e){return t==null?t:{currencyCode:t.currency_code,amount:t.amount}}function Ju(t){return t==null?t:{currency_code:t.currencyCode,amount:t.amount}}function Xc(t){return hw(t)}function hw(t,e){return t==null?t:{isActive:t.is_active,topUpBalance:Ku(t.top_up_balance),minimumBalanceThreshold:Ku(t.minimum_balance_threshold)}}function pw(t){return fw(t)}function fw(t,e){return t==null?t:{hasAcceptedTerms:t.has_accepted_terms,hasStripeSetup:t.has_stripe_setup,metronomeDashboardUrl:t.metronome_dashboard_url==null?void 0:t.metronome_dashboard_url,metronomeDashboardDarkModeUrl:t.metronome_dashboard_dark_mode_url==null?void 0:t.metronome_dashboard_dark_mode_url,metronomeLinks:t.metronome_links==null?void 0:cw(t.metronome_links),rechargeSettings:t.recharge_settings==null?void 0:Xc(t.recharge_settings),stripeBillingUrl:t.stripe_billing_url==null?void 0:t.stripe_billing_url}}function gw(t){return mw(t)}function mw(t,e){return t==null?t:{apiKey:t.api_key,apiKeyId:t.api_key_id}}function xw(t){return vw(t)}function vw(t,e){return t==null?t:{rechargeSettings:t.recharge_settings==null?void 0:Xc(t.recharge_settings)}}function yw(t){return t==null?t:{top_up_balance:Ju(t.topUpBalance),minimum_balance_threshold:Ju(t.minimumBalanceThreshold)}}function ww(t){return t==null?t:{recharge_settings:yw(t.rechargeSettings)}}function bw(t){return Cw(t)}function Cw(t,e){return t==null?t:{rechargeSettings:t.recharge_settings==null?void 0:Xc(t.recharge_settings)}}function _w(t){return t==null?t:{terms_id:t.termsId}}class Iw extends Ky{async createApiKeyRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("BearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/manage/api/api_keys",method:"POST",headers:o,query:n},e);return new ir(i,a=>gw(a))}async createApiKey(e){return await(await this.createApiKeyRaw(e)).value()}async deleteSingleApiKeyRaw(e,n){if(e.apiKeyId==null)throw new il("apiKeyId",'Required parameter "apiKeyId" was null or undefined when calling deleteSingleApiKey().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("BearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/manage/api/api_keys/{api_key_id}".replace("{api_key_id}",encodeURIComponent(String(e.apiKeyId))),method:"DELETE",headers:i,query:o},n);return new Vu(a)}async deleteSingleApiKey(e,n){await this.deleteSingleApiKeyRaw(e,n)}async getApiKeysRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("BearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/manage/api/api_keys",method:"GET",headers:o,query:n},e);return new ir(i,a=>ow(a))}async getApiKeys(e){return await(await this.getApiKeysRaw(e)).value()}async getApiStripeSubscriptionRaw(e,n){const o={};e.isBusiness!=null&&(o.isBusiness=e.isBusiness);const i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("BearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/manage/api/stripe_subscription",method:"GET",headers:i,query:o},n);return new ir(a,s=>aw(s))}async getApiStripeSubscription(e={},n){return await(await this.getApiStripeSubscriptionRaw(e,n)).value()}async getApiSubscriptionRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("BearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/manage/api/subscription",method:"GET",headers:o,query:n},e);return new ir(i,a=>pw(a))}async getApiSubscription(e){return await(await this.getApiSubscriptionRaw(e)).value()}async getApiTermsRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("BearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/manage/api/terms",method:"GET",headers:o,query:n},e);return new ir(i,a=>iw(a))}async getApiTerms(e){return await(await this.getApiTermsRaw(e)).value()}async postApiSubscriptionRaw(e,n){if(e.postApiSubscriptionRequest==null)throw new il("postApiSubscriptionRequest",'Required parameter "postApiSubscriptionRequest" was null or undefined when calling postApiSubscription().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("BearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/manage/api/subscription",method:"POST",headers:i,query:o,body:ww(e.postApiSubscriptionRequest)},n);return new ir(a,s=>bw(s))}async postApiSubscription(e,n){return await(await this.postApiSubscriptionRaw(e,n)).value()}async postApiTermsRaw(e,n){if(e.postApiTermsRequest==null)throw new il("postApiTermsRequest",'Required parameter "postApiTermsRequest" was null or undefined when calling postApiTerms().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("BearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/manage/api/terms",method:"POST",headers:i,query:o,body:_w(e.postApiTermsRequest)},n);return new Vu(a)}async postApiTerms(e,n){await this.postApiTermsRaw(e,n)}async reactivateSubscriptionRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("BearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/manage/api/reactivate",method:"POST",headers:o,query:n},e);return new ir(i,a=>xw(a))}async reactivateSubscription(e){return await(await this.reactivateSubscriptionRaw(e)).value()}}const Sw="/api".replace(/\/+$/,"");class Yl{constructor(e={}){this.configuration=e}set config(e){this.configuration=e}get basePath(){return this.configuration.basePath!=null?this.configuration.basePath:Sw}get fetchApi(){return this.configuration.fetchApi}get middleware(){return this.configuration.middleware||[]}get queryParamsStringify(){return this.configuration.queryParamsStringify||hg}get username(){return this.configuration.username}get password(){return this.configuration.password}get apiKey(){const e=this.configuration.apiKey;if(e)return typeof e=="function"?e:()=>e}get accessToken(){const e=this.configuration.accessToken;if(e)return typeof e=="function"?e:async()=>e}get headers(){return this.configuration.headers}get credentials(){return this.configuration.credentials}}const Rw=new Yl,fa=class fa{constructor(e=Rw){ke(this,"fetchApi",async(e,n)=>{let o={url:e,init:n};for(const a of this.middleware)a.pre&&(o=await a.pre({fetch:this.fetchApi,...o})||o);let i;try{i=await(this.configuration.fetchApi||fetch)(o.url,o.init)}catch(a){for(const s of this.middleware)s.onError&&(i=await s.onError({fetch:this.fetchApi,url:o.url,init:o.init,error:a,response:i?i.clone():void 0})||i);if(i===void 0)throw a instanceof Error?new kw(a,"The request failed and the interceptors did not return an alternative response"):a}for(const a of this.middleware)a.post&&(i=await a.post({fetch:this.fetchApi,url:o.url,init:o.init,response:i.clone()})||i);return i});this.configuration=e,this.middleware=e.middleware}withMiddleware(...e){const n=this.clone();return n.middleware=n.middleware.concat(...e),n}withPreMiddleware(...e){const n=e.map(o=>({pre:o}));return this.withMiddleware(...n)}withPostMiddleware(...e){const n=e.map(o=>({post:o}));return this.withMiddleware(...n)}isJsonMime(e){return e?fa.jsonRegex.test(e):!1}async request(e,n){const{url:o,init:i}=await this.createFetchParams(e,n),a=await this.fetchApi(o,i);if(a&&a.status>=200&&a.status<300)return a;throw new Yr(a,"Response returned an error code")}async createFetchParams(e,n){let o=this.configuration.basePath+e.path;e.query!==void 0&&Object.keys(e.query).length!==0&&(o+="?"+this.configuration.queryParamsStringify(e.query));const i=Object.assign({},this.configuration.headers,e.headers);Object.keys(i).forEach(h=>i[h]===void 0?delete i[h]:{});const a=typeof n=="function"?n:async()=>n,s={method:e.method,headers:i,body:e.body,credentials:this.configuration.credentials},c={...s,...await a({init:s,context:e})};let d;Ew(c.body)||c.body instanceof URLSearchParams||Tw(c.body)?d=c.body:this.isJsonMime(i["Content-Type"])?d=JSON.stringify(c.body):d=c.body;const u={...c,body:d};return{url:o,init:u}}clone(){const e=this.constructor,n=new e(this.configuration);return n.middleware=this.middleware.slice(),n}};ke(fa,"jsonRegex",new RegExp("^(:?application/json|[^;/ 	]+/[^;/ 	]+[+]json)[ 	]*(:?;.*)?$","i"));let eo=fa;function Tw(t){return typeof Blob<"u"&&t instanceof Blob}function Ew(t){return typeof FormData<"u"&&t instanceof FormData}class Yr extends Error{constructor(n,o){super(o);ke(this,"name","ResponseError");this.response=n}}class kw extends Error{constructor(n,o){super(o);ke(this,"name","FetchError");this.cause=n}}class _e extends Error{constructor(n,o){super(o);ke(this,"name","RequiredError");this.field=n}}function hg(t,e=""){return Object.keys(t).map(n=>pg(n,t[n],e)).filter(n=>n.length>0).join("&")}function pg(t,e,n=""){const o=n+(n.length?`[${t}]`:t);if(e instanceof Array){const i=e.map(a=>encodeURIComponent(String(a))).join(`&${encodeURIComponent(o)}=`);return`${encodeURIComponent(o)}=${i}`}if(e instanceof Set){const i=Array.from(e);return pg(t,i,n)}return e instanceof Date?`${encodeURIComponent(o)}=${encodeURIComponent(e.toISOString())}`:e instanceof Object?hg(e,o):`${encodeURIComponent(o)}=${encodeURIComponent(String(e))}`}function Fr(t){for(const e of t)if(e.contentType==="multipart/form-data")return!0;return!1}class Oe{constructor(e,n=o=>o){this.raw=e,this.transformer=n}async value(){return this.transformer(await this.raw.json())}}class bn{constructor(e){this.raw=e}async value(){}}class Js{constructor(e){this.raw=e}async value(){return await this.raw.blob()}}function Aw(t){return t==null?t:{organization_invite_id:t.organizationInviteId}}function fg(t){return jw(t)}function jw(t,e){return t==null?t:{avatarUrl:t.avatar_url}}const Wr={Owner:"OWNER",Writer:"WRITER"};function Yc(t){return Pw(t)}function Pw(t,e){return t}const gg={Private:"PRIVATE",Team:"TEAM"};function Mw(t){return Ow(t)}function Ow(t,e){return t}function ns(t){return Bw(t)}function Bw(t,e){return t==null?t:{organizationId:t.organization_id,name:t.name,type:t.type==null?void 0:Mw(t.type),role:t.role==null?void 0:Yc(t.role),avatar:t.avatar==null?void 0:fg(t.avatar)}}function Lw(t){return Nw(t)}function Nw(t,e){return t==null?t:{organization:ns(t.organization)}}const mg={Apple:"APPLE",Stripe:"STRIPE"};function Dw(t){return Fw(t)}function Fw(t,e){return t}function zw(t){return Uw(t)}function Uw(t,e){return t==null?t:{planId:t.plan_id,planName:t.plan_name,startTime:new Date(t.start_time),terminationTime:new Date(t.termination_time),priceCurrency:t.price_currency==null?void 0:t.price_currency,priceAmount:t.price_amount==null?void 0:t.price_amount,pricePeriod:t.price_period==null?void 0:t.price_period,subscriptionProvider:t.subscription_provider==null?void 0:Dw(t.subscription_provider)}}const sl={Positive:"POSITIVE",Negative:"NEGATIVE",Neutral:"NEUTRAL"};function Gw(t){return t==null?t:{description_id:t.descriptionId,reaction:t.reaction}}const _9={InProgress:"IN_PROGRESS",Paused:"PAUSED",Canceled:"CANCELED"};const Qr={Asset:"ASSET",CanvasAsset:"CANVAS_ASSET",Response:"RESPONSE",Upload:"UPLOAD"};function Hw(t){return qw(t)}function qw(t,e){return t}function Xu(t){return Ww(t)}function Ww(t,e){return t==null?t:{assetType:Hw(t.asset_type),assetId:t.asset_id}}function Yu(t){return t==null?t:{asset_type:t.assetType,asset_id:t.assetId}}function $w(t){return Vw(t)}function Vw(t,e){return t}function ki(t){return Kw(t)}function Kw(t,e){return t==null?t:{aspectRatio:t.aspect_ratio,height:t.height,width:t.width}}function xg(t){return t==null?t:{aspect_ratio:t.aspectRatio,height:t.height,width:t.width}}function Jw(t){return Xw(t)}function Xw(t,e){return t==null?t:{modelVersion:$w(t.model_version),basicResolutions:t.basic_resolutions==null?void 0:t.basic_resolutions.map(ki),advancedResolutions:t.advanced_resolutions==null?void 0:t.advanced_resolutions.map(ki),restrictedResolutions:t.restricted_resolutions==null?void 0:t.restricted_resolutions.map(ki)}}function Yw(t){return Qw(t)}function Qw(t,e){return t==null?t:{availableResolutions:Jw(t.available_resolutions)}}const I9={Beacons:"BEACONS",BuyMeACoffee:"BUY_ME_A_COFFEE",SquareCashApp:"SQUARE_CASH_APP",Discord:"DISCORD",Etsy:"ETSY",Facebook:"FACEBOOK",Instagram:"INSTAGRAM",KoFi:"KO_FI",LinkedIn:"LINKED_IN",Linktree:"LINKTREE",Patreon:"PATREON",Paypal:"PAYPAL",Shopify:"SHOPIFY",Tiktok:"TIKTOK",Twitter:"TWITTER",Venmo:"VENMO",Youtube:"YOUTUBE"};function Qc(t){return Zw(t)}function Zw(t,e){return t}function Pa(t){return t==null?t:{social_platform:t.socialPlatform,social_platform_user_handle:t.socialPlatformUserHandle}}function e2(t){return t2(t)}function t2(t,e){return t==null?t:{jobId:t.job_id,userId:t.user_id,jobSize:t.job_size}}function n2(t){return o2(t)}function o2(t,e){return t==null?t:{batchGenerationModel:e2(t.batch_generation_model)}}function r2(t){return i2(t)}function i2(t,e){return t==null?t:{userDisplayHandle:t.user_display_handle,userId:t.user_id,blockedTime:t.blocked_time==null?void 0:new Date(t.blocked_time)}}function s2(t){return t==null?t:{cover_only:t.coverOnly,image_ids:t.imageIds,request_ids:t.requestIds,response_ids:t.responseIds}}function a2(t){return l2(t)}function l2(t,e){return t==null?t:{resultId:t.result_id==null?void 0:t.result_id,fileName:t.file_name==null?void 0:t.file_name}}function c2(t){return t==null?t:{organization_invite_id:t.organizationInviteId}}function vg(t){return d2(t)}function d2(t,e){return t==null?t:{canvasAssetId:t.canvas_asset_id,canvasAssetContent:t.canvas_asset_content}}const S9={Response:"RESPONSE",Upload:"UPLOAD"};function u2(t){return h2(t)}function h2(t,e){return t==null?t:{canvasId:t.canvas_id,createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at),title:t.title==null?void 0:t.title}}function yg(t){return p2(t)}function p2(t,e){return t==null?t:{title:t.title==null?void 0:t.title,canvasId:t.canvas_id==null?void 0:t.canvas_id,createdAt:t.created_at==null?void 0:new Date(t.created_at),updatedAt:t.updated_at==null?void 0:new Date(t.updated_at),canvasJson:t.canvas_json==null?void 0:t.canvas_json,currentTransactionId:t.current_transaction_id==null?void 0:t.current_transaction_id}}function f2(t){return g2(t)}function g2(t,e){return t==null?t:{caption:t.caption==null?void 0:t.caption}}function m2(t){return x2(t)}function x2(t,e){return t==null?t:{colorHex:t.color_hex,colorWeight:t.color_weight==null?void 0:t.color_weight}}function v2(t){return t==null?t:{color_hex:t.colorHex,color_weight:t.colorWeight}}function y2(t){return w2(t)}function w2(t,e){return t}function b2(t){return C2(t)}function C2(t,e){return t==null?t:{name:y2(t.name),members:t.members.map(m2)}}function _2(t){return"members"in t}function I2(t){return t==null?t:{members:t.members.map(v2)}}function S2(t){return"name"in t}function R2(t){return t==null?t:{name:t.name}}function wg(t){return t==null?t:_2(t)?I2(t):S2(t)?R2(t):{}}function T2(t){return E2(t)}function E2(t,e){return t==null?t:{presetColorPalettes:t.preset_color_palettes==null?void 0:t.preset_color_palettes.map(b2)}}function k2(t){return t==null?t:{invitee_user_display_handle:t.inviteeUserDisplayHandle,invitee_user_email:t.inviteeUserEmail}}function A2(t){return t==null?t:{invite_requests:t.inviteRequests==null?void 0:t.inviteRequests.map(k2)}}function j2(t){return P2(t)}function P2(t,e){return t}function M2(t){return O2(t)}function O2(t,e){return t==null?t:{description:t.description,errorType:t.error_type==null?void 0:j2(t.error_type)}}function Zc(t){return B2(t)}function B2(t,e){return t==null?t:{organizationInviteId:t.organization_invite_id,organizationId:t.organization_id,inviteeUserId:t.invitee_user_id==null?void 0:t.invitee_user_id,inviteeUserEmail:t.invitee_user_email==null?void 0:t.invitee_user_email,inviteeUserDisplayHandle:t.invitee_user_display_handle==null?void 0:t.invitee_user_display_handle,inviterUserId:t.inviter_user_id==null?void 0:t.inviter_user_id,expiryTime:t.expiry_time==null?void 0:new Date(t.expiry_time)}}function L2(t){return N2(t)}function N2(t,e){return t==null?t:{invites:t.invites==null?void 0:t.invites.map(Zc),errors:t.errors==null?void 0:t.errors.map(M2)}}function D2(t){return t==null?t:{name:t.name}}function F2(t){return z2(t)}function z2(t,e){return t==null?t:{organization:ns(t.organization)}}function U2(t){return t==null?t:{organization_id:t.organizationId,user_id:t.userId,quantity:t.quantity,reason:t.reason}}function G2(t){return H2(t)}function H2(t,e){return t==null?t:{purchaseLink:t.purchase_link}}function q2(t){return t==null?t:{response_id:t.responseId,image_id:t.imageId,url:t.url}}function W2(t){return $2(t)}function $2(t,e){return t==null?t:{descriptionId:t.description_id,created:new Date(t.created),data:t.data.map(f2)}}const Qu={Png:"PNG",Jpeg:"JPEG"},hn={X1:"X1",X2:"X2",X4:"X4",X8:"X8",Mp4:"MP4"};function bg(t){return V2(t)}function V2(t,e){return t==null?t:{features:t.features}}function K2(t){return t==null?t:{plan_id:t.planId}}function J2(t){return X2(t)}function X2(t,e){return t==null?t:{celloToken:t.cello_token}}function Y2(t){return Q2(t)}function Q2(t,e){return t==null?t:{failureMessage:t.failure_message==null?void 0:t.failure_message}}const Z2={Quality:"QUALITY",Balanced:"BALANCED",Fast:"FAST"};const ar={Auto:"AUTO",General:"GENERAL",Realistic:"REALISTIC",Design:"DESIGN",Render3D:"RENDER_3D",Anime:"ANIME"};function eb(t){return t==null?t:{prompt:t.prompt,model:t.model,magic_prompt_option:t.magicPromptOption,seed:t.seed,style_type:t.styleType,negative_prompt:t.negativePrompt,private:t._private,resolution:xg(t.resolution),sampling_speed:t.samplingSpeed,tile_type:t.tileType,color_palette:wg(t.colorPalette)}}function tb(t){return t==null?t:{image_weight:t.imageWeight,prompt:t.prompt,model:t.model,magic_prompt_option:t.magicPromptOption,seed:t.seed,style_type:t.styleType,negative_prompt:t.negativePrompt,private:t._private,resolution:xg(t.resolution),sampling_speed:t.samplingSpeed,tile_type:t.tileType,color_palette:wg(t.colorPalette)}}function al(t){return nb(t)}function nb(t,e){return t==null?t:{seed:t.seed==null?void 0:t.seed,resolution:t.resolution==null?void 0:t.resolution,rejectedPromptId:t.rejected_prompt_id==null?void 0:t.rejected_prompt_id,requestId:t.request_id==null?void 0:t.request_id}}function ob(t){return rb(t)}function rb(t,e){return t==null?t:{jwt:t.jwt==null?void 0:t.jwt}}const R9={InProgress:"IN_PROGRESS",Paused:"PAUSED",Completed:"COMPLETED",Canceled:"CANCELED"};function Cg(t){return ib(t)}function ib(t,e){return t}function sb(t){return ab(t)}function ab(t,e){return t==null?t:{jobId:t.job_id,jobStatus:Cg(t.job_status)}}function lb(t){return cb(t)}function cb(t,e){return t==null?t:{jobId:t.job_id==null?void 0:t.job_id,jobStatus:t.job_status==null?void 0:Cg(t.job_status),jobName:t.job_name==null?void 0:t.job_name,creationTimestamp:t.creation_timestamp==null?void 0:new Date(t.creation_timestamp),completionPercentage:t.completion_percentage==null?void 0:t.completion_percentage}}function db(t){return ub(t)}function ub(t,e){return t==null?t:{blockedUsers:t.blocked_users==null?void 0:t.blocked_users.map(r2)}}function hb(t){return pb(t)}function pb(t,e){return t==null?t:{canvasAsset:vg(t.canvas_asset)}}function fb(t){return gb(t)}function gb(t,e){return t==null?t:{canvas:yg(t.canvas)}}function mb(t){return xb(t)}function xb(t,e){return t==null?t:{generationJob:sb(t.generation_job)}}function vb(t){return yb(t)}function yb(t,e){return t==null?t:{resumableJobs:t.resumable_jobs==null?void 0:t.resumable_jobs,unresumableJobs:t.unresumable_jobs==null?void 0:t.unresumable_jobs}}function wb(t){return bb(t)}function bb(t,e){return t==null?t:{canvasIds:t.canvas_ids==null?void 0:t.canvas_ids,canvasListItems:t.canvas_list_items==null?void 0:t.canvas_list_items.map(u2),nextPage:t.next_page==null?void 0:t.next_page}}function Cb(t){return _b(t)}function _b(t,e){return t==null?t:{displayHandle:t.display_handle,joined:t.joined,invited:t.invited,profilePic:t.profile_pic==null?void 0:t.profile_pic,name:t.name==null?void 0:t.name}}function Ib(t){return Sb(t)}function Sb(t,e){return t==null?t:{organizationInviteSuggestions:t.organization_invite_suggestions==null?void 0:t.organization_invite_suggestions.map(Cb)}}function Rb(t){return Tb(t)}function Tb(t,e){return t==null?t:{organizationId:t.organization_id==null?void 0:t.organization_id,userId:t.user_id==null?void 0:t.user_id,displayHandle:t.display_handle==null?void 0:t.display_handle,externalPhotoUrl:t.external_photo_url==null?void 0:t.external_photo_url,email:t.email==null?void 0:t.email,role:t.role==null?void 0:Yc(t.role),inviteStatus:t.invite_status==null?void 0:t.invite_status,inviteId:t.invite_id==null?void 0:t.invite_id,inviteExpiryTime:t.invite_expiry_time==null?void 0:new Date(t.invite_expiry_time),credits:t.credits==null?void 0:t.credits}}function Eb(t){return kb(t)}function kb(t,e){return t==null?t:{members:t.members==null?void 0:t.members.map(Rb)}}function Ab(t){return jb(t)}function jb(t,e){return t==null?t:{invoiceTotal:t.invoice_total==null?void 0:t.invoice_total,nextBillingDate:t.next_billing_date==null?void 0:new Date(t.next_billing_date)}}function Pb(t){return Mb(t)}function Mb(t,e){return t==null?t:{requestorRole:Yc(t.requestor_role),memberCount:t.member_count,activeInviteCount:t.active_invite_count,organization:ns(t.organization),billingInfo:Ab(t.billing_info)}}function Ob(t){return Bb(t)}function Bb(t,e){return t==null?t:{organizations:t.organizations==null?void 0:t.organizations.map(ns),ownsTeamOrganization:t.owns_team_organization==null?void 0:t.owns_team_organization}}function Lb(t){return Nb(t)}function Nb(t,e){return t==null?t:{page:t.page,pageSize:t.page_size==null?void 0:t.page_size}}function Db(t){return Fb(t)}function Fb(t,e){return t==null?t:{socialProviders:t.social_providers==null?void 0:t.social_providers.map(Qc)}}function zb(t){return Ub(t)}function Ub(t,e){return t}function Gb(t){return Hb(t)}function Hb(t,e){return t==null?t:{type:zb(t.type),amount:t.amount}}function qb(t){return Wb(t)}function Wb(t,e){return t==null?t:{evaluatedCosts:t.evaluated_costs==null?void 0:t.evaluated_costs.map(Gb)}}function $b(t){return Vb(t)}function Vb(t,e){return t==null?t:{invites:t.invites==null?void 0:t.invites.map(Zc)}}function Kb(t){return Jb(t)}function Jb(t,e){return t==null?t:{linkId:t.link_id,socialLinkUrl:t.social_link_url,socialPlatform:Qc(t.social_platform),socialPlatformUserHandle:t.social_platform_user_handle}}function Ma(t){return Xb(t)}function Xb(t,e){return t==null?t:{profileId:t.profile_id,joinedDate:t.joined_date==null?void 0:new Date(t.joined_date),displayHandle:t.display_handle,displayName:t.display_name==null?void 0:t.display_name,displayLocation:t.display_location==null?void 0:t.display_location,userBio:t.user_bio==null?void 0:t.user_bio,socialLinks:t.social_links==null?void 0:t.social_links.map(Kb)}}function Yb(t){return Qb(t)}function Qb(t,e){return t==null?t:{userProfiles:t.user_profiles.map(Ma)}}function Zb(t){return eC(t)}function eC(t,e){return t==null?t:{splashImageUrls:t.splash_image_urls}}function tC(t){return t==null?t:{reason:t.reason}}const lt={AppMenuUpgradePlan:"APP_MENU_UPGRADE_PLAN",AppleUpgradePlan:"APPLE_UPGRADE_PLAN",DailyLimitBanner:"DAILY_LIMIT_BANNER",DailyLimitBannerV2:"DAILY_LIMIT_BANNER_V2",DescribeQuotaError:"DESCRIBE_QUOTA_ERROR",DescribeQuotaWarning:"DESCRIBE_QUOTA_WARNING",DesktopHeaderUpgrade:"DESKTOP_HEADER_UPGRADE",DevelopmentEnvironmentHardCancel:"DEVELOPMENT_ENVIRONMENT_HARD_CANCEL",DirectPricingPageVisit:"DIRECT_PRICING_PAGE_VISIT",EditorSnackBar:"EDITOR_SNACK_BAR",EditorVisibilitySnackBar:"EDITOR_VISIBILITY_SNACK_BAR",FoundSubscriptionInAppMenu:"FOUND_SUBSCRIPTION_IN_APP_MENU",GenerationInputDailyLimitBox:"GENERATION_INPUT_DAILY_LIMIT_BOX",GenerationInputWaitTimeBox:"GENERATION_INPUT_WAIT_TIME_BOX",GenerationQuotaDisplay:"GENERATION_QUOTA_DISPLAY",ImageUploadTooltip:"IMAGE_UPLOAD_TOOLTIP",NegativePromptInputTooltip:"NEGATIVE_PROMPT_INPUT_TOOLTIP",NewFeatureDemoModal:"NEW_FEATURE_DEMO_MODAL",PaywallModalDirectCheckout:"PAYWALL_MODAL_DIRECT_CHECKOUT",RenderingInputTooltip:"RENDERING_INPUT_TOOLTIP",RetryOrRemixAlert:"RETRY_OR_REMIX_ALERT",SeedInputTooltip:"SEED_INPUT_TOOLTIP",SeeAllPlansFromPaywallModal:"SEE_ALL_PLANS_FROM_PAYWALL_MODAL",SlowQueueFullBannerV2:"SLOW_QUEUE_FULL_BANNER_V2",TileInputTooltip:"TILE_INPUT_TOOLTIP",TileQuotaWarning:"TILE_QUOTA_WARNING",Unknown:"UNKNOWN",VisibilityInputTooltip:"VISIBILITY_INPUT_TOOLTIP",WaitTimeBanner:"WAIT_TIME_BANNER",WaitTimeButtonFloatingText:"WAIT_TIME_BUTTON_FLOATING_TEXT",ZoomInPageVisibilitySnackBar:"ZOOM_IN_PAGE_VISIBILITY_SNACK_BAR"};function nC(t){return t==null?t:{profile_id:t.profileId,social_link_ids_to_remove:t.socialLinkIdsToRemove,display_name:t.displayName,display_location:t.displayLocation,user_bio:t.userBio,social_links:t.socialLinks==null?void 0:t.socialLinks.map(Pa)}}function oC(t){return rC(t)}function rC(t,e){return t==null?t:{userProfile:Ma(t.user_profile)}}function iC(t){return sC(t)}function sC(t,e){return t==null?t:{downloadUrl:t.download_url==null?void 0:t.download_url,status:t.status==null?void 0:t.status,error:t.error==null?void 0:t.error}}function aC(t){return t==null?t:{asset_type:t.assetType,asset_id:t.assetId,current_transaction_id:t.currentTransactionId}}function lC(t){return cC(t)}function cC(t,e){return t==null?t:{canvasAsset:vg(t.canvas_asset),currentTransactionId:t.current_transaction_id}}function dC(t){return t==null?t:{block_user_id:t.blockUserId}}function uC(t){return hC(t)}function hC(t,e){return t==null?t:{placeholder:t.placeholder==null?void 0:t.placeholder}}function pC(t){return t==null?t:{asset_type:t.assetType,asset_id:t.assetId}}function fC(t){return t==null?t:{asset_type:t.assetType,asset_id:t.assetId}}function gC(t){return mC(t)}function mC(t,e){return t==null?t:{avatar:fg(t.avatar)}}function xC(t){return t==null?t:{social_link_request:Pa(t.socialLinkRequest)}}function vC(t){return yC(t)}function yC(t,e){return t==null?t:{socialLinkUrl:t.social_link_url,socialPlatform:Qc(t.social_platform),socialPlatformUserHandle:t.social_platform_user_handle}}function wC(t){return bC(t)}function bC(t,e){return t==null?t:{socialLink:vC(t.social_link)}}function CC(t){return t==null?t:{asset_ids_to_keep:t.assetIdsToKeep,current_transaction_id:t.currentTransactionId}}function _C(t){return IC(t)}function IC(t,e){return t==null?t:{currentTransactionId:t.current_transaction_id}}function SC(t){return t==null?t:{canvas_asset_id:t.canvasAssetId,current_transaction_id:t.currentTransactionId}}function RC(t){return TC(t)}function TC(t,e){return t==null?t:{canvasTransactionId:t.canvas_transaction_id}}function EC(t){return t==null?t:{asset_type:t.assetType,asset_id:t.assetId}}function kC(t){return AC(t)}function AC(t,e){return t==null?t:{backgroundRemovedImageId:t.background_removed_image_id}}function jC(t){return t==null?t:{sampling_response_id:t.samplingResponseId,prompt:t.prompt,magic_prompt_option:t.magicPromptOption,style_type:t.styleType,private:t._private}}function PC(t){return t==null?t:{blocked_user_id:t.blockedUserId,blocked_user_handle:t.blockedUserHandle}}function MC(t){return OC(t)}function OC(t,e){return t==null?t:{placeholder:t.placeholder==null?void 0:t.placeholder}}function BC(t){return t==null?t:{display_name:t.displayName,display_location:t.displayLocation,user_bio:t.userBio,social_links:t.socialLinks==null?void 0:t.socialLinks.map(Pa)}}function LC(t){return NC(t)}function NC(t,e){return t==null?t:{userProfile:Ma(t.user_profile)}}function DC(t){return FC(t)}function FC(t,e){return t==null?t:{prompt:t.prompt==null?void 0:t.prompt,visibility:t.visibility==null?void 0:t.visibility,magicPrompt:t.magic_prompt==null?void 0:t.magic_prompt,aspectRatio:t.aspect_ratio==null?void 0:t.aspect_ratio,model:t.model==null?void 0:t.model,seedNumber:t.seed_number==null?void 0:t.seed_number,rendering:t.rendering==null?void 0:t.rendering,negativePrompt:t.negative_prompt==null?void 0:t.negative_prompt,style:t.style==null?void 0:t.style,colorPalette:t.color_palette==null?void 0:t.color_palette}}function zC(t){return t==null?t:{canvas_id:t.canvasId,canvas_json:t.canvasJson,title:t.title,current_transaction_id:t.currentTransactionId}}function UC(t){return GC(t)}function GC(t,e){return t==null?t:{canvas:yg(t.canvas)}}function HC(t){return t==null?t:{profile_id:t.profileId,display_name:t.displayName,display_location:t.displayLocation,user_bio:t.userBio,social_links:t.socialLinks==null?void 0:t.socialLinks.map(Pa)}}function qC(t){return WC(t)}function WC(t,e){return t==null?t:{userProfile:Ma(t.user_profile)}}function $C(t){return VC(t)}function VC(t,e){return t}function KC(t){return JC(t)}function JC(t,e){return t==null?t:{queueType:t.queue_type==null?void 0:$C(t.queue_type),activeRequestsInQueue:t.active_requests_in_queue==null?void 0:t.active_requests_in_queue}}function XC(t){return t==null?t:{user_id:t.userId,reason:t.reason}}function YC(t){return t==null?t:{organization_invite_id:t.organizationInviteId}}function QC(t){return ZC(t)}function ZC(t,e){return t==null?t:{invite:Zc(t.invite)}}function e_(t){return t_(t)}function t_(t,e){return t==null?t:{colorPalettes:T2(t.color_palettes)}}function n_(t){return o_(t)}function o_(t,e){return t==null?t:{jobs:t.jobs==null?void 0:t.jobs.map(lb),hasMoreJobs:t.has_more_jobs==null?void 0:t.has_more_jobs,totalJobs:t.total_jobs==null?void 0:t.total_jobs}}function r_(t){return t==null?t:{include_inactive:t.includeInactive}}function i_(t){return s_(t)}function s_(t,e){return t==null?t:{queuedRequests:t.queued_requests==null?void 0:t.queued_requests.map(KC),requestsInProgress:t.requests_in_progress==null?void 0:t.requests_in_progress}}function a_(t){return l_(t)}function l_(t,e){return t==null?t:{samplingRequests:t.sampling_requests}}function c_(t){return t==null?t:{request_ids:t.requestIds}}function d_(t){return u_(t)}function u_(t,e){return t==null?t:{samplingRequests:t.sampling_requests}}const fi={Photo:"PHOTO",_3D:"3D",Anime:"ANIME",Painting:"PAINTING",Design:"DESIGN",General:"GENERAL"};function h_(t){return t==null?t:{categories:t.categories}}const zs={Search:"SEARCH",AutoSearch:"AUTO_SEARCH",Explore:"EXPLORE",Top:"TOP"},ys={Hour:"HOUR",Day:"DAY",Week:"WEEK",Month:"MONTH",Year:"YEAR"};function p_(t){return t==null?t:{search_query:t.searchQuery,size:t.size,offset:t.offset,context:t.context,filters:h_(t.filters),timeline:t.timeline}}function f_(t){return g_(t)}function g_(t,e){return t==null?t:{results:t.results,offset:t.offset}}function m_(t){return x_(t)}function x_(t,e){return t==null?t:{privateGeneration:t.private_generation,balance:t.balance,maxBalance:t.max_balance}}function _g(t){return v_(t)}function v_(t,e){return t==null?t:{activeSubscription:t.active_subscription==null?void 0:zw(t.active_subscription),subscriptionQuota:t.subscription_quota==null?void 0:m_(t.subscription_quota),noActiveSubscription:t.no_active_subscription,hasPrivateChannel:t.has_private_channel==null?void 0:t.has_private_channel}}const vr={AppMenuDirectTopUp:"APP_MENU_DIRECT_TOP_UP",BatchGenerationTopUp:"BATCH_GENERATION_TOP_UP",GenerationBoxPromptLimitTopUp:"GENERATION_BOX_PROMPT_LIMIT_TOP_UP",GenerationPreviewTopUp:"GENERATION_PREVIEW_TOP_UP",GenerationProgressTopUp:"GENERATION_PROGRESS_TOP_UP",InsufficientCreditsBanner:"INSUFFICIENT_CREDITS_BANNER",PricingPageTopUp:"PRICING_PAGE_TOP_UP",PromptLimitTopUp:"PROMPT_LIMIT_TOP_UP",TeamBillingMemberTopUp:"TEAM_BILLING_MEMBER_TOP_UP",Unknown:"UNKNOWN"};function y_(t){return t==null?t:{job_status:t.jobStatus}}function w_(t){return t==null?t:{name:t.name}}function b_(t){return C_(t)}function C_(t,e){return t==null?t:{organization:ns(t.organization)}}function __(t){return I_(t)}function I_(t,e){return t==null?t:{backgroundRemovedAssetId:Xu(t.background_removed_asset_id),backgroundMaskAssetId:Xu(t.background_mask_asset_id)}}function S_(t){return t==null?t:{external_photo_url:t.externalPhotoUrl}}function Ig(t){return R_(t)}function R_(t,e){return t==null?t:{userId:t.user_id,organizationId:t.organization_id==null?void 0:t.organization_id,emailAddress:t.email_address,externalPhotoUrl:t.external_photo_url,displayHandle:t.display_handle,tosAcceptanceRequired:t.tos_acceptance_required==null?void 0:t.tos_acceptance_required,sessionReplayEnabled:t.session_replay_enabled==null?void 0:t.session_replay_enabled,badge:t.badge==null?void 0:t.badge,subscriptionPlanId:t.subscription_plan_id==null?void 0:t.subscription_plan_id,recommendedDisplayHandle:t.recommended_display_handle==null?void 0:t.recommended_display_handle}}function T_(t){return E_(t)}function E_(t,e){return t==null?t:{userModel:Ig(t.user_model),enabledFeatures:bg(t.enabled_features),subscriptionStatus:t.subscription_status==null?void 0:_g(t.subscription_status)}}function k_(t){return t==null?t:{display_handle:t.displayHandle}}function A_(t){return j_(t)}function j_(t,e){return t==null?t:{userModel:Ig(t.user_model),enabledFeatures:t.enabled_features==null?void 0:bg(t.enabled_features)}}const qn={WaitTimeNotElapsed:"WAIT_TIME_NOT_ELAPSED",LimitReached:"LIMIT_REACHED",ServerBusy:"SERVER_BUSY",InsufficientFunds:"INSUFFICIENT_FUNDS"};function P_(t){return M_(t)}function M_(t,e){return t==null?t:{slowCreditMax:t.slow_credit_max,slowCreditBalance:t.slow_credit_balance,dateWhenSlowCreditsRefresh:new Date(t.date_when_slow_credits_refresh),subscriptionPriorityCreditMax:t.subscription_priority_credit_max,subscriptionPriorityCreditBalance:t.subscription_priority_credit_balance,subscriptionPriorityStickyCreditBalance:t.subscription_priority_sticky_credit_balance,allowedToGenerate:t.allowed_to_generate,minimumTimeBetweenGenerationsS:t.minimum_time_between_generations_s,rejectReason:t.reject_reason==null?void 0:t.reject_reason,timeUntilUserCanGenerateS:t.time_until_user_can_generate_s}}function O_(t){return t==null?t:{model_version:t.modelVersion,aspect_ratio:t.aspectRatio}}function B_(t){return L_(t)}function L_(t,e){return t==null?t:{validatedResolution:ki(t.validated_resolution),modified:t.modified}}function N_(t){return D_(t)}function D_(t,e){return t==null?t:{creditsConsumed:t.credits_consumed==null?void 0:t.credits_consumed,numberOfGenerations:t.number_of_generations==null?void 0:t.number_of_generations,preview:t.preview==null?void 0:DC(t.preview)}}function Zu(t){return F_(t)}function F_(t,e){return t==null?t:{errors:t.errors==null?void 0:t.errors}}function z_(t){return t==null?t:{model_version:t.modelVersion,height:t.height,width:t.width}}function U_(t){return G_(t)}function G_(t,e){return t==null?t:{validatedResolution:ki(t.validated_resolution),modified:t.modified}}class H_ extends eo{async generateCelloTokenRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("bearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/account/cello/token",method:"GET",headers:o,query:n},e);return new Oe(i,a=>J2(a))}async generateCelloToken(e){return await(await this.generateCelloTokenRaw(e)).value()}async getAccountProfilesRaw(e,n){if(e.userHandle==null)throw new _e("userHandle",'Required parameter "userHandle" was null or undefined when calling getAccountProfiles().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/account/profiles/{user_handle}".replace("{user_handle}",encodeURIComponent(String(e.userHandle))),method:"GET",headers:i,query:o},n);return new Oe(a,s=>Yb(s))}async getAccountProfiles(e,n){return await(await this.getAccountProfilesRaw(e,n)).value()}async getProfileSocialProvidersRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("bearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/account/profiles/social_providers",method:"GET",headers:o,query:n},e);return new Oe(i,a=>Db(a))}async getProfileSocialProviders(e){return await(await this.getProfileSocialProvidersRaw(e)).value()}async getSubscriptionStatusRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("bearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/account/subscriptionStatus",method:"GET",headers:o,query:n},e);return new Oe(i,a=>_g(a))}async getSubscriptionStatus(e){return await(await this.getSubscriptionStatusRaw(e)).value()}async getUserTaskQuotaStatsRaw(e,n){if(e.modelVersion==null)throw new _e("modelVersion",'Required parameter "modelVersion" was null or undefined when calling getUserTaskQuotaStats().');const o={};e.modelVersion!=null&&(o.modelVersion=e.modelVersion),e.samplingSpeed!=null&&(o.samplingSpeed=e.samplingSpeed),e.requestAction!=null&&(o.requestAction=e.requestAction);const i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/account/user_task_quota_stats",method:"GET",headers:i,query:o},n);return new Oe(a,s=>P_(s))}async getUserTaskQuotaStats(e,n){return await(await this.getUserTaskQuotaStatsRaw(e,n)).value()}async optInSessionReplayRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("bearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/account/opt_in_session_replay",method:"POST",headers:o,query:n},e);return new bn(i)}async optInSessionReplay(e){await this.optInSessionReplayRaw(e)}async patchAccountProfileRaw(e,n){if(e.userHandle==null)throw new _e("userHandle",'Required parameter "userHandle" was null or undefined when calling patchAccountProfile().');if(e.patchUserProfileRequest==null)throw new _e("patchUserProfileRequest",'Required parameter "patchUserProfileRequest" was null or undefined when calling patchAccountProfile().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/account/profiles/{user_handle}".replace("{user_handle}",encodeURIComponent(String(e.userHandle))),method:"PATCH",headers:i,query:o,body:nC(e.patchUserProfileRequest)},n);return new Oe(a,s=>oC(s))}async patchAccountProfile(e,n){return await(await this.patchAccountProfileRaw(e,n)).value()}async postAccountLoginRaw(e,n){if(e.userLoginRequest==null)throw new _e("userLoginRequest",'Required parameter "userLoginRequest" was null or undefined when calling postAccountLogin().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/account/login",method:"POST",headers:i,query:o,body:S_(e.userLoginRequest)},n);return new Oe(a,s=>T_(s))}async postAccountLogin(e,n){return await(await this.postAccountLoginRaw(e,n)).value()}async postAccountProfileRaw(e,n){if(e.userHandle==null)throw new _e("userHandle",'Required parameter "userHandle" was null or undefined when calling postAccountProfile().');if(e.postUserProfileRequest==null)throw new _e("postUserProfileRequest",'Required parameter "postUserProfileRequest" was null or undefined when calling postAccountProfile().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/account/profiles/{user_handle}".replace("{user_handle}",encodeURIComponent(String(e.userHandle))),method:"POST",headers:i,query:o,body:BC(e.postUserProfileRequest)},n);return new Oe(a,s=>LC(s))}async postAccountProfile(e,n){return await(await this.postAccountProfileRaw(e,n)).value()}async postAccountRegisterRaw(e,n){if(e.userRegistrationRequest==null)throw new _e("userRegistrationRequest",'Required parameter "userRegistrationRequest" was null or undefined when calling postAccountRegister().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/account/register",method:"POST",headers:i,query:o,body:k_(e.userRegistrationRequest)},n);return new Oe(a,s=>A_(s))}async postAccountRegister(e,n){return await(await this.postAccountRegisterRaw(e,n)).value()}async postProfileSocialProvidersRaw(e,n){if(e.postProfileSocialProviderRequest==null)throw new _e("postProfileSocialProviderRequest",'Required parameter "postProfileSocialProviderRequest" was null or undefined when calling postProfileSocialProviders().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/account/profiles/social_providers",method:"POST",headers:i,query:o,body:xC(e.postProfileSocialProviderRequest)},n);return new Oe(a,s=>wC(s))}async postProfileSocialProviders(e,n){return await(await this.postProfileSocialProvidersRaw(e,n)).value()}async putAccountProfileRaw(e,n){if(e.userHandle==null)throw new _e("userHandle",'Required parameter "userHandle" was null or undefined when calling putAccountProfile().');if(e.putUserProfileRequest==null)throw new _e("putUserProfileRequest",'Required parameter "putUserProfileRequest" was null or undefined when calling putAccountProfile().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/account/profiles/{user_handle}".replace("{user_handle}",encodeURIComponent(String(e.userHandle))),method:"PUT",headers:i,query:o,body:HC(e.putUserProfileRequest)},n);return new Oe(a,s=>qC(s))}async putAccountProfile(e,n){return await(await this.putAccountProfileRaw(e,n)).value()}}class q_ extends eo{async deleteCanvasRaw(e,n){if(e.canvasId==null)throw new _e("canvasId",'Required parameter "canvasId" was null or undefined when calling deleteCanvas().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/canvases/{canvas_id}".replace("{canvas_id}",encodeURIComponent(String(e.canvasId))),method:"DELETE",headers:i,query:o},n);return new bn(a)}async deleteCanvas(e,n){await this.deleteCanvasRaw(e,n)}async deleteCanvasAssetRaw(e,n){if(e.assetId==null)throw new _e("assetId",'Required parameter "assetId" was null or undefined when calling deleteCanvasAsset().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/canvases/assets/{asset_id}".replace("{asset_id}",encodeURIComponent(String(e.assetId))),method:"DELETE",headers:i,query:o},n);return new bn(a)}async deleteCanvasAsset(e,n){await this.deleteCanvasAssetRaw(e,n)}async getCanvasRaw(e,n){if(e.canvasId==null)throw new _e("canvasId",'Required parameter "canvasId" was null or undefined when calling getCanvas().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/canvases/{canvas_id}".replace("{canvas_id}",encodeURIComponent(String(e.canvasId))),method:"GET",headers:i,query:o},n);return new Oe(a,s=>fb(s))}async getCanvas(e,n){return await(await this.getCanvasRaw(e,n)).value()}async getCanvasAssetRaw(e,n){if(e.assetId==null)throw new _e("assetId",'Required parameter "assetId" was null or undefined when calling getCanvasAsset().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/canvases/assets/{asset_id}".replace("{asset_id}",encodeURIComponent(String(e.assetId))),method:"GET",headers:i,query:o},n);return new Oe(a,s=>hb(s))}async getCanvasAsset(e,n){return await(await this.getCanvasAssetRaw(e,n)).value()}async getCanvasAssetBytesRaw(e,n){if(e.assetId==null)throw new _e("assetId",'Required parameter "assetId" was null or undefined when calling getCanvasAssetBytes().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/canvases/assets/{asset_id}/retrieve".replace("{asset_id}",encodeURIComponent(String(e.assetId))),method:"GET",headers:i,query:o},n);return new Js(a)}async getCanvasAssetBytes(e,n){return await(await this.getCanvasAssetBytesRaw(e,n)).value()}async getCanvasThumbnailRaw(e,n){if(e.canvasId==null)throw new _e("canvasId",'Required parameter "canvasId" was null or undefined when calling getCanvasThumbnail().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/canvases/{canvas_id}/thumbnail".replace("{canvas_id}",encodeURIComponent(String(e.canvasId))),method:"GET",headers:i,query:o},n);return new bn(a)}async getCanvasThumbnail(e,n){await this.getCanvasThumbnailRaw(e,n)}async getListCanvasesRaw(e,n){const o={};e.page!=null&&(o.page=e.page);const i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/canvases/list",method:"GET",headers:i,query:o},n);return new Oe(a,s=>wb(s))}async getListCanvases(e={},n){return await(await this.getListCanvasesRaw(e,n)).value()}async postAddKnownAssetToCanvasRaw(e,n){if(e.canvasId==null)throw new _e("canvasId",'Required parameter "canvasId" was null or undefined when calling postAddKnownAssetToCanvas().');if(e.postAddKnownAssetToCanvasRequest==null)throw new _e("postAddKnownAssetToCanvasRequest",'Required parameter "postAddKnownAssetToCanvasRequest" was null or undefined when calling postAddKnownAssetToCanvas().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/canvases/{canvas_id}/add-known-asset".replace("{canvas_id}",encodeURIComponent(String(e.canvasId))),method:"POST",headers:i,query:o,body:aC(e.postAddKnownAssetToCanvasRequest)},n);return new Oe(a,s=>lC(s))}async postAddKnownAssetToCanvas(e,n){return await(await this.postAddKnownAssetToCanvasRaw(e,n)).value()}async postCanvasThumbnailRaw(e,n){if(e.canvasId==null)throw new _e("canvasId",'Required parameter "canvasId" was null or undefined when calling postCanvasThumbnail().');if(e.body==null)throw new _e("body",'Required parameter "body" was null or undefined when calling postCanvasThumbnail().');const o={},i={};if(i["Content-Type"]="image/*",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/canvases/{canvas_id}/thumbnail".replace("{canvas_id}",encodeURIComponent(String(e.canvasId))),method:"POST",headers:i,query:o,body:e.body},n);return new bn(a)}async postCanvasThumbnail(e,n){await this.postCanvasThumbnailRaw(e,n)}async pruneCanvasAssetsRaw(e,n){if(e.canvasId==null)throw new _e("canvasId",'Required parameter "canvasId" was null or undefined when calling pruneCanvasAssets().');if(e.postPruneCanvasAssetsRequest==null)throw new _e("postPruneCanvasAssetsRequest",'Required parameter "postPruneCanvasAssetsRequest" was null or undefined when calling pruneCanvasAssets().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/canvases/{canvas_id}/prune-assets".replace("{canvas_id}",encodeURIComponent(String(e.canvasId))),method:"POST",headers:i,query:o,body:CC(e.postPruneCanvasAssetsRequest)},n);return new Oe(a,s=>_C(s))}async pruneCanvasAssets(e,n){return await(await this.pruneCanvasAssetsRaw(e,n)).value()}async putCanvasRaw(e,n){if(e.putCanvasRequest==null)throw new _e("putCanvasRequest",'Required parameter "putCanvasRequest" was null or undefined when calling putCanvas().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/canvases",method:"PUT",headers:i,query:o,body:zC(e.putCanvasRequest)},n);return new Oe(a,s=>UC(s))}async putCanvas(e,n){return await(await this.putCanvasRaw(e,n)).value()}async removeAssetFromCanvasRaw(e,n){if(e.canvasId==null)throw new _e("canvasId",'Required parameter "canvasId" was null or undefined when calling removeAssetFromCanvas().');if(e.postRemoveAssetFromCanvasRequest==null)throw new _e("postRemoveAssetFromCanvasRequest",'Required parameter "postRemoveAssetFromCanvasRequest" was null or undefined when calling removeAssetFromCanvas().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/canvases/{canvas_id}/remove-asset".replace("{canvas_id}",encodeURIComponent(String(e.canvasId))),method:"POST",headers:i,query:o,body:SC(e.postRemoveAssetFromCanvasRequest)},n);return new Oe(a,s=>RC(s))}async removeAssetFromCanvas(e,n){return await(await this.removeAssetFromCanvasRaw(e,n)).value()}}class W_ extends eo{async bulkDownloadImagesRaw(e,n){if(e.bulkDownloadImagesRequest==null)throw new _e("bulkDownloadImagesRequest",'Required parameter "bulkDownloadImagesRequest" was null or undefined when calling bulkDownloadImages().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/download/bulk/images",method:"POST",headers:i,query:o,body:s2(e.bulkDownloadImagesRequest)},n);return new Oe(a,s=>a2(s))}async bulkDownloadImages(e,n){return await(await this.bulkDownloadImagesRaw(e,n)).value()}async downloadResponseImageRaw(e,n){if(e.responseId==null)throw new _e("responseId",'Required parameter "responseId" was null or undefined when calling downloadResponseImage().');if(e.quality==null)throw new _e("quality",'Required parameter "quality" was null or undefined when calling downloadResponseImage().');const o={};e.quality!=null&&(o.quality=e.quality);const i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/download/response/{response_id}/image".replace("{response_id}",encodeURIComponent(String(e.responseId))),method:"GET",headers:i,query:o},n);return new Js(a)}async downloadResponseImage(e,n){return await(await this.downloadResponseImageRaw(e,n)).value()}async downloadTiledImageRaw(e,n){if(e.responseId==null)throw new _e("responseId",'Required parameter "responseId" was null or undefined when calling downloadTiledImage().');const o={};e.fileType!=null&&(o.file_type=e.fileType);const i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/download/{response_id}/tiled".replace("{response_id}",encodeURIComponent(String(e.responseId))),method:"GET",headers:i,query:o},n);return new Js(a)}async downloadTiledImage(e,n){return await(await this.downloadTiledImageRaw(e,n)).value()}async pollBulkDownloadImagesResultRaw(e,n){if(e.resultId==null)throw new _e("resultId",'Required parameter "resultId" was null or undefined when calling pollBulkDownloadImagesResult().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/download/bulk/{result_id}/poll".replace("{result_id}",encodeURIComponent(String(e.resultId))),method:"GET",headers:i,query:o},n);return new Oe(a,s=>iC(s))}async pollBulkDownloadImagesResult(e,n){return await(await this.pollBulkDownloadImagesResultRaw(e,n)).value()}}class eh extends eo{async getGenerateTestJwtRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("bearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/e2e/testing/generate-test-jwt",method:"GET",headers:o,query:n},e);return new Oe(i,a=>ob(a))}async getGenerateTestJwt(e){return await(await this.getGenerateTestJwtRaw(e)).value()}async postEnrollSubscriptionRaw(e,n){if(e.enrollSubscriptionRequest==null)throw new _e("enrollSubscriptionRequest",'Required parameter "enrollSubscriptionRequest" was null or undefined when calling postEnrollSubscription().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/e2e/testing/enroll-subscription",method:"POST",headers:i,query:o,body:K2(e.enrollSubscriptionRequest)},n);return new bn(a)}async postEnrollSubscription(e,n){await this.postEnrollSubscriptionRaw(e,n)}}class $_ extends eo{async generationsGetRequestStatsPostRaw(e,n){if(e.retrieveGenerationRequestsStatsRequest==null)throw new _e("retrieveGenerationRequestsStatsRequest",'Required parameter "retrieveGenerationRequestsStatsRequest" was null or undefined when calling generationsGetRequestStatsPost().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/generations/getRequestStats",method:"POST",headers:i,query:o,body:r_(e.retrieveGenerationRequestsStatsRequest)},n);return new Oe(a,s=>i_(s))}async generationsGetRequestStatsPost(e,n){return await(await this.generationsGetRequestStatsPostRaw(e,n)).value()}async getAvailableResolutionsRaw(e,n){if(e.modelVersion==null)throw new _e("modelVersion",'Required parameter "modelVersion" was null or undefined when calling getAvailableResolutions().');const o={};e.modelVersion!=null&&(o.modelVersion=e.modelVersion);const i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/generations/availableResolutions",method:"GET",headers:i,query:o},n);return new Oe(a,s=>Yw(s))}async getAvailableResolutions(e,n){return await(await this.getAvailableResolutionsRaw(e,n)).value()}async getRequestCostRaw(e,n){if(e.modelVersion==null)throw new _e("modelVersion",'Required parameter "modelVersion" was null or undefined when calling getRequestCost().');const o={};e.modelVersion!=null&&(o.modelVersion=e.modelVersion),e.samplingSpeed!=null&&(o.samplingSpeed=e.samplingSpeed),e.requestAction!=null&&(o.requestAction=e.requestAction);const i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/generations/getRequestCost",method:"GET",headers:i,query:o},n);return new Oe(a,s=>qb(s))}async getRequestCost(e,n){return await(await this.getRequestCostRaw(e,n)).value()}async postBatchGenerateFromFileRaw(e,n){const o={},i={};if(this.configuration&&this.configuration.accessToken){const h=this.configuration.accessToken,p=await h("bearerAuth",[]);p&&(i.Authorization=`Bearer ${p}`)}const s=Fr([{contentType:"multipart/form-data"}]);let c,d=!1;d=s,d?c=new FormData:c=new URLSearchParams,e.jobFile!=null&&c.append("job_file",e.jobFile);const u=await this.request({path:"/generations/batchGenerateFromFile",method:"POST",headers:i,query:o,body:c},n);return new Oe(u,h=>n2(h))}async postBatchGenerateFromFile(e={},n){return await(await this.postBatchGenerateFromFileRaw(e,n)).value()}async postInpaintRaw(e,n){if(e.imageRequest==null)throw new _e("imageRequest",'Required parameter "imageRequest" was null or undefined when calling postInpaint().');if(e.imageFile==null)throw new _e("imageFile",'Required parameter "imageFile" was null or undefined when calling postInpaint().');if(e.mask==null)throw new _e("mask",'Required parameter "mask" was null or undefined when calling postInpaint().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const h=this.configuration.accessToken,p=await h("bearerAuth",[]);p&&(i.Authorization=`Bearer ${p}`)}const s=Fr([{contentType:"multipart/form-data"}]);let c,d=!1;d=s,d=s,d?c=new FormData:c=new URLSearchParams,e.imageRequest!=null&&c.append("image_request",new Blob([JSON.stringify(eb(e.imageRequest))],{type:"application/json"})),e.imageFile!=null&&c.append("image_file",e.imageFile),e.mask!=null&&c.append("mask",e.mask);const u=await this.request({path:"/generations/inpaint",method:"POST",headers:i,query:o,body:c},n);return new Oe(u,h=>al(h))}async postInpaint(e,n){return await(await this.postInpaintRaw(e,n)).value()}async postRemixImageFromFileRaw(e,n){if(e.imageRequest==null)throw new _e("imageRequest",'Required parameter "imageRequest" was null or undefined when calling postRemixImageFromFile().');if(e.imageFile==null)throw new _e("imageFile",'Required parameter "imageFile" was null or undefined when calling postRemixImageFromFile().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const h=this.configuration.accessToken,p=await h("bearerAuth",[]);p&&(i.Authorization=`Bearer ${p}`)}const s=Fr([{contentType:"multipart/form-data"}]);let c,d=!1;d=s,d?c=new FormData:c=new URLSearchParams,e.imageRequest!=null&&c.append("image_request",new Blob([JSON.stringify(tb(e.imageRequest))],{type:"application/json"})),e.imageFile!=null&&c.append("image_file",e.imageFile);const u=await this.request({path:"/generations/remixImageFromFile",method:"POST",headers:i,query:o,body:c},n);return new Oe(u,h=>al(h))}async postRemixImageFromFile(e,n){return await(await this.postRemixImageFromFileRaw(e,n)).value()}async postRetryGenerationRaw(e,n){if(e.postRetryGenerationRequest==null)throw new _e("postRetryGenerationRequest",'Required parameter "postRetryGenerationRequest" was null or undefined when calling postRetryGeneration().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/generations/retry",method:"POST",headers:i,query:o,body:jC(e.postRetryGenerationRequest)},n);return new Oe(a,s=>al(s))}async postRetryGeneration(e,n){return await(await this.postRetryGenerationRaw(e,n)).value()}async postValidateBatchGenerateFromFileRaw(e,n){const o={},i={};if(this.configuration&&this.configuration.accessToken){const h=this.configuration.accessToken,p=await h("bearerAuth",[]);p&&(i.Authorization=`Bearer ${p}`)}const s=Fr([{contentType:"multipart/form-data"}]);let c,d=!1;d=s,d?c=new FormData:c=new URLSearchParams,e.jobFile!=null&&c.append("job_file",e.jobFile);const u=await this.request({path:"/generations/validateBatchGenerateFromFile",method:"POST",headers:i,query:o,body:c},n);return new Oe(u,h=>N_(h))}async postValidateBatchGenerateFromFile(e={},n){return await(await this.postValidateBatchGenerateFromFileRaw(e,n)).value()}async retrieveColorPalettesRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("bearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/generations/retrieveColorPalettes",method:"GET",headers:o,query:n},e);return new Oe(i,a=>e_(a))}async retrieveColorPalettes(e){return await(await this.retrieveColorPalettesRaw(e)).value()}async validateAspectRatioRaw(e,n){if(e.validateAspectRatioRequest==null)throw new _e("validateAspectRatioRequest",'Required parameter "validateAspectRatioRequest" was null or undefined when calling validateAspectRatio().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/generations/validateAspectRatio",method:"POST",headers:i,query:o,body:O_(e.validateAspectRatioRequest)},n);return new Oe(a,s=>B_(s))}async validateAspectRatio(e,n){return await(await this.validateAspectRatioRaw(e,n)).value()}async validateResolutionRaw(e,n){if(e.validateResolutionRequest==null)throw new _e("validateResolutionRequest",'Required parameter "validateResolutionRequest" was null or undefined when calling validateResolution().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/generations/validateResolution",method:"POST",headers:i,query:o,body:z_(e.validateResolutionRequest)},n);return new Oe(a,s=>U_(s))}async validateResolution(e,n){return await(await this.validateResolutionRaw(e,n)).value()}}class V_ extends eo{async getDownloadJobResultsRaw(e,n){if(e.generationJobId==null)throw new _e("generationJobId",'Required parameter "generationJobId" was null or undefined when calling getDownloadJobResults().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/jobs/generations/{generation_job_id}/downloadResults".replace("{generation_job_id}",encodeURIComponent(String(e.generationJobId))),method:"GET",headers:i,query:o},n);return new Js(a)}async getDownloadJobResults(e,n){return await(await this.getDownloadJobResultsRaw(e,n)).value()}async getGenerationJobRaw(e,n){if(e.generationJobId==null)throw new _e("generationJobId",'Required parameter "generationJobId" was null or undefined when calling getGenerationJob().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/jobs/generations/{generation_job_id}".replace("{generation_job_id}",encodeURIComponent(String(e.generationJobId))),method:"GET",headers:i,query:o},n);return new Oe(a,s=>mb(s))}async getGenerationJob(e,n){return await(await this.getGenerationJobRaw(e,n)).value()}async getGenerationJobsRaw(e,n){const o={};e.page!=null&&(o.page=e.page),e.pageSize!=null&&(o.page_size=e.pageSize);const i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/jobs/generations/retrieveJobs",method:"GET",headers:i,query:o},n);return new Oe(a,s=>n_(s))}async getGenerationJobs(e={},n){return await(await this.getGenerationJobsRaw(e,n)).value()}async getGenerationJobsRequiresCreditRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("bearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/jobs/generations/requiresCredit",method:"GET",headers:o,query:n},e);return new Oe(i,a=>vb(a))}async getGenerationJobsRequiresCredit(e){return await(await this.getGenerationJobsRequiresCreditRaw(e)).value()}async getPageForJobRaw(e,n){if(e.generationJobId==null)throw new _e("generationJobId",'Required parameter "generationJobId" was null or undefined when calling getPageForJob().');const o={};e.pageSize!=null&&(o.page_size=e.pageSize);const i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/jobs/generations/{generation_job_id}/getPageForJob".replace("{generation_job_id}",encodeURIComponent(String(e.generationJobId))),method:"GET",headers:i,query:o},n);return new Oe(a,s=>Lb(s))}async getPageForJob(e,n){return await(await this.getPageForJobRaw(e,n)).value()}async updateJobStatusRaw(e,n){if(e.generationJobId==null)throw new _e("generationJobId",'Required parameter "generationJobId" was null or undefined when calling updateJobStatus().');if(e.updateJobStatusRequest==null)throw new _e("updateJobStatusRequest",'Required parameter "updateJobStatusRequest" was null or undefined when calling updateJobStatus().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/jobs/generations/{generation_job_id}/updateJobStatus".replace("{generation_job_id}",encodeURIComponent(String(e.generationJobId))),method:"PUT",headers:i,query:o,body:y_(e.updateJobStatusRequest)},n);return new bn(a)}async updateJobStatus(e,n){await this.updateJobStatusRaw(e,n)}}class K_ extends eo{async getLandingMediaRaw(e,n){const o={};e.requestedAspectRatio!=null&&(o.requestedAspectRatio=e.requestedAspectRatio);const i={},a=await this.request({path:"/media/landing",method:"GET",headers:i,query:o},n);return new Oe(a,s=>Zb(s))}async getLandingMedia(e={},n){return await(await this.getLandingMediaRaw(e,n)).value()}async globalSearchRaw(e,n){if(e.searchRequest==null)throw new _e("searchRequest",'Required parameter "searchRequest" was null or undefined when calling globalSearch().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/gallery/global-search",method:"POST",headers:i,query:o,body:p_(e.searchRequest)},n);return new Oe(a,s=>f_(s))}async globalSearch(e,n){return await(await this.globalSearchRaw(e,n)).value()}async retrieveRequestsControllerRaw(e,n){if(e.retrieveRequestsRequest==null)throw new _e("retrieveRequestsRequest",'Required parameter "retrieveRequestsRequest" was null or undefined when calling retrieveRequestsController().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/gallery/retrieve-requests",method:"POST",headers:i,query:o,body:c_(e.retrieveRequestsRequest)},n);return new Oe(a,s=>d_(s))}async retrieveRequestsController(e,n){return await(await this.retrieveRequestsControllerRaw(e,n)).value()}async retrieveRequestsInFlightRaw(e,n){const o={};e.excludeQueued!=null&&(o.excludeQueued=e.excludeQueued),e.excludeBatchQueued!=null&&(o.excludeBatchQueued=e.excludeBatchQueued);const i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/gallery/retrieve-requests-inflight",method:"GET",headers:i,query:o},n);return new Oe(a,s=>a_(s))}async retrieveRequestsInFlight(e={},n){return await(await this.retrieveRequestsInFlightRaw(e,n)).value()}async upsertBackgroundRemovalAssetsRaw(e,n){if(e.maskImageFile==null)throw new _e("maskImageFile",'Required parameter "maskImageFile" was null or undefined when calling upsertBackgroundRemovalAssets().');if(e.sourceAssetId==null)throw new _e("sourceAssetId",'Required parameter "sourceAssetId" was null or undefined when calling upsertBackgroundRemovalAssets().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const h=this.configuration.accessToken,p=await h("bearerAuth",[]);p&&(i.Authorization=`Bearer ${p}`)}const s=Fr([{contentType:"multipart/form-data"}]);let c,d=!1;d=s,d?c=new FormData:c=new URLSearchParams,e.maskImageFile!=null&&c.append("mask_image_file",e.maskImageFile),e.sourceAssetId!=null&&c.append("source_asset_id",new Blob([JSON.stringify(Yu(e.sourceAssetId))],{type:"application/json"})),e.targetAssetId!=null&&c.append("target_asset_id",new Blob([JSON.stringify(Yu(e.targetAssetId))],{type:"application/json"}));const u=await this.request({path:"/media/upsertBackgroundRemovalAssets",method:"POST",headers:i,query:o,body:c},n);return new Oe(u,h=>__(h))}async upsertBackgroundRemovalAssets(e,n){return await(await this.upsertBackgroundRemovalAssetsRaw(e,n)).value()}}class J_ extends eo{async acceptOrganizationInviteRaw(e,n){if(e.acceptOrganizationInviteRequest==null)throw new _e("acceptOrganizationInviteRequest",'Required parameter "acceptOrganizationInviteRequest" was null or undefined when calling acceptOrganizationInvite().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/organizations/invite/accept",method:"POST",headers:i,query:o,body:Aw(e.acceptOrganizationInviteRequest)},n);return new Oe(a,s=>Lw(s))}async acceptOrganizationInvite(e,n){return await(await this.acceptOrganizationInviteRaw(e,n)).value()}async cancelOrganizationInviteRaw(e,n){if(e.cancelOrganizationInviteRequest==null)throw new _e("cancelOrganizationInviteRequest",'Required parameter "cancelOrganizationInviteRequest" was null or undefined when calling cancelOrganizationInvite().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/organizations/invite/cancel",method:"POST",headers:i,query:o,body:c2(e.cancelOrganizationInviteRequest)},n);return new bn(a)}async cancelOrganizationInvite(e,n){await this.cancelOrganizationInviteRaw(e,n)}async createOrganizationRaw(e,n){if(e.createOrganizationRequest==null)throw new _e("createOrganizationRequest",'Required parameter "createOrganizationRequest" was null or undefined when calling createOrganization().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/organizations",method:"POST",headers:i,query:o,body:D2(e.createOrganizationRequest)},n);return new Oe(a,s=>F2(s))}async createOrganization(e,n){return await(await this.createOrganizationRaw(e,n)).value()}async createOrganizationInvitesRaw(e,n){if(e.organizationId==null)throw new _e("organizationId",'Required parameter "organizationId" was null or undefined when calling createOrganizationInvites().');if(e.createOrganizationInvitesRequest==null)throw new _e("createOrganizationInvitesRequest",'Required parameter "createOrganizationInvitesRequest" was null or undefined when calling createOrganizationInvites().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/organizations/{organization_id}/invites".replace("{organization_id}",encodeURIComponent(String(e.organizationId))),method:"POST",headers:i,query:o,body:A2(e.createOrganizationInvitesRequest)},n);return new Oe(a,s=>L2(s))}async createOrganizationInvites(e,n){return await(await this.createOrganizationInvitesRaw(e,n)).value()}async createTopUpPurchaseLinkRaw(e,n){if(e.createTopUpPurchaseLinkRequest==null)throw new _e("createTopUpPurchaseLinkRequest",'Required parameter "createTopUpPurchaseLinkRequest" was null or undefined when calling createTopUpPurchaseLink().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/organizations/create-top-up-link",method:"POST",headers:i,query:o,body:U2(e.createTopUpPurchaseLinkRequest)},n);return new Oe(a,s=>G2(s))}async createTopUpPurchaseLink(e,n){return await(await this.createTopUpPurchaseLinkRaw(e,n)).value()}async deleteOrganizationAvatarRaw(e,n){if(e.organizationId==null)throw new _e("organizationId",'Required parameter "organizationId" was null or undefined when calling deleteOrganizationAvatar().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/organizations/{organization_id}/avatar".replace("{organization_id}",encodeURIComponent(String(e.organizationId))),method:"DELETE",headers:i,query:o},n);return new bn(a)}async deleteOrganizationAvatar(e,n){await this.deleteOrganizationAvatarRaw(e,n)}async getOrganizationRaw(e,n){if(e.organizationId==null)throw new _e("organizationId",'Required parameter "organizationId" was null or undefined when calling getOrganization().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/organizations/{organization_id}".replace("{organization_id}",encodeURIComponent(String(e.organizationId))),method:"GET",headers:i,query:o},n);return new Oe(a,s=>Pb(s))}async getOrganization(e,n){return await(await this.getOrganizationRaw(e,n)).value()}async getOrganizationInviteSuggestionsRaw(e,n){if(e.organizationId==null)throw new _e("organizationId",'Required parameter "organizationId" was null or undefined when calling getOrganizationInviteSuggestions().');const o={};e.userHandlePrefix!=null&&(o.user_handle_prefix=e.userHandlePrefix),e.maxItems!=null&&(o.maxItems=e.maxItems);const i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/organizations/{organization_id}/invites/suggestions".replace("{organization_id}",encodeURIComponent(String(e.organizationId))),method:"GET",headers:i,query:o},n);return new Oe(a,s=>Ib(s))}async getOrganizationInviteSuggestions(e,n){return await(await this.getOrganizationInviteSuggestionsRaw(e,n)).value()}async getOrganizationMembersRaw(e,n){if(e.organizationId==null)throw new _e("organizationId",'Required parameter "organizationId" was null or undefined when calling getOrganizationMembers().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/organizations/{organization_id}/members".replace("{organization_id}",encodeURIComponent(String(e.organizationId))),method:"GET",headers:i,query:o},n);return new Oe(a,s=>Eb(s))}async getOrganizationMembers(e,n){return await(await this.getOrganizationMembersRaw(e,n)).value()}async getOrganizationsRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("bearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/organizations",method:"GET",headers:o,query:n},e);return new Oe(i,a=>Ob(a))}async getOrganizations(e){return await(await this.getOrganizationsRaw(e)).value()}async getUserOrganizationInvitesRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("bearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/organizations/invites",method:"GET",headers:o,query:n},e);return new Oe(i,a=>$b(a))}async getUserOrganizationInvites(e){return await(await this.getUserOrganizationInvitesRaw(e)).value()}async leaveOrganizationRaw(e,n){if(e.organizationId==null)throw new _e("organizationId",'Required parameter "organizationId" was null or undefined when calling leaveOrganization().');if(e.leaveOrganizationRequest==null)throw new _e("leaveOrganizationRequest",'Required parameter "leaveOrganizationRequest" was null or undefined when calling leaveOrganization().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/organizations/{organization_id}/leave".replace("{organization_id}",encodeURIComponent(String(e.organizationId))),method:"POST",headers:i,query:o,body:tC(e.leaveOrganizationRequest)},n);return new bn(a)}async leaveOrganization(e,n){await this.leaveOrganizationRaw(e,n)}async postOrganizationAvatarRaw(e,n){if(e.organizationId==null)throw new _e("organizationId",'Required parameter "organizationId" was null or undefined when calling postOrganizationAvatar().');if(e.imageFile==null)throw new _e("imageFile",'Required parameter "imageFile" was null or undefined when calling postOrganizationAvatar().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const h=this.configuration.accessToken,p=await h("bearerAuth",[]);p&&(i.Authorization=`Bearer ${p}`)}const s=Fr([{contentType:"multipart/form-data"}]);let c,d=!1;d=s,d?c=new FormData:c=new URLSearchParams,e.imageFile!=null&&c.append("image_file",e.imageFile);const u=await this.request({path:"/organizations/{organization_id}/avatar".replace("{organization_id}",encodeURIComponent(String(e.organizationId))),method:"POST",headers:i,query:o,body:c},n);return new Oe(u,h=>gC(h))}async postOrganizationAvatar(e,n){return await(await this.postOrganizationAvatarRaw(e,n)).value()}async removeFromOrganizationRaw(e,n){if(e.organizationId==null)throw new _e("organizationId",'Required parameter "organizationId" was null or undefined when calling removeFromOrganization().');if(e.removeFromOrganizationRequest==null)throw new _e("removeFromOrganizationRequest",'Required parameter "removeFromOrganizationRequest" was null or undefined when calling removeFromOrganization().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/organizations/{organization_id}/remove".replace("{organization_id}",encodeURIComponent(String(e.organizationId))),method:"POST",headers:i,query:o,body:XC(e.removeFromOrganizationRequest)},n);return new bn(a)}async removeFromOrganization(e,n){await this.removeFromOrganizationRaw(e,n)}async resendOrganizationInviteRaw(e,n){if(e.resendOrganizationInviteRequest==null)throw new _e("resendOrganizationInviteRequest",'Required parameter "resendOrganizationInviteRequest" was null or undefined when calling resendOrganizationInvite().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/organizations/invite/resend",method:"POST",headers:i,query:o,body:YC(e.resendOrganizationInviteRequest)},n);return new Oe(a,s=>QC(s))}async resendOrganizationInvite(e,n){return await(await this.resendOrganizationInviteRaw(e,n)).value()}async switchActiveOrganizationRaw(e,n){if(e.organizationId==null)throw new _e("organizationId",'Required parameter "organizationId" was null or undefined when calling switchActiveOrganization().');const o={},i={};if(this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/organizations/{organization_id}/switch".replace("{organization_id}",encodeURIComponent(String(e.organizationId))),method:"POST",headers:i,query:o},n);return new bn(a)}async switchActiveOrganization(e,n){await this.switchActiveOrganizationRaw(e,n)}async updateOrganizationRaw(e,n){if(e.organizationId==null)throw new _e("organizationId",'Required parameter "organizationId" was null or undefined when calling updateOrganization().');if(e.updateOrganizationRequest==null)throw new _e("updateOrganizationRequest",'Required parameter "updateOrganizationRequest" was null or undefined when calling updateOrganization().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/organizations/{organization_id}".replace("{organization_id}",encodeURIComponent(String(e.organizationId))),method:"PUT",headers:i,query:o,body:w_(e.updateOrganizationRequest)},n);return new Oe(a,s=>b_(s))}async updateOrganization(e,n){return await(await this.updateOrganizationRaw(e,n)).value()}}class X_ extends eo{async getBlockedUsersRaw(e){const n={},o={};if(this.configuration&&this.configuration.accessToken){const a=this.configuration.accessToken,s=await a("bearerAuth",[]);s&&(o.Authorization=`Bearer ${s}`)}const i=await this.request({path:"/privacy/block-users",method:"GET",headers:o,query:n},e);return new Oe(i,a=>db(a))}async getBlockedUsers(e){return await(await this.getBlockedUsersRaw(e)).value()}async postBlockedUsersRaw(e,n){if(e.postBlockUserRequest==null)throw new _e("postBlockUserRequest",'Required parameter "postBlockUserRequest" was null or undefined when calling postBlockedUsers().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/privacy/block-users",method:"POST",headers:i,query:o,body:dC(e.postBlockUserRequest)},n);return new Oe(a,s=>uC(s))}async postBlockedUsers(e,n){return await(await this.postBlockedUsersRaw(e,n)).value()}async postUnblockUsersRaw(e,n){if(e.postUnblockUserRequest==null)throw new _e("postUnblockUserRequest",'Required parameter "postUnblockUserRequest" was null or undefined when calling postUnblockUsers().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/privacy/unblock-users",method:"POST",headers:i,query:o,body:PC(e.postUnblockUserRequest)},n);return new Oe(a,s=>MC(s))}async postUnblockUsers(e,n){return await(await this.postUnblockUsersRaw(e,n)).value()}}class Y_ extends eo{async addDescriptionReactionRaw(e,n){if(e.addDescriptionReactionRequest==null)throw new _e("addDescriptionReactionRequest",'Required parameter "addDescriptionReactionRequest" was null or undefined when calling addDescriptionReaction().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/describe/reaction",method:"POST",headers:i,query:o,body:Gw(e.addDescriptionReactionRequest)},n);return new bn(a)}async addDescriptionReaction(e,n){await this.addDescriptionReactionRaw(e,n)}async describeImageRaw(e,n){if(e.describeImageRequest==null)throw new _e("describeImageRequest",'Required parameter "describeImageRequest" was null or undefined when calling describeImage().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/describe",method:"POST",headers:i,query:o,body:q2(e.describeImageRequest)},n);return new Oe(a,s=>W2(s))}async describeImage(e,n){return await(await this.describeImageRaw(e,n)).value()}async generateBackgroundMaskForImageRaw(e,n){if(e.postGenerateBackgroundMaskForImageRequest==null)throw new _e("postGenerateBackgroundMaskForImageRequest",'Required parameter "postGenerateBackgroundMaskForImageRequest" was null or undefined when calling generateBackgroundMaskForImage().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/images/masks/generateBackgroundMaskForImage",method:"POST",headers:i,query:o,body:pC(e.postGenerateBackgroundMaskForImageRequest)},n);return new bn(a)}async generateBackgroundMaskForImage(e,n){await this.generateBackgroundMaskForImageRaw(e,n)}async generateMasksForImageRaw(e,n){if(e.postGenerateMasksForImageRequest==null)throw new _e("postGenerateMasksForImageRequest",'Required parameter "postGenerateMasksForImageRequest" was null or undefined when calling generateMasksForImage().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/images/masks/generate",method:"POST",headers:i,query:o,body:fC(e.postGenerateMasksForImageRequest)},n);return new bn(a)}async generateMasksForImage(e,n){await this.generateMasksForImageRaw(e,n)}async removeImageBackgroundRaw(e,n){if(e.postRemoveImageBackgroundRequest==null)throw new _e("postRemoveImageBackgroundRequest",'Required parameter "postRemoveImageBackgroundRequest" was null or undefined when calling removeImageBackground().');const o={},i={};if(i["Content-Type"]="application/json",this.configuration&&this.configuration.accessToken){const s=this.configuration.accessToken,c=await s("bearerAuth",[]);c&&(i.Authorization=`Bearer ${c}`)}const a=await this.request({path:"/images/masks/removeImageBackground",method:"POST",headers:i,query:o,body:EC(e.postRemoveImageBackgroundRequest)},n);return new Oe(a,s=>kC(s))}async removeImageBackground(e,n){return await(await this.removeImageBackgroundRaw(e,n)).value()}}const rn=()=>{var t,e,n;return!!((n=(e=(t=window.webkit)==null?void 0:t.messageHandlers)==null?void 0:e.ideogramBridgeHandler)!=null&&n.postMessage)},Q_=()=>{var t,e,n,o;return(o=(n=(e=(t=window.webkit)==null?void 0:t.messageHandlers)==null?void 0:e.ideogramBridgeHandler)==null?void 0:n.postMessage)==null?void 0:o.call(n,{method:"logout"})},Z_=()=>{var t,e,n,o;return(o=(n=(e=(t=window.webkit)==null?void 0:t.messageHandlers)==null?void 0:e.ideogramBridgeHandler)==null?void 0:n.postMessage)==null?void 0:o.call(n,{method:"refreshJwt"})},eI=()=>{var t,e,n,o;return(o=(n=(e=(t=window.webkit)==null?void 0:t.messageHandlers)==null?void 0:e.ideogramBridgeHandler)==null?void 0:n.postMessage)==null?void 0:o.call(n,{method:"deleteAccount"})},Sg=t=>{var e,n,o,i;return(i=(o=(n=(e=window.webkit)==null?void 0:e.messageHandlers)==null?void 0:n.ideogramBridgeHandler)==null?void 0:o.postMessage)==null?void 0:i.call(o,{method:"downloadApiImage",argument:t})},tI=t=>{var e,n,o,i;return(i=(o=(n=(e=window.webkit)==null?void 0:e.messageHandlers)==null?void 0:n.ideogramBridgeHandler)==null?void 0:o.postMessage)==null?void 0:i.call(o,{method:"downloadApiImageWithQuality",argument:t})},Rg=()=>{var t,e,n,o;return(o=(n=(e=(t=window.webkit)==null?void 0:t.messageHandlers)==null?void 0:e.ideogramBridgeHandler)==null?void 0:n.postMessage)==null?void 0:o.call(n,{method:"manageSubscription"})},nI={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_AMPLITUDE_API_KEY:"da0464495cb85fed194d60eee20539e6",VITE_APP_AMPLITUDE_EXPERIMENT_PROXY_URL:"https://ideogram.ai/amp-labs",VITE_APP_AMPLITUDE_FLAGS_PROXY_URL:"https://ideogram.ai/amp-flags",VITE_APP_AMPLITUDE_PROXY_URL:"https://ideogram.ai/amplitude",VITE_APP_CELLO_ATTRIBUTION_CDN_URL:"https://assets.cello.so/attribution/latest/cello-attribution.js",VITE_APP_CELLO_COMPONENT_CDN_URL:"https://assets.cello.so/app/latest/cello.js",VITE_APP_CELLO_PRODUCT_ID:"ideogram.ai",VITE_APP_FIREBASE_API_KEY:"AIzaSyBwq4bRiOapXYaKE-0Y46vLAw1-fzALq7Y",VITE_APP_FIREBASE_AUTH_DOMAIN:"ideogram-prod.firebaseapp.com",VITE_APP_FIREBASE_PROXY_AUTH_DOMAIN:"ideogram.ai",VITE_APP_GTAG:"G-44J8R31CP6",VITE_APP_TURNSTILE_SITE_KEY:"0x4AAAAAAAYMuk7BF-qKU-xo",VITE_EXTERNAL_API_BASE_URL:"https://api.ideogram.ai",VITE_STAGING_ENV:"0"},{VITE_APP_CELLO_PRODUCT_ID:oI}=nI,rI=(t,e)=>{window.cello=window.cello||{cmd:[]},window.cello.cmd.push(function(n){n.boot({productId:oI,token:t,language:"en",productUserDetails:e,hideDefaultLauncher:!0,onOpen:()=>document.body.style.overflow="hidden",onClose:()=>document.body.style.overflow="auto"})})},iI=()=>{window.cello.cmd.push(function(t){t.open()})},Tg=()=>{window.cello.cmd.push(function(t){t.close()})},ed=async()=>await window.CelloAttribution("getUcc"),sI=async()=>{if(!await ed())return;const t="REFERER_NAME_KEY",e=await window.CelloAttribution("getReferrerName"),n=e||localStorage.getItem(t);return n&&localStorage.setItem(t,n),n},aI=async()=>Le("/api/subscription/queryPlansAvailableForPurchase",{method:"POST",headers:{"Content-Type":"application/json",...Ne}}).then(t=>t.json()),Eg=async t=>{const e=await ed();return Le("/api/subscription/checkoutSubscriptionPlan",{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({...t,affiliate_id:e||void 0})}).then(n=>n.json())},lI=async(t,e="UNKNOWN")=>Le("/api/subscription/checkoutCreditPurchase",{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({quantity:t,top_up_reason:e})}).then(n=>{if(n.status!==200)throw n;return n.json()}),kg=async t=>Le("/api/subscription/stripePortal",{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({redirect_path:t})}).then(e=>e.json()),cI=async t=>Le("/api/subscription/cancelSubscriptionPlan",{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({terminate_immediately:!0,cancel_reason:t})}),Ag=async(t,e)=>Le("/api/subscription/upgradeSubscription",{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({plan_id:t,conversion_reason:e})}),jg=async t=>Le("/api/subscription/previewPlanUpgradeCost",{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({plan_id:t})}).then(e=>e.json()),Oa=async t=>Le(`/api/users/public_info/${t}`,{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(e=>{if(e.status===200)return e.json();if(e.status===404)return e.json().then(n=>{const o=n;throw o===void 0?n:o});throw e}),T9=async t=>Le(`/api/g/my_favourites?${t?`page=${t}`:""}`,{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(e=>{if(e.status!==200)throw e;return e.json()}),E9=async t=>Le(`/api/users/following/count/${t}`,{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(e=>e.json()).then(e=>e.following),dI=async t=>Le(`/api/users/followers/count/${t}`,{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(e=>e.json()).then(e=>e.followers),k9=async t=>Le(`/api/users/following/list?user_id=${t}`,{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(e=>e.json()),A9=async t=>Le(`/api/users/followers/list?user_id=${t}`,{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(e=>e.json()),uI=async t=>Le(`/api/users/follows/${t}`,{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(e=>e.json()).then(e=>e.follows),j9=async t=>Le(`/api/users/followed/${t}`,{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(e=>e.json()).then(e=>e.follows),hI=async t=>Le(`/api/users/follows/${t}`,{method:"POST",headers:{"Content-Type":"application/json",...Ne}}).then(e=>e.json()).then(e=>e.success),P9=async t=>Le(`/api/users/follows/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json",...Ne}}).then(e=>e.json()).then(e=>e.success),pI=async t=>Le("/api/users/delete_account",{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({display_handle:t})}).then(e=>e.json()),fI=async()=>Le("/api/users/sign_out",{method:"POST",headers:{"Content-Type":"application",...Ne},body:JSON.stringify({})}),gI=async()=>Le("/api/users/settings",{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(t=>t.json()),Pg=async t=>Le("/api/users/settings",{method:"PATCH",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify(t)}).then(e=>e.json()),mI=async t=>Le("/api/users/set_profile_picture",{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify(t)}).then(e=>e.json()),M9=async t=>Le("/api/users/validateDisplayHandle",{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({display_handle:t})}).then(e=>e.json()),td=(t,e)=>Ta(Math.ceil(t*1e3)).local().fromNow().replace("a few seconds ago","just now").replace("an ","1 ").replace("a ","1 ").replace(" days","d").replace(" day","d").replace(" hours","h").replace(" hour","h").replace(" minutes","m").replace(" minute","m").replace(" month","mo").replace(" monthes","mo").replace(" year","y").replace(" years","y").replace(" ago",e?"":" ago"),nd=t=>Ta(Math.ceil(t*1e3)).local().format("MMM D, YYYY, h:mm A"),xI=t=>t.toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"}),O9=t=>t.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}),th=()=>{const t=new Date,e=Date.now(),o=Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()+1)-e,i=Math.floor(o/1e3/60/60),a=Math.floor(o/1e3/60%60);return i>0?`${i} hour${i>1?"s":""}`:`${a} minute${a>1?"s":""}`},zi=t=>{const e=Date.now(),n=t.getTime()-e,o=Math.floor(n/1e3/60/60/24),i=Math.floor(n/1e3/60/60%24),a=Math.floor(n/1e3/60%60);return o>0?`${o} day${o>1?"s":""}`:i>0?`${i} hour${i>1?"s":""}`:`${a} minute${a>1?"s":""}`},Ql=t=>Math.floor((Date.now()-t)/864e5),B9=t=>new Date().toDateString()===t.toDateString(),L9=t=>{const e=new Date;return e.setDate(e.getDate()-1),e.toDateString()===t.toDateString()},N9=(t,e)=>{const n=new Date,o=new Date;return o.setDate(n.getDate()-e),t>=o&&t<=n},D9=t=>["January","February","March","April","May","June","July","August","September","October","November","December"][t-1],od=t=>{if(t>120){const e=Math.floor(t/60),n=t-e*60;return`Wait ${e}m ${n}s`}return`Wait ${t}s`},vI=t=>{if(t>120){const e=Math.floor(t/60),n=(t-e*60).toString().padStart(2,"0");return`${e}:${n}`}return`${t}`},yI={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_AMPLITUDE_API_KEY:"da0464495cb85fed194d60eee20539e6",VITE_APP_AMPLITUDE_EXPERIMENT_PROXY_URL:"https://ideogram.ai/amp-labs",VITE_APP_AMPLITUDE_FLAGS_PROXY_URL:"https://ideogram.ai/amp-flags",VITE_APP_AMPLITUDE_PROXY_URL:"https://ideogram.ai/amplitude",VITE_APP_CELLO_ATTRIBUTION_CDN_URL:"https://assets.cello.so/attribution/latest/cello-attribution.js",VITE_APP_CELLO_COMPONENT_CDN_URL:"https://assets.cello.so/app/latest/cello.js",VITE_APP_CELLO_PRODUCT_ID:"ideogram.ai",VITE_APP_FIREBASE_API_KEY:"AIzaSyBwq4bRiOapXYaKE-0Y46vLAw1-fzALq7Y",VITE_APP_FIREBASE_AUTH_DOMAIN:"ideogram-prod.firebaseapp.com",VITE_APP_FIREBASE_PROXY_AUTH_DOMAIN:"ideogram.ai",VITE_APP_GTAG:"G-44J8R31CP6",VITE_APP_TURNSTILE_SITE_KEY:"0x4AAAAAAAYMuk7BF-qKU-xo",VITE_EXTERNAL_API_BASE_URL:"https://api.ideogram.ai",VITE_STAGING_ENV:"0"},{VITE_APP_AMPLITUDE_API_KEY:ll,VITE_APP_AMPLITUDE_PROXY_URL:wI,VITE_APP_AMPLITUDE_FLAGS_PROXY_URL:bI,VITE_APP_AMPLITUDE_EXPERIMENT_PROXY_URL:CI}=yI;let bo=null;const _I=async()=>{ll&&(Sv(ll,{defaultTracking:!0,serverUrl:wI}),bo=Rv.initializeWithAmplitudeAnalytics(ll,{serverUrl:CI,flagsServerUrl:bI,exposureTrackingProvider:{track:t=>{Vc({event_type:"$exposure",event_properties:{experiment_key:t.experiment_key,flag_key:t.flag_key,variant:t.variant}})}},retryFetchOnFailure:!0,automaticExposureTracking:!0,fetchOnStart:!0,automaticFetchOnAmplitudeIdentityChange:!0}))},II=async t=>{const{userModel:e,subscriptionStatus:n,chosenOrganization:o}=t,{userId:i}=e,a=new Tv;a.set(fo.username,e.displayHandle),n!=null&&n.activeSubscription?(n.activeSubscription.planName.toLocaleLowerCase().includes("team")?a.set(fo.current_tier,`${n.activeSubscription.planName} - ${o.role==="OWNER"?"owner":"member"}`):a.set(fo.current_tier,n.activeSubscription.planName),a.set(fo.sub_age,Ql(n.activeSubscription.startTime.getTime()))):a.set(fo.current_tier,"Free"),a.set(fo.current_badge,e.badge??"NULL");const s=await Oa(i);return a.set(fo.total_generations,s.num_generations),a.set(fo.total_likes,s.num_likes),a.set(fo.account_age,Ql(s.join_time_float*1e3)),a.set(fo.total_followers,await dI(i)),a},Ui={model_2_1_release:"model_2-1_release",creations_prompt2:"creations_prompt2",free_search:"free_search",team_billing_pricing:"team_billing_pricing",pricing_2025:"pricing_2025",mobile_jump_to_creations:"mobile_jump_to_creations"},Xs=t=>(bo==null?void 0:bo.variant(t).value)==="treatment",SI=t=>t&&t>=1736208e3,RI=t=>SI(t)&&Xs(Ui.free_search),Mg=t=>t&&t>=1738022400&&Xs(Ui.mobile_jump_to_creations),fo={account_age:"account_age",current_tier:"current_tier",sub_age:"sub_age",current_badge:"current_badge",total_generations:"total_generations",total_likes:"total_likes",username:"username",total_followers:"total_followers"},Og=()=>window.location.hostname==="localhost"||!1,rd=()=>window.location.hostname==="localhost",Bt={api_edit_recharge_settings:"api_edit_recharge_settings",api_management_access:"api_management_access",batch_generation:"batch_generation",batch_generation_launch_modal:"batch_generation_launch_modal",canvas_text_tool:"canvas_text_tool",can_access_affiliate_program:"can_access_affiliate_program",model_2_1:"model_2_1",model_2_1_preview:"model_2_1_preview",pro_plan_beta:"pro_plan_beta",super_res_beta:"super_res_beta",tiling_beta:"tiling_beta",team_billing:"team_billing",creations_prompt:"creations_prompt",auto_search_demo:"auto_search_demo",creations_grid:"creations_grid",session_replay:"session_replay",pricing_2025:"pricing_2025",mobile_jump_to_creations:"mobile_jump_to_creations"},TI=t=>{const{userProfileState:e,organizationApi:n}=t,[o,i]=l.useState(null),{data:a,refetch:s}=Ve(["retrieveOrganization",e==null?void 0:e.displayHandle],()=>n==null?void 0:n.getOrganizations(),{enabled:!!n&&!!e,staleTime:1/0,retry:3}),c=l.useMemo(()=>{let h=(a==null?void 0:a.organizations)??[];(a==null?void 0:a.ownsTeamOrganization)!==!1&&(h=h.filter(m=>m.type!==gg.Private));const p=h.find(m=>m.role===Wr.Owner),g=h.filter(m=>m.role!==Wr.Owner).sort((m,v)=>m.name.localeCompare(v.name));return p&&g.unshift(p),g},[a]),d=l.useCallback(h=>{const{chosenOrganizationId:p,name:g,isPersonalOrganization:m,role:v,avatar:x}=h;p&&p!==(o==null?void 0:o.chosenOrganizationId)&&n&&(i({chosenOrganizationId:p,isPersonalOrganization:m,name:g,role:v,avatar:x}),n==null||n.switchActiveOrganization({organizationId:p}))},[o==null?void 0:o.chosenOrganizationId,n]);l.useEffect(()=>{o!=null&&o.chosenOrganizationId&&DI(o.chosenOrganizationId)},[o]),l.useEffect(()=>{o!=null&&o.chosenOrganizationId&&!c.some(h=>h.organizationId===o.chosenOrganizationId)&&s()},[o,c,s]);const u=l.useRef(!1);return l.useEffect(()=>{var g,m;if(u.current||!e||!c.length)return;const h=tc()??(e==null?void 0:e.organizationId),p=c.find(v=>v.organizationId===h);if(h&&p)i({chosenOrganizationId:h,isPersonalOrganization:p.name===(e==null?void 0:e.displayHandle),name:p.name,role:p.role,avatar:(g=p.avatar)==null?void 0:g.avatarUrl});else{const v=c.find(x=>x.role===Wr.Owner);v&&d({chosenOrganizationId:v.organizationId,isPersonalOrganization:!0,name:v.name,role:v.role,avatar:(m=v.avatar)==null?void 0:m.avatarUrl})}u.current=!0},[d,c,e]),{userOrganizations:c,chosenOrganization:o,setChosenOrganization:i,updateChosenOrganization:d,refreshOrganizations:s}},oe={HOME:"/",HOME_TAB:"/t/:tab",HOME_TAB_FILTER:"/t/:tab/:filter",GENERATION:"/g/:request_id/:image_index",IMAGE:"/i/:image_id",PROFILE:"/u/:uhandle",PROFILE_TAB:"/u/:uhandle/:tab",LOGIN:"/login",WELCOME:"/welcome",PRICING:"/pricing",SEARCH:"/search/:query",NOTIFICATIONS:"/notifications",API_MANAGEMENT:"/manage-api",EDITOR:"/editor",CANVAS:"/canvas/:canvas_id",CANVAS_HOME:"/canvas",BATCH_GENERATION:"/batch",TEAM_BILLING:"/team"},EI=[oe.LOGIN,oe.PRICING],On={api_docs:"https://developer.ideogram.ai",api_pricing:"https://about.ideogram.ai/api-pricing",api_tos:"https://about.ideogram.ai/legal/api-tos",status_page:"https://status.ideogram.ai/",youtube:"https://www.youtube.com/@Ideogram_ai",x:"https://twitter.com/ideogram_ai",discord:"https://discord.gg/ideogram",privacy:"https://about.ideogram.ai/privacy",tos:"https://about.ideogram.ai/tos",doc:"https://docs.ideogram.ai/",career:"https://jobs.ashbyhq.com/ideogram",about:"https://ideogram.ai/launch",credit_system:"https://docs.ideogram.ai/plans-and-pricing/plans-and-pricing#the-credit-system",model_2_0:"https://about.ideogram.ai/2.0",canvas:"https://about.ideogram.ai/canvas",pricing:"https://ideogram.ai/pricing",linkedIn:"https://www.linkedin.com/company/ideogram-ai",reddit:"https://www.reddit.com/r/ideogramai"},Bn=t=>!!(t==="/"||pt(oe.HOME,t)||pt(oe.HOME_TAB,t)||pt(oe.HOME_TAB_FILTER,t)),Ba=t=>!!(t==="/"||pt(oe.PROFILE,t)||pt(oe.PROFILE_TAB,t)),Zl=t=>!!pt(oe.CANVAS,t),kI=t=>!!pt(oe.BATCH_GENERATION,t),AI=t=>!!pt(oe.TEAM_BILLING,t),jI=t=>{const{browsingDataDictRef:e,getBrowsingKey:n,decorateGeneration:o}=t,{userSettings:i}=l.useContext(ge),[a,s]=l.useState((i==null?void 0:i.default_profile_show_grid_view)??!1),c=l.useCallback(R=>{s(!!R.show_grid_view),Pg({default_profile_show_grid_view:R.show_grid_view})},[]);l.useEffect(()=>{s((i==null?void 0:i.default_profile_show_grid_view)??!1)},[i]);const d=l.useCallback(()=>{const R=e.current[n()],S=e.current;let E;return Object.keys(S).length?E={...R,generation:o(R==null?void 0:R.generation),generationList:R!=null&&R.generationList?R.generationList.map(N=>N.image_id?N:o(N)):void 0}:E=R,E},[e,o,n]),u=l.useCallback((R,S)=>{e.current={...e.current,[S]:{...e.current[S],generationList:R}}},[e]),h=l.useCallback((R,S)=>{e.current={...e.current,[S]:{...e.current[S],paginationState:R}}},[e]),p=l.useCallback((R,S)=>{e.current={...e.current,[S]:{...e.current[S],searchValue:R}}},[e]),g=l.useCallback(R=>{const S=Ut.cloneDeep(d().generationList);S&&(e.current={...e.current,[n()]:{...e.current[n()],generationList:S.filter(E=>E.request_id!==R)}})},[e,d,n]),m=l.useCallback(R=>{const S=n();S&&(R?e.current={...e.current,[S]:{...e.current[S],notificationState:{notifications:R,scrollPosition:0}}}:e.current={...e.current,[S]:{...e.current[S],notificationState:void 0}})},[e,n]),v=l.useCallback(R=>{const S=n();S&&e.current[S].notificationState&&(e.current={...e.current,[S]:{...e.current[S],notificationState:{...e.current[S].notificationState,scrollPosition:R}}})},[e,n]),x=l.useRef(1),y=l.useCallback(R=>{x.current=R},[]),_=l.useCallback(()=>x.current,[]),w=l.useCallback((R,S)=>{e.current={...e.current,[S]:{...e.current[S],creationsVirtualColumnData:R}}},[e]),I=l.useCallback((R,S)=>{e.current={...e.current,[S]:{...e.current[S],feedVirtualColumnData:R}}},[e]);return{getBrowsingData:d,showAllImage:a,setShowAllImage:s,setBrowsingSettings:c,saveCurrentGenerationListData:u,saveBrowsingPaginationState:h,saveSearchValue:p,clearGenerationInCurrentListData:g,setNotifications:m,setNotificationScrollPosition:v,setNotificationPage:y,getNotificationPage:_,saveCreationsVirtualColumnData:w,saveFeedVirtualColumnData:I}},nh=["home","profile"],mt=t=>{let e="other";return pt(oe.GENERATION,t)?e="generation":Bn(t)?e="home":(pt(oe.PROFILE,t)||pt(oe.PROFILE_TAB,t))&&(e="profile"),{pathname:t,pageType:e,yPosition:0}},$e=l.createContext({navigate:()=>{},replace:()=>{},back:()=>{},closeGeneration:()=>{},getBrowsingData:()=>{},saveCurrentGenerationListData:()=>{},setGenerationDecoration:()=>{},saveBrowsingPaginationState:()=>{},saveSearchValue:()=>{},decorateGeneration:()=>{},clearGenerationInCurrentListData:()=>{},getBrowsingKey:()=>0,markGenerationCollapsed:()=>{},isGenerationCollapsed:()=>!1,resetCollapsedGenerations:()=>{},setNotifications:()=>{},setNotificationScrollPosition:()=>{},getNotificationPage:()=>0,setNotificationPage:()=>{},saveCreationsVirtualColumnData:()=>{},saveFeedVirtualColumnData:()=>{},clearGenerationDecorator:()=>{},columnDataDirty:!1,setColumnDataDirty:()=>{},playingTileResponseId:"",setPlayingTileResponseId:()=>{},actualShowAllImageRenderHeightMapRef:{current:{}},actualRenderHeightMapRef:{current:{}},refreshTheme:()=>{},searchState:null,setSearchState:()=>{},setQueryParam:()=>{},deleteQueryParam:()=>{},latestCollapseTimestamp:null,homePageTab:null,setHomePageTab:()=>{},showAllImage:!1,setShowAllImage:()=>{},setBrowsingSettings:()=>{}}),PI=({refreshTheme:t,children:e})=>{const n=ja(),o=l.useRef(Date.now()),[i,a]=l.useState(!1),s=l.useRef({[o.current]:mt(window.location.pathname)}),[c,d]=l.useState(null),[u,h]=l.useState(null),p=l.useRef({}),g=l.useRef(new Set),[m,v]=l.useState(null),x=l.useCallback(se=>{v(Date.now()),g.current.add(se)},[]),y=l.useCallback(se=>g.current.has(se),[]),_=l.useCallback(()=>g.current.clear(),[]),w=l.useCallback(se=>{const H=se==null?void 0:se.cover_response_id,me=se==null?void 0:se.image_id;return H&&p.current[H]?p.current[H]:me&&p.current[me]?p.current[me]:se},[]),I=l.useCallback(se=>{se.cover_response_id?p.current[se.cover_response_id]=se:se.image_id&&(p.current[se.image_id]=se)},[]),R=l.useCallback(()=>{p.current={}},[]),S=l.useCallback(()=>{var se,H,me;return((se=history.state)==null?void 0:se.ideogramBrowsingKey)??((me=(H=history.state)==null?void 0:H.usr)==null?void 0:me.ideogramBrowsingKey)},[]);l.useEffect(()=>{history.replaceState({ideogramBrowsingKey:o.current},"",window.location.href)},[]),l.useEffect(()=>{const se=H=>{var ne,ue,fe,Se;const me=(Se=((ne=H.state)==null?void 0:ne.ideogramBrowsingKey)??((fe=(ue=H.state)==null?void 0:ue.usr)==null?void 0:fe.ideogramBrowsingKey))==null?void 0:Se.toString();if(me&&(history.replaceState({ideogramBrowsingKey:me},"",window.location.href),me)){const je={...s.current};for(const qe of Object.keys(je))if(qe>me&&delete je[parseInt(qe)],qe===me){const De=s.current[me];De&&De.yPosition!==void 0&&window.scrollTo(0,De.yPosition)}s.current=je}};return window.removeEventListener("popstate",se),window.addEventListener("popstate",se),()=>{window.removeEventListener("popstate",se)}},[]);const E=l.useCallback((se,H)=>{const{preserveSearch:me,searchParams:ne}=H??{},ue=Date.now(),fe={...s.current,[S()]:{...s.current[S()],yPosition:window.scrollY}};typeof se=="string"?(s.current={...fe,[ue]:{...mt(se)}},n({pathname:se,search:ne?ne.toString():me?new URL(document.location.toString()).searchParams.toString():void 0},{state:{ideogramBrowsingKey:ue}})):(s.current={...fe,[ue]:{...mt(se.pathname),...se}},n({pathname:se.pathname,search:ne?ne.toString():me?new URL(document.location.toString()).searchParams.toString():void 0},{state:{ideogramBrowsingKey:ue}}))},[S,n]),N=l.useCallback(se=>{typeof se=="string"?(s.current={...s.current,[S()]:{...mt(se),...s.current[S()]}},n({pathname:se,search:window.location.search},{state:{ideogramBrowsingKey:S()},replace:!0})):(s.current={...s.current,[S()]:{...mt(se.pathname),...se}},n({pathname:se.pathname,search:window.location.search},{state:{ideogramBrowsingKey:S()},replace:!0}))},[S,n]),k=l.useCallback(()=>{const se=Date.now();s.current={[se]:mt(oe.HOME)},n(oe.HOME,{state:{ideogramBrowsingKey:se}})},[n]),A=l.useCallback(()=>{let se=0;for(const H of Object.keys(s.current).filter(me=>parseInt(me)<=S()).sort().reverse()){const me=s.current[parseInt(H)],{pageType:ne}=me;if(nh.includes(ne))return se;se++}return-1},[S]),D=l.useCallback(se=>{let H=0;for(const me of Object.keys(s.current).filter(ne=>parseInt(ne)<=S()).sort().reverse()){const ne=s.current[parseInt(me)],{pageType:ue,pathname:fe}=ne;if(nh.includes(ue))if(ue==="profile"&&se&&!fe.startsWith(se))H++;else return H;else H++}return-1},[S]),O=l.useCallback(()=>{Object.keys(s.current).length>1?n(-1):k()},[n,k]),L=l.useCallback((se,H,me)=>{const ne=me&&se?D(se):A();ne>0?n(-ne):ne<0&&k(),H&&setTimeout(()=>window.scrollTo({top:0,behavior:"smooth"}),300)},[A,D,n,k]),{getBrowsingData:P,showAllImage:G,setShowAllImage:B,setBrowsingSettings:M,saveCurrentGenerationListData:z,saveBrowsingPaginationState:F,saveSearchValue:T,clearGenerationInCurrentListData:j,setNotifications:Z,setNotificationScrollPosition:ee,setNotificationPage:te,getNotificationPage:$,saveCreationsVirtualColumnData:X,saveFeedVirtualColumnData:W}=jI({browsingDataDictRef:s,getBrowsingKey:S,decorateGeneration:w}),[Y,q]=l.useState(""),V=l.useRef({}),Q=l.useRef({}),K=l.useCallback(()=>{Q.current={},V.current={}},[]);l.useEffect(()=>(window.removeEventListener("resize",K),window.removeEventListener("orientationchange",K),window.addEventListener("resize",K),window.addEventListener("orientationchange",K),()=>{window.removeEventListener("resize",K),window.removeEventListener("orientationchange",K)}),[K]);const ae=l.useCallback(se=>{const{name:H,value:me}=se,ne=new URL(window.location.href);ne.searchParams.set(H,me),window.history.replaceState({ideogramBrowsingKey:S()},"",ne)},[S]),ce=l.useCallback(se=>{const H=new URL(window.location.href);H.searchParams.delete(se),window.history.replaceState({ideogramBrowsingKey:S()},"",H)},[S]),ve={navigate:E,replace:N,back:O,closeGeneration:L,getBrowsingData:P,saveCurrentGenerationListData:z,setGenerationDecoration:I,saveBrowsingPaginationState:F,decorateGeneration:w,clearGenerationInCurrentListData:j,getBrowsingKey:S,markGenerationCollapsed:x,isGenerationCollapsed:y,resetCollapsedGenerations:_,setNotifications:Z,setNotificationScrollPosition:ee,setNotificationPage:te,getNotificationPage:$,saveCreationsVirtualColumnData:X,saveFeedVirtualColumnData:W,clearGenerationDecorator:R,columnDataDirty:i,setColumnDataDirty:a,saveSearchValue:T,playingTileResponseId:Y,setPlayingTileResponseId:q,actualRenderHeightMapRef:V,actualShowAllImageRenderHeightMapRef:Q,refreshTheme:t,searchState:c,setSearchState:d,setQueryParam:ae,deleteQueryParam:ce,latestCollapseTimestamp:m,homePageTab:u,setHomePageTab:h,showAllImage:G,setShowAllImage:B,setBrowsingSettings:M};return r.jsx($e.Provider,{value:ve,children:e})},MI={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_AMPLITUDE_API_KEY:"da0464495cb85fed194d60eee20539e6",VITE_APP_AMPLITUDE_EXPERIMENT_PROXY_URL:"https://ideogram.ai/amp-labs",VITE_APP_AMPLITUDE_FLAGS_PROXY_URL:"https://ideogram.ai/amp-flags",VITE_APP_AMPLITUDE_PROXY_URL:"https://ideogram.ai/amplitude",VITE_APP_CELLO_ATTRIBUTION_CDN_URL:"https://assets.cello.so/attribution/latest/cello-attribution.js",VITE_APP_CELLO_COMPONENT_CDN_URL:"https://assets.cello.so/app/latest/cello.js",VITE_APP_CELLO_PRODUCT_ID:"ideogram.ai",VITE_APP_FIREBASE_API_KEY:"AIzaSyBwq4bRiOapXYaKE-0Y46vLAw1-fzALq7Y",VITE_APP_FIREBASE_AUTH_DOMAIN:"ideogram-prod.firebaseapp.com",VITE_APP_FIREBASE_PROXY_AUTH_DOMAIN:"ideogram.ai",VITE_APP_GTAG:"G-44J8R31CP6",VITE_APP_TURNSTILE_SITE_KEY:"0x4AAAAAAAYMuk7BF-qKU-xo",VITE_EXTERNAL_API_BASE_URL:"https://api.ideogram.ai",VITE_STAGING_ENV:"0"},{VITE_EXTERNAL_API_BASE_URL:OI,VITE_APP_CELLO_COMPONENT_CDN_URL:BI,VITE_APP_CELLO_ATTRIBUTION_CDN_URL:LI}=MI,ec=new mv;ec.setCustomParameters({prompt:"select_account"});const id=new xv("apple.com");id.addScope("email");id.addScope("name");const Lt=()=>{try{Vf(void 0)}catch{}rn()?Q_():yv(Jn).catch(()=>{}).then(fI)};let Ne,nr;const oh=18e5,ge=l.createContext({availableStripePlansData:void 0,userAuthState:null,userAuthStateLoading:!1,signInWithGoogle:()=>new Promise(t=>t()),signInWithApple:()=>new Promise(t=>t()),userProfileState:null,jwt:null,updateToken:()=>{},registerV2:()=>new Promise(t=>t("unknown")),profileLink:void 0,signinError:!1,updateTosAgreeTime:()=>null,isLoginLoading:!1,isLoadingAvailablePlans:!1,isBasicSubscriber:void 0,isPlusSubscriber:void 0,isProSubscriber:void 0,isTeamSubscriber:void 0,isAnnualSubscriber:!1,sessionId:"",location:"",subscriptionStatus:void 0,isFeatureEnabled:()=>!1,userSettings:{default_to_private_generation_if_available:!0,default_model_version:"V_1_5"},processingLogin:!1,hasAccessToEditor:!1,hasAccessToAdvancedFeatures:!1,downloadsApi:null,accountApi:null,visionApi:null,privacyApi:null,e2eTestApi:null,mediaApi:null,generationsApi:null,canvasApi:null,jobsApi:null,organizationApi:null,manageExternalApi:null,hasAccessToImageUpload:!1,hasAccessToBatchGeneration:!1,isBatchGenerationEnabled:!1,isTeamBillingEnabled:!1,isBatchGenerationLaunchModalEnabled:!1,hasAccessToTiling:!1,hasAccessToSuperRes:!1,hasAccessToCustomColorPalette:!1,hasAccessToRemoveBg:!1,hasAccessToModel21:!1,isPromptUnderCreationsEnabled:!1,userPublicProfileData:void 0,userOrganizations:[],chosenOrganization:null,setChosenOrganization:()=>{},updateChosenOrganization:()=>{},refreshOrganizations:()=>{},isPricing2025Enabled:!1,isBetaTestersTeamInvitee:!1,isFetchingUserSubscriptionStatus:!1}),NI=({children:t})=>{const e=Ee(),n=l.useRef(`${lg()}_${Date.now()}`),o=l.useRef(Intl.DateTimeFormat().resolvedOptions().timeZone),[i,a]=l.useState(null),[s,c]=l.useState(),[d,u]=l.useState(),{replace:h}=l.useContext($e),p=l.useMemo(()=>s===void 0,[s]);l.useEffect(()=>{c(Jn.currentUser);const de=Jn.onAuthStateChanged(Pe=>{e({eventKey:"FIREBASE_AUTH_STATE_CHANGE_TRIGGERED"}),c(Pe)});return()=>{de()}},[c,e]);const g=l.useRef(p);l.useEffect(()=>{g.current=p},[p]),l.useEffect(()=>{setTimeout(()=>{g.current&&e({eventKey:"10S_FIREBASE_AUTH_STATE_STUCK"})},1e4)},[e]);const[m,v]=l.useState(null);l.useEffect(()=>{nr=m==null?void 0:m.displayHandle},[m==null?void 0:m.displayHandle]);const[x,y]=l.useState(!1),[_,w]=l.useState(!1),[I,R]=l.useState([]),[S,E]=l.useState(null),[N,k]=l.useState(null),[A,D]=l.useState(null),[O,L]=l.useState(null),[P,G]=l.useState(null),[B,M]=l.useState(null),[z,F]=l.useState(null),[T,j]=l.useState(null),[Z,ee]=l.useState(null),[te,$]=l.useState(null),[X,W]=l.useState(!1),{userOrganizations:Y,chosenOrganization:q,setChosenOrganization:V,updateChosenOrganization:Q,refreshOrganizations:K}=TI({userProfileState:m,userAuthState:s,organizationApi:Z}),[ae,ce]=l.useState(new eh(new Yl({middleware:Us,accessToken:"jwt",headers:{organizationId:(q==null?void 0:q.chosenOrganizationId)??""}})));l.useEffect(()=>{!s&&!rn()&&v(null)},[s,v]);const ve=l.useCallback(async()=>{},[ae]),se=l.useCallback(async()=>{window.history.replaceState({},"","/"),await vv(Jn,ec).catch(de=>{e({eventKey:"FIREBASE_GOOGLE_LOGIN_ERROR",metaData:{message:de==null?void 0:de.message,code:de==null?void 0:de.code,redirect:!0}}),y(!0),w(!1)})},[e]),H=l.useCallback(async()=>{await Mu(Jn,ec).then(de=>{w(!0),de.user.getIdToken().then(Pe=>{Ne={Authorization:`Bearer ${Pe}`},a(Pe)})}).catch(de=>{e({eventKey:"FIREBASE_GOOGLE_LOGIN_ERROR",metaData:{message:de==null?void 0:de.message,code:de==null?void 0:de.code}}),y(!0),w(!1)})},[e]),me=l.useCallback(async()=>{if(rn()||!Jn){Lt();return}Jn.config.authDomain=Dx,!rd()?await se():await H()},[H,se,ve]),ne=l.useCallback(async()=>{if(rn()||!Jn){Lt();return}Jn.config.authDomain=e9,await Mu(Jn,id).then(de=>{w(!0),de.user.getIdToken().then(Pe=>{Ne={Authorization:`Bearer ${Pe}`},a(Pe)})}).catch(de=>{e({eventKey:"FIREBASE_APPLE_LOGIN_ERROR",metaData:{message:de==null?void 0:de.message,code:de==null?void 0:de.code}}),y(!0),w(!1)})},[e,ve]);l.useEffect(()=>{if(i){e({eventKey:"JWT_TOKEN_SET"});const de=new Yl({accessToken:i,middleware:Us}),Pe=new cg({basePath:OI,accessToken:i,middleware:Us});E(new H_(de)),k(new Y_(de)),D(new X_(de)),L(new W_(de)),ce(new eh(de)),G(new K_(de)),M(new $_(de)),F(new q_(de)),j(new V_(de)),ee(new J_(de)),$(new Iw(Pe))}},[i,e]);const ue=l.useCallback(async(de,Pe)=>{const J=de.userId;if(J){if(v(de),R(Pe.features),Vf(J),bo)try{bo.clear();const U={user_id:J};await bo.start(U),W(!0)}catch{e({eventKey:"AMPLITUDE_AUTH_SET_FAILED"})}if(Pe.features.includes(Bt.can_access_affiliate_program)){const U=await(S==null?void 0:S.getAccountProfiles({userHandle:de.displayHandle}).then(pe=>{var Te,Ie;return(Ie=(Te=pe.userProfiles)==null?void 0:Te[0])==null?void 0:Ie.displayName}));S==null||S.generateCelloToken().then(pe=>{rI(pe.celloToken,{email:de.emailAddress,firstName:U??de.displayHandle})})}}},[S,e]),{isFetching:fe}=Ve(["login",S],()=>(e({eventKey:"CALLING_LOGIN"}),S.postAccountLogin({userLoginRequest:{externalPhotoUrl:(s==null?void 0:s.photoURL)??void 0}})),{enabled:!!S,onSuccess:({enabledFeatures:de,userModel:Pe})=>{Pe.userId?(ue(Pe,de),e({eventKey:"USER_LOGIN",metaData:{userId:Pe.userId}}),(pt(oe.WELCOME,window.location.pathname)||pt(oe.LOGIN,window.location.pathname))&&h(oe.HOME)):document.visibilityState==="visible"&&(w(!1),u(Pe.recommendedDisplayHandle),h(oe.WELCOME)),w(!1)},staleTime:1/0,retry:(de,Pe)=>(e({eventKey:"LOGIN_CALL_ERROR",metaData:{message:Pe==null?void 0:Pe.code,code:Pe==null?void 0:Pe.message,status:Pe==null?void 0:Pe.status}}),De(),de<3),retryDelay:100,onError:de=>{e({eventKey:"LOGIN_CALL_ERROR",metaData:{message:de==null?void 0:de.code,code:de==null?void 0:de.message,status:de==null?void 0:de.status}}),Lt(),w(!1)}}),Se=l.useRef(null),[je,qe]=l.useState(!1),De=l.useCallback(async()=>{let de="";rn()?(de=await Z_(),qe(!0)):s?(de=await s.getIdToken(!0),qe(!0)):!s&&!p&&qe(!0),de!==""&&(Ne={Authorization:`Bearer ${de}`},a(de),w(!0),Se.current=Date.now())},[s,qe,p]);l.useEffect(()=>{De(),setInterval(()=>{De()},oh)},[De,s]),l.useEffect(()=>{const de=()=>{document.visibilityState==="visible"&&(!Se.current||Se.current+oh<Date.now())&&De()};return document.addEventListener("visibilitychange",de),()=>{document.removeEventListener("visibilitychange",de)}},[De]),l.useEffect(()=>{rn()&&De()},[De]),l.useEffect(()=>{!p&&!rn()&&(s?De():EI.some(de=>pt(de,window.location.pathname))||(v(null),window.location.pathname=oe.LOGIN))},[De,s,p]);const Ye=l.useCallback(async de=>{if(!S)return"unknown";const Pe=await S.postAccountRegister({userRegistrationRequest:{displayHandle:de.display_handle}}).catch(J=>J.response.json().then(U=>U.status===403?"invalidInput":U.status===405?"recentDeleted":(e({eventKey:"SIGNUP_V2_UNEXPECTED_FAILURE"}),"unknown")));if(typeof Pe=="string")return Pe;if(ue(Pe.userModel,Pe.enabledFeatures??{features:[]}),de.name)try{await S.putAccountProfile({userHandle:Pe.userModel.displayHandle,putUserProfileRequest:{displayName:de.name}})}catch{e({eventKey:"SIGNUP_V2_CREATE_PROFILE_FAILED"})}return e({eventKey:"SIGNUP_V2_SUCCESS"}),"success"},[S,ue,e]),nt=l.useCallback(async()=>{const de=await Le("/api/users/tosAgree",{method:"POST",headers:{"Content-Type":"application/json",...Ne}});return de.status===404?!1:(await de.json(),!0)},[]),ct=l.useMemo(()=>m!=null&&m.displayHandle?oe.PROFILE.replace(":uhandle",m==null?void 0:m.displayHandle):void 0,[m==null?void 0:m.displayHandle]),{data:he,isFetching:Fe}=Ve(["fetchUserSubscriptionStatus",q==null?void 0:q.chosenOrganizationId],()=>S.getSubscriptionStatus(),{enabled:!!nr&&!!(q!=null&&q.chosenOrganizationId),staleTime:1/0,onError:de=>{de.status===403&&Lt()}});l.useEffect(()=>{!m||!he||!q||II({userModel:m,subscriptionStatus:he,chosenOrganization:q}).then(de=>Ev(de,{user_id:m.userId}))},[m,he,q]);const{data:Ge}=Ve(["fetchUserSettings"],()=>gI(),{enabled:!!m,staleTime:1/0,retryDelay:100,retry:3,onError:de=>{de.status===403&&Lt()}}),{data:st,isLoading:bt}=Ve(["fetchAvailablePlans"],()=>aI(),{enabled:!!m,staleTime:1/0,retryDelay:100,retry:3}),[En]=ts(),We=l.useCallback(de=>{const Pe=`config_${de}`;if(En.has(Pe)){const J=En.get(Pe);if(J==="true")return!0;if(J==="false")return!1}return Array.isArray(I)&&I.includes(de)},[I,En]),vt=l.useMemo(()=>{var de,Pe;return((de=he==null?void 0:he.activeSubscription)==null?void 0:de.planName)==="Ideogram Basic"||((Pe=he==null?void 0:he.activeSubscription)==null?void 0:Pe.planName)==="Ideogram Basic Annual"},[he]),Qt=l.useMemo(()=>{var de,Pe;return((de=he==null?void 0:he.activeSubscription)==null?void 0:de.planName)==="Ideogram Plus"||((Pe=he==null?void 0:he.activeSubscription)==null?void 0:Pe.planName)==="Ideogram Plus Annual"},[he]),kt=l.useMemo(()=>{var de,Pe;return((de=he==null?void 0:he.activeSubscription)==null?void 0:de.planName)==="Ideogram Pro"||((Pe=he==null?void 0:he.activeSubscription)==null?void 0:Pe.planName)==="Ideogram Pro Annual"},[he]),Ct=l.useMemo(()=>{var de,Pe;return((de=he==null?void 0:he.activeSubscription)==null?void 0:de.planName)==="Ideogram Team"||((Pe=he==null?void 0:he.activeSubscription)==null?void 0:Pe.planName)==="Ideogram Team Annual"},[he]),so=l.useMemo(()=>{var de,Pe,J;return((de=he==null?void 0:he.activeSubscription)==null?void 0:de.planName)==="Ideogram Basic Annual"||((Pe=he==null?void 0:he.activeSubscription)==null?void 0:Pe.planName)==="Ideogram Plus Annual"||((J=he==null?void 0:he.activeSubscription)==null?void 0:J.planName)==="Ideogram Pro Annual"},[he]),gn=l.useMemo(()=>!!(he!=null&&he.activeSubscription),[he==null?void 0:he.activeSubscription]),Dn=l.useMemo(()=>!!(he!=null&&he.activeSubscription)||We(Bt.pro_plan_beta),[We,he==null?void 0:he.activeSubscription]),kn=l.useMemo(()=>Qt||kt||Ct,[Qt,kt,Ct]),An=l.useMemo(()=>(Y==null?void 0:Y.length)>1,[Y==null?void 0:Y.length]),Vn=l.useMemo(()=>We(Bt.team_billing)||An,[An,We]),mn=l.useMemo(()=>We(Bt.batch_generation)||We(Bt.pro_plan_beta),[We]),ln=l.useMemo(()=>We(Bt.batch_generation_launch_modal),[We]),cn=l.useMemo(()=>(kt||Ct||We(Bt.pro_plan_beta)&&!!(he!=null&&he.activeSubscription))&&mn,[mn,We,kt,Ct,he==null?void 0:he.activeSubscription]),Fn=l.useMemo(()=>We(Bt.tiling_beta)||!!(he!=null&&he.activeSubscription),[We,he==null?void 0:he.activeSubscription]),Zt=l.useMemo(()=>We(Bt.super_res_beta)||!!(he!=null&&he.activeSubscription),[We,he==null?void 0:he.activeSubscription]),St=l.useMemo(()=>Qt||kt||Ct,[Qt,kt,Ct]),dn=l.useMemo(()=>!!(he!=null&&he.activeSubscription),[he==null?void 0:he.activeSubscription]),Dt=l.useMemo(()=>We(Bt.model_2_1)||We(Bt.model_2_1_preview)&&!!(he!=null&&he.activeSubscription),[We,he==null?void 0:he.activeSubscription]),{data:At,isFetching:xn}=Ve(["userProfile",m==null?void 0:m.displayHandle],()=>Oa(m.userId),{enabled:!!(m!=null&&m.userId),staleTime:1/0,retry:!1}),{pathname:jn}=Rn(),vn=jn.startsWith("/t/my-images")&&!!(At!=null&&At.join_time_float)&&At.join_time_float>=1736208e3&&Xs(Ui.creations_prompt2),Gt=l.useMemo(()=>We(Bt.creations_prompt)?!0:X&&vn,[X,vn,We]),en=!!pt(oe.PRICING,jn)&&!!(At!=null&&At.join_time_float)&&At.join_time_float>1737072e3&&Xs(Ui.pricing_2025),Kn=l.useMemo(()=>We(Bt.pricing_2025)||en,[We,en]),ao={availableStripePlansData:st,userAuthState:s,userAuthStateLoading:p,signInWithGoogle:me,signInWithApple:ne,userProfileState:m,jwt:i,updateToken:De,registerV2:Ye,profileLink:ct,signinError:x,updateTosAgreeTime:nt,isLoginLoading:!je||_||fe&&!!i||xn||Fe,isLoadingAvailablePlans:bt,isBasicSubscriber:vt,isPlusSubscriber:Qt,isProSubscriber:kt,isTeamSubscriber:Ct,isAnnualSubscriber:so,sessionId:n.current,location:o.current,subscriptionStatus:he,isFeatureEnabled:We,userSettings:Ge,processingLogin:_,hasAccessToEditor:gn,hasAccessToAdvancedFeatures:Dn,accountApi:S,visionApi:N,privacyApi:A,downloadsApi:O,e2eTestApi:ae,mediaApi:P,generationsApi:B,canvasApi:z,jobsApi:T,organizationApi:Z,manageExternalApi:te,hasAccessToImageUpload:kn,hasAccessToBatchGeneration:cn,isBatchGenerationEnabled:mn,isTeamBillingEnabled:Vn,isBatchGenerationLaunchModalEnabled:ln,hasAccessToTiling:Fn,hasAccessToSuperRes:Zt,recommendedDisplayHandle:d,hasAccessToCustomColorPalette:St,hasAccessToRemoveBg:dn,hasAccessToModel21:Dt,isPromptUnderCreationsEnabled:Gt,userPublicProfileData:At,userOrganizations:Y,chosenOrganization:q,setChosenOrganization:V,updateChosenOrganization:Q,refreshOrganizations:K,isPricing2025Enabled:Kn,isBetaTestersTeamInvitee:An,isFetchingUserSubscriptionStatus:Fe};return r.jsxs(ge.Provider,{value:ao,children:[r.jsxs(Kf,{children:[r.jsx("script",{type:"module",src:BI,async:!0}),r.jsx("script",{type:"module",src:LI,async:!0})]}),t]})},sd=t=>`IDEOGRAM_ACTIVE_ORG_ID_${t}`,DI=t=>{nr&&localStorage.setItem(sd(nr),t)},tc=()=>{if(nr)return localStorage.getItem(sd(nr))},rh=()=>{nr&&localStorage.removeItem(sd(nr))};class Bg{async pre(e){const n=tc();if(!n)return e;const o={...e.init.headers,"X-Ideo-Org":n},i={...e.init,headers:o};return{url:e.url,init:i}}async preFetch(e,n){const o=tc();if(!o)return n;const i={...n==null?void 0:n.headers,"X-Ideo-Org":o};return{...n,headers:i}}async post(e){return e.response.status===433&&(rh(),window.location.reload()),e.response}async postFetch(e){return e.status===433&&(rh(),window.location.reload()),e}}class FI{async pre(e){const n=this.getTraceID(),o={...e.init.headers,"X-Request-ID":n,traceparent:this.generateTraceParentValue(n)},i={...e.init,headers:o};return{url:e.url,init:i}}async preFetch(e,n){const o=this.getTraceID(),i={...n==null?void 0:n.headers,"X-Request-ID":o,traceparent:this.generateTraceParentValue(o)};return{...n,headers:i}}generateTraceParentValue(e){return`00-${e}-${e.substring(0,16)}-00`}getTraceID(){return lg().replace(/-/g,"").toLowerCase()}}const Us=[new FI,new Bg],zI=[new Bg];async function Le(t,e){const n=await Us.reduce(async(i,a)=>a.preFetch(t,await i),Promise.resolve(e));let o=await fetch(t,n);return o=await zI.reduce(async(i,a)=>a.postFetch(await i),Promise.resolve(o)),o}function $n({width:t,height:e,color:n,rotate:o=0}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??20,height:e??20,fill:n??"inherit",viewBox:"0 0 20 20",style:{transform:`rotate(${o}deg)`},children:r.jsx("g",{children:r.jsx("path",{fill:n??"inherit",d:"M4.147 12.354a.5.5 0 01-.001-.707L9.61 6.163a.55.55 0 01.779 0l5.465 5.484a.5.5 0 01-.708.706L10 7.188l-5.146 5.165a.5.5 0 01-.707.001z"})})})}const UI=new Map([["background","#FAFAFA"],["surface","#ffffff"],["solid","#ffffff"],["primary","#27272A"],["secondary","#52525B"],["reverseSecondary","#D4D4D8"],["informative","#71717A"],["active","#FF3D59"],["transparentActive","#FF3D5988"],["backdrop","rgb(0 0 0/25%)"],["error","#FF5757"],["revertBackdrop","#000000DD"],["transparentSolid","rgba(255, 255, 255, 0.8)"],["transparentSecondary","rgba(202, 202, 202, 0.9)"],["foggyBackground1","rgba(5, 5, 3, 0.01)"],["foggyBackground2","rgba(5, 5, 3, 0.07)"],["selectedToggleButton","#ffffff"],["toggleButtonBackground","#eeeeef"],["like","#DC2626"],["inputBackground","#F2F2F7"],["primaryBackground","#F4F4F5"],["tertiary","#71717A"],["transparentSurface","#3F3F4633"],["violet","#001370"],["inputBorderDefault","#D4D4D8"],["inputBorderHover","#A1A1AA"],["inputBorderFocus","#71717A"],["inputBorderPressed","#71717A"],["inputValue","#18181B"],["sliderRail","#E4E4E7"],["sliderColor","#18181B"],["sliderMarker","#71717A"],["sliderThumbDefault","#FAFAFA"],["sliderThumbHover","#FAFAFA"],["sliderThumbPressed","#FAFAFA"],["sliderThumbBorderDefault","#E4E4E7"],["sliderThumbBorderHover","#D4D4D8"],["sliderThumbBorderPressed","#A1A1AA"],["sliderThumbBoxShadowDefault","0px 2px 4px -2px rgba(0, 0, 0, 0.1), 0px 4px 6px -1px rgba(0, 0, 0, 0.1)"],["sliderThumbBoxShadowHover","0px 4px 6px -4px rgba(0, 0, 0, 0.1), 0px 10px 15px -3px rgba(0, 0, 0, 0.1)"],["toggleBackground","#F4F4F5"],["toggleGroupInnerShadow","0px 2px 4px 0px #09090B0D inset"],["toggleButtonSelected","#FFFFFF"],["toggleTextSelected","#27272A"],["toggleButtonBoxShadowSelected","0px 1px 2px -1px #09090B1A, 0px 1px 3px 0px #09090B1A"],["toggleButtonRest","#09090B00"],["toggleTextRest","#52525B"],["toggleButtonHover","#09090B0D"],["toggleTextHover","#27272A"],["toggleButtonPressed","#09090B1A"],["toggleTextPressed","#27272A"],["toggleButtonDisabled","#09090B00"],["toggleTextDisabled","#A1A1AA"],["border","#E4E4E7"],["primaryButton","#18181B"],["primaryButtonText","#FAFAFA"],["primaryButtonBoxShadow","0px 1px 2px -1px #09090B1A, 0px 1px 3px 0px #09090B1A"],["primaryButtonHover","#27272A"],["primaryButtonTextHover","#FAFAFA"],["primaryButtonTextHoverBoxShadow","0px 2px 4px -2px #09090B1A, 0px 4px 6px -1px #09090B1A"],["primaryButtonDisable","#F4F4F5"],["primaryButtonTextDisable","#71717A"],["primaryButtonPressed","#3F3F46"],["outlinedButtonBorder","#E4E4E7"],["outlinedButton","#FFFFFF00"],["outlinedButtonText","#3F3F46"],["outlinedButtonHover","#F4F4F5"],["outlinedButtonTextHover","#27272A"],["outlinedButtonPressed","#E4E4E7"],["outlinedButtonTextPressed","#18181B"],["outlinedButtonBorderPressed","#A1A1AA"],["outlinedButtonDisabled","#F4F4F5"],["outlinedButtonTextDisabled","#A1A1AA"],["quietButton","#09090B00"],["quietButtonText","#3F3F46"],["quietButtonHover","#09090B0D"],["quietButtonTextHover","#27272A"],["quietButtonTextDisabled","#A1A1AA"],["quietButtonPressed","#09090B1A"],["quietButtonTextHoverPressed","#18181B"],["batchGenerationButtonBackground","#FFFFFF"],["neutral_100A","rgba(9, 9, 11, 0.05)"],["batchGenerationButtonBackgroundMaskDisabled","rgba(9, 9, 11, 0.1)"],["batchGenerationButtonDisable","#3F3F46"],["batchGenerationButtonTextDisable","#71717A"],["batchGenerationButtonText","#18181B"],["batchGenerationButtonBorder","#D4D4D8"],["divider","#A1A1AA"],["dividerDragButtonBorder","#E4E4E7"],["dividerDragButtonBackground","#FFFFFF"],["dividerDragButtonIcon","#71717A"],["dividerDragButtonShadow","0px 1px 2px 0px #0202030D"],["buttonIcon","#3F3F46"],["label","#52525B"],["disabledLabel","#A1A1AA"],["tooltip","#27272A"],["tooltipText","#FAFAFA"],["tag","#FFFFFF00"],["tagBorder","#E4E4E7"],["tagText","#52525B"],["tagHover","#F4F4F5"],["tagBorderHover","#D4D4D8"],["tagTextHover","#3F3F46"],["tagPressed","#E4E4E7"],["tagBorderPressed","#A1A1AA"],["tagTextPressed","#27272A"],["infoCardBorder","#E4E4E7"],["infoCardBackground","#F4F4F5"],["infoCardText","#52525B"],["infoCardLink","#27272A"],["modalbackground","#ffffff"],["modalOverlay","rgba(63, 63, 70, 0.2)"],["staticTitle","#27272A"],["staticContent","#52525B"],["staticIcon","#3F3F46"],["menuAction","#52525B"],["menuActionHover","#F4F4F5"],["destructive","#DC2626"],["destructiveIcon","#B42318"],["destructiveSecondary","#55160C"],["backgroundSurfaceDestructive","#FFEFEE"],["borderDestructive","#FECDCA"],["borderHighlight","#D4D4D8"],["menuActionDisabled","#A1A1AA"],["metadataPanel","#FFFFFF"],["menuBackground","#FFFFFF"],["previewPanelBackground","#ECECEE"],["previewPanelBoxShadow","0px 20px 25px -5px rgba(9, 9, 11, 0.10), 0px 8px 10px -6px rgba(9, 9, 11, 0.10);"],["previewPlaceholderMask","linear-gradient(135deg, rgba(61, 94, 255, 0.25) 0%, rgba(154, 94, 237, 0.25) 14.29%, rgba(200, 101, 219, 0.25) 28.57%, rgba(229, 115, 204, 0.25) 42.86%, rgba(246, 136, 194, 0.25) 57.14%, rgba(255, 159, 189, 0.25) 71.43%, rgba(255, 184, 193, 0.25) 85.71%, rgba(255, 208, 206, 0.25) 100%)"],["shortcutBorder","#52525B"],["shortcutBackground","#3F3F46"],["shortcutIcon","#E4E4E7"],["skeleton","#F4F4F5"],["skeletonBorder","#D4D4D8"],["promptBoxColor","#FFFFFF"],["menuShadow","0px 4px 6px -1px rgba(9, 9, 11, 0.10), 0px 2px 4px -2px rgba(9, 9, 11, 0.10);"],["glassBackground","rgba(9, 9, 11, 0.15)"],["glassBackgroundHover","rgba(9, 9, 11, 0.25)"],["glassBackgroundPressed","rgba(9, 9, 11, 0.35)"],["tileControlBlack","#18181B"],["tileControlWhite","#FFFFFF"],["tileControlGrey","rgba(212, 212, 216, 0.30)"],["iconPrimary","#18181B"],["success","#047857"],["toggleSuccess","#047857"],["successBackground","#ECFDF5"],["IdeogramPink","#FF3D59"],["IdeogramPinkHover","#E51B46"],["IdeogramPinkPressed","#BA3242"],["IdeogramPinkText","#E51B46"],["IdeogramPinkSurface","#FFEFEE"],["IdeogramPinkBorder","#FFD0CE"],["planCardHighlight","linear-gradient(180deg, rgba(255, 61, 89, 0.15) 0%, rgba(255, 61, 89, 0.01) 100%), var(--color-bg-surface, #FFF)"],["Interactive","#52525B"],["InteractiveHover","#18181B"],["InteractiveActive","#18181B"],["successBannerBackground","#E9FFE7"],["successBannerText","#20632C"],["bulkSelectBackground","#ECECEE"],["transparentActive","rgba(9, 9, 11, 0.10)"],["loadPreviousMasksDisabled","#D4D4D8"],["backgroundSurface","#fff"],["progressBase","#09090B2B"],["violetBackground","#ebefff"],["labelToggleSelected","#FFFFFF"]]),GI=new Map([["background","#09090B"],["surface","#09090B"],["solid","#000000"],["primary","#FAFAFA"],["secondary","#D4D4D8"],["reverseSecondary","#52525B"],["informative","#A1A1AA"],["active","#FF3D59"],["transparentActive","#FF3D5988"],["backdrop","rgb(0 0 0/25%)"],["error","#FF7979"],["revertBackdrop","#FFFFFFDD"],["transparentSolid","rgba(0, 0, 0, 0.8)"],["transparentSecondary","rgba(87, 87, 87, 0.9)"],["foggyBackground1","rgba(250, 250, 252, 0.08)"],["foggyBackground2","rgba(250, 250, 252, 0.2)"],["selectedToggleButton","#5a5a5f"],["toggleButtonBackground","#1c1c1f"],["like","#F87171"],["inputBackground","#1C1C1E"],["primaryBackground","#3F3F46"],["tertiary","#a1a1aa"],["transparentSurface","#18181B80"],["violet","#001370"],["inputBorderDefault","#27272A"],["inputBorderHover","#52525B"],["inputBorderFocus","#A1A1AA"],["inputBorderPressed","#71717A"],["inputValue","#F4F4F5"],["sliderRail","#52525B"],["sliderColor","#D4D4D8"],["sliderMarker","#D4D4D8"],["sliderThumbDefault","#FFFFFF"],["sliderThumbHover","#F4F4F5"],["sliderThumbPressed","#E4E4E7"],["sliderThumbBorderDefault","#FFFFFF"],["sliderThumbBorderHover","#F4F4F5"],["sliderThumbBorderPressed","#E4E4E7"],["sliderThumbBoxShadowDefault","0px 2px 4px -2px rgba(0, 0, 0, 0.1), 0px 4px 6px -1px rgba(0, 0, 0, 0.1)"],["sliderThumbBoxShadowHover","0px 4px 6px -4px rgba(0, 0, 0, 0.1), 0px 10px 15px -3px rgba(0, 0, 0, 0.1)"],["toggleBackground","#27272A"],["toggleGroupInnerShadow","0px 2px 4px 0px #09090B0D inset"],["toggleButtonSelected","#3F3F46"],["toggleTextSelected","#FAFAFA"],["toggleButtonBoxShadowSelected","0px 1px 2px -1px #09090B1A, 0px 1px 3px 0px #09090B1A"],["toggleButtonRest","#09090B00"],["toggleTextRest","#D4D4D8"],["toggleButtonHover","#FFFFFF0D"],["toggleTextHover","#FAFAFA"],["toggleButtonPressed","#FFFFFF1A"],["toggleTextPressed","#FAFAFA"],["toggleButtonDisabled","#09090B00"],["toggleTextDisabled","#71717A"],["border","#27272A"],["primaryButton","#F4F4F5"],["primaryButtonText","#27272A"],["primaryButtonBoxShadow","0px 1px 2px -1px #09090B1A, 0px 1px 3px 0px #09090B1A"],["primaryButtonHover","#E4E4E7"],["primaryButtonTextHover","#27272A"],["primaryButtonTextHoverBoxShadow","0px 2px 4px -2px #09090B1A, 0px 4px 6px -1px #09090B1A"],["primaryButtonDisable","#3F3F46"],["primaryButtonTextDisable","#71717A"],["primaryButtonText","#18181B"],["primaryButtonPressed","#D4D4D8"],["outlinedButtonBorder","#27272A"],["outlinedButton","#00000000"],["outlinedButtonText","#E4E4E7"],["outlinedButtonHover","#27272A"],["outlinedButtonTextHover","#F4F4F5"],["outlinedButtonPressed","#27272A"],["outlinedButtonTextPressed","#FAFAFA"],["outlinedButtonBorderPressed","#52525B"],["outlinedButtonDisabled","#27272A"],["outlinedButtonTextDisabled","#71717A"],["quietButton","#FFFFFF00"],["quietButtonText","#E4E4E7"],["quietButtonHover","#FFFFFF1A"],["quietButtonTextHover","#F4F4F5"],["quietButtonTextDisabled","#71717A"],["quietButtonPressed","#FFFFFF33"],["quietButtonTextHoverPressed","#FAFAFA"],["batchGenerationButtonBackground","#27272A"],["neutral_100A","rgba(220, 220, 255, 0.13)"],["batchGenerationButtonBackgroundMaskDisabled","rgba(220, 220, 255, 0.23)"],["batchGenerationButtonDisable","#F4F4F5"],["batchGenerationButtonTextDisable","#71717A"],["batchGenerationButtonText","#D4D4D8"],["batchGenerationButtonBorder","#52525B"],["divider","#3F3F46"],["dividerDragButtonBorder","#27272A"],["dividerDragButtonBackground","#3F3F46"],["dividerDragButtonIcon","#D4D4D8"],["dividerDragButtonShadow","0px 1px 2px 0px #0202030D"],["buttonIcon","#3F3F46"],["label","#A1A1AA"],["disabledLabel","#52525B"],["tooltip","#27272A"],["tooltipText","#FAFAFA"],["tag","#00000000"],["tagBorder","#27272A"],["tagText","#D4D4D8"],["tagHover","#27272A"],["tagBorderHover","#3F3F46"],["tagTextHover","#E4E4E7"],["tagPressed","#3F3F46"],["tagBorderPressed","#52525B"],["tagTextPressed","#F4F4F5"],["infoCardBorder","#27272A"],["infoCardBackground","#27272A"],["infoCardText","#D4D4D8"],["infoCardLink","#D4D4D8"],["modalbackground","#09090B"],["modalOverlay","rgba(24, 24, 27, 0.5)"],["staticTitle","#FAFAFA"],["staticContent","#D4D4D8"],["staticIcon","#E4E4E7"],["menuAction","#D4D4D8"],["menuActionHover","#27272A"],["destructive","#F87171"],["destructiveIcon","#FDA29B"],["destructiveSecondary","#FAFAFA"],["backgroundSurfaceDestructive","#55160C"],["borderDestructive","#7A271A"],["borderHighlight","#3F3F46"],["menuActionDisabled","#71717A"],["metadataPanel","#18181B"],["menuBackground","#18181B"],["previewPanelBackground","#27272A"],["previewPanelBoxShadow","0px 20px 25px -5px rgba(9, 9, 11, 0.10), 0px 8px 10px -6px rgba(9, 9, 11, 0.10)"],["previewPlaceholderMask","linear-gradient(135deg, rgba(61, 94, 255, 0.25) 0%, rgba(154, 94, 237, 0.25) 14.29%, rgba(200, 101, 219, 0.25) 28.57%, rgba(229, 115, 204, 0.25) 42.86%, rgba(246, 136, 194, 0.25) 57.14%, rgba(255, 159, 189, 0.25) 71.43%, rgba(255, 184, 193, 0.25) 85.71%, rgba(255, 208, 206, 0.25) 100%)"],["shortcutBorder","#3F3F46"],["shortcutBackground","#3F3F46"],["shortcutIcon","#E4E4E7"],["skeleton","#27272A"],["skeletonBorder","#3F3F46"],["promptBoxColor","#18181B"],["menuShadow","0px 4px 6px -1px rgba(9, 9, 11, 0.10), 0px 2px 4px -2px rgba(9, 9, 11, 0.10);"],["glassBackground","rgba(9, 9, 11, 0.15)"],["glassBackgroundHover","rgba(9, 9, 11, 0.25)"],["glassBackgroundPressed","rgba(9, 9, 11, 0.35)"],["tileControlBlack","#18181B"],["tileControlWhite","#FFFFFF"],["tileControlGrey","rgba(212, 212, 216, 0.30)"],["iconPrimary","#FFFFFF"],["success","#6EE7B7"],["toggleSuccess","#059669"],["successBackground","#064E3B"],["IdeogramPink","#FF3D59"],["IdeogramPinkHover","#E51B46"],["IdeogramPinkPressed","#BA3242"],["IdeogramPinkText","#FF6B74"],["IdeogramPinkSurface","#59001D"],["IdeogramPinkBorder","#733135"],["planCardHighlight","linear-gradient(180deg, rgba(255, 61, 89, 0.30) 0%, rgba(255, 61, 89, 0.05) 100%), var(--color-bg-surface, #27272A)"],["Interactive","#D4D4D8"],["InteractiveHover","#FFFFFF"],["InteractiveActive","#FFFFFF"],["successBannerBackground","#284028"],["successBannerText","#C3FFC1"],["bulkSelectBackground","#3F3F46"],["transparentActive","rgba(9, 9, 11, 0.10)"],["loadPreviousMasksDisabled","#52525B"],["backgroundSurface","#27272A"],["progressBase","#71717A"],["violetBackground","#ebefff"],["labelToggleSelected","#3F3F46"]]),Xo={light:"light",dark:"dark",auto:"auto"},$r="IDEOGRAM_APP_THEME_MODE";let os=localStorage.getItem($r)===Xo.dark||(localStorage.getItem($r)===Xo.auto||!localStorage.getItem($r))&&window.matchMedia("(prefers-color-scheme: dark)").matches;const HI=t=>{os=t===Xo.dark||t===Xo.auto&&window.matchMedia("(prefers-color-scheme: dark)").matches},f=t=>(os?GI.get(t):UI.get(t))??"#fff",cl=t=>(new Array(2).join("0")+t).slice(-2),ih=t=>(t.indexOf("#")===0&&(t=t.slice(1)),t.length===3&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),parseInt(t.slice(0,2),16)+parseInt(t.slice(2,4),16)+parseInt(t.slice(4,6),16)<382.5?"#ffffff":"#000000"),qI=t=>{t=t.replace("#","");let e=parseInt(t.substring(0,2),16),n=parseInt(t.substring(2,4),16),o=parseInt(t.substring(4,6),16);return e=255-e,n=255-n,o=255-o,`#${e.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}${o.toString(16).padStart(2,"0")}`};document.body.style.backgroundColor=f("background");document.body.style.color=f("primary");var ad={},dl={};const WI=Dv(nv);var sh;function fn(){return sh||(sh=1,function(t){"use client";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return e.createSvgIcon}});var e=WI}(dl)),dl}var $I=pn;Object.defineProperty(ad,"__esModule",{value:!0});var Lg=ad.default=void 0,VI=$I(fn()),KI=r;Lg=ad.default=(0,VI.default)((0,KI.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");function JI({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M7.75 12a1.75 1.75 0 11-3.5 0 1.75 1.75 0 013.5 0zm6 0a1.75 1.75 0 11-3.5 0 1.75 1.75 0 013.5 0zM18 13.75a1.75 1.75 0 100-3.5 1.75 1.75 0 000 3.5z"})})}const Rt=t=>{const{children:e,content:n,size:o,open:i,placement:a}=t;return n?r.jsx(Ca,{open:i,title:n,arrow:!0,enterDelay:100,enterTouchDelay:100,leaveTouchDelay:5e3,placement:a,slotProps:{popper:{onClick:s=>s.stopPropagation(),sx:{pointerEvents:"all",zIndex:s=>s.zIndex.tooltip+1033}},tooltip:{onClick:s=>s.stopPropagation(),sx:{backgroundColor:f("tooltip"),color:f("tooltipText"),padding:o==="small"?"4px 8px":"12px",borderRadius:o==="small"?2:3,marginTop:a==="bottom"||!a?"6px !important":void 0,marginBottom:a==="top"?"6px !important":void 0,marginRight:a==="left"?"6px !important":void 0,marginLeft:a==="right"?"6px !important":void 0,pointerEvents:"all",fontSize:14,fontFamily:"Manrope, sans-serif",maxWidth:"320px"}},arrow:{sx:{color:f("tooltip")}}},PopperProps:{modifiers:[{name:"offset",options:{offset:[0,2]}}]},children:e}):e},Yt=t=>{const{onClick:e,icon:n,pressed:o,size:i,round:a,disabled:s,tooltip:c,nonTransparent:d}=t;return r.jsx(Rt,{content:c&&!s?r.jsx(le,{fontSize:14,children:c}):void 0,size:"small",children:r.jsx(XI,{disabled:s,sx:{...o?{color:f("outlinedButtonTextPressed"),backgroundColor:f("outlinedButtonPressed"),borderWidth:1,borderStyle:"solid",borderColor:f("outlinedButtonBorderPressed")}:{color:f("outlinedButtonText"),backgroundColor:d===!0?f("promptBoxColor"):d||f("outlinedButton"),borderWidth:1,borderStyle:"solid",borderColor:f("outlinedButtonBorder")},"&:hover":{color:f("outlinedButtonTextHover"),backgroundColor:f("outlinedButtonHover")},width:i??40,height:i??40,minWidth:i??40,minHeight:i??40,borderRadius:a?5:2},onClick:e,disableRipple:!0,children:n})})},XI=b(gt)(()=>({minWidth:0,"&.Mui-disabled":{opacity:1,color:f("outlinedButtonTextDisabled"),backgroundColor:f("outlinedButtonDisabled"),borderWidth:"0 !important"},padding:0})),Ys=["photo","illustration","3d render","typography","cinematic","poster","painting","fashion","product","anime","architecture","dark fantasy","vibrant","graffiti","portrait photography","wildlife photography","conceptual art","ukiyo-e"],YI=()=>{const t=Ee(),e=we(),n=xe(e.breakpoints.down("md")),{suggestions:o,setSuggestions:i}=l.useContext(ye),[a,s]=l.useState([]),[c,d]=l.useState(!1);l.useEffect(()=>{a.length===0&&s(Ys)},[a]);const u=l.useMemo(()=>n?4:6,[n]),h=l.useMemo(()=>c?a.filter(g=>!o.includes(g)):a.filter(g=>!o.includes(g)).slice(0,u),[o,a,u,c]),p=l.useMemo(()=>r.jsxs(r.Fragment,{children:[o.map(g=>r.jsx(QI,{clickable:!1,label:g,sx:{fontSize:n?13:14,marginRight:n?"4px":1,"& .MuiChip-label":{paddingLeft:n?1:void 0,paddingRight:n?1:void 0}},onDelete:()=>{t({eventKey:"REMOVE_STYLE",metaData:{styleName:g}}),i(o.filter(m=>m!==g))},onClick:()=>{t({eventKey:"REMOVE_STYLE",metaData:{styleName:g}}),i(o.filter(m=>m!==g))},deleteIcon:r.jsx(Lg,{sx:{width:16,height:16},fontSize:"small"})},g)),Ys.map(g=>h.includes(g)?r.jsx(ZI,{clickable:!1,label:g,onClick:()=>{t({eventKey:"ADD_STYLE",metaData:{styleName:g}}),i([...o,g])},sx:{fontSize:n?13:14,marginRight:n?"4px":1,"& .MuiChip-label":{paddingLeft:n?1:void 0,paddingRight:n?1:void 0}}},g):null)]}),[o,n,t,i,h]);return r.jsx(C,{display:"flex",flexDirection:"column",children:r.jsx(C,{display:"flex",flexDirection:"column",flex:1,paddingRight:n?0:1.5,children:r.jsxs(C,{display:"flex",flexDirection:"row",alignItems:"center",maxWidth:"100%",width:"100%",minHeight:n?32:40,flexWrap:"wrap",children:[p,r.jsx(Yt,{onClick:()=>{t({eventKey:c?"COLLAPSE_STYLE_CLICK":"SEE_ALL_STYLE_CLICK"}),d(!c)},pressed:c,icon:r.jsx(JI,{color:f(c?"outlinedButtonTextPressed":"outlinedButtonText")}),size:32})]})})})},QI=b(Hf)(({theme:t})=>({marginTop:4,marginBottom:4,outlineStyle:"solid",outlineWidth:.5,outlineColor:f("tagBorderPressed"),backgroundColor:f("tagPressed"),color:f("tagTextPressed"),"&:hover":{outlineColor:f("tagBorderHover"),backgroundColor:f("tagHover"),color:f("tagTextHover"),[t.breakpoints.down("md")]:{outlineColor:f("tagBorderPressed"),backgroundColor:f("tagPressed"),color:f("tagTextPressed")}},"& .MuiChip-deleteIcon":{color:f("tagTextPressed"),"&:hover":{color:f("tagTextPressed")}},fontSize:14,height:32,borderRadius:8,cursor:"pointer"})),ZI=b(Hf)(({theme:t})=>({padding:0,marginTop:4,marginBottom:4,outlineStyle:"solid",outlineWidth:.5,outlineColor:f("tagBorder"),backgroundColor:f("tag"),color:f("tagText"),"&:hover":{outlineColor:f("tagBorderHover"),backgroundColor:f("tagHover"),color:f("tagTextHover"),[t.breakpoints.down("md")]:{outlineColor:f("tagBorder"),backgroundColor:f("tag"),color:f("tagText")}},fontSize:14,height:32,borderRadius:8,cursor:"pointer"})),La=t=>{const e=t.split(", "),n=[...e];e.reverse();const o=[];for(const i of e)if(Ys.includes(i)&&!o.includes(i))n.pop(),o.push(i);else break;return{prompt:n.join(", "),styles:o}},Yn=t=>["V_0_3","V_1_1","V_1_5","V_2_1"].includes(t??""),nc=t=>t.split(":").reverse().join(":"),rs=t=>t==="V_0_1"||t==="V_0_2"||t==="V_0_3",eS=t=>t!=null&&t.includes("x")?t.replace("x",":"):"1:1",tS=t=>{if(t!=null&&t.includes(":")){const e=t.split(":");return{width:parseInt(e[0]??"1"),height:parseInt(e[1]??"1")}}return{width:1,height:1}},Be=t=>{const{onClick:e,icon:n,tooltip:o,pressed:i,size:a,disabled:s,largeTooltip:c,freeWidth:d,round:u,tooltipPlacement:h,customBorderRadius:p,customPressedButtonColor:g,disablePointerEvent:m,radius:v}=t;return r.jsx(Rt,{content:typeof o=="string"?r.jsx(le,{fontSize:14,children:o}):o,size:c?"default":"small",placement:h,children:r.jsx(C,{sx:{pointerEvents:"auto"},children:r.jsx(nS,{disableRipple:!0,disabled:s,onClick:e,sx:{...i?{color:f("outlinedButtonTextPressed"),backgroundColor:g??f("outlinedButtonPressed")}:{backgroundColor:f("quietButton")},width:d?void 0:(a==null?void 0:a.width)??40,padding:d?1:0,height:(a==null?void 0:a.height)??40,borderRadius:v??(u?`${((a==null?void 0:a.width)??40)/2}px`:p??2),pointerEvents:m?"none":void 0},children:n})})})},nS=b(Yo)(()=>({color:f("Interactive"),fill:f("Interactive"),fontFamily:"Manrope",fontSize:14,fontWeight:600,lineHeight:"20px",letterSpacing:"-0.56px","&:hover":{color:f("InteractiveHover"),fill:f("InteractiveHover"),backgroundColor:f("quietButtonHover")},"&:active":{fill:f("InteractiveActive"),color:f("InteractiveActive"),backgroundColor:f("quietButtonPressed")},"&.Mui-disabled":{opacity:1,fill:f("quietButtonTextDisabled"),color:f("quietButtonTextDisabled")},minWidth:0})),to=b(C)({display:"flex",alignItems:"flex-start",justifyContent:"space-between",flexWrap:"wrap",width:"100%"}),no=232,is=t=>{const e=we(),n=xe(e.breakpoints.down("md")),{currentSelection:o,options:i,width:a,height:s,disabled:c,round:d}=t;return r.jsx(Zo,{width:a??no,height:s,value:o,disabled:c,round:d,exclusive:!0,children:i.map((u,h)=>{const{optionName:p,optionId:g,onSelect:m,optionIcon:v,disabled:x,hint:y}=u;return r.jsx(on,{value:g??p,onClick:()=>m(),disableRipple:!0,sx:{marginLeft:h===0?"0 !important":"2px !important",fontSize:14,padding:0,...s?{height:s-4,minHeight:s-4,maxHeight:s-4}:{height:36,minHeight:36,maxHeight:36},borderRadius:`${d?s??40/2:6}px !important`},disabled:x,children:r.jsx(Rt,{content:y,size:"small",children:r.jsxs(oS,{sx:{paddingX:n?1:"12px"},children:[v,p]})})},g??p)})})},oS=b(C)({paddingTop:"4px",paddingBottom:"4px",height:"100%",display:"flex",alignItems:"center"}),on=b(ov)(()=>({color:f("toggleTextRest"),flex:1,backgroundColor:f("toggleButtonRest"),borderStyle:"none",borderWidth:0,transition:"0.1s",textWrap:"nowrap",borderRadius:"6px !important","&:hover":{color:f("toggleTextHover"),backgroundColor:f("toggleButtonHover")},"&.Mui-selected":{color:`${f("toggleTextSelected")} !important`,backgroundColor:`${f("toggleButtonSelected")} !important`,boxShadow:`${f("toggleButtonBoxShadowSelected")} !important`,"&:hover":{color:f("toggleTextSelected"),backgroundColor:f("toggleButtonSelected"),boxShadow:f("toggleButtonBoxShadowSelected")}},"&.Mui-disabled":{borderStyle:"none",pointerEvents:"auto",color:f("toggleTextDisabled"),backgroundColor:f("toggleButtonDisabled"),"&:hover":{color:f("toggleTextDisabled"),backgroundColor:f("toggleButtonDisabled")}}})),Zo=({width:t,height:e,round:n,disabled:o,children:i,...a})=>r.jsx(ld,{...a,disabled:o,sx:{maxWidth:t,minWidth:t,outlineStyle:o?"none !important":void 0,height:e??40,borderRadius:`${n?e??40/2:6}px !important`},children:i}),ld=b(rv)(()=>({backgroundColor:f("toggleBackground"),padding:"2px",boxShadow:f("toggleGroupInnerShadow"),"& .Mui-selected":{boxShadow:f("toggleGroupInnerShadow")}})),ss=t=>{const{width:e,backgroundColor:n,children:o,boxRef:i,marginBottom:a,id:s,free:c,hoverEffect:d,maxWidth:u}=t;return c?r.jsx(C,{...t,free:void 0,children:o}):r.jsx(C,{id:s,sx:{position:"relative",width:e??"100%","&::before":{content:'""',display:"block",paddingTop:"100%"},marginBottom:a,maxWidth:u},ref:i,children:r.jsx(C,{sx:{position:"absolute",backgroundColor:n,top:0,left:0,bottom:0,right:0,transition:"all .3s ease-in-out","&:hover":d?{transform:"scale(0.95)"}:void 0},children:o})})},Hn={"3:1":{width:1536,height:512},"1:3":{width:512,height:1536},"9:16":{width:720,height:1280},"10:16":{width:768,height:1232},"3:4":{width:768,height:1024},"2:3":{width:768,height:1152},"1:1":{width:1024,height:1024},"4:3":{width:1024,height:768},"3:2":{width:1152,height:768},"16:10":{width:1232,height:768},"16:9":{width:1280,height:720}},dr={"0.563":"9:16","0.623":"10:16","0.667":"2:3","0.750":"3:4","1.000":"1:1","1.333":"4:3","1.500":"3:2","1.604":"16:10","1.778":"16:9","3.000":"3:1","0.333":"1:3"},rS=["9:16","10:16","2:3","3:4","1:1","4:3","3:2","16:10","16:9"],iS=["9:16","10:16","2:3","3:4","1:1","4:3","3:2","16:10","16:9"],Ng=t=>{var R;const{editorMode:e,onChange:n}=t,{generationInput:o,setGenerationInput:i}=l.useContext(ye),{aspectRatio:a,model_version:s}=o,c=l.useRef(null),[d,u]=l.useState(null),h=l.useRef(null),[p,g]=l.useState(null),m=l.useCallback(()=>{u(null)},[u]),v=l.useCallback(S=>parseInt(S.split(":")[0])/parseInt(S.split(":")[1]),[]),x=l.useMemo(()=>p??a??"1:1",[p,a]),y=l.useMemo(()=>v(x),[x,v]);l.useEffect(()=>{a!==void 0&&a!=="1:1"&&(h.current=a)},[a]);const _=l.useMemo(()=>{if(Yn(s)){let S=a??"1:1";return S==="1:1"&&(S=h.current??"9:16"),parseInt(S.split(":")[0])<parseInt(S.split(":")[1])?[S,"1:1",nc(S)]:[nc(S),"1:1",S]}return["10:16","1:1","16:10"]},[a,s]),w=Math.min(((R=c.current)==null?void 0:R.offsetHeight)??320,window.innerWidth-120),I=l.useMemo(()=>Yn(s),[s]);return r.jsxs(r.Fragment,{children:[r.jsxs(Zo,{width:no,exclusive:!0,size:"small",color:"primary",value:a??"1:1",children:[_.map((S,E)=>r.jsxs(on,{value:S,sx:{marginLeft:E===0?"0 !important":"2px !important"},onClick:()=>{i({...o,aspectRatio:S}),n==null||n(S)},disableRipple:!0,children:[r.jsx(uS,{aspectRatioNumber:v(S)}),S]},S)),r.jsx(hS,{children:r.jsx(Be,{pressed:!!d,customBorderRadius:"6px",size:{width:32,height:36},customPressedButtonColor:f("quietButtonHover"),disabled:!I,icon:r.jsx($n,{color:f(I?"primary":"toggleTextDisabled"),width:16,height:16}),onClick:S=>I&&u(S.currentTarget),tooltip:I?void 0:"Only model 2.0 and 1.0 supports the other aspect ratios.",largeTooltip:!0})})]}),r.jsxs(sS,{anchorEl:d,open:!!d,onClose:()=>m(),keepMounted:!0,disablePortal:!0,sx:{zIndex:S=>S.zIndex.drawer+160},slotProps:{paper:{sx:{backgroundColor:f("menuBackground"),padding:1,paddingX:1,marginTop:e?-2:1,borderRadius:2,outlineColor:f("border"),outlineStyle:"solid",outlineWidth:.5}}},anchorOrigin:{vertical:e?"top":"bottom",horizontal:e?"left":"right"},transformOrigin:{vertical:e?"bottom":"top",horizontal:e?"left":"right"},children:[r.jsx(ss,{width:w,children:r.jsxs(dS,{children:[r.jsx(aS,{sx:{width:y>=1?w:(w??0)*y,height:y<=1?w:(w??0)/y}}),r.jsx(lS,{sx:{height:y>=1?w:(w??0)*y,width:y<=1?w:(w??0)/y}}),r.jsx(cS,{children:Hn[x]?`${Hn[x].width} x ${Hn[x].height}`:"1024 x 1024"})]})}),r.jsx(C,{width:8}),r.jsx(ld,{ref:c,orientation:"vertical",value:a??"1:1",onMouseLeave:()=>g(null),children:(e?iS:rS).map((S,E)=>r.jsx(on,{value:S,onClick:()=>{i({...o,aspectRatio:S}),n==null||n(S),m()},onMouseEnter:()=>g(S),disableRipple:!0,sx:{marginTop:E===0?"0 !important":"2px !important"},children:S},S))})]})]})},sS=b(So)({"& .MuiList-root":{display:"flex",alignItems:"center",justifyContent:"center",paddingTop:0,paddingBottom:0},marginRight:-8,minHeight:"101dvh",overscrollBehavior:"contain"}),aS=b(C)(()=>({borderWidth:1,borderStyle:"solid",borderColor:f("primary"),borderRadius:6,position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",zIndex:1})),lS=b(C)(()=>({borderWidth:2,borderStyle:"dashed",borderColor:f("border"),borderRadius:6,position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",zIndex:0})),cS=b(C)(()=>({color:f("primary"),fontSize:12,position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",textAlign:"center",blockSize:"fit-content",width:"fit-content"})),dS=b(C)({minHeight:"100%",minWidth:"100%",position:"relative"}),uS=({aspectRatioNumber:t,width:e=20,height:n=20,color:o=f("primary")})=>r.jsx(C,{sx:{width:e,height:n,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(C,{sx:{borderRadius:"2px",borderWidth:1.5,borderColor:o,width:t<=1?(e-4)*t:e-4,height:t>=1?(n-4)/t:n-4}})}),hS=b("div")({display:"flex",alignItems:"center",justifyContent:"center",width:32,transform:"rotate(180deg)",marginLeft:2}),Dg=(t,e)=>e==="response"?`/api/images/direct/${t}.jpg`:e==="tile"?`/api/images/tiled/${t}.jpg`:`${window.location.origin}/api/uploads/retrieve/${t}.jpg`,Qs=(t,e,n)=>rd()?Dg(t,n):`${window.location.origin}/assets/image/${e}/${n}/${t}`,Pt=(t,e,n)=>rd()?Dg(t,n):n==="edit"?Zr(t,e==="detailed"?"lossless":"balanced"):`${window.location.origin}/assets/progressive-image/${e}/${n}/${t}`,cd=(t,e)=>Qs(t,e,"response"),Zr=(t,e)=>Qs(t,e,"edit"),Na=(t,e,n)=>`${window.location.origin}/api/images/intermediate/${t}_${e}_${n}.jpg`,Fg=t=>`${window.location.origin}/api/images/request/${t}/parent/inpaint`,dd=t=>`${t==null?void 0:t.slice(0,40).split(" ").join("_").replace(/\W/g,"")}`,zg=(t,e)=>{let n=t;return!Yn(e)&&t!=="1:1"&&(parseInt(t.split(":")[0])<parseInt(t.split(":")[1])?n="10:16":n="16:10"),n},Ug=t=>Object.keys(dr).reduce((e,n)=>{const o=parseFloat(e),i=parseFloat(n);return Math.abs(i-parseFloat(t))<Math.abs(o-parseFloat(t))?n:e}),Er=2,ws=2048,pS=(t,e)=>{const n={width:t,height:e};if(t>e)if(t*Er<ws)n.width*=Er,n.height*=Er;else{const o=ws/t;n.width*=o,n.height*=o}else if(e*Er<ws)n.width*=Er,n.height*=Er;else{const o=ws/e;n.width*=o,n.height*=o}return n},No=t=>new Promise(e=>{const n=new Image;n.addEventListener("load",()=>{e(n)}),n.src=t}),ud=async(t,e)=>{const{trackFailureEventKey:n,throwError:o}=e??{};return Le(`/api/images/retrieve_metadata_request_id/${t}`,{method:"GET",headers:Ne}).then(i=>{if(i.status!==200){if(n&&Xe({eventKey:n,metaData:{request_id:t}}),o)throw i;return}return i.json()})},Da=async t=>Le(`/api/images/retrieve_metadata_upload_id/${t}`,{method:"GET",headers:Ne}).then(e=>{if(e.status!==200)throw e;return e.json()}).then(async e=>e),ah=async t=>Le(`/api/f/p/load?page=${t}`,{method:"GET",headers:Ne}).then(e=>{if(e.status!==200)throw e;return e.json()}),lh=async t=>{const{page:e=0,model_name:n,cluster_name:o,lookback_seconds:i,score_minimum:a,shuffle:s}=t;return Le(`/api/f/labelling?page=${e}&model=${n}&cluster=${o}&lookback_seconds=${i}&score_minimum=${a}&shuffle=${s}`,{method:"GET",headers:Ne}).then(c=>{if(c.status!==200)throw c;return c.json()})},hd=t=>{let e="&filters=everything";return t==="edits"?e="&filters=edit":t==="generations"?e="&filters=generations":t==="uploads"?e="&filters=upload":t==="upscales"&&(e="&filters=upscales"),e},F9=async t=>{const{userId:e,page:n,filter:o,isProfileOwner:i}=t;return Le(`/api/g/u?user_id=${e}${i?hd(o):"&filters=generations&filters=upscales"}${n?`&page=${n}`:""}`,{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(a=>{if(a.status!==200)throw a;return a.json()})},ch=async t=>Le("/api/g/profile_search",{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({userId:t.userHandle,searchPrompt:t.searchPrompt,offset:t.offset,private:t.private,all_privacy:t.all_privacy})}).then(e=>{if(e.status!==200)throw e;return e.json()}),z9=async t=>{const{userId:e,page:n,filter:o}=t;return Le(`/api/g/u?user_id=${e}&private=true${hd(o)}${n?`&page=${n}`:""}`,{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(i=>{if(i.status!==200)throw i;return i.json()})},dh=async t=>{const{userId:e,page:n,filter:o,all_privacy:i}=t;return Le(`/api/g/u?user_id=${e}${t.private===!0?"&private=true":""}${i?"&all_privacy=true":""}${hd(o)}${n?`&page=${n}`:""}`,{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(a=>{if(a.status!==200)throw a;return a.json()})},uh=async(t,e)=>Le(`/api/g/u/mfu?user_id=${t}${e?`&page=${e}`:""}`,{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(n=>{if(n.status!==200)throw n;return n.json()}),hh=async(t,e)=>Le(`/api/g/u/p?user_id=${t}${e?`&page=${e}`:""}`,{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(n=>{if(n.status!==200)throw n;return n.json()}),Gg=async t=>{const{request_id:e,response_id:n,pin:o}=t;return Le("/api/users/profile/pin",{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({request_id:e,response_id:n,value:o})}).then(i=>{if(i.status!==200)throw i;return i.json()})},fS=async t=>{const{timestamp:e,req:n}=t,{prompt:o,user_id:i,aspect_ratio:a,private:s,model_version:c,use_autoprompt:d,seed:u,negative_prompt:h,sampling_speed:p,num_steps:g,tiling_preset:m,parent:v,upscale_details_weight:x,style_expert:y,resolution:_,color_palette:w}=n;return Le("/api/images/sample",{headers:{"Content-Type":"application/json",...Ne},method:"POST",body:JSON.stringify({aspect_ratio:a,prompt:o,user_id:i,private:s,model_version:c,use_autoprompt_option:d,seed:u,negative_prompt:h,sampling_speed:p,num_steps:g,tiling_preset:m,parent:v,upscale_details_weight:x,style_expert:y,resolution:_,color_palette:w==null?void 0:w.map(I=>({color_hex:I.colorHex,color_weight:I.colorWeight}))})}).then(I=>{if(I.status!==200)throw I;return I.json()}).then(async I=>(I.response_ids&&await Promise.all(I.response_ids.map(R=>No(cd(R,"balanced")))),I)).then(I=>({timestamp:e,res:I}))},gS=t=>Le(`/api/prompts/r/${t}`,{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({})}),mS=async t=>Le("/api/f/following?mode=pin",{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(e=>{if(e.status!==200)throw e;return e.json()}),pd=async t=>{const{make_public:e,request_ids:n}=t;return Le("/api/sampling_requests/toggle_private_public_request",{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({request_ids:n,make_public:e})}).then(o=>o.json())},fd=async t=>{const{request_ids:e}=t;return Le("/api/users/archive_request",{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({request_ids:e})}).then(n=>n.json())},Gi=10,xS=async t=>{const e=t.file.size/1024/1024;if(e>Gi)return{success:!1,error_message:`Uploaded ${e.toFixed(1)} MB, max ${Gi} MB.`};const n=new FormData;return n.append("file",t.file),t.aspect_ratio&&n.append("aspect_ratio",t.aspect_ratio),t.canvas_id&&n.append("canvas_id",t.canvas_id),t.canvas_transaction_id&&n.append("canvas_transaction_id",t.canvas_transaction_id),t.preserve_alpha&&n.append("preserve_alpha","true"),Le(`/api/uploads/${t.type}`,{method:"POST",body:n,headers:Ne}).then(o=>o.json()).then(o=>o)},Hg=async t=>xS({file:t.file,type:"upload",aspect_ratio:t.aspect_ratio}),vS=async t=>{const e=t.file.size/1024/1024;if(e>5)return{success:!1,error_message:`Uploaded ${e.toFixed(1)} MB, max 5 MB.`};const n=new FormData;return n.append("file",t.file),t.metadata&&(t.metadata.parent_image_id?n.append("parent_image_id",t.metadata.parent_image_id):t.metadata.parent_request_id&&t.metadata.parent_response_id&&(n.append("parent_request_id",t.metadata.parent_request_id),n.append("parent_response_id",t.metadata.parent_response_id)),n.append("aspect_ratio",t.metadata.aspect_ratio),n.append("public",t.metadata.private?"false":"true")),Le("/api/uploads/edit",{method:"POST",body:n,headers:Ne}).then(o=>o.json()).then(o=>o)},gd=async t=>{const{make_public:e,image_ids:n}=t;return Le("/api/uploads/toggle_private_public_upload",{method:"POST",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({image_ids:n,make_public:e})}).then(o=>o.json())},md=async t=>{const{image_ids:e}=t;Le("/api/uploads/delete",{method:"DELETE",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({image_ids:e})})},U9=t=>{var e,n,o,i;if(t.edit_parent){if((e=t.edit_parent.upload_parent)!=null&&e.image_id)return{assetId:(n=t.edit_parent.upload_parent)==null?void 0:n.image_id,assetType:Qr.Upload};if((o=t.edit_parent.variation_parent)!=null&&o.response_id)return{assetId:(i=t.edit_parent.variation_parent)==null?void 0:i.response_id,assetType:Qr.Response}}},yS=t=>{var e,n,o,i;return!!((n=(e=t==null?void 0:t.edit_parent)==null?void 0:e.upload_parent)!=null&&n.private)||!!((i=(o=t==null?void 0:t.edit_parent)==null?void 0:o.variation_parent)!=null&&i.should_hide)},wS=tt.forwardRef(function(e,n){return r.jsx(rr,{direction:"up",ref:n,...e})}),bS=t=>{const{open:e,handleClose:n,content:o,mobileFullScreen:i,border:a}=t;return r.jsx(Wn,{open:e,TransitionComponent:wS,onClose:()=>n(),fullScreen:!0,sx:{zIndex:s=>s.zIndex.drawer+138},slotProps:{backdrop:{sx:{backgroundColor:f("modalOverlay")}}},PaperProps:{sx:{height:i?"100dvh":"fit-content",position:"fixed",bottom:0,borderTopRightRadius:i?void 0:"16px",borderTopLeftRadius:i?void 0:"16px",padding:0,backgroundColor:f("modalbackground"),overscrollBehavior:"contain",...a?{borderWidth:1,borderStyle:"solid",borderColor:f("borderHighlight")}:{}},onScroll:s=>s.stopPropagation()},children:o})},CS=tt.forwardRef(function(e,n){return r.jsx(qf,{ref:n,...e})}),_S=t=>{const{open:e,handleClose:n,content:o,border:i}=t;return r.jsx(Wn,{open:e,TransitionComponent:CS,onMouseDown:a=>a.stopPropagation(),onClose:()=>n(),fullWidth:!0,sx:{zIndex:a=>a.zIndex.drawer+138},slotProps:{backdrop:{sx:{backgroundColor:f("modalOverlay")}}},PaperProps:{sx:{borderRadius:"16px",padding:0,backgroundColor:f("modalbackground"),margin:0,maxWidth:"100%",width:"100%",...i?{borderWidth:1,borderStyle:"solid",borderColor:f("borderHighlight")}:{}}},children:o})},IS=tt.forwardRef(function(e,n){return r.jsx(qf,{ref:n,...e})}),SS=t=>{const{open:e,handleClose:n,content:o,maxWidth:i,border:a}=t;return r.jsx(Wn,{open:e,TransitionComponent:IS,onClose:()=>n(),onMouseDown:s=>s.stopPropagation(),sx:{zIndex:s=>s.zIndex.drawer+138},slotProps:{backdrop:{sx:{backgroundColor:f("modalOverlay")}}},PaperProps:{sx:{maxWidth:i??960,borderRadius:"16px",padding:0,backgroundColor:f("menuBackground"),boxShadow:"0px 4px 6px -1px rgba(9, 9, 11, 0.10), 0px 2px 4px -2px rgba(9, 9, 11, 0.10)",...a?{borderWidth:1,borderStyle:"solid",borderColor:f("borderHighlight")}:{}}},children:o})},Rr=t=>{const e=we(),n=xe(e.breakpoints.down(560)),o=xe(e.breakpoints.down(720));return n?r.jsx(bS,{...t}):o?r.jsx(_S,{...t}):r.jsx(SS,{...t})};function wt({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 20 20",children:r.jsx("g",{children:r.jsx("path",{fill:n??"inherit",d:"M4.089 4.216l.057-.07a.5.5 0 01.638-.057l.07.057L10 9.293l5.146-5.147a.5.5 0 01.638-.057l.07.057a.5.5 0 01.057.638l-.057.07L10.707 10l5.147 5.146a.5.5 0 01.057.638l-.057.07a.5.5 0 01-.638.057l-.07-.057L10 10.707l-5.146 5.147a.5.5 0 01-.638.057l-.07-.057a.5.5 0 01-.057-.638l.057-.07L9.293 10 4.146 4.854a.5.5 0 01-.057-.638l.057-.07-.057.07z"})})})}const It=t=>{const{onClick:e,label:n,size:o,disabled:i,minWidth:a,fullWidth:s,loading:c,variant:d,customHeight:u,withIcon:h,dropdownOptions:p,dropdownClickEvent:g,border:m=!0}=t,v=Ee(),[x,y]=l.useState(null),[_,w]=l.useState(80),I=l.useRef(null);return l.useEffect(()=>{I.current&&w(I.current.getBoundingClientRect().width)},[]),r.jsxs(r.Fragment,{children:[r.jsxs(kS,{ref:I,sx:{minWidth:a,width:s?"100%":void 0,flex:s?1:void 0,...u?{height:u}:{},...i?{borderStyle:"none"}:m?d==="inputButton"?{borderStyle:"none",borderLeftStyle:"solid",borderTopLeftRadius:0,borderBottomLeftRadius:0}:{}:{borderColor:"transparent"},justifyContent:p?"space-between":"center"},disabled:i,disableRipple:!0,children:[p&&r.jsx("div",{}),r.jsx(ES,{onClick:e,sx:{...o==="small"?{padding:"0 12px",minHeight:32,fontSize:14}:{padding:"0 16px",minHeight:40,fontSize:16},paddingLeft:h?1:void 0,...p?{paddingRight:"2px",borderTopLeftRadius:8,borderBottomLeftRadius:8}:{borderRadius:"8px"},...i?{fill:`${f("outlinedButtonTextDisabled")} !important`,color:`${f("outlinedButtonTextDisabled")} !important`,backgroundColor:`${f("primaryButtonDisable")} !important`}:{}},children:c?r.jsx(co,{size:24,sx:{color:f("menuBackground")}}):n}),p&&r.jsx(r.Fragment,{children:r.jsx(TS,{onClick:R=>{g&&v({eventKey:g}),y(R.currentTarget)},sx:{backgroundColor:f(i?"outlinedButtonDisabled":x?"outlinedButtonHover":"menuBackground")},children:r.jsx($n,{color:f("iconPrimary"),width:16,height:16})})})]}),p&&r.jsx(AS,{anchorEl:x,open:!!x,onClose:()=>y(null),sx:{zIndex:R=>R.zIndex.drawer+140,"& .MuiPopover-paper":{minWidth:_}},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},disablePortal:!0,children:p.map((R,S)=>{const{onClick:E,label:N}=R;return r.jsx(RS,{onClick:()=>{E==null||E(),y(null)},disableRipple:!0,children:N},`menu-button-${S}`)})})]})},RS=b(gt)(()=>({display:"flex",alignItems:"center",justifyContent:"flex-start",borderRadius:8,height:40,color:f("menuAction"),"&:hover":{backgroundColor:f("menuActionHover")},width:"100%",minWidth:140,padding:"8px 10px"})),TS=b(C)(()=>({borderRightStyle:"solid",borderRightWidth:1,borderRightColor:f("outlinedButtonBorder"),minHeight:"100%",display:"flex",alignItems:"center",justifyContent:"center",width:24,transform:"rotate(180deg)","&:hover":{color:f("outlinedButtonTextHover"),backgroundColor:f("outlinedButtonHover")},borderTopLeftRadius:8,borderBottomLeftRadius:8})),ES=b(C)(()=>({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",flex:1,color:f("Interactive"),backgroundColor:f("outlinedButton"),fill:f("Interactive"),"&:hover":{fill:f("InteractiveHover"),color:f("InteractiveHover"),backgroundColor:f("outlinedButtonHover")},"&:active":{fill:f("InteractiveActive"),color:f("InteractiveActive"),backgroundColor:f("outlinedButtonHover")},height:"100%",letterSpacing:"-0.56px"})),kS=b(gt)(()=>({textWrap:"nowrap",borderRadius:8,color:f("Interactive"),backgroundColor:f("outlinedButton"),borderWidth:1,borderStyle:"solid",borderColor:f("borderHighlight"),"&:hover":{color:"transparent",backgroundColor:"transparent"},"&.Mui-disabled":{pointerEvents:"auto",cursor:"default",backgroundColor:f("outlinedButton")},padding:0,alignItems:"stretch",overflow:"hidden"})),AS=b(So)(()=>({"& .MuiPopover-paper":{backgroundColor:f("menuBackground"),padding:4,borderRadius:12,borderStyle:"solid",borderWidth:.5,borderColor:f("border"),"& .MuiMenu-list":{paddingTop:0,paddingBottom:0},boxShadow:f("menuShadow"),marginTop:4,color:f("Interactive"),fill:f("Interactive"),"&:hover":{fill:f("InteractiveHover"),color:f("InteractiveHover")},"&:active":{fill:f("InteractiveActive"),color:f("InteractiveActive")}}})),ht=t=>{const{onClick:e,label:n,size:o,disabled:i,minWidth:a,fullWidth:s,loading:c,dropdownOptions:d,dropdownClickEvent:u,brandColorHighlight:h,warningColor:p,rounded:g,customHeight:m,loadingIcon:v,shadow:x}=t,y=_a(),_=Ee(),[w,I]=l.useState(null),R=l.useMemo(()=>h?{backgroundColor:`${f("IdeogramPink")}`,color:"#fff !important","&:hover":{backgroundColor:f("IdeogramPinkHover")},"&:focus":{backgroundColor:f("IdeogramPinkPressed")},fontWeight:"600 !important"}:p?{"&:hover":{color:"#fff !important",backgroundColor:f("IdeogramPinkHover")},backgroundColor:f("destructive"),color:i?f("primaryButtonTextDisable"):"#FAFAFA"}:{"&:hover":{fill:f(i?"primaryButtonTextDisable":"primaryButtonTextHover"),color:f(i?"primaryButtonTextDisable":"primaryButtonTextHover"),backgroundColor:f(i?"primaryButtonDisable":"primaryButtonHover")},"&:active":{backgroundColor:f(i?"primaryButtonDisable":"primaryButtonPressed")},backgroundColor:f(i?"primaryButtonDisable":"primaryButton"),fill:f(i?"primaryButtonTextDisable":"primaryButtonText"),color:f(i?"primaryButtonTextDisable":"primaryButtonText")},[h,p,i,y]);return r.jsxs(r.Fragment,{children:[r.jsxs(MS,{sx:{minWidth:a,width:s?"100%":void 0,flex:s?1:void 0,justifyContent:d?"space-between":"center",borderRadius:g?6:2,height:m,boxShadow:x?"0px 1px 2px 0px rgba(9, 9, 11, 0.05)":void 0},disabled:i,disableRipple:!0,children:[d&&r.jsx("div",{}),r.jsx(PS,{onClick:e,sx:{...o==="small"?{padding:"0 12px",minHeight:32,fontSize:14}:{padding:"0 16px",minHeight:40,fontSize:16},...d?{paddingRight:1,borderTopLeftRadius:g?"24px":"8px",borderBottomLeftRadius:g?"24px":"8px"}:{borderRadius:g?6:2},...R},children:c?v??r.jsx(co,{size:20,sx:{color:f("menuBackground")}}):n}),d&&r.jsx(r.Fragment,{children:r.jsx(jS,{onClick:S=>{u&&_({eventKey:u}),I(S.currentTarget)},sx:{minHeight:o==="small"?32:40,borderRightStyle:i?"none":"solid",borderTopLeftRadius:g?24:8,borderBottomLeftRadius:g?24:8,paddingLeft:g?"4px":0,...R},children:r.jsx($n,{color:f(i?"primaryButtonTextDisable":"primaryButtonText"),width:16,height:16})})})]}),d&&r.jsx(OS,{anchorEl:w,open:!!w,onClose:()=>I(null),sx:{zIndex:S=>S.zIndex.drawer+140},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},disablePortal:!0,children:d.map((S,E)=>{const{menuButton:N}=S;return r.jsx(C,{onClick:()=>I(null),children:N},`option-${E}`)})})]})},jS=b(C)(()=>({borderRightWidth:1,borderRightColor:f("informative"),display:"flex",alignItems:"center",justifyContent:"center",width:24,transform:"rotate(180deg)","&:hover":{color:f("primaryButtonTextHover"),backgroundColor:f("primaryButtonHover")},transition:"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"})),PS=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",flex:1,height:"100%"}),MS=b(gt)(()=>({"&.Mui-disabled":{opacity:1,color:f("primaryButtonTextDisable"),backgroundColor:f("primaryButtonDisable"),pointerEvents:"auto",cursor:"not-allowed"},fontWeight:500,textWrap:"nowrap",padding:0})),OS=b(So)(()=>({"& .MuiPopover-paper":{backgroundColor:f("menuBackground"),padding:4,borderRadius:12,outlineStyle:"solid",outlineWidth:1,outlineColor:f("border"),"& .MuiMenu-list":{paddingTop:0,paddingBottom:0},boxShadow:f("menuShadow"),marginTop:4}})),BS=t=>{const e=we(),n=xe(e.breakpoints.down(720)),{handleDismiss:o,handleClose:i,handleAction:a,titleText:s,message:c,confirmText:d,cancelText:u,warning:h,hideCancel:p,primaryActionLoading:g}=t,m=l.useMemo(()=>o===void 0?i:o,[i,o]);return r.jsxs(FS,{children:[r.jsx(GS,{children:r.jsx(Be,{onClick:m,icon:r.jsx(wt,{color:f("quietButtonText")})})}),r.jsx(zS,{children:r.jsx(DS,{fontSize:22,fontWeight:700,children:s})}),r.jsxs(US,{sx:{flexDirection:"column"},children:[r.jsx(NS,{fontSize:16,maxWidth:n?void 0:"100%",flex:2,children:c}),r.jsx(C,{height:24}),r.jsxs(LS,{children:[!p&&r.jsxs(r.Fragment,{children:[r.jsx(It,{label:u??"Cancel",onClick:i}),r.jsx(C,{width:8})]}),r.jsx(ht,{warningColor:h,label:d,onClick:()=>{a()},loading:g})]})]})]})},LS=b(C)({display:"flex",alignItems:"center",justifyContent:"flex-end",flex:1}),NS=b(C)(()=>({color:f("staticContent"),fontFamily:"Manrope, sans-serif",userSelect:"text"})),DS=b(le)(()=>({color:f("staticTitle"),userSelect:"text",letterSpacing:"-0.88px"})),FS=b(C)(()=>({display:"flex",flexDirection:"column",position:"relative",maxHeight:"96dvh",color:f("infoCardBackground")})),zS=b(C)({display:"flex",flexDirection:"column",marginLeft:23,marginTop:23,marginBottom:0}),US=b(C)({display:"flex",marginLeft:24,marginRight:24,marginBottom:24,marginTop:16}),GS=b(C)({position:"absolute",top:16,right:16,zIndex:1}),qg=({handleDismiss:t,handleClose:e,handleAction:n,titleText:o,message:i,confirmText:a,cancelText:s,warning:c,hideCancel:d,primaryActionLoading:u})=>{const h=t===void 0?e:t;return r.jsx(Rr,{open:!0,handleClose:h,content:r.jsx(BS,{handleDismiss:t,handleClose:e,handleAction:n,titleText:o,message:i,confirmText:a,cancelText:s,warning:c,hideCancel:d,primaryActionLoading:u})})},Tt=l.createContext({modalContent:null,setModalContent:()=>[]}),HS=({children:t})=>{const[e,n]=l.useState(null),o={setModalContent:n,modalContent:e};return r.jsx(Tt.Provider,{value:o,children:t})},as=t=>{const{open:e,infoText:n}=t;return r.jsx(Ia,{children:r.jsxs(WS,{sx:{zIndex:o=>o.zIndex.drawer+146},open:e,children:[r.jsx(co,{sx:{color:"#FAFAFC"}}),n&&r.jsx(qS,{children:n})]})})},qS=b(le)({fontSize:12,color:"#FAFAFC",marginTop:16}),WS=b(ri)(()=>({color:f("backdrop"),display:"flex",flexDirection:"column",alignItems:"center"}));function or({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 18 18",children:r.jsx("path",{fill:n??"inherit",d:"M3.398 9.727a.563.563 0 0 0-.796.796l3.375 3.375c.22.22.576.22.796 0l8.25-8.25a.562.562 0 1 0-.796-.796l-7.852 7.852z"})})}const ai=tt.forwardRef(({width:t,height:e,color:n},o)=>r.jsx("svg",{ref:o,xmlns:"http://www.w3.org/2000/svg",width:t??12,height:e??12,fill:n??"inherits",viewBox:"0 0 12 12",children:r.jsx("path",{fill:n??"inherits",d:"M5.5 6.5a.5.5 0 011 0V8a.5.5 0 01-1 0V6.5zM6 3.75a.75.75 0 100 1.5.75.75 0 000-1.5zM1 6a5 5 0 1110 0A5 5 0 011 6zm5-4a4 4 0 100 8 4 4 0 000-8z"})}));ai.displayName="InfoTooltipIcon";const Wg=t=>{const e=we(),n=xe(e.breakpoints.down("md")),{currentSelection:o,options:i,width:a,disabled:s,hint:c,quickOption:d,disableEnforceFocus:u,shouldHavePaddingLeft:h=!0}=t,[p,g]=l.useState(null),m=l.useCallback(()=>{g(null)},[g]),v=l.useMemo(()=>i.find(w=>w.optionId===o||w.optionName===o),[i,o]),[x,y]=l.useState(i[0]),_=l.useCallback(()=>{o!==((d==null?void 0:d.optionId)??(d==null?void 0:d.optionName))&&v&&y(v),d==null||d.onSelect()},[o,d,y,v]);return r.jsxs(XS,{width:a??200,boxShadow:s?void 0:f("toggleGroupInnerShadow"),children:[r.jsx(Ca,{enterDelay:1e3,enterNextDelay:1e3,disableHoverListener:!c,disableFocusListener:!0,disableTouchListener:!0,slotProps:{tooltip:{sx:{backgroundColor:f("revertBackdrop"),color:f("background"),display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"}}},PopperProps:{modifiers:[{name:"offset",options:{offset:[0,-8]}}]},title:c,children:r.jsxs(kr,{width:"100%",children:[d&&r.jsx(r.Fragment,{children:r.jsx(KS,{sx:{backgroundColor:o!==((d==null?void 0:d.optionId)??(d==null?void 0:d.optionName))?f("toggleBackground"):`${f("toggleButtonSelected")} !important`,color:`${f(s?"secondary":"toggleTextSelected")} !important`,fontSize:n?12:14,boxShadow:o===((d==null?void 0:d.optionId)??(d==null?void 0:d.optionName))?f("toggleButtonBoxShadowSelected"):void 0,minWidth:80},onClick:_,disableRipple:!0,children:d.optionSelectedName??d.optionName})}),r.jsxs(VS,{disabled:s,sx:{backgroundColor:s?`${f("toggleBackground")} !important`:o===((d==null?void 0:d.optionId)??(d==null?void 0:d.optionName))?f("toggleBackground"):`${f("toggleButtonSelected")} !important`,color:`${f(s?"toggleTextDisabled":"toggleTextSelected")} !important`,fontSize:n?12:14,fontFamily:v==null?void 0:v.optionFontFamily,boxShadow:o===((d==null?void 0:d.optionId)??(d==null?void 0:d.optionName))?void 0:f("toggleButtonBoxShadowSelected")},onClick:w=>g(w.currentTarget),disableRipple:!0,children:[!d&&h&&r.jsx(kr,{width:24}),o===((d==null?void 0:d.optionId)??(d==null?void 0:d.optionName))?r.jsxs(kr,{flex:1,children:[(x==null?void 0:x.optionSelectedIcon)&&r.jsxs(r.Fragment,{children:[x==null?void 0:x.optionSelectedIcon,r.jsx(C,{width:4})]}),(x==null?void 0:x.optionSelectedName)??(x==null?void 0:x.optionName)]}):r.jsxs(kr,{flex:1,children:[(v==null?void 0:v.optionSelectedIcon)&&r.jsxs(r.Fragment,{children:[v==null?void 0:v.optionSelectedIcon,r.jsx(C,{width:4})]}),(v==null?void 0:v.optionSelectedName)??(v==null?void 0:v.optionName)]}),r.jsx(kr,{width:24,sx:{transform:"rotate(180deg)"},children:r.jsx($n,{color:f(s?"toggleTextDisabled":"primary"),width:16,height:16})})]})]})}),r.jsx($S,{anchorEl:p,open:!!p,onClose:()=>m(),keepMounted:!0,disablePortal:!0,disableEnforceFocus:u,sx:{zIndex:w=>w.zIndex.drawer+162},slotProps:{paper:{sx:{width:(a??200)-4,zIndex:2,display:"flex",flexDirection:"column",alignItems:"center",borderRadius:"6px",overflow:"hidden",color:f("toggleTextRest"),backgroundColor:f("menuBackground"),padding:"4px",marginTop:"4px",outlineColor:f("border"),outlineStyle:"solid",outlineWidth:.5,boxShadow:f("menuShadow")},onClick:w=>w.stopPropagation()}},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:r.jsx(C,{width:"100%",height:"100%",children:i.map(w=>{const{optionName:I,optionId:R,optionFontFamily:S,onSelect:E,optionIcon:N,disabled:k,hint:A}=w,D=R===o||I===o;return r.jsxs(JS,{className:D?"Dropdown-selected":void 0,sx:{zIndex:D?1:0,fontFamily:S},value:R??I,onClick:O=>{O.stopPropagation(),E(),g(null)},disableRipple:!0,disabled:k,children:[r.jsxs(kr,{children:[N&&r.jsxs(r.Fragment,{children:[N,r.jsx(C,{width:12})]}),I,A&&r.jsx(Rt,{content:A,children:r.jsx(C,{marginLeft:1,children:r.jsx(ai,{color:f("iconPrimary")})})})]}),o===(R??I)&&r.jsx(or,{color:f("menuAction"),width:20,height:20})]},R??I)})})})]})},$S=b(So)({"& .MuiList-root":{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:0,paddingBottom:0,width:"100%"},marginTop:2,minHeight:"101dvh",overscrollBehavior:"contain"}),kr=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"}),VS=b(gt)(()=>({flex:1,minWidth:"auto",padding:6,paddingTop:4,paddingBottom:4,paddingRight:0,borderStyle:"none",borderWidth:0,borderRadius:"6px !important",color:f("toggleTextRest"),backgroundColor:f("toggleButtonRest"),"&:hover":{color:f("toggleTextHover"),backgroundColor:f("toggleButtonHover")},"&.Mui-disabled":{borderStyle:"none","&:hover":{color:f("toggleTextDisabled")}},display:"flex",alignItems:"center",justifyContent:"space-between",height:36})),KS=b(gt)(()=>({padding:6,paddingTop:4,paddingBottom:4,borderStyle:"none",borderWidth:0,marginRight:"24px",borderRadius:"6px !important",color:f("toggleTextRest"),backgroundColor:f("toggleButtonRest"),"&:hover":{color:f("toggleTextHover"),backgroundColor:f("toggleButtonHover")},"&.Mui-disabled":{borderStyle:"none",textDecoration:"underline",pointerEvents:"auto","&:hover":{color:f("secondary")}},display:"flex",alignItems:"center",justifyContent:"center",height:36})),JS=b(gt)(()=>({width:"100%",fontSize:14,paddingTop:6,paddingBottom:6,color:f("menuAction"),flex:1,backgroundColor:f("menuBackground"),borderStyle:"none",borderWidth:0,transition:"0.1s","&:hover":{color:f("toggleTextHover"),backgroundColor:f("toggleButtonHover")},"&.Mui-disabled":{borderStyle:"none",pointerEvents:"auto",color:`${f("toggleTextDisabled")} !important`,backgroundColor:`${f("toggleButtonDisabled")} !important`},borderRadius:"6px",height:40,display:"flex",alignItems:"center",justifyContent:"space-between"})),XS=b(C)(()=>({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",padding:2,backgroundColor:f("toggleBackground"),borderRadius:8})),yr=t=>{const e=Ee(),{open:n,onClose:o,topUpModalRef:i,disablePortal:a,topUpReason:s,teamMemberTopUpRequest:c}=t,{organizationApi:d}=l.useContext(ge),[u,h]=l.useState(1),[p,g]=l.useState(!1),[m,v]=l.useState(!1),x=we(),y=xe(x.breakpoints.down("sm")),_=l.useMemo(()=>Array.from({length:10},(I,R)=>({optionName:(R+1).toString(),optionSelectedName:r.jsx(r5,{children:`Qty: ${R+1}`}),onSelect:()=>{h(R+1)}})),[]),w=l.useCallback(async()=>{e({eventKey:"TOP_UP_CHECKOUT_CLICK"}),g(!0),v(!1);try{if(c){if(d){const{purchaseLink:I}=await d.createTopUpPurchaseLink({createTopUpPurchaseLinkRequest:{quantity:u,userId:(c==null?void 0:c.userId)||"",organizationId:(c==null?void 0:c.organizationId)||"",reason:s}});window.location.href=I}}else{const{checkout_url:I}=await lI(u,s);window.location.href=I}}catch{v(!0)}finally{g(!1)}},[d,u,s,c,e]);return r.jsxs(Wn,{ref:i,sx:{zIndex:I=>I.zIndex.drawer+145},open:n,onClose:()=>o(),slotProps:{backdrop:{sx:{backgroundColor:f("modalOverlay")}}},PaperProps:{sx:{backgroundColor:f("menuBackground"),boxShadow:"0px 4px 6px -1px rgba(9, 9, 11, 0.10), 0px 2px 4px -2px rgba(9, 9, 11, 0.10)",outlineColor:f("borderHighlight"),outlineStyle:"solid",color:f("primary"),zIndex:I=>I.zIndex.drawer+150,padding:3,display:"flex",flexDirection:"column",borderRadius:4,margin:"8px",...y?{height:"fit-content",position:"fixed",bottom:0,borderTopRightRadius:"16px",borderTopLeftRadius:"16px",margin:0,overscrollBehavior:"contain",borderBottomRightRadius:0,borderBottomLeftRadius:0}:{}},onScroll:I=>I.stopPropagation()},disablePortal:a,children:[r.jsx(n5,{children:r.jsx(Be,{icon:r.jsx(wt,{color:f("iconPrimary"),width:20,height:20}),onClick:()=>{e({eventKey:"TOP_UP_CANCEL_CHECKOUT_CLICK"}),o()}})}),r.jsx(C,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:r.jsx(YS,{children:"Top up your priority credits"})}),r.jsx(QS,{children:"$4 USD for 100 credits in the priority queue"}),r.jsx(ZS,{children:"Your top-up balance will be used when your monthly priority credits run out. Unused top-up credits carry over to the next month as long as your subscription is active, and expire a year from purchase."}),m&&r.jsx(e5,{children:"There was an error processing your request. Please try again."}),r.jsxs(t5,{children:[r.jsx(Wg,{options:_,currentSelection:u.toString(),width:100,disableEnforceFocus:!0,shouldHavePaddingLeft:!1}),r.jsx(ht,{label:r.jsx(o5,{children:`Add ${100*u} credits • $${4*u} USD`}),onClick:w,minWidth:202})]}),r.jsx(as,{open:p})]})},YS=b(le)(()=>({fontSize:"22px",fontWeight:700,letterSpacing:"-0.88px"})),QS=b(le)({fontSize:14,fontWeight:600,marginTop:24,marginBottom:8,letterSpacing:"-0.56px"}),ZS=b(le)(()=>({fontSize:14,fontWeight:400,color:f("secondary")})),e5=b(le)(()=>({fontSize:14,fontWeight:400,color:f("IdeogramPinkText"),marginTop:8})),t5=b(C)(({theme:t})=>({marginTop:24,display:"flex",alignItems:"center",justifyContent:"flex-end",gap:8,[t.breakpoints.down("sm")]:{justifyContent:"space-between"}})),n5=b(C)({position:"absolute",right:"12px",top:"12px"}),o5=b(le)(()=>({fontSize:14,fontWeight:600,letterSpacing:"-0.56px"})),r5=b(le)(()=>({fontSize:14,fontWeight:600,padding:"0 8px",color:f("secondary")})),Do=l.createContext({setBackdropLoading:()=>[]}),i5=({children:t})=>{const[e,n]=l.useState(!1),o={setBackdropLoading:n};return r.jsxs(Do.Provider,{value:o,children:[t,r.jsx(as,{open:!!e,infoText:e===!0||e===!1?void 0:e})]})},s5=()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 50 50",fill:f("solid"),children:r.jsx("path",{d:"M44.527 34.75c-1.078 2.395-1.597 3.465-2.984 5.578-1.941 2.953-4.68 6.64-8.063 6.664-3.011.028-3.789-1.965-7.878-1.93-4.086.02-4.938 1.97-7.954 1.938-3.386-.031-5.976-3.352-7.918-6.3-5.43-8.27-6.003-17.966-2.648-23.122 2.375-3.656 6.129-5.805 9.656-5.805 3.594 0 5.852 1.973 8.82 1.973 2.883 0 4.637-1.976 8.794-1.976 3.14 0 6.46 1.71 8.836 4.664-7.766 4.257-6.504 15.347 1.34 18.316zM31.195 8.469c1.512-1.942 2.66-4.68 2.242-7.469-2.464.168-5.347 1.742-7.03 3.781-1.528 1.86-2.794 4.617-2.302 7.285 2.692.086 5.477-1.52 7.09-3.597z"})}),a5=()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 48 48",children:[r.jsx("path",{fill:"#FFC107",d:"M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4 12.955 4 4 12.955 4 24s8.955 20 20 20 20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z"}),r.jsx("path",{fill:"#FF3D00",d:"m6.306 14.691 6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4 16.318 4 9.656 8.337 6.306 14.691z"}),r.jsx("path",{fill:"#4CAF50",d:"M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238A11.91 11.91 0 0 1 24 36c-5.202 0-9.619-3.317-11.283-7.946l-6.522 5.025C9.505 39.556 16.227 44 24 44z"}),r.jsx("path",{fill:"#1976D2",d:"M43.611 20.083H42V20H24v8h11.303a12.04 12.04 0 0 1-4.087 5.571l.003-.002 6.19 5.238C36.971 39.205 44 34 44 24c0-1.341-.138-2.65-.389-3.917z"})]}),l5=()=>{const{signInWithGoogle:t,signInWithApple:e}=l.useContext(ge);return r.jsxs(r.Fragment,{children:[r.jsxs(ph,{onClick:async()=>{Xe({eventKey:"CONTINUE_WITH_GOOGLE_CLICK"}),await t()},variant:"contained",color:"primary",children:[r.jsx(a5,{}),r.jsx("span",{style:{marginLeft:8},children:"Continue with Google"})]}),r.jsxs(ph,{onClick:async()=>{Xe({eventKey:"CONTINUE_WITH_APPLE_CLICK"}),await e()},variant:"contained",color:"primary",sx:{marginTop:2},children:[r.jsx(s5,{}),r.jsx("span",{style:{marginLeft:8},children:"Continue with Apple"})]})]})},ph=b(gt)({padding:8,flex:1,fontSize:14,fontWeight:600,letterSpacing:"-0.28px"}),c5=t=>{const{open:e,onClose:n}=t;return r.jsx(Wn,{sx:{zIndex:o=>o.zIndex.drawer+145},open:e,onClose:()=>n(),PaperProps:{sx:{backgroundColor:f("background"),color:f("primary"),zIndex:o=>o.zIndex.drawer+150,padding:4,display:"flex",flexDirection:"column",borderRadius:4,width:400,maxWidth:"100dvw"}},children:r.jsx(l5,{})})},G9=t=>t/100,H9=t=>t*100,fh=(t,e=!1)=>{const o=t%1===0&&e?0:2;return new Intl.NumberFormat(navigator.language,{style:"currency",currency:"USD",minimumFractionDigits:o,maximumFractionDigits:o}).format(t)},q9=()=>{var i;return((i=new Intl.NumberFormat(navigator.language,{style:"currency",currency:"USD"}).formatToParts(0).find(a=>a.type==="currency"))==null?void 0:i.value)??"US$"},$g=t=>{const{open:e,onCancel:n,onConfirm:o,planId:i}=t,a=we(),s=xe(a.breakpoints.down("md")),c=Ee(),{t:d}=Kc(),{setBackdropLoading:u}=l.useContext(Do),{availableStripePlansData:h}=l.useContext(ge),p=l.useMemo(()=>h==null?void 0:h.find(w=>w.planId===i),[h,i]),g=l.useMemo(()=>{if(p!=null&&p.planName)return p.pricePeriod==="yearly"?p.planName:`${p.planName} Monthly`},[p==null?void 0:p.planName,p==null?void 0:p.pricePeriod]),m=l.useMemo(()=>!!(g!=null&&g.includes("Team")),[g]),v=l.useMemo(()=>{if(p!=null&&p.priceAmount)return(m?2:1)*(p==null?void 0:p.priceAmount)},[m,p==null?void 0:p.priceAmount]),{data:x}=Ve(["previewPlanUpgradeCost",i],()=>jg(i),{staleTime:3e4,retry:3,refetchOnMount:"always"}),y=l.useMemo(()=>x==null?void 0:x.upgrade_cost_excl_tax,[x==null?void 0:x.upgrade_cost_excl_tax]),_=l.useMemo(()=>!v||!g||!y,[g,y,v]);return l.useEffect(()=>{u(_)},[_,u]),_?null:r.jsxs(Wn,{open:e,onClose:()=>n(),sx:{zIndex:w=>w.zIndex.drawer+145},slotProps:{backdrop:{sx:{backgroundColor:f("modalOverlay")}}},PaperProps:{sx:{backgroundColor:f("menuBackground"),boxShadow:"0px 4px 6px -1px rgba(9, 9, 11, 0.10), 0px 2px 4px -2px rgba(9, 9, 11, 0.10)",outlineColor:f("borderHighlight"),outlineStyle:"solid",color:f("primary"),zIndex:w=>w.zIndex.drawer+150,padding:3,display:"flex",flexDirection:"column",borderRadius:4,margin:"8px",...s?{height:"fit-content",position:"fixed",bottom:0,borderTopRightRadius:"16px",borderTopLeftRadius:"16px",margin:0,overscrollBehavior:"contain",borderBottomRightRadius:0,borderBottomLeftRadius:0}:{}},onScroll:w=>w.stopPropagation()},children:[r.jsx(u5,{children:r.jsx(Be,{icon:r.jsx(wt,{color:f("iconPrimary"),width:20,height:20}),onClick:()=>{c({eventKey:"TOP_UP_CANCEL_CHECKOUT_CLICK"}),n()}})}),r.jsx(h5,{children:r.jsx(Qo,{i18nKey:"subscription.alert.upgrade.title",values:{planName:g}})}),r.jsx(p5,{children:r.jsxs(Qo,{i18nKey:"subscription.alert.upgrade.message",values:{prorationCost:fh(y,!0),renewCost:fh(v,!0),planName:g},children:[r.jsx(g5,{}),r.jsx(d5,{}),r.jsx(oc,{href:On.tos,target:"_blank"}),r.jsx(oc,{href:On.privacy,target:"_blank"})]})}),r.jsxs(f5,{children:[r.jsx(It,{label:d("button.cancel"),onClick:()=>{c({eventKey:"UPGRADE_PLUS_CANCEL"}),n()}}),r.jsx(ht,{label:d("subscription.alert.upgrade.confirm"),onClick:()=>{c({eventKey:"UPGRADE_PLUS_CONFIRM"}),o()}})]})]})},d5=()=>{const{t}=Kc();return r.jsx(Rt,{size:"small",content:t("subscription.alert.upgrade.prorated.tooltip"),children:r.jsx(oc,{children:"prorated charge"})})},u5=b(C)({position:"absolute",right:"12px",top:"12px"}),h5=b(le)(()=>({fontSize:"22px",fontWeight:700,letterSpacing:"-0.88px"})),p5=b(le)(()=>({fontSize:14,fontWeight:400,color:f("secondary"),marginTop:"24px"})),f5=b(C)(()=>({marginTop:24,display:"flex",alignItems:"center",justifyContent:"flex-end",gap:8})),g5=b("span")(()=>({color:f("primary"),fontWeight:600,letterSpacing:"-0.56px"})),oc=b("a")(()=>({color:f("primary"),fontWeight:600,cursor:"pointer",textDecoration:"underline",textDecorationStyle:"dotted",textUnderlineOffset:2})),rc="PAID_SUBSCRIPTION_CONVERSION_REASON_STORAGE_KEY",gh="tab",m5=l.createContext({currentPlan:null,currentSubscriptionPeriod:null,selectedSubscriptionPeriod:"ANNUAL",setSelectedSubscriptionPeriod:()=>{},handlePricingPageLogin:()=>{},handleUpgradePlan:()=>{},handleManageBilling:()=>{},setTopUpOpen:()=>{},currentPlanCreditAmount:0,creditTableRef:{current:null},scrollToPricingTable:()=>{},isInPersonalOrganization:!1,setPlanFilter:()=>{},planFilter:"personal",isTeamMember:!1}),W9=t=>{var W,Y;const{children:e}=t,{subscriptionStatus:n,userProfileState:o,availableStripePlansData:i,e2eTestApi:a,chosenOrganization:s,userOrganizations:c}=l.useContext(ge),{setQueryParam:d}=l.useContext($e),u=Ee(),h=l.useRef(null),[p,g]=l.useState(!1),{setBackdropLoading:m}=l.useContext(Do),v=l.useMemo(()=>!!(s!=null&&s.isPersonalOrganization),[s]),x=l.useMemo(()=>{var q,V,Q,K,ae,ce,ve,se;return!o||!n?null:((q=n==null?void 0:n.activeSubscription)==null?void 0:q.planName)==="Ideogram Basic"||((V=n==null?void 0:n.activeSubscription)==null?void 0:V.planName)==="Ideogram Basic Annual"?"BASIC":((Q=n==null?void 0:n.activeSubscription)==null?void 0:Q.planName)==="Ideogram Plus"||((K=n==null?void 0:n.activeSubscription)==null?void 0:K.planName)==="Ideogram Plus Annual"?"PLUS":((ae=n==null?void 0:n.activeSubscription)==null?void 0:ae.planName)==="Ideogram Pro"||((ce=n==null?void 0:n.activeSubscription)==null?void 0:ce.planName)==="Ideogram Pro Annual"?"PRO":((ve=n==null?void 0:n.activeSubscription)==null?void 0:ve.planName)==="Ideogram Team"||((se=n==null?void 0:n.activeSubscription)==null?void 0:se.planName)==="Ideogram Team Annual"?"TEAM":"FREE"},[n,o]),[y]=ts(),[_,w]=l.useState(x==="TEAM"?"business":y.get(gh)??"personal");l.useEffect(()=>{x==="TEAM"&&w("business")},[x]),l.useEffect(()=>{d({name:gh,value:_})},[_,d]);const I=l.useMemo(()=>{var q,V,Q,K,ae,ce,ve,se;return((q=n==null?void 0:n.activeSubscription)==null?void 0:q.planName)==="Ideogram Basic"||((V=n==null?void 0:n.activeSubscription)==null?void 0:V.planName)==="Ideogram Plus"||((Q=n==null?void 0:n.activeSubscription)==null?void 0:Q.planName)==="Ideogram Pro"||((K=n==null?void 0:n.activeSubscription)==null?void 0:K.planName)==="Ideogram Team"?"MONTHLY":((ae=n==null?void 0:n.activeSubscription)==null?void 0:ae.planName)==="Ideogram Basic Annual"||((ce=n==null?void 0:n.activeSubscription)==null?void 0:ce.planName)==="Ideogram Plus Annual"||((ve=n==null?void 0:n.activeSubscription)==null?void 0:ve.planName)==="Ideogram Pro Annual"||((se=n==null?void 0:n.activeSubscription)==null?void 0:se.planName)==="Ideogram Team Annual"?"ANNUAL":null},[(W=n==null?void 0:n.activeSubscription)==null?void 0:W.planName]),[R,S]=l.useState(I??"ANNUAL");l.useEffect(()=>{I&&S(I)},[I]);const[E,N]=l.useState(!1),k=l.useCallback(()=>{N(!0)},[]),A=l.useMemo(()=>{var q;return(q=i==null?void 0:i.find(V=>V.planName==="Ideogram Basic"))==null?void 0:q.planId},[i]),D=l.useMemo(()=>{var q;return(q=i==null?void 0:i.find(V=>V.planName==="Ideogram Plus"))==null?void 0:q.planId},[i]),O=l.useMemo(()=>{var q;return(q=i==null?void 0:i.find(V=>V.planName==="Ideogram Pro"))==null?void 0:q.planId},[i]),L=l.useMemo(()=>{var q;return(q=i==null?void 0:i.find(V=>V.planName==="Ideogram Basic Annual"))==null?void 0:q.planId},[i]),P=l.useMemo(()=>{var q;return(q=i==null?void 0:i.find(V=>V.planName==="Ideogram Plus Annual"))==null?void 0:q.planId},[i]),G=l.useMemo(()=>{var q;return(q=i==null?void 0:i.find(V=>V.planName==="Ideogram Pro Annual"))==null?void 0:q.planId},[i]),B=l.useMemo(()=>{var q;return(q=i==null?void 0:i.find(V=>V.planName==="Ideogram Team"))==null?void 0:q.planId},[i]),M=l.useMemo(()=>{var q;return(q=i==null?void 0:i.find(V=>V.planName==="Ideogram Team Annual"))==null?void 0:q.planId},[i]),{data:z}=Ve(["previewPlanUpgradeCost",G],()=>jg(G),{enabled:!!x&&x!=="FREE"&&!(x==="PRO"&&I==="ANNUAL")&&!!G,staleTime:6e4,refetchInterval:6e4,retry:3}),F=l.useMemo(()=>(z==null?void 0:z.credit_from_current_plan)??0,[z]),[T,j]=l.useState(null),Z=l.useMemo(()=>{var q;return((q=n==null?void 0:n.activeSubscription)==null?void 0:q.subscriptionProvider)==="APPLE"},[(Y=n==null?void 0:n.activeSubscription)==null?void 0:Y.subscriptionProvider]),ee=l.useCallback((q,V)=>{let Q,K;if(V==="ANNUAL"?q==="BASIC"?(Q=L,K="Ideogram Basic Annual"):q==="PLUS"?(Q=P,K="Ideogram Plus Annual"):q==="PRO"?(Q=G,K="Ideogram Pro Annual"):q==="TEAM"&&(Q=M,K="Ideogram Team Annual"):V==="MONTHLY"&&(q==="BASIC"?(Q=A,K="Ideogram Basic Monthly"):q==="PLUS"?(Q=D,K="Ideogram Plus Monthly"):q==="PRO"?(Q=O,K="Ideogram Pro Monthly"):q==="TEAM"&&(Q=B,K="Ideogram Team Monthly")),!(!Q||!K)){if(x==="FREE")u({eventKey:"SUBSCRIPTION_V2_PURCHASE_CLICK",metaData:{plan:q,period:V}}),m(!0),Eg({plan_id:Q,conversion_reason:localStorage.getItem(rc)??lt.DirectPricingPageVisit}).then(({checkout_url:ae})=>window.location.href=ae);else if(x!==null){if(Z)return;u({eventKey:"SUBSCRIPTION_V2_UPGRADE_CLICK",metaData:{plan:q,period:V}}),j(Q)}}},[x,L,P,G,M,A,D,O,B,u,m,a,Z]),te=l.useCallback(()=>{!x||x==="FREE"||Z||(m(!0),kg(oe.PRICING).then(({portal_url:q})=>window.location.href=q))},[x,Z,m]),$=l.useCallback(()=>{h.current&&h.current.scrollIntoView({block:"center",inline:"center",behavior:"smooth"})},[]),X=l.useMemo(()=>{var q;if(x==="TEAM"){const{chosenOrganizationId:V}=s??{};if(!(((q=c.find(K=>K.organizationId===V))==null?void 0:q.role)==="OWNER"))return!0}return!1},[s,x,c]);return r.jsxs(m5.Provider,{value:{currentPlan:x,currentSubscriptionPeriod:I,selectedSubscriptionPeriod:R,setSelectedSubscriptionPeriod:S,handlePricingPageLogin:k,handleUpgradePlan:ee,handleManageBilling:te,setTopUpOpen:g,currentPlanCreditAmount:F,creditTableRef:h,scrollToPricingTable:$,isInPersonalOrganization:v,planFilter:_,setPlanFilter:w,isTeamMember:X},children:[e,r.jsx(c5,{open:E,onClose:()=>N(!1)}),T&&r.jsx($g,{open:!!T,onCancel:()=>j(null),onConfirm:async()=>{j(null),m(!0);const q=await Ag(T,localStorage.getItem(rc)??lt.DirectPricingPageVisit),{redirect_url:V}=await q.json();setTimeout(()=>{m(!1),V?window.location.href=V:window.location.reload()},1e3)},planId:T}),r.jsx(yr,{open:p,onClose:()=>g(!1),topUpReason:vr.PricingPageTopUp})]})},Nt=()=>{const{setModalContent:t}=l.useContext(Tt),{subscriptionStatus:e}=l.useContext(ge),{navigate:n}=l.useContext($e);return l.useCallback(i=>{var c,d;const{newTab:a,conversionReason:s}=i;localStorage.setItem(rc,s),((c=e==null?void 0:e.activeSubscription)==null?void 0:c.subscriptionProvider)===mg.Apple&&!rn()?t(r.jsx(qg,{handleAction:()=>{t(null)},handleClose:()=>{t(null)},titleText:"Plan managed in the App Store",message:r.jsxs(r.Fragment,{children:["You subscribed to Ideogram through the App Store. Please visit the"," ",r.jsx(x5,{children:r.jsx("a",{href:"https://apps.apple.com/account/subscriptions",children:"App Store"})})," ","on your Apple device to manage your Ideogram subscription."]}),confirmText:"Close",hideCancel:!0})):rn()?Rg():a?(d=window.open(oe.PRICING,"_blank"))==null||d.focus():n(oe.PRICING)},[n,t,e])},x5=b(le)(()=>({color:f("primary"),fontWeight:600,textDecoration:"underline",display:"inline"})),v5=()=>{const t=we(),e=xe(t.breakpoints.down("sm")),[n,o]=l.useState(!1),{subscriptionStatus:i,isBasicSubscriber:a}=l.useContext(ge),{slowCredit:s}=l.useContext(ye),c=Nt();if(!(!(i!=null&&i.noActiveSubscription||a)||!s))return r.jsxs(y5,{flexDirection:e?"column":"row",alignItems:e?"flex-start":"center",children:[r.jsxs(w5,{children:[r.jsx(b5,{children:a?"You don’t have enough credits":"Not enough credits left on your Free plan"}),r.jsx(C5,{children:a?`Your daily limit resets in ${zi(s.refresh)}. Top up or upgrade to keep creating.`:`Wait for your limit to reset in ${zi(s.refresh)}, or upgrade your plan.`})]}),a?r.jsxs(mh,{children:[r.jsx(It,{label:"See plans",onClick:()=>c({conversionReason:"INSUFFICIENT_CREDIT_TOAST",newTab:!0})}),r.jsx(ht,{label:"Top up credits",onClick:()=>o(!0)})]}):r.jsx(mh,{children:r.jsx(ht,{label:"See plans",onClick:()=>c({conversionReason:"INSUFFICIENT_CREDIT_TOAST",newTab:!0})})}),r.jsx(yr,{open:n,onClose:()=>o(!1),topUpReason:vr.InsufficientCreditsBanner})]})},y5=b(C)({display:"flex",gap:16}),w5=b(C)({display:"flex",flexDirection:"column",justifyContent:"center"}),mh=b(C)({display:"flex",alignItems:"center",gap:8}),b5=b(le)(()=>({color:f("primary"),fontSize:16,fontWeight:600,lineHeight:"24px",letterSpacing:"-0.32px"})),C5=b(le)(()=>({color:f("secondary"),fontSize:16,fontWeight:400,lineHeight:"24px"})),Tn=l.createContext({alertContent:null,setAlertText:()=>[],setAlertContent:()=>[],backgroundColor:void 0,showClose:void 0,autoCloseTimerRef:{current:null}}),_5=({children:t})=>{const[e,n]=l.useState(null),[o,i]=l.useState(),[a,s]=l.useState(),c=l.useRef(null),d=l.useCallback((p,g)=>{c.current&&clearTimeout(c.current);const{autoDismissMs:m,backgroundColor:v,showClose:x}=g??{};i(v),s(x),p===null?n(null):(n(r.jsx(r.Fragment,{children:p})),m&&(c.current=setTimeout(()=>n(null),m)))},[n]),u=l.useCallback((p,g)=>{c.current&&clearTimeout(c.current);const{autoDismissMs:m,backgroundColor:v,showClose:x}=g??{};i(v),s(x),n(p),m&&(c.current=setTimeout(()=>n(null),m))},[]),h={setAlertText:d,setAlertContent:u,alertContent:e,backgroundColor:o,showClose:a,autoCloseTimerRef:c};return r.jsx(Tn.Provider,{value:h,children:t})},I5=t=>{const{modelVersion:e,requestAction:n,samplingSpeed:o}=t,{accountApi:i,userProfileState:a,subscriptionStatus:s,chosenOrganization:c}=l.useContext(ge),{setAlertContent:d}=l.useContext(Tn),[u,h]=l.useState(null),[p,g]=l.useState(!1),[m,v]=l.useState(0),x=l.useRef(),{data:y,refetch:_,isFetching:w}=Ve(["getUserTaskQuotaStats",c==null?void 0:c.chosenOrganizationId],()=>i==null?void 0:i.getUserTaskQuotaStats({modelVersion:e,requestAction:n,samplingSpeed:o}),{enabled:!!i&&!!a&&!!(c!=null&&c.chosenOrganizationId),staleTime:1/0,refetchInterval:3e4});l.useEffect(()=>{!i||!a||_()},[i,e,n,o,_,a]);const I=l.useMemo(()=>y?{balance:y.slowCreditBalance??0,max:y.slowCreditMax??0,total:y.slowCreditBalance??0,refresh:y.dateWhenSlowCreditsRefresh}:void 0,[y]),R=l.useMemo(()=>y?{balance:y.subscriptionPriorityCreditBalance??0,max:y.subscriptionPriorityCreditMax??0,stickyBalance:y.subscriptionPriorityStickyCreditBalance??0,total:(y.subscriptionPriorityCreditBalance??0)+(y.subscriptionPriorityStickyCreditBalance??0)}:void 0,[y]),S=l.useRef(null);l.useEffect(()=>{S.current=u},[u]);const E=l.useCallback(D=>{g(!0);const O=Date.now(),L=D;v(L),x.current&&clearInterval(x.current),x.current=window.setInterval(()=>{const P=Math.floor((Date.now()-O)/1e3),G=L-P;v(G),G<=0&&(clearInterval(x.current),g(!1),S.current===qn.WaitTimeNotElapsed&&h(null))},1e3)},[]);l.useEffect(()=>{m<=0&&clearInterval(x.current)},[m]);const N=l.useCallback(D=>{const{userTaskQuotaStats:O,showGenerationIntervalError:L,showInsufficientFundError:P}=D;O.allowedToGenerate?h(null):!O.allowedToGenerate&&O.rejectReason&&(O.rejectReason===qn.InsufficientFunds?s!=null&&s.noActiveSubscription?h(O.rejectReason):P&&d(r.jsx(v5,{})):O.rejectReason===qn.WaitTimeNotElapsed?(L?L&&(h(O.rejectReason),d(`Please wait ${O.minimumTimeBetweenGenerationsS}s between generations.`)):h(null),E(O.timeUntilUserCanGenerateS)):O.rejectReason===qn.LimitReached?h(O.rejectReason):O.rejectReason===qn.ServerBusy?(E(0),h(O.rejectReason)):d("Something went wrong. Please try again later."))},[E,d,s==null?void 0:s.noActiveSubscription]);l.useEffect(()=>{y&&N({userTaskQuotaStats:y})},[N,y]);const k=l.useCallback(D=>{!a||!i||(g(!0),_().then(O=>{O.data&&(O.data.minimumTimeBetweenGenerationsS&&E(O.data.minimumTimeBetweenGenerationsS),N({userTaskQuotaStats:O.data,showGenerationIntervalError:D,showInsufficientFundError:!0}))}))},[i,N,_,E,a]);return l.useMemo(()=>({isGenerationBlocked:!!u,slowCredit:I,priorityCredit:R,refreshUserTaskQuotaStatsOnSample:k,serverErrorReason:u,generationThrottle:p,generationThrottleCountDown:m,resetThrottleTimer:E,isFetchingUserTaskQuotaStats:w}),[I,R,k,u,p,m,E,w])},xh=()=>{const t=Nt();return r.jsx("span",{onClick:()=>t({conversionReason:lt.RetryOrRemixAlert}),style:{cursor:"pointer",textDecoration:"underline",textDecorationStyle:"dashed"},children:"Ideogram Basic or above"})},Vg=()=>{const{subscriptionStatus:t}=l.useContext(ge),[e,n]=l.useState();return l.useEffect(()=>{t!=null&&t.noActiveSubscription&&ed().then(o=>{o&&sI().then(i=>{n(i||i!=="null"?r.jsxs(ul,{children:["Don’t forget ",r.jsx(hl,{children:i}),"’s gift: Get"," ",r.jsx(hl,{children:"100 bonus priority credits"})," when you subscribe to any plan."]}):r.jsxs(ul,{children:["Don’t forget your gift: Get"," ",r.jsx(hl,{children:"100 bonus priority prompts"}),"when you subscribe to any plan."]}))})})},[t==null?void 0:t.noActiveSubscription]),{bannerContent:e?r.jsxs(S5,{children:[r.jsx(ul,{children:"🎁"}),e]}):null}},S5=b(C)({display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"center",gap:8}),ul=b(le)(()=>({color:f("successBannerText"),fontSize:16,fontWeight:400,lineHeight:"24px"})),hl=b("span")(()=>({fontWeight:600,lineHeight:"24px",letterSpacing:"-0.32px"})),R5=t=>{const{annual:e,annualPlanUsdAmount:n,monthlyPlanUsdAmount:o}=t;return!n||!o?null:r.jsxs(j5,{children:[r.jsxs(A5,{children:["$",e?Math.round(n/12*100)/100:o]}),r.jsxs(k5,{children:[r.jsxs(E5,{children:[r.jsx(vh,{children:"USD/month"}),e&&r.jsx(T5,{children:"-20%"})]}),r.jsxs(vh,{sx:{opacity:e?1:0},children:["billed yearly as"," ",r.jsxs("span",{style:{fontWeight:600,color:f("primary")},children:["$",n]})]})]})]})},T5=b(C)(()=>({color:f("IdeogramPinkText"),fontSize:12,fontWeight:600,borderRadius:"4px",background:`${f("IdeogramPinkSurface")} !important`,paddingLeft:"4px",paddingRight:"4px",marginLeft:"4px"})),E5=b(C)({display:"flex",alignItems:"center"}),vh=b(le)(()=>({fontSize:14,color:f("secondary"),lineHeight:"20px"})),k5=b(C)({display:"flex",flexDirection:"column",marginLeft:"4px",marginTop:"2px"}),A5=b(le)(()=>({fontSize:26,fontWeight:700,lineHeight:"125%",color:f("primary")})),j5=b(C)({display:"flex",alignItems:"flex-start",userSelect:"text"}),P5=t=>{const{variant:e,checked:n,onToggle:o}=t;return e==="small-gradient"?r.jsx(M5,{checked:n,onClick:o}):e==="gradient"?r.jsx(O5,{checked:n,onClick:o}):e==="pink"?r.jsx(B5,{checked:n,onClick:o}):r.jsx(L5,{checked:n,onClick:o})},M5=b(t=>r.jsx(Sa,{focusVisibleClassName:".Mui-focusVisible",disableRipple:!0,...t}))(()=>({width:32,height:20,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(12px)",color:"#fff","& + .MuiSwitch-track":{background:"radial-gradient(ellipse at 60% 70%, rgba(255, 208, 206, 0.5) 0%, rgba(255, 184, 193, 0.5) 14.29%, rgba(255, 159, 189, 0.5) 28.57%, rgba(246, 136, 194, 0.5) 42.86%, rgba(229, 115, 204, 0.5) 57.14%, rgba(200, 101, 219, 0.5) 71.43%, rgba(154, 94, 237, 0.5) 85.71%, rgba(61, 94, 255, 0.5) 100%)",opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:f("solid"),border:"1px solid #fff"},"&.Mui-disabled + .MuiSwitch-track":{opacity:1}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:16,height:16,boxShadow:"none"},"& .MuiSwitch-track":{borderRadius:32/2,backgroundColor:f("skeletonBorder"),opacity:1,transition:"background-color 500ms ease"}})),O5=b(t=>r.jsx(Sa,{focusVisibleClassName:".Mui-focusVisible",disableRipple:!0,...t}))(()=>({width:64,height:36,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(28px)",color:"#fff","& + .MuiSwitch-track":{background:"radial-gradient(ellipse at 60% 70%, rgba(255, 208, 206, 0.5) 0%, rgba(255, 184, 193, 0.5) 14.29%, rgba(255, 159, 189, 0.5) 28.57%, rgba(246, 136, 194, 0.5) 42.86%, rgba(229, 115, 204, 0.5) 57.14%, rgba(200, 101, 219, 0.5) 71.43%, rgba(154, 94, 237, 0.5) 85.71%, rgba(61, 94, 255, 0.5) 100%)",opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:f("solid"),border:"6px solid #fff"},"&.Mui-disabled + .MuiSwitch-track":{opacity:1}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:32,height:32,boxShadow:"none"},"& .MuiSwitch-track":{borderRadius:36/2,backgroundColor:f("skeletonBorder"),opacity:1,transition:"background-color 500ms ease"}})),B5=b(t=>r.jsx(Sa,{focusVisibleClassName:".Mui-focusVisible",disableRipple:!0,...t}))(()=>({width:48,height:28,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(20px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:f("IdeogramPink"),opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:f("solid"),border:"6px solid #fff"},"&.Mui-disabled + .MuiSwitch-track":{opacity:1}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:24,height:24},"& .MuiSwitch-track":{borderRadius:28/2,backgroundColor:f("skeletonBorder"),opacity:1,transition:"background-color 500ms ease"}})),L5=b(t=>r.jsx(Sa,{focusVisibleClassName:".Mui-focusVisible",disableRipple:!0,...t}))(()=>({width:40,height:24,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(16px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:f("IdeogramPink"),opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:f("solid"),border:"6px solid #fff"},"&.Mui-disabled + .MuiSwitch-track":{opacity:1}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:20,height:20,boxShadow:"none"},"& .MuiSwitch-track":{borderRadius:24/2,backgroundColor:f("skeletonBorder"),opacity:1,transition:"background-color 500ms ease"}})),N5=t=>{const{annual:e,setAnnual:n}=t,o=Ee(),{isAnnualSubscriber:i}=l.useContext(ge);return i?r.jsx("div",{}):r.jsxs(F5,{onClick:()=>{o({eventKey:"ANNUAL_TOGGLE_CLICK_FROM_PAYWALL_MODAL"}),n(!e)},children:[r.jsx(P5,{checked:e}),r.jsx(D5,{color:f(e?"IdeogramPinkText":"informative"),children:"Annual"})]})},D5=b(le)({fontSize:14,fontWeight:600,paddingRight:8,paddingLeft:8}),F5=b(C)({display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}),Kg=t=>{const{paywallModalEntryPoint:e,paywallType:n="Plus",annual:o,setAnnual:i}=t,a=Ee(),s=Nt(),c=we(),d=xe(c.breakpoints.down("md")),{isBasicSubscriber:u,isPlusSubscriber:h,subscriptionStatus:p,availableStripePlansData:g}=l.useContext(ge),m=l.useMemo(()=>{var N;return(N=g==null?void 0:g.find(k=>k.planName===`Ideogram ${n} Annual`))==null?void 0:N.planId},[g,n]),v=l.useMemo(()=>{var N;return(N=g==null?void 0:g.find(k=>k.planName===`Ideogram ${n} Annual`))==null?void 0:N.priceAmount},[g,n]),x=l.useMemo(()=>{var N;return(N=g==null?void 0:g.find(k=>k.planName===`Ideogram ${n}`))==null?void 0:N.planId},[g,n]),y=l.useMemo(()=>{var N;return(N=g==null?void 0:g.find(k=>k.planName===`Ideogram ${n}`))==null?void 0:N.priceAmount},[g,n]),_=l.useMemo(()=>o?m:x,[o,m,x]),[w,I]=l.useState(!1),[R,S]=l.useState(null),E=l.useCallback(()=>{a({eventKey:"UPGRADE_CLICK_FROM_PAYWALL_MODAL"}),_&&(p!=null&&p.noActiveSubscription?(I(!0),Eg({plan_id:_,conversion_reason:`${e||"UNKNOWN"}_${lt.PaywallModalDirectCheckout}`}).then(({checkout_url:N})=>window.location.href=N)):(u||n==="Pro"&&h)&&S(_))},[a,_,p==null?void 0:p.noActiveSubscription,u,n,h,e]);return r.jsxs(G5,{children:[r.jsxs(U5,{children:[r.jsx(R5,{annual:o,annualPlanUsdAmount:v,monthlyPlanUsdAmount:y}),r.jsx(N5,{annual:o,setAnnual:i})]}),r.jsxs(z5,{children:[r.jsx(ht,{fullWidth:!0,label:`${d?"Get":"Upgrade to"} ${n} ${o?" Annual":" Monthly"}`,onClick:E,loading:w}),r.jsx(It,{fullWidth:!0,label:"See all plans",onClick:()=>{a({eventKey:"SEE_PLANS_CLICK_FROM_PAYWALL_MODAL"}),s({newTab:!0,conversionReason:`${e}_${lt.SeeAllPlansFromPaywallModal}`})}})]}),R&&r.jsx($g,{open:!!R,onCancel:()=>S(null),onConfirm:async()=>{S(null),I(!0),await Ag(R,`${e}_${lt.SeeAllPlansFromPaywallModal}`),setTimeout(()=>{window.location.reload()},1e3)},planId:R})]})},z5=b(C)({display:"flex",marginTop:"16px",gap:"8px"}),U5=b(C)({display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:16}),G5=b(C)({display:"flex",flexDirection:"column"}),Jg=()=>r.jsx(H5,{sx:{background:'url("https://storage.googleapis.com/ideogram-static/paywall__modal_image_vertical.png") center center / cover'}}),H5=b(C)({width:"100%",minWidth:"50%",minHeight:240,objectFit:"cover",backgroundSize:"cover",objectPosition:"center",flex:1,maxHeight:"100%"}),q5=t=>{const{benefit:e,paywallType:n}=t,[o,i]=l.useState(!1);return r.jsx($5,{item:!0,xs:12,sm:6,children:r.jsxs(C,{display:"flex",onMouseEnter:()=>{i(!0)},onMouseLeave:()=>{i(!1)},children:[r.jsx(C,{children:r.jsx(or,{color:f("secondary"),width:18,height:18})}),r.jsxs(W5,{children:[r.jsx(V5,{sx:{fontWeight:e.shouldHightlightOn.includes(n)?600:400,color:e.shouldHightlightOn.includes(n)?f("primary"):f("secondary")},children:e.title}),r.jsx(Rt,{content:e.description,placement:"top",open:o,children:r.jsx(C,{children:r.jsx(ai,{width:14,height:14,color:f("secondary")})})})]})]})})},W5=b(C)({display:"inline-flex",alignItems:"center",gap:"4px",paddingLeft:"12px"}),$5=b(Co)({display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start"}),V5=b("span")(()=>({fontSize:"14px",letterSpacing:"-0.14px",lineHeight:"20px"})),Xg=t=>{const{paywallType:e="Plus"}=t,{isBatchGenerationEnabled:n}=l.useContext(ge),o=l.useMemo(()=>[{title:"3,500 priority credits",description:"Skip the wait and generate in parallel.",type:["Pro"],shouldHightlightOn:["Pro"]},{title:"1,000 priority credits",description:"Skip the wait and generate in parallel.",type:["Plus"],shouldHightlightOn:["Plus"]},...n?[{title:"Batch Generation",description:"Save time and create in bulk by uploading a spreadsheet with your prompts.",type:["Pro"],shouldHightlightOn:["Pro"]}]:[],{title:"Unlimited slow credits",description:"Create as many images as you can imagine.",type:["Plus","Pro"],shouldHightlightOn:["Pro","Plus"]},{title:"Private generation",description:"Hide your generated images from public view.",type:["Plus","Pro"],shouldHightlightOn:["Plus"]},{title:"Image upload",description:"Bring your own images to remix and describe.",type:["Plus","Pro"],shouldHightlightOn:["Plus"]},{title:"Image deletion",description:"Discard creations you don’t want anymore.",type:["Plus","Pro"],shouldHightlightOn:[]},{title:"Download quality",description:"Export images in their original, high-quality PNG format.",type:["Plus","Pro"],shouldHightlightOn:[]},{title:"Custom color palettes",description:"Match your image colors to your brand or creative vision.",type:["Plus","Pro"],shouldHightlightOn:[]},{title:"Unlimited Canvas",description:"Generate, edit, and organize on as many canvases as you want.",type:["Plus","Pro"],shouldHightlightOn:[]},{title:"Magic Fill & Extend",description:"Seamlessly extend, modify, and refine your images.",type:["Plus","Pro"],shouldHightlightOn:[]},{title:"Advanced settings",description:"Add negative prompts, rendering speed, and seed number.",type:["Plus","Pro"],shouldHightlightOn:[]},{title:"Background Removal",description:"Make any image background transparent in a single click.",type:["Plus","Pro"],shouldHightlightOn:[]},{title:"Upscale",description:"Enhance your images with higher 2K resolution.",type:["Plus","Pro"],shouldHightlightOn:[]},{title:"Search community images",description:"Find inspiration from fellow Ideogram creators.",type:["Plus","Pro"],shouldHightlightOn:[]},{title:"Tile",description:"Make seamless repeating patterns on Model 1.0.",type:["Plus","Pro"],shouldHightlightOn:[]}],[n]),i=we(),a=xe(i.breakpoints.down("sm")),c=l.useCallback(d=>{const u=d.filter(v=>v.type.includes(e)),h=[],p=Math.ceil(u.length/2),g=u.slice(0,p),m=u.slice(p);for(let v=0;v<g.length;v++)h.push(g[v]),m[v]!==void 0&&h.push(m[v]);return h},[e])(o);return r.jsxs(K5,{children:[r.jsxs(X5,{children:["Get premium features with ",r.jsxs(Y5,{children:["Ideogram ",e]})]}),r.jsx(J5,{children:"Upgrade now and enjoy:"}),r.jsx(Co,{container:!0,marginTop:"20px",spacing:"12px",children:(a?o:c).map((d,u)=>d.type.includes(e)&&r.jsx(q5,{benefit:d,paywallType:e},u))})]})},K5=b(C)(()=>({fontFamily:"Manrope, sans-serif",display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",width:"100%",color:f("secondary"),userSelect:"text",paddingBottom:"8px"})),J5=b(le)({fontSize:16,marginTop:8}),X5=b(le)({fontSize:"24px",lineHeight:1.25,letterSpacing:"-0.88px"}),Y5=b("span")(()=>({color:f("primary"),fontSize:"24px",fontWeight:700,whiteSpace:"nowrap"})),Q5=t=>{const e=we(),n=xe(e.breakpoints.down(1044)),{bannerContent:o}=Vg(),{setModalContent:i}=l.useContext(Tt),a=l.useRef(null),[s,c]=l.useState(!0),d=l.useCallback(()=>{const u=a.current;if(u){const h=u.scrollHeight-u.scrollTop<=u.clientHeight+4;c(h)}},[c]);return l.useEffect(()=>{const u=a.current;if(d(),u)return u.addEventListener("scroll",d),()=>{u.removeEventListener("scroll",d)}},[d]),r.jsxs(oR,{flexDirection:n?"column":"row",children:[r.jsx(tR,{sx:n?{backgroundColor:f("glassBackground"),"&:hover":{backgroundColor:f("glassBackgroundHover")},"&:active":{backgroundColor:f("glassBackgroundPressed")}}:{},children:r.jsx(Be,{icon:r.jsx(wt,{color:n?"#fff":f("secondary")}),onClick:()=>i(null)})}),r.jsx(Jg,{}),r.jsxs(nR,{ref:a,children:[r.jsx(C,{paddingX:"24px",paddingBottom:o?2:0,children:r.jsx(Xg,{...t})}),r.jsxs(eR,{sx:s?{}:{borderTopStyle:"solid",borderTopColor:f("border"),borderTopWidth:.5,boxShadow:"0px 25px 50px -12px rgba(9, 9, 11, 0.25)"},children:[!!o&&r.jsx(r.Fragment,{children:r.jsx(Z5,{children:o})}),r.jsx(Kg,{...t})]})]})]})},Z5=b(C)(()=>({padding:"16px 32px",color:f("successBannerText"),backgroundColor:f("successBannerBackground"),display:"flex",alignItems:"center",justifyContent:"center",marginLeft:-32,marginTop:-16,width:"calc(100% + 64px)"})),eR=b(C)(()=>({position:"sticky",width:"100%",bottom:0,left:0,backgroundColor:f("menuBackground"),padding:"16px 24px 24px",overflowX:"clip"})),tR=b(C)({position:"absolute",top:8,right:8,zIndex:1,borderRadius:8}),nR=b(C)(()=>({padding:"40px 0 0 0",backgroundColor:f("menuBackground"),maxHeight:"100%",overflow:"auto",position:"relative",flex:1})),oR=b(C)({display:"flex",maxHeight:"100%",overflow:"auto",position:"relative"}),rR=t=>{const{setModalContent:e}=l.useContext(Tt),{bannerContent:n}=Vg();return r.jsxs(r.Fragment,{children:[r.jsx(lR,{children:r.jsx(Be,{icon:r.jsx(wt,{color:"#fff"}),onClick:()=>e(null)})}),r.jsxs(aR,{children:[r.jsx(Jg,{}),r.jsxs(sR,{children:[r.jsx(Xg,{...t}),!!n&&r.jsx(C,{height:16})]}),r.jsxs(cR,{children:[!!n&&r.jsx(r.Fragment,{children:r.jsx(iR,{children:n})}),r.jsx(Kg,{...t})]})]})]})},iR=b(C)(()=>({padding:"16px 32px",color:f("successBannerText"),backgroundColor:f("successBannerBackground"),display:"flex",alignItems:"center",justifyContent:"center",marginLeft:-32,marginTop:-16,width:"calc(100% + 64px)"})),sR=b(C)({padding:"32px 16px 16px 16px",width:"100%"}),aR=b(C)(()=>({display:"flex",flexDirection:"column",backgroundColor:f("menuBackground"),position:"relative",height:"101dvh",overflow:"auto"})),lR=b(C)(()=>({position:"absolute",top:8,right:8,zIndex:1,borderRadius:8,backgroundColor:f("glassBackground"),"&:hover":{backgroundColor:f("glassBackgroundHover")},"&:active":{backgroundColor:f("glassBackgroundPressed")}})),cR=b(C)(()=>({position:"sticky",width:"100%",bottom:0,left:0,backgroundColor:f("menuBackground"),padding:"0 16px 16px 16px",borderTopStyle:"solid",borderTopColor:f("border"),borderTopWidth:.5,boxShadow:"0px 25px 50px -12px rgba(9, 9, 11, 0.25)",overflowX:"clip"})),dR=t=>{const e=we();return xe(e.breakpoints.down("md"))?r.jsx(rR,{...t}):r.jsx(Q5,{...t})},uR=t=>{const{setModalContent:e}=l.useContext(Tt),{subscriptionStatus:n,isAnnualSubscriber:o}=l.useContext(ge),[i,a]=l.useState(!!(o||n!=null&&n.noActiveSubscription));return r.jsx(Rr,{open:!0,content:r.jsx(dR,{...t,annual:i,setAnnual:a}),handleClose:()=>{e(null)},mobileFullScreen:!0,maxWidth:1152,border:!0})},$t=()=>{var i;const{setModalContent:t}=l.useContext(Tt),{subscriptionStatus:e}=l.useContext(ge),n=Nt(),o=l.useCallback((a,s)=>{var c;rn()?Rg():((c=e==null?void 0:e.activeSubscription)==null?void 0:c.subscriptionProvider)===mg.Apple&&!rn()?n({newTab:!0,conversionReason:""}):t(r.jsx(uR,{paywallModalEntryPoint:a,paywallType:s||"Plus"}))},[n,t,(i=e==null?void 0:e.activeSubscription)==null?void 0:i.subscriptionProvider]);return l.useEffect(()=>{No("https://storage.googleapis.com/ideogram-static/paywall_image_horizontal.png"),No("https://storage.googleapis.com/ideogram-static/paywall_image_vertical.png")},[]),{showPayWallModel:o}},ic=b(C)({display:"flex",padding:8,alignItems:"center",gap:"12px"}),yh=b(le)(()=>({color:"#FAFAFA",fontSize:14,fontWeight:700,lineHeight:"20px",letterSpacing:"-0.56px"})),sc=b(le)(()=>({color:"#D4D4D8",fontSize:14,fontWeight:400,lineHeight:"20px",letterSpacing:"-0.14px"})),$9=b("span")(()=>({fontWeight:600,lineHeight:"20px",letterSpacing:"-0.56px"})),hR="#27272A",pR=()=>{const t=()=>{window.location.reload()};return r.jsxs(ic,{children:[r.jsx(yh,{children:r.jsx(Qo,{i18nKey:"canvas.alert.canvas_out_of_date.title"})}),r.jsx(sc,{children:r.jsx(Qo,{i18nKey:"canvas.alert.canvas_out_of_date.message"})}),r.jsx(yh,{onClick:t,sx:{cursor:"pointer"},marginLeft:"12px",children:r.jsx(Qo,{i18nKey:"canvas.alert.canvas_out_of_date.action"})})]})};class Re{constructor(e,n){this.x=e,this.y=n}static deserialize(e){return new Re(e.x,e.y)}getSerializedData(){return{x:this.x,y:this.y}}equals(e){return this.x===e.x&&this.y===e.y}add(e){return new Re(this.x+e.x,this.y+e.y)}subtract(e){return new Re(this.x-e.x,this.y-e.y)}elementWiseDivide(e){return new Re(this.x/e.x,this.y/e.y)}elementWiseMultiply(e){return new Re(this.x*e.x,this.y*e.y)}multiply(e){return new Re(this.x*e,this.y*e)}dot(e){return this.x*e.x+this.y*e.y}proj(e){return e.multiply(this.dot(e)/e.dot(e))}length(){return Math.sqrt(this.x**2+this.y**2)}round(){return new Re(Math.round(this.x),Math.round(this.y))}min(e){return new Re(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new Re(Math.max(this.x,e.x),Math.max(this.y,e.y))}as_hw(){return new Ue(this.y,this.x)}copy(){return new Re(this.x,this.y)}static minX(e){if(e.length===0)return 0;let n=e[0].x;for(let o=1;o<e.length;++o)n=Math.min(n,e[o].x);return n}static minY(e){if(e.length===0)return 0;let n=e[0].y;for(let o=1;o<e.length;++o)n=Math.min(n,e[o].y);return n}static maxX(e){if(e.length===0)return 0;let n=e[0].x;for(let o=1;o<e.length;++o)n=Math.max(n,e[o].x);return n}static maxY(e){if(e.length===0)return 0;let n=e[0].y;for(let o=1;o<e.length;++o)n=Math.max(n,e[o].y);return n}}class Ue{constructor(e,n){this.h=e,this.w=n}static deserialize(e){return new Ue(e.h,e.w)}getSerializedData(){return{h:this.h,w:this.w}}equals(e){return this.h===e.h&&this.w===e.w}elementWiseDivide(e){return new Ue(this.h/e.h,this.w/e.w)}multiply(e){return new Ue(this.h*e,this.w*e)}abs(){return new Ue(Math.abs(this.h),Math.abs(this.w))}as_xy(){return new Re(this.w,this.h)}}class V9{constructor(e,n){this.canonical=e,this.unnormalized=n}}class In{constructor({position:e,size:n,borderHitWidth:o=0}){this.position=e,this.size=n,this.borderHitWidth=o}inLeftHitBox(e){const n=this.borderHitWidth/2,{h:o}=this.size,{x:i,y:a}=this.position,s=e.x>=i-n&&e.x<=i+n,c=e.y>=a-n&&e.y<=a+o+n;return s&&c}inTopHitBox(e){const n=this.borderHitWidth/2,{w:o}=this.size,{x:i,y:a}=this.position,s=e.x>=i-n&&e.x<=i+o+n,c=e.y>=a-n&&e.y<=a+n;return s&&c}inRightHitBox(e){const n=this.borderHitWidth/2,{w:o,h:i}=this.size,{x:a,y:s}=this.position,c=e.x>=a+o-n&&e.x<=a+o+n,d=e.y>=s-n&&e.y<=s+i+n;return c&&d}inBottomHitBox(e){const n=this.borderHitWidth/2,{w:o,h:i}=this.size,{x:a,y:s}=this.position,c=e.x>=a-n&&e.x<=a+o+n,d=e.y>=s+i-n&&e.y<=s+i+n;return c&&d}inBox(e,n=0){const{w:o,h:i}=this.size,{x:a,y:s}=this.position,c=e.x>=a-n&&e.x<=a+o+n,d=e.y>=s-n&&e.y<=s+i+n;return c&&d}overlapsBox(e){const{w:n,h:o}=this.size,{x:i,y:a}=this.position,s=new Re(e.position.x,e.position.y),c=new Re(e.position.x+e.size.w,e.position.y+e.size.h);return!(s.x<i&&c.x<i||s.x>i+n&&c.x>i+n||s.y<a&&c.y<a||s.y>a+o&&c.y>a+o)}boxIntersectionArea(e){const n=this.topLeft(),o=this.bottomRight(),i=new Re(e.position.x,e.position.y),a=new Re(e.position.x+e.size.w,e.position.y+e.size.h),s=Math.max(n.x,i.x),c=Math.min(o.x,a.x);if(s>=c)return 0;const d=Math.max(n.y,i.y),u=Math.min(o.y,a.y);return d>=u?0:(c-s)*(u-d)}intersection(e){const n=this.topLeft(),o=this.bottomRight(),i=new Re(e.position.x,e.position.y),a=new Re(e.position.x+e.size.w,e.position.y+e.size.h),s=Math.max(n.x,i.x),c=Math.max(s,Math.min(o.x,a.x)),d=Math.max(n.y,i.y),u=Math.max(d,Math.min(o.y,a.y));return new In({position:new Re(s,d),size:new Ue(u-d,c-s)})}width(){return this.size.w}height(){return this.size.h}left(){return this.position.x}right(){return this.position.x+this.size.w}top(){return this.position.y}bottom(){return this.position.y+this.size.h}area(){return this.size.w*this.size.h}topLeft(){return this.position.copy()}topRight(){return this.position.add(new Re(this.size.w,0))}bottomLeft(){return this.position.add(new Re(0,this.size.h))}bottomRight(){return this.position.add(new Re(this.size.w,this.size.h))}center(){return this.position.add(new Re(this.size.w/2,this.size.h/2))}centerLeft(){return this.position.add(new Re(0,this.size.h/2))}centerTop(){return this.position.add(new Re(this.size.w/2,0))}centerRight(){return this.position.add(new Re(this.size.w,this.size.h/2))}centerBottom(){return this.position.add(new Re(this.size.w/2,this.size.h))}corner(e){return e==="TL"?this.topLeft():e==="TR"?this.topRight():e==="BL"?this.bottomLeft():e==="BR"?this.bottomRight():this.position.copy()}inCornerHitBox(e,n){const o=this.corner(e);return n.x>=o.x-this.borderHitWidth/2&&n.x<=o.x+this.borderHitWidth/2&&n.y>=o.y-this.borderHitWidth/2&&n.y<=o.y+this.borderHitWidth/2}getInteractionArea(e){const n=["TL","TR","BL","BR"].find(o=>this.inCornerHitBox(o,e));if(n)return n;if(this.inLeftHitBox(e))return"L";if(this.inRightHitBox(e))return"R";if(this.inTopHitBox(e))return"T";if(this.inBottomHitBox(e))return"B";if(this.inBox(e))return"BOX"}static areEqualPlacement(e,n){return!(!e.position.equals(n.position)||!e.size.equals(n.size))}static maxMiniOverBoundingBoxes(e,n){const o=e.map(p=>p.topLeft()),i=Re.minX(o),a=Re.minY(o),s=e.map(p=>p.bottomRight()),c=Re.maxX(s),d=Re.maxY(s),u=new Re(i,a),h=new Ue(d-a,c-i);return new In({position:u,size:h,borderHitWidth:n})}}const Jt=1e5;function fR(t){return 1-(1-t)*(1-t)}class gR{constructor(e=new Re(0,0),n=.5){ke(this,"translate",new Re(0,0));ke(this,"scale",.5);ke(this,"canvasWidth",1);ke(this,"canvasHeight",1);this.translate=e,this.scale=n}animate(){if(!this.animateTo)return;const e=this.translate,n=this.scale,{scale:o,translate:i,startTime:a,endTime:s}=this.animateTo,d=(performance.now()-a)/(s-a),u=fR(Math.max(0,Math.min(1,d))),h=u*o+(1-u)*n,p=i.multiply(u).add(e.multiply(1-u));this.translate=p,this.scale=h,this._clampBounds(),d>=1&&this.cancelAnimate()}cancelAnimate(){this.animateTo=void 0}setCameraScale(e,n){if(this.cancelAnimate(),this.scale===e)return;const o=n??this.translate.copy(),i=Math.max(this.canvasWidth,this.canvasHeight)/window.devicePixelRatio,a=25,s=i/(2*Jt),c=Math.min(Math.max(e,s),a),d=c/this.scale;this.scale=c;const p=this.translate.subtract(o).multiply(1/d).add(o);this.setCameraTranslate(p)}isBBoxMostlyInView(e,n=.5){return n<=0?!0:n>1?!1:this.getCameraViewBBox().boxIntersectionArea(e)/e.area()>=n}focusCameraIfOutOfView(e,n=.5){if(this.isBBoxMostlyInView(e,n))return;const o=e.width(),i=e.height(),a=Math.max(.5*o,64),s=Math.max(.5*i,64),c=this.canvasWidth/window.devicePixelRatio/(o+a),d=this.canvasHeight/window.devicePixelRatio/(i+s),u=Math.min(c,d);this.animateTo={startTime:performance.now(),endTime:performance.now()+750,scale:u,translate:e.center()}}setCameraBox(e,n){if(!e.width()){this.scale=1/window.devicePixelRatio,this.translate=new Re(0,0);return}const o=e.width(),i=e.height(),a=n==="fit"?Math.max(.2*o,64):0,s=n==="fit"?Math.max(.2*i,64):0,c=this.canvasWidth/window.devicePixelRatio/(o+a),d=this.canvasHeight/window.devicePixelRatio/(i+s),u=n==="fill"?Math.max(c,d):Math.min(c,d);this.setCameraScale(u),this.setCameraTranslate(e.center())}setCameraTranslate(e){this.cancelAnimate(),this.translate.x=e.x,this.translate.y=e.y,this._clampBounds()}clampPosition(e,n){const{x:o,y:i}=e,a=(n==null?void 0:n.w)??0,s=(n==null?void 0:n.h)??0,c=Jt,d=Math.max(-c,Math.min(c-a,o)),u=Math.max(-c,Math.min(c-s,i));return new Re(d,u)}_clampBounds(){const e=this.translate,n=Jt,o=this.canvasWidth/this.scale/window.devicePixelRatio/2,i=this.canvasHeight/this.scale/window.devicePixelRatio/2;this.translate.x=Math.max(Math.min(e.x,n-o),-n+o),this.translate.y=Math.max(Math.min(e.y,n-i),-n+i)}setup(e,n,o){this.canvasWidth=n,this.canvasHeight=o,this._clampBounds(),e.setTransform(1,0,0,1,n/2,o/2);const i=this.scale*window.devicePixelRatio;e.scale(i,i),e.translate(-this.translate.x,-this.translate.y)}getCameraViewBBox(){const e=this.canvasWidth/window.devicePixelRatio/this.scale,n=this.canvasHeight/window.devicePixelRatio/this.scale,o=this.translate.x-e/2,i=this.translate.y-n/2;return new In({position:new Re(o,i),size:new Ue(n,e),borderHitWidth:0})}renderPixelGrid(e){if(this.scale<8)return;const n=1/this.scale;e.lineWidth=1*n,e.strokeStyle="rgba(128, 128, 128, 0.15)";const o=this.getCameraViewBBox(),i=o.topLeft(),a=o.bottomRight(),s=Math.floor(i.x),c=Math.ceil(a.x);e.beginPath();for(let h=s;h<=c;h++)e.moveTo(h,i.y),e.lineTo(h,a.y);const d=Math.floor(i.y),u=Math.ceil(a.y);for(let h=d;h<=u;h++)e.moveTo(i.x,h),e.lineTo(a.x,h);e.stroke()}renderDebugGrid(e){const n=1/this.scale;e.lineWidth=5*n,e.strokeStyle="#000",e.beginPath(),e.moveTo(-Jt,0),e.lineTo(Jt,0),e.moveTo(0,-Jt),e.lineTo(0,Jt),e.stroke();const o=1024,i=Math.floor(Jt/o),a=Math.floor(Jt/o);e.lineWidth=1*n,e.beginPath(),e.setLineDash([5*n,2.5*n]),e.strokeStyle="#00F";for(let u=-i;u<=i;u++){if(u===0)continue;const h=u*o;e.moveTo(h,-Jt),e.lineTo(h,Jt)}for(let u=-a;u<=a;u++){if(u===0)continue;const h=u*o;e.moveTo(-Jt,h),e.lineTo(Jt,h)}e.stroke(),e.strokeStyle="#0F0",e.setLineDash([]),e.lineWidth=2*n,e.strokeRect(-Jt,-Jt,2*Jt,2*Jt),e.fillStyle="#000",e.beginPath(),e.arc(0,0,10*n,0,2*Math.PI),e.fill(),e.fillStyle="#000",e.textBaseline="top",e.textAlign="left";const s=n*5,c=n*24*1.4;e.font=`normal ${n*24}px serif`,e.fillText(`Scale: ${this.scale.toFixed(4)}`,s,s),e.fillText(`Tx: ${this.translate.x.toFixed(0)}`,s,s+c),e.fillText(`Ty: ${this.translate.y.toFixed(0)}`,s,s+2*c),e.fillText(`dPR: ${window.devicePixelRatio.toFixed(2)}`,s,s+3*c);const d=this.getCameraViewBBox();e.strokeStyle="rgba(0, 255, 0, 1)",e.lineWidth=3*n,e.beginPath(),e.rect(d.position.x,d.position.y,d.size.w,d.size.h),e.stroke(),e.strokeStyle="transparent"}renderDebugPoint(e,n){const o=1/this.scale,i=10*o;e.fillStyle="#F00",e.beginPath(),e.arc(n.x,n.y,i,0,2*Math.PI),e.fill(),e.fillStyle="#000",e.textBaseline="top",e.textAlign="left",e.font=`normal ${o*24}px serif`,e.fillText(`(${n.x.toFixed(2)}, ${n.y.toFixed(2)})`,n.x+i,n.y+i)}}const mR="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Yg=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=mR[n[t]&63];return e};const xR='"Arial", sans-serif',Qg="Normal",fr={displayName:"Arial",family:"Arial",genericName:"sans-serif",weight:400,style:"normal"},vR=[100,200,300,400,500,600,700,800,900],yR=new Map([["Thin",100],["Extra Light",200],["Light",300],["Normal",400],["Medium",500],["Semi Bold",600],["Bold",700],["Extra Bold",800],["Black",900]]),wR=new Map([[100,"Thin"],[200,"Extra Light"],[300,"Light"],[400,"Normal"],[500,"Medium"],[600,"Semi Bold"],[700,"Bold"],[800,"Extra Bold"],[900,"Black"]]),bR=[{displayName:"Advent Pro"},{displayName:"Antonio"},{displayName:"Bodoni Moda"},{displayName:"Bricolage Groresque"},{displayName:"Cairo"},{displayName:"Caveat"},{displayName:"Climate Crisis"},{displayName:"Comfortaa"},{displayName:"Dancing Script"},{displayName:"Danfo"},{displayName:"DM Sans"},{displayName:"Doto"},{displayName:"DynaPuff"},{displayName:"EB Garamond"},{displayName:"Exo"},{displayName:"Fraunces"},{displayName:"Fredoka"},{displayName:"Gluten"},{displayName:"Grandstander"},{displayName:"Grenze Gotisch"},{displayName:"Inconsolata"},{displayName:"Inter"},{displayName:"Jaro"},{displayName:"Jura"},{displayName:"Kablammo"},{displayName:"Karla"},{displayName:"Lemonada"},{displayName:"Lexend"},{displayName:"Libre Franklin"},{displayName:"Lora"},{displayName:"Manrope"},{displayName:"Marhey"},{displayName:"Merienda"},{displayName:"Montserrat"},{displayName:"Mulish"},{displayName:"Noto Sans"},{displayName:"Noto Serif"},{displayName:"Nunito"},{displayName:"Open Sans"},{displayName:"Orbitron"},{displayName:"Oswald"},{displayName:"Oxanium"},{displayName:"Pixelify Sans"},{displayName:"Playfair Display"},{displayName:"Playpen Sans"},{displayName:"Plus Jakarta Sans"},{displayName:"Raleway"},{displayName:"Roboto"},{displayName:"Roboto Condensed"},{displayName:"Roboto Mono"},{displayName:"Roboto Serif"},{displayName:"Roboto Slab"},{displayName:"Rubik"},{displayName:"Shantell Sans"},{displayName:"Smooch Sans"},{displayName:"Sour Gummy"},{displayName:"Source Code Pro"},{displayName:"Source Sans"},{displayName:"Space Grotesk"},{displayName:"Teko"},{displayName:"Tektur"},{displayName:"Texturina"},{displayName:"Tilt Prism"},{displayName:"Tourney"},{displayName:"Truculenta"},{displayName:"Work Sans"},{displayName:"Amatic SC"},{displayName:"Anton"},{displayName:"Bangers"},{displayName:"Bokor"},{displayName:"Comic Neue"},{displayName:"Faculty Glyphic"},{displayName:"Galindo"},{displayName:"Lato"},{displayName:"Limelight"},{displayName:"Lobster"},{displayName:"Merriweather"},{displayName:"Monoton"},{displayName:"Nothing You Could Do"},{displayName:"Pacifico"},{displayName:"Poppins"},{displayName:"Sevillana"},{displayName:"Special Elite"},{displayName:"Spectral"}],Zs=12,CR="<<MAGIC_DELIMITER_RETURN>>",_R=document.createElement("canvas"),wh=_R.getContext("2d"),pl=new Map,IR=t=>(pl.has(t)||pl.set(t,new Map),pl.get(t)??new Map),zr=(t,e,n)=>{if(t===CR)return{sum:0,advances:[]};if(t.length===0)return{sum:0,advances:[]};const o=new Intl.Segmenter(void 0,{granularity:"grapheme"});let i=0;const a=[];return[...o.segment(t)].forEach(c=>{const{segment:d}=c,u=e(c.index),h=IR(u);if(!h.has(d)){wh.font=u;const g=wh.measureText(d);new RegExp("\\p{Emoji_Presentation}","u").test(d)?h.set(d,Zs):h.set(d,g.width)}const p=n(c.index);i+=p/Zs*(h.get(d)??0),a.push({x:i,index:c.index,length:c.segment.length})}),{sum:i,advances:a}},Zg=t=>{const n=[...new Intl.Segmenter(void 0,{granularity:"word"}).segment(t)],o=[];let i=null;for(let a=0;a<n.length;a++){const s=n[a];if(i===null){i=s.segment;continue}if(s.segment===`
`||s.segment==="\r"){i&&o.push(i),o.push(s.segment),i="";continue}if(!s.isWordLike){i=`${i}${s.segment}`;continue}i&&o.push(i),i=s.segment}return i&&o.push(i),o},SR=t=>{const{text:e,maxWidth:n,getFontNormString:o,getFontSize:i}=t,a=[],s=[],c=Zg(e);let d=0,u=0;for(let h=0;h<c.length;h++){const p=c[h];a[d]||(a[d]=[],s[d]=[]);const g=a[d];if(p===`
`||p==="\r"){a[d].push("​"),s[d].push({x:u,index:g.join("").length-1,length:1}),d++,u=0;continue}const m=a.flatMap(S=>S.join("")).join("").length,{sum:v,advances:x}=zr(p,S=>o(m+S),S=>i(m+S)),y=zr(p.trim(),S=>o(m+S),S=>i(m+S)).sum,_=a[d].length===0;if(u+y>n&&!_){d++,u=v,a[d]=[p],s[d]=x.slice(0);continue}const R=g.join("").length;g.push(p),s[d]=s[d].concat(x.map(S=>({index:R+S.index,x:u+S.x,length:S.length}))),u+=v}return a[d]||(a[d]=[],s[d]=[]),a.map((h,p)=>({text:h.join(""),graphemePositions:s[p]}))},em=(t,e)=>!t||!e?!0:!(e.end<=t.start||t.end<=e.start),RR=(t,e)=>{const n=Math.max(0,Math.min(e.end,t.start)-e.start),o=Math.max(0,Math.min(e.end,t.end)-e.start);return{start:t.start-n,end:t.end-o}},TR=(t,e)=>{const n=e.end-e.start,o=e.start<=t.start?n:0,i=e.start<=t.end?n:0;return{start:t.start+o,end:t.end+i}},tm={fontConfig:{...fr},textColor:"#000000",textSize:Zs},nm={segmentConfig:[tm],textAlign:"left"},Lr=(t=[],e=0)=>{const n={};return t.forEach(o=>{if(o.range){const{start:i,end:a}=o.range;if(!(e>=i&&e<a))return}Object.assign(n,o)}),n},Ii=(t=[],e)=>{const n={};if(e.start===e.end)return Lr(t,Math.max(0,e.start-1));const o=t.filter(a=>!(a.range&&!em(a.range,e))).reverse();return["textColor","fontConfig","textSize"].forEach(a=>{var c;let s=null;for(let d=e.start;d<e.end;d++){const u=(c=o.find(p=>p[a]&&(!p.range||p.range.start<=d&&p.range.end>d)))==null?void 0:c[a];if(s===null&&(s=u),!(typeof u=="object"?JSON.stringify(u)===JSON.stringify(s):u===s)){s=null;break}s=u}s!==null&&(n[a]=s)}),n},sr=t=>({...tm,...t}),ER=(t=[],e)=>{const n=[...t].reverse(),o=n.findIndex(a=>{var s,c;return!a.range&&!e||((s=a.range)==null?void 0:s.start)===(e==null?void 0:e.start)&&((c=a.range)==null?void 0:c.end)===(e==null?void 0:e.end)}),i=n.findIndex(a=>!e||!a.range||e&&em(a.range,e));return o!==-1&&i!==-1&&o<=i?n[o]:null},kR=(t,e,n)=>{const o=t.end-t.start;if(n<0&&o===0)return e.start<t.start?{rangeRemoved:{start:t.start+n,end:t.start}}:e.start===t.start?{rangeRemoved:{start:t.start,end:t.start-n}}:{};const i={...t},a=i.end-i.start+n,s={start:t.start,end:t.start+a};return{...o>0&&{rangeRemoved:i},rangeAdded:s}},om=(t,e)=>`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${e??t[3]})`,AR=(t,e,n)=>[t[0]*(1-n)+e[0]*n,t[1]*(1-n)+e[1]*n,t[2]*(1-n)+e[2]*n,t[3]*(1-n)+e[3]*n],jR=[{offset:0,color:[255,159,189,.2]},{offset:.2,color:[246,136,194,.2]},{offset:.4,color:[229,115,204,.2]},{offset:.6,color:[200,101,219,.2]},{offset:.9,color:[154,94,237,.2]},{offset:1,color:[61,94,255,.2]}],PR=[{offset:0,color:[61,94,255,1]},{offset:.14,color:[154,94,237,1]},{offset:.29,color:[200,101,219,1]},{offset:.43,color:[229,115,204,1]},{offset:.57,color:[246,136,194,1]},{offset:.71,color:[255,159,189,1]},{offset:.86,color:[255,184,193,1]},{offset:1,color:[255,208,206,1]}],xd=(t,e,n=1,o=1,i=!1)=>{const a=t.createLinearGradient(e.left(),e.top(),e.right(),e.bottom());for(let s=0;s<o;s++){const c=s%2===1!==i;PR.forEach(d=>{a.addColorStop(s/o+(c?1-d.offset:d.offset)/o,om(d.color,n))})}return a},MR=(t,e)=>{const n=t.createLinearGradient(e.left(),e.top(),e.right(),e.bottom());return jR.forEach(o=>{n.addColorStop(o.offset,om(AR([255,255,255,1],o.color,.2),1))}),n},OR=(t,e)=>{t.clearRect(0,0,t.canvas.width,t.canvas.height);const n=MR(t,e);t.fillStyle=n,t.fillRect(e.left(),e.top(),e.width(),e.height()),t.fillStyle="#fff";const o=Math.max(e.width(),e.height()),i=64,a=o/i;for(let s=0;s<i;s++)for(let c=0;c<i;c++)(s+c)%2!==0&&t.fillRect(e.left()+s*a,e.top()+c*a,a,a)};let Mt=function(t){return t.ELLIPSE="ELLIPSE",t.IMAGE="IMAGE",t.RECT="RECT",t.BOARD="BOARD",t.STROKE="STROKE",t.TEXT="TEXT",t.HANDLE="HANDLE",t.MASK_INVERT="MASK_INVERT",t}({});const rm=new Set(["TL","TR","BR","BL"]),im=new Set(["L","TL","BL"]),sm=new Set(["R","TR","BR"]),am=new Set(["T","TL","TR"]),lm=new Set(["B","BL","BR"]),K9=t=>{if(t==="TL"||t==="BR")return"nwse-resize";if(t==="TR"||t==="BL")return"nesw-resize";if(t==="L"||t==="R")return"ew-resize";if(t==="T"||t==="B")return"ns-resize";if(t==="BOX")return"move";if(t==="CLICK")return"pointer"};class Fo{constructor({id:e,type:n,name:o,position:i,size:a,uncroppedSize:s,zIndex:c=0,color:d="black",borderColor:u="transparent",borderLineWidth:h=0,borderPosition:p="center",strokeLineWidth:g=5,cropInsets:m={},scaledCropInsets:v={},fillColor:x="transparent",assetId:y,offset:_=new Re(0,0),text:w="",textConfig:I=nm,visible:R=!0,radius:S,positions:E,strokeColor:N,strokeLasso:k,erase:A=!1,strokeType:D,requestId:O,responseId:L,imageIndex:P,generationType:G,imageId:B}){ke(this,"borderAnimate",!1);ke(this,"borderAnimateLineDash",[8,8]);ke(this,"borderAnimatePeriodMs",500);ke(this,"fillCheckered",!1);ke(this,"fillCheckeredAnimate",!0);ke(this,"fillCheckeredSize",16);ke(this,"fillCheckeredColorEven","transparent");ke(this,"fillCheckeredColorOdd","#FFB0AE");ke(this,"borderHitWidth",16);ke(this,"uiScale",1);ke(this,"hover");this.data={id:e||Yg(),name:o??this.defaultName(),type:n,position:i,zIndex:c,size:a,uncroppedSize:s,cropInsets:m,scaledCropInsets:v,color:d,borderPosition:p,borderColor:u,borderLineWidth:h,strokeLineWidth:g,fillColor:x,offset:_,assetId:y,text:w,textConfig:I,visible:R,radius:S,positions:E,strokeColor:N,strokeLasso:k,strokeType:D,erase:A,requestId:O,responseId:L,imageIndex:P,generationType:G,imageId:B}}getSerializedData(){var e,n,o;return Fa({id:this.data.id,type:this.data.type,name:this.data.name,visible:this.data.visible,position:this.data.position.getSerializedData(),size:this.data.size.getSerializedData(),uncroppedSize:this.data.uncroppedSize?this.data.uncroppedSize.getSerializedData():this.data.size.getSerializedData(),zIndex:this.data.zIndex,rotation:this.data.rotation,scale:this.data.scale,cropInsets:this.data.cropInsets,scaledCropInsets:this.data.scaledCropInsets,color:this.data.color,opacity:this.data.opacity,borderColor:this.data.borderColor,borderLineWidth:this.data.borderLineWidth,borderPosition:this.data.borderPosition,fillColor:this.data.fillColor,offset:this.data.offset,text:this.data.text,textConfig:this.data.textConfig,position2:(e=this.data.position2)==null?void 0:e.getSerializedData(),radius:(n=this.data.radius)==null?void 0:n.getSerializedData(),positions:(o=this.data.positions)==null?void 0:o.flatMap(i=>[i.x,i.y]),strokeColor:this.data.strokeColor,strokeLasso:this.data.strokeLasso,strokeLineWidth:this.data.strokeLineWidth,strokeType:this.data.strokeType,generationType:this.data.generationType,imageId:this.data.imageId})}defaultName(){return"Element"}borderUIWidth(){return this.borderHitWidth*this.uiScale}bbox(){return new In({position:this.data.position,size:this.data.size,borderHitWidth:this.borderUIWidth()})}getInteractionArea(e){return this.getFullBBox().getInteractionArea(e)}render(e,n){this.data.visible&&(this.renderEnter(e),this.renderFill(e,n),n.ignoreBorder||this.renderBorder(e),this.renderContent(e,n),this.renderExit(e))}renderFill(e,n){this.data.fillColor==="transparent"&&!this.fillGradient||(n.maskDisplay?e.fillStyle=this.createInpaintingGradient(e):e.fillStyle=this.fillGradient??this.data.fillColor??"#FFFFFF",e.fillRect(this.data.position.x,this.data.position.y,this.data.size.w,this.data.size.h))}renderBorder(e){if((!this.data.borderColor||this.data.borderColor==="transparent")&&!this.borderGradient||!this.data.borderLineWidth)return;const n=(this.hover?1.5:1)*this.uiScale*this.data.borderLineWidth;if(e.lineJoin="miter",e.lineCap="butt",e.strokeStyle=this.borderGradient??this.data.borderColor,e.lineWidth=n,this.borderAnimate||this.data.borderColor==="ants"){const i=new Date().getMilliseconds(),a=this.borderAnimateLineDash.reduce((c,d)=>c+d,0)-1,s=-Math.floor(i*a/this.borderAnimatePeriodMs);e.setLineDash(this.borderAnimateLineDash),e.lineDashOffset=s}this.data.borderPosition==="center"?e.strokeRect(this.data.position.x,this.data.position.y,this.data.size.w,this.data.size.h):this.data.borderPosition==="outer"?e.strokeRect(this.data.position.x-n/2,this.data.position.y-n/2,this.data.size.w+n,this.data.size.h+n):this.data.borderPosition==="inner"?e.strokeRect(this.data.position.x+n/2,this.data.position.y+n/2,this.data.size.w-n,this.data.size.h-n):e.strokeRect(this.data.position.x,this.data.position.y,this.data.size.w,this.data.size.h),e.setLineDash([])}renderEnter(e){const n=this.data.position.add(this.data.size.multiply(.5).as_xy());e.translate(n.x,n.y),e.rotate((this.data.rotation??0)*Math.PI/180),e.translate(-n.x,-n.y),e.globalAlpha=this.data.opacity??1}renderExit(e){const n=this.data.position.add(this.data.size.multiply(.5).as_xy());e.translate(n.x,n.y),e.rotate(-(this.data.rotation??0)*Math.PI/180),e.translate(-n.x,-n.y),e.globalAlpha=1}renderContent(e,n){}getFullBBox(){let e=0;this.data.type===Mt.STROKE&&(e+=(this.data.strokeLineWidth??0)/2);const{x:n,y:o}=this.data.position,{w:i,h:a}=this.data.size;return new In({position:new Re(n-e,o-e),size:new Ue(a+2*e,i+2*e),borderHitWidth:this.borderUIWidth()})}updatePositionAndSize(){}updateFromSizeToSize(e,n){}setPosition(e){this.data.position.x=e.x,this.data.position.y=e.y}translate(e){this.setPosition(this.data.position.add(e))}createInpaintingGradient(e){return this.data.erase?"rgba(255, 255, 255, 0.3)":xd(e,this.getFullBBox(),.85)}zIndex(){return this.data.zIndex??0}copy(){return es.cloneDeep(this)}}const fl="#D4D4D8",BR="rgba(0, 0, 0, 0.4)",LR="#A1A1AA",NR="#FFFFFF",bs=28,bh=22,Ch=4,DR=[new Path2D("M16.729 18.7917C17.1087 18.7916 17.4167 19.0993 17.4167 19.479C17.4167 19.8587 17.1091 20.1666 16.7294 20.1667L4.8127 20.1701C4.433 20.1702 4.125 19.8625 4.125 19.4828C4.125 19.1031 4.43261 18.7952 4.8123 18.7951L16.729 18.7917Z"),new Path2D("M10.6775 1.84417L10.7708 1.83789C11.1189 1.83789 11.4065 2.09653 11.4521 2.4321L11.4583 2.52539L11.4574 15.07L14.8691 11.6597C15.1132 11.4156 15.4951 11.3935 15.7643 11.5932L15.8414 11.6598C16.0854 11.9039 16.1076 12.2858 15.9078 12.5549L15.8413 12.632L11.2601 17.2123C11.0161 17.4562 10.6344 17.4785 10.3653 17.279L10.2882 17.2126L5.7017 12.6323C5.43303 12.364 5.43273 11.9287 5.70103 11.6601C5.94494 11.4158 6.32687 11.3934 6.59615 11.5929L6.6733 11.6594L10.0824 15.0636L10.0833 2.52539C10.0833 2.17734 10.342 1.88969 10.6775 1.84417L10.7708 1.83789L10.6775 1.84417Z")];class cm extends Fo{constructor({id:e,position:n,size:o}){const i=new Ue(o.h,o.w);super({id:e,position:n,size:o,uncroppedSize:i,type:Mt.BOARD,fillColor:"#FFFFFF"}),this.isActive=!1}isInPill(e){const n=this.getFullBBox(),o=bs*this.uiScale;return new In({position:n.topLeft().subtract(new Re(0,o+Ch*this.uiScale)),size:new Ue(o,o)}).inBox(e)}_renderPill(e){const o=this.bbox().topLeft();e.fillStyle=this.isActive?"#FFF":fl,e.lineWidth=this.uiScale*1;const i=1*this.uiScale,a=bs*i,s=6*this.uiScale,c=o.y-a-Ch*this.uiScale;e.strokeStyle=fl,e.fillStyle="rgba(255, 255, 255, 0.20)",e.beginPath(),e.roundRect(o.x,c,a,a,[s,s,s,s]),e.fill();const d=new DOMMatrix;d.a=i,d.b=0,d.c=0,d.d=i,d.e=o.x+(bs-bh)*this.uiScale/2,d.f=c+(bs-bh)*this.uiScale/2;const u=new Path2D;DR.forEach(h=>{u.addPath(h,d)}),e.fillStyle=LR,(this.isActive||this.hover==="CLICK")&&(e.fillStyle=NR,e.shadowColor="#000",e.shadowBlur=1,e.shadowOffsetX=.5,e.shadowOffsetY=.5),e.beginPath(),e.fill(u),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}render(e,n){if(n.hideUI)return;const o=this.bbox(),i=o.topLeft(),a=o.bottomRight();if(this.isActive){const s=Jt;e.beginPath(),e.fillStyle=BR,e.rect(-s,-s,2*s,s+i.y),e.rect(-s,i.y,s+i.x,o.height()),e.rect(a.x,i.y,2*s,o.height()),e.rect(-s,a.y,2*s,2*s),e.fill()}this.isActive||this._renderPill(e),e.beginPath(),e.lineWidth=this.uiScale*1,e.strokeStyle=fl,e.lineJoin="miter",e.rect(i.x,i.y,o.width(),o.height()),e.stroke()}}const ga=class ga extends Fo{constructor({id:e,name:n,position:o,radius:i,borderPosition:a="center",borderColor:s="black",borderLineWidth:c=1,fillColor:d="transparent"}){super({id:e,name:n,type:Mt.ELLIPSE,position:o,size:i.multiply(2),uncroppedSize:i.multiply(2),borderPosition:a,borderColor:s,borderLineWidth:c,fillColor:d,radius:i})}defaultName(){return`Ellipse ${ga.defaultNameIdx++}`}updatePositionAndSize(){this.data.radius!==void 0&&(this.data.size=this.data.radius.multiply(2))}render(e){this.data.visible&&(this.renderEnter(e),this.renderContent(e),this.renderExit(e))}renderContent(e){!this.data.fillColor||!this.data.borderColor||!this.data.radius||(e.beginPath(),e.ellipse(this.data.position.x+this.data.radius.w,this.data.position.y+this.data.radius.h,Math.max(this.data.radius.w,0),Math.max(this.data.radius.h,0),this.data.rotation??0,0,2*Math.PI),e.closePath(),this.fillCheckered||this.data.fillColor==="magic"?e.fillStyle=this.createInpaintingGradient(e):e.fillStyle=this.data.fillColor,e.fill(),e.strokeStyle=this.data.borderColor,e.lineWidth=this.data.borderLineWidth??1,e.stroke())}};ke(ga,"defaultNameIdx",1);let ac=ga;const ma=class ma extends Fo{constructor({id:n,name:o,position:i,size:a,position2:s,borderPosition:c="center",borderColor:d="black",borderLineWidth:u=1,fillColor:h="transparent",allowedAspects:p=new Set,visible:g,erase:m,zIndex:v}){let x=a,y=i;if(!x){if(!s)throw new Error("One of `size` or `position2` must be specified.");x=s.subtract(y).as_hw().abs(),y=y.min(s)}const _=new Ue(x.h,x.w);super({id:n,name:o,type:Mt.RECT,position:y,size:x,uncroppedSize:_,borderPosition:c,borderColor:d,borderLineWidth:u,fillColor:h,erase:m,zIndex:v,visible:g});ke(this,"allowedAspects",new Set);this.allowedAspects=p}defaultName(){return`Rectangle ${ma.defaultNameIdx++}`}};ke(ma,"defaultNameIdx",1);let er=ma;const gl=5,xa=class xa extends Fo{constructor({id:n,name:o,positions:i=[],borderColor:a="transparent",fillColor:s="transparent",strokeColor:c="black",strokeLasso:d=!1,strokeLineWidth:u=gl,strokeType:h="quadratic",erase:p=!1,zIndex:g}){const m=Re.minX(i),v=Re.minX(i),x=Re.maxX(i),y=Re.maxY(i),_=new Ue(Math.max(y-v,10),Math.max(x-m,10)),w=new Ue(_.h,_.w),I=new Re((m+x)/2,(v+y)/2);super({id:n,name:o,type:Mt.STROKE,position:I,size:_,uncroppedSize:w,borderColor:a,fillColor:s,borderLineWidth:1,positions:i,strokeColor:c,strokeLasso:d,strokeLineWidth:u,strokeType:h,erase:p,zIndex:g});ke(this,"strokeCheckered",!1);ke(this,"strokeLineCap","round");ke(this,"strokeLineJoin","round")}defaultName(){return`Stroke ${xa.defaultNameIdx++}`}pushPosition(n){var u;this.data.positions===void 0&&(this.data.positions=[]);const o=.1*(this.data.strokeLineWidth||gl*this.uiScale),i=(u=this.data.positions)==null?void 0:u.at(-1);if(i&&n.subtract(i).length()<o)return;this.data.positions.push(n);const a=Re.minX(this.data.positions),s=Re.minY(this.data.positions),c=Re.maxX(this.data.positions),d=Re.maxY(this.data.positions);this.data.size=new Ue(Math.max(d-s,10),Math.max(c-a,10)),this.data.position=new Re(a,s)}updatePositionAndSize(){if(this.data.positions===void 0)return;const n=Re.minX(this.data.positions),o=Re.minY(this.data.positions),i=Re.maxX(this.data.positions),a=Re.maxY(this.data.positions);this.data.size=new Ue(Math.max(a-o,10),Math.max(i-n,10)),this.data.position=new Re(n,o)}setPosition(n){var i;const o=n.subtract(this.data.position);super.setPosition(n),(i=this.data.positions)==null||i.forEach(a=>{a.x+=o.x,a.y+=o.y})}renderFill(){}renderContent(n,o){const i=this.data.positions;if(!i||i.length===0)return;let a=this.data.strokeLineWidth??gl;this.data.strokeLasso&&this.inCreation&&(a=this.uiScale*2),n.lineWidth=a;const s=i[0];if(n.beginPath(),n.moveTo(s.x,s.y),n.lineCap=this.strokeLineCap,n.lineJoin=this.strokeLineJoin,i.length===1&&n.arc(s.x,s.y,0,0,2*Math.PI),i.length===2){const c=i[1];n.lineTo(c.x,c.y)}if(i.length>2){const c=s.add(i[1]).multiply(.5);n.lineTo(c.x,c.y);for(let u=1;u<i.length-1;u++){const h=i[u],p=i[u+1],g=h.add(p).multiply(.5);n.quadraticCurveTo(h.x,h.y,g.x,g.y)}const d=i[i.length-1];n.lineTo(d.x,d.y)}o.maskDisplay?(n.fillStyle=this.createInpaintingGradient(n),n.strokeStyle=this.createInpaintingGradient(n)):o.hideUI?(n.fillStyle="black",n.strokeStyle="black"):(n.fillStyle=this.data.fillColor??"black",n.strokeStyle=this.data.strokeColor??"black"),this.data.strokeLasso?this.inCreation&&!this.data.erase?(n.stroke(),n.globalAlpha=.15,n.closePath(),n.fill(),n.globalAlpha=1):(n.closePath(),n.fill()):n.stroke()}};ke(xa,"defaultNameIdx",1);let lc=xa;const FR=t=>({...fr,...t,family:t.family??t.displayName??fr.family}),zR=bR.map(t=>FR(t)),J9=t=>`family=${t.family.replaceAll(" ","+")}:ital,wght@${vR.flatMap(n=>[`0,${n}`,`1,${n}`]).sort().join(";")}`,UR=[...zR].sort((t,e)=>t.displayName.localeCompare(e.displayName)),GR=t=>(UR.find(n=>n.family===t)??fr).genericName,HR=t=>{const{fontFamily:e,fontStyle:n,fontWeight:o}=t;if(!e)return null;const i=e??fr.family;return{displayName:i,genericName:GR(i),family:i,style:n??fr.style,weight:yR.get(o??Qg)??fr.weight}},dm=t=>{const e=document.fonts.keys(),n=[];let o=e.next();for(;!o.done;){const i=o.value;(!t||i.family===t||i.family===`"${t}"`)&&n.push(i),o=e.next()}return n},um=(t,e="normal")=>{if(!t)return[400];const n=dm(t).filter(i=>i.style===e);if(n.length<1)return[400];const o=new Set;return n.map(i=>i.weight).forEach(i=>{if(i==="auto")o.add(400);else if(i.includes(" ")){const[a,s]=i.split(" ").map(c=>parseInt(c,10));for(let c=a;c<s;c+=100)o.add(c)}else o.add(parseInt(i))}),[...o].sort((i,a)=>i<a?-1:1)},X9=(t,e="normal")=>um(t,e).includes(700),qR=t=>t?dm(t).some(e=>e.style==="italic"):!1,ml=.25,xl=1.2,va=class va extends Fo{constructor({id:n,position:o,size:i=new Ue(100,400),text:a="",textConfig:s=nm,zIndex:c}){super({id:n,type:Mt.TEXT,position:o,size:i,uncroppedSize:i,text:a,textConfig:s,zIndex:c});ke(this,"isActive",!1);ke(this,"selectionStart",null);ke(this,"selectionEnd",null);ke(this,"changeTime",0);ke(this,"textFormatting",{lines:[],lineHeights:[],lineXOffsets:[]});ke(this,"fontLastLoaded",!1);this.updateTextFormatting()}defaultName(){return`Text ${va.defaultNameIdx++}`}getInteractionArea(n){const o=super.getInteractionArea(n);return o&&["T","B"].includes(o)?"BOX":o}enterUI(){this.isActive=!0}exitUI(){this.isActive=!1,this.selectionStart=null,this.selectionEnd=null}updateTextFormatting(){const n=(h=0)=>{var p;return sr(Ii((p=this.data.textConfig)==null?void 0:p.segmentConfig,{start:h,end:h+1})).textSize},o=n(0)*ml,i=SR({text:this.data.text??"",maxWidth:this.data.size.w-o*2,getFontNormString:h=>this.getFontNormString(h),getFontSize:n}),a=[],s=[];let c=0,d=0;i.forEach(h=>{if(h.text.length===0){const v=xl*n(Math.max(0,c-1));a.push(v),d+=v,c+=0;return}const p=h.graphemePositions.map((v,x)=>{var _;return v.x===(((_=h.graphemePositions[x-1])==null?void 0:_.x)??0)&&h.graphemePositions.length>1?0:n(c+v.index)}),g=Math.max(...p),m=xl*g;a.push(m),d+=m,c+=h.text.length});const u=n(0);this.data.size.h=Math.max(2*o+d,u),i.forEach(h=>{var v,x;const p=[...h.graphemePositions].reverse().find(y=>{const _=h.text[y.index];return _!==" "&&_!=="​"}),g=(p==null?void 0:p.x)??0,m=this.data.size.w-o*2;((v=this.data.textConfig)==null?void 0:v.textAlign)==="center"?s.push((m-g)/2):((x=this.data.textConfig)==null?void 0:x.textAlign)==="right"?s.push(m-g):s.push(0)}),this.textFormatting={lines:i,lineHeights:a,lineXOffsets:s}}updatePositionAndSize(){this.updateTextFormatting()}getCursorPosition(n){var x,y,_;const o=this.getFullBBox(),i=sr(Ii((x=this.data.textConfig)==null?void 0:x.segmentConfig,{start:0,end:1})).textSize*ml,a=n.y-o.top()-i,{lines:s,lineHeights:c,lineXOffsets:d}=this.textFormatting;let u=0,h=0;for(let w=0;w<s.length;w++){const I=c[w];if(u+I>a)break;h++,u+=I}if(a<0)return 0;if(h>=s.length)return((y=this.data.text)==null?void 0:y.length)??0;const p=n.x-o.left()-i-d[h],g=s[h],m=s.slice(0,h).reduce((w,I)=>w+I.text.length,0);if(!g)return m;const v=g.graphemePositions;for(let w=0;w<v.length;w++){const I=g.graphemePositions[w],R=((_=g.graphemePositions[w-1])==null?void 0:_.x)??0;if((I.x+R)/2>p)return m+I.index}return m+g.text.replace("​","").length}getWordSegmentRange(n){const o=Zg(this.data.text??"");let i=0;for(let a=0;a<o.length;a++){const s=o[a],c=s.length;if(n>=i&&n<=i+c){const d=s.trim().length;return{start:i,end:i+d}}i+=s.length}return{start:n,end:n}}resetBlink(){this.changeTime=new Date().getTime()}getSelectionRange(){const{selectionStart:n,selectionEnd:o}=this,i=Math.min(n??0,o??0),a=Math.max(n??0,o??0);return{start:i,end:a}}render(n){var y;const{selectionStart:o,selectionEnd:i,uiScale:a}=this;n.font=this.getSizedFontString();const s=o!==null&&i!==null&&o!==i,{start:c,end:d}=this.getSelectionRange();let u=(new Date().getTime()-this.changeTime)%1e3<500;const h=sr(Ii((y=this.data.textConfig)==null?void 0:y.segmentConfig,{start:0,end:1})).textSize*ml;n.font=this.getSizedFontString();const{x:p,y:g}=this.data.position;n.textBaseline="alphabetic";const m=this.textFormatting.lines;let v=0,x=0;m.forEach((_,w)=>{var D;const I=this.textFormatting.lineHeights[w],R=p+h+this.textFormatting.lineXOffsets[w],S=(xl-1)*I,E=g+h+v,N=g+h+(v+I)-S/2;v+=I;const k=O=>this.getFontNormString(O+x),A=O=>{var L;return sr(Lr((L=this.data.textConfig)==null?void 0:L.segmentConfig,O+x)).textSize};if(s){const O=c-x,L=d-x;let P=1/0;O>=0&&O<=_.text.length&&(P=zr(_.text.substring(0,O),k,A).sum),O<=0&&(P=0);let G=1/0;L>=0&&L<=_.text.length&&(G=zr(_.text.substring(0,L),k,A).sum),L>=_.text.length&&(G=zr(_.text,k,A).sum),Number.isFinite(P)&&Number.isFinite(G)&&(n.fillStyle="#ACCEF7",n.fillRect(R+P,E,G-P,I))}if(u&&o!==null&&o===i){const O=o-x;if(O>=0&&O<_.text.length||O===_.text.length&&w===m.length-1){n.fillStyle=Lr((D=this.data.textConfig)==null?void 0:D.segmentConfig,Math.max(0,o-1)).textColor??"black";const L=zr(_.text.substring(0,O),k,A).sum,P=Math.max(1,1*a);n.fillRect(R+L-P/2,E,P,I),u=!1}}_.graphemePositions.forEach(({index:O,length:L},P,G)=>{var z,F;const B=_.text.substring(O,O+L),M=sr(Lr((z=this.data.textConfig)==null?void 0:z.segmentConfig,x+O));n.font=this.getSizedFontString(x+O),n.fillStyle=M.textColor,n.fillText(B,R+(((F=G[P-1])==null?void 0:F.x)??0),N)}),x+=_.text.length})}getFontString(n,o=0){var p;const i=sr(Lr((p=this.data.textConfig)==null?void 0:p.segmentConfig,o)),a=i.fontConfig.style,s=i.fontConfig.weight,c=`${n}px`,d=`"${i.fontConfig.family}", ${i.fontConfig.genericName}`,u=[a,s,c,d].join(" "),h=[a,s,c,xR].join(" ");try{return document.fonts.check(u)?u:h}catch{return h}}getSizedFontString(n=0){var i;const o=sr(Lr((i=this.data.textConfig)==null?void 0:i.segmentConfig,n));return this.getFontString(o.textSize,n)}getFontNormString(n=0){return this.getFontString(Zs,n)}scaleTextSize(n,o){var a;const i=structuredClone(n.data.textConfig);(a=i==null?void 0:i.segmentConfig)==null||a.forEach(s=>{s.textSize&&(s.textSize=s.textSize*o)}),this.data.textConfig=i}applyInputConfig(n,o){var g,m,v,x,y;if(this.data.textConfig&&(this.data.textConfig.textAlign=n.textAlign??"left"),o.start===o.end)return;const i=o.start===0&&o.end===(((g=this.data.text)==null?void 0:g.length)??0),{fontColor:a,fontSize:s}=n,c=ER((m=this.data.textConfig)==null?void 0:m.segmentConfig,i?void 0:o),d=HR(n);if(c){d&&(c.fontConfig=d),a&&(c.textColor=a),s&&(c.textSize=s);return}let u=!1;const h=Ii(((v=this.data.textConfig)==null?void 0:v.segmentConfig)??[],o),p={range:i?void 0:o};s&&(p.textSize=s,h.textSize!==s&&(u=!0)),d&&(p.fontConfig=d,JSON.stringify(h.fontConfig)!==JSON.stringify(d)&&(u=!0)),a&&(p.textColor=a,h.textColor!==a&&(u=!0)),u&&((y=(x=this.data.textConfig)==null?void 0:x.segmentConfig)==null||y.push(p))}};ke(va,"defaultNameIdx",1);let gr=va;const Fa=t=>{for(const e in t)t[e]===void 0&&delete t[e];return t},_h=t=>JSON.stringify(t,(n,o)=>n!=="scale"&&typeof o=="number"?Number(o.toFixed(4)):o),hm=(t,e)=>{let n;if(t.positions){n=[];for(let i=0;i<t.positions.length;i+=2)n.push(new Re(t.positions[i+0],t.positions[i+1]))}const o={...t,position:Re.deserialize(t.position),size:Ue.deserialize(t.size),uncroppedSize:t.uncroppedSize?Ue.deserialize(t.uncroppedSize):Ue.deserialize(t.size),position2:t.position2?Re.deserialize(t.position2):void 0,radius:t.radius?Ue.deserialize(t.radius):void 0,positions:n};if(o.type===Mt.ELLIPSE)return new ac(o);if(o.type===Mt.IMAGE){const{requestId:i,responseId:a,imageIndex:s,assetId:c,generationType:d,imageId:u,id:h}=o;if(!e.hasEntry(h)){const g=new Image;e.setImage(h,g),e.updateImageMeta(h,{requestId:i,responseId:a,imageIndex:s,assetId:c,imageId:u,generationType:d})}return new Hi(o,{getImage:e.getImage,getImageMeta:e.getImageMeta})}else{if(o.type===Mt.RECT)return new er(o);if(o.type===Mt.BOARD)return new cm(o);if(o.type===Mt.STROKE)return new lc(o);if(o.type===Mt.TEXT)return new gr(o)}return new Fo(o)},ya=class ya extends Fo{constructor({id:n,name:o,position:i,size:a,uncroppedSize:s,cropInsets:c,scaledCropInsets:d,assetId:u,requestId:h,responseId:p,zIndex:g,imageIndex:m,generationType:v,imageId:x},{getImage:y,getImageMeta:_}){super({id:n,assetId:u,requestId:h,responseId:p,name:o,type:Mt.IMAGE,position:i??new Re(0,0),size:a??new Ue(1024,1024),uncroppedSize:s??new Ue(1024,1024),cropInsets:c,scaledCropInsets:d,borderLineWidth:1,zIndex:g,imageIndex:m,generationType:v,imageId:x});ke(this,"isLoading",!1);this.getImage=y,this.getImageMeta=_}getSerializedData(){const n=super.getSerializedData(),o=this.getImageMeta(this.data.id),{requestId:i,responseId:a,assetId:s,imageIndex:c,generationType:d,imageId:u}=o;return Fa({...n,requestId:i,responseId:a,assetId:s,imageIndex:c,generationType:d,imageId:u})}defaultName(){return`Image ${ya.defaultNameIdx++}`}createLoadingGradient(n,o=!1){const i=.2*new Date().getTime()/1e3,a=this.data.position.add(this.data.size.as_xy().elementWiseMultiply(new Re(.5,.5))),s=a.subtract(this.data.size.as_xy()),c=a.add(this.data.size.as_xy()),d=n.createLinearGradient(s.x,s.y,c.x,c.y),u=(h,p=1)=>`rgba(${h[0]}, ${h[1]}, ${h[2]}, ${p})`;if(o)d.addColorStop((0+i)%1,"rgba(61, 94, 255, 1)"),d.addColorStop((.05+i)%1,"rgba(154, 94, 237, 1)"),d.addColorStop((.1+i)%1,"rgba(200, 101, 219, 1)"),d.addColorStop((.15+i)%1,"rgba(229, 115, 204, 1)"),d.addColorStop((.2+i)%1,"rgba(246, 136, 194, 1)"),d.addColorStop((.25+i)%1,"rgba(255, 159, 189, 1)"),d.addColorStop((.3+i)%1,"rgba(255, 184, 193, 1)"),d.addColorStop((.5+i)%1,"rgba(255, 208, 206, 1)"),d.addColorStop((.65+i)%1,"rgba(61, 94, 255, 1)"),d.addColorStop((.7+i)%1,"rgba(255, 184, 193, 1)"),d.addColorStop((.75+i)%1,"rgba(255, 159, 189, 1)"),d.addColorStop((.8+i)%1,"rgba(246, 136, 194, 1)"),d.addColorStop((.85+i)%1,"rgba(229, 115, 204, 1)"),d.addColorStop((.9+i)%1,"rgba(200, 101, 219, 1)"),d.addColorStop((.95+i)%1,"rgba(154, 94, 237, 1)");else{const h=[220,220,220],p=[240,240,240];d.addColorStop((0+i)%1,u(h)),d.addColorStop((.2+i)%1,u(p)),d.addColorStop((.4+i)%1,u(h)),d.addColorStop((.6+i)%1,u(h)),d.addColorStop((.8+i)%1,u(p))}return d}renderHTMLElement(n,o){this.scalingRenderHTMLElement(n,o)}getAssetRequest(n,o){var I;const{id:i,assetId:a}=this.data;if(!a)return;const s=this.getFullBBox();if(!n.isBBoxMostlyInView(s,.05))return;const{quality:d}=this.getImageMeta(i);if(d==="detailed")return;const u=o.some(R=>s.overlapsBox(R)),h=n.getCameraViewBBox(),g=((I=this.getImage(i))==null?void 0:I.width)||1024,m=s.width()/h.width(),x=n.canvasWidth*m/g;let y="fast";const _=x>.1;if(u||x>1?y="detailed":_&&(y="balanced"),!(d==="balanced"&&(y==="balanced"||y==="fast"))&&!(d==="fast"&&y==="fast"))return{assetId:a,quality:y}}scalingRenderHTMLElement(n,o){const{left:i,right:a,top:s,bottom:c}=this.data.scaledCropInsets??{},d=Math.max(i??0,0),u=Math.max(a??0,0),h=Math.max(s??0,0),p=Math.max(c??0,0),{w:g,h:m}=this.data.size,{width:v,height:x}=o,y=0+d,_=0+h,w=v-u,I=x-p;n.drawImage(o,y,_,w-y,I-_,this.data.position.x,this.data.position.y,g,m)}legacyRenderHTMLElement(n,o){const{width:i,height:a}=o,{w:s,h:c}=this.data.size,{left:d,right:u,top:h,bottom:p}=this.data.cropInsets??{},g=Math.max(d??0,0),m=Math.max(u??0,0),v=Math.max(h??0,0),x=Math.max(p??0,0),y=Math.min(d??0,0),_=Math.min(u??0,0),w=Math.min(h??0,0),I=Math.min(p??0,0);let R=this.data.uncroppedSize??this.data.size;R.h===0&&R.w===0&&(R=this.data.size);const S=R.w-(y+_),E=R.h-(w+I),N=i/S,k=a/E,A=Math.min(N,k),D=-(S*A-i)/2,O=-(E*A-a)/2,L=g*A+D,P=v*A+O,G=S*A-(g+m)*A,B=E*A-(v+x)*A;n.drawImage(o,L,P,G,B,this.data.position.x,this.data.position.y,s,c)}renderContent(n,o){const{inpaintImage:i,genStage:a}=this.getImageMeta(this.data.id);let s=this.getImage(this.data.id);const c=s&&s.complete&&s.width>0;if(!c&&!o.ignoreLoading&&(n.fillStyle=this.createLoadingGradient(n,!!i),n.fillRect(this.data.position.x,this.data.position.y,this.data.size.w,this.data.size.h),s=i),!s)return;const{width:d}=s;if(this.isLoading||!(s.complete&&d!==0)){if(o.ignoreLoading)return;n.fillStyle=this.createLoadingGradient(n,!1),n.fillRect(this.data.position.x,this.data.position.y,this.data.size.w,this.data.size.h);return}this.renderHTMLElement(n,s),c&&a===Ft.INTERMEDIATE&&i&&this.renderHTMLElement(n,i)}};ke(ya,"defaultNameIdx",1);let Hi=ya;const pm=()=>{const{generationsApi:t}=l.useContext(ge),{data:e}=Ve(["getAvailableResolutions","V_1_5"],()=>t==null?void 0:t.getAvailableResolutions({modelVersion:"V_1_5"}),{staleTime:1/0,retry:3}),n=l.useMemo(()=>{const i=new Set;if(e){const{availableResolutions:a}=e,{basicResolutions:s,advancedResolutions:c,restrictedResolutions:d}=a,u=new Set(d?d.map(h=>h.aspectRatio):[]);if(s)for(const h of s)u.has(h.aspectRatio)||i.add(h);if(c)for(const h of c)u.has(h.aspectRatio)||i.add(h)}return i},[e]),o=l.useCallback(i=>[...n].sort((s,c)=>Math.abs(s.width/s.height-i)-Math.abs(c.width/c.height-i))[0],[n]);return{allowedAspectObjects:n,getClosetAspectRatioObject:o}},Ih="Your prompt doesn't seem to meet our content policy. Please try another.",cc=24,Y9=t=>{var X;const e=Ee(),{appendAction:n,setCanvasState:o,canvasState:i,canvasId:a,canvasTransactionIdMapRef:s,imageStore:c,contextWindowAspectRatioObject:d}=t,{getImage:u,getImageMeta:h,setImage:p,setImageSrc:g,updateImageMeta:m}=c,{generationsApi:v,canvasApi:x}=l.useContext(ge),{onGenerationSubmitRef:y,onGenerationRespondedRef:_,onPromptRejectedRef:w,inSessionGenerations:I,generationInput:R,addInProgressCanvasGeneration:S,markCanvasGenerationResponded:E,deleteInSessionGeneration:N,inflightRequestStateSynced:k}=l.useContext(ye),{setAlertContent:A}=l.useContext(Tn),D=l.useRef(new Set),O=l.useRef();l.useEffect(()=>{R.retry_inpaint_data||(O.current=void 0)},[R.retry_inpaint_data]);const L=l.useCallback((W,Y)=>`${W}-${Y}`,[]),{getClosetAspectRatioObject:P}=pm(),G=l.useCallback(W=>{o(Y=>{const{id:q,type:V,resolution:Q}=W,K=V==="inpaint"||V==="generate"&&O.current;let{h:ae,w:ce}=K&&O.current?O.current.size:Y.contextWindow.size();if(Q)if(ce=Q.width,ae=Q.height,V==="upscale"){const me=pS(ce,ae);ce=me.width,ae=me.height}else{const me=P(ce/ae);ce=me.width,ae=me.height}if(Y.getElement(q))return Y;const se=Y.copy();let H=se.contextWindow.position();return K&&O.current?H=O.current.position:(V==="generate"||V==="context_window_remix"||V==="upscale")&&(H=se.getAndMoveToGenerationPosition()),O.current=void 0,new Array(K||V==="upscale"?1:4).fill(0).forEach((me,ne)=>{const ue=ne,fe=0,Se=L(q,ne),je=new Hi({id:Se,position:new Re(ue*(ce+cc),fe*ae).add(H),size:new Ue(ae,ce),uncroppedSize:new Ue(ae,ce),imageIndex:ne,generationType:V},{getImage:u,getImageMeta:h});c.updateImageMeta(Se,{imageIndex:ne,generationType:V}),se.addElement(je)}),n("GENERATE_IMAGE",se),se})},[n,L,P,u,h,c,o]),B=l.useCallback(W=>{const{timestampString:Y,requestId:q,imageIndex:V}=W,Q=L(Y,V);m(Q,{requestId:q,imageIndex:V})},[L,m]),M=l.useCallback(W=>{if(!x)return;const{responseId:Y,elementId:q}=W;x.postAddKnownAssetToCanvas({canvasId:a,postAddKnownAssetToCanvasRequest:{assetType:"RESPONSE",assetId:Y}}).then(V=>{s.current.set(a,V.currentTransactionId),o(Q=>{const K=Q.getElement(q);return K&&m(K.data.id,{assetId:V.canvasAsset.canvasAssetId}),Q})}).catch(()=>e({eventKey:"CANVAS_ADD_KNOWN_ASSET_ERROR"}))},[x,a,o,e,m,s]),z=l.useCallback(W=>{var H,me,ne,ue,fe;const{inSessionGeneration:Y,imageIndex:q}=W,V=String(Y.data.timestamp),Q=Y.data.generation.request_id??"",K=Y.stage,ae=(ue=(ne=(me=(H=Y.data)==null?void 0:H.generation)==null?void 0:me.responses)==null?void 0:ne[q])==null?void 0:ue.response_id,ce=Y.data.generation.latest_intermediate_image_seconds,ve=L(V,q);let se=u(ve);if(se||(se=new Image,p(ve,se)),ae&&K==="DONE"){if(D.current.has(ae))return;D.current.add(ae);const{generationType:Se}=c.getImageMeta(ve);if(Se==="inpaint"){const je=(fe=Y.data.generation.responses)==null?void 0:fe.findIndex(qe=>qe.highest_fidelity);if(je!==void 0&&je>=0){const De=Y.data.generation.responses[je].response_id;g(ve,Pt(De,"detailed","response"),()=>{const Ye=c.getImage(ve);m(ve,{genStage:Ft.DONE,originalElementHeight:Ye==null?void 0:Ye.height,originalElementWidth:Ye==null?void 0:Ye.width})}),m(ve,{requestId:Q,responseId:De,imageIndex:je}),M({responseId:De,elementId:ve})}}else g(ve,Pt(ae,"detailed","response"),()=>{const je=c.getImage(ve);m(ve,{genStage:Ft.DONE,originalElementHeight:je==null?void 0:je.height,originalElementWidth:je==null?void 0:je.width})}),m(ve,{requestId:Q,responseId:ae}),M({responseId:ae,elementId:ve})}else Q&&K==="INTERMEDIATE"&&ce!==void 0&&(g(ve,Na(Q,ce,q)),m(ve,{genStage:Ft.INTERMEDIATE}))},[L,u,p,c,g,m,M]),F=l.useRef(!1);l.useEffect(()=>{F.current=!1},[a]),l.useEffect(()=>{F.current||!k||!a||!i.hydratedCanvasId||i.hydratedCanvasId!==a||(o(W=>{const Y=W.copy(),q=Y.getAllElements().filter(Q=>{const K=h(Q.data.id)??{};return!!K.requestId&&!K.assetId});if(!q.length)return W;const V=Ut.groupBy(q,Q=>{var K;return(K=h(Q.data.id))==null?void 0:K.requestId});for(const Q in V)ud(Q).then(K=>{V[Q].forEach(ce=>{var H,me;const{imageIndex:ve}=h(ce.data.id)??{},se=(me=(H=K==null?void 0:K.responses)==null?void 0:H[ve??0])==null?void 0:me.response_id;if(se)u(ce.data.id)&&g(ce.data.id,Pt(se,"detailed","response")),m(ce.data.id,{responseId:se}),M({elementId:ce.data.id,responseId:se});else{const ne=I.find(fe=>fe.data.generation.request_id===Q);if(!ne)return;const ue=L(ne.data.timestamp.toString(),ve??0);u(ue)||p(ue,new Image),m(ue,h(ce.data.id)??{}),ce.data.id=ue}})});return Y}),F.current=!0)},[a,i,M,L,u,h,I,k,o,p,g,m]),l.useEffect(()=>{I.forEach(W=>{[0,1,2,3].forEach(Y=>{z({inSessionGeneration:W,imageIndex:Y})})})},[z,I]);const T=l.useCallback(W=>({prompt:W,magicPromptOption:R.use_autoprompt,styleType:R.style_expert?wm.get(R.style_expert):ar.Auto,_private:!!R.private,resolution:d,model:"V_1_5",tileType:void 0,seed:void 0,negativePrompt:void 0,samplingSpeed:Z2.Balanced}),[d,R.private,R.style_expert,R.use_autoprompt]),j=l.useCallback((W,Y)=>{N(W),o(q=>{const V=q.copy();return new Array(4).fill(0).forEach((Q,K)=>{const ae=L(String(W),K);V.deleteElement(ae)}),V}),Y!=null&&Y.failureMessage?A(r.jsx(ic,{children:r.jsx(sc,{children:Y.failureMessage})}),{backgroundColor:"#27272A"}):A(r.jsx(ic,{children:r.jsx(sc,{children:"Something went wrong. Please let us know."})}),{backgroundColor:"#27272A"})},[N,L,A,o]),Z=l.useCallback(W=>{const{imageSrc:Y,maskSrc:q,timestamp:V}=W,Q=document.createElement("canvas"),K=Q.getContext("2d"),ae=new Image;ae.src=Y;const ce=new Image;ce.src=q;const ve=()=>{if(K&&ce.src&&ae.src&&ae.complete&&ce.complete){K.canvas.width=ae.width,K.canvas.height=ae.height,K.drawImage(ce,0,0),K.globalCompositeOperation="source-in",K.drawImage(ae,0,0);const se=new Image;se.src=Q.toDataURL("image/png"),[0,1,2,3].forEach(H=>{const me=L(String(V),H);m(me,{inpaintImage:se})})}};ae.onload=()=>{ve(),URL.revokeObjectURL(ae.src)},ce.onload=()=>{ve(),URL.revokeObjectURL(ce.src)}},[L,m]);l.useEffect(()=>(y.current=W=>{var Y,q,V;O.current&&Z({imageSrc:(Y=O.current)==null?void 0:Y.imageSrc,maskSrc:(q=O.current)==null?void 0:q.maskSrc,timestamp:W.generationTimestamp}),G({id:String(W.generationTimestamp),type:((V=W.request.parent)==null?void 0:V.type)==="SUPER_RES"?"upscale":"generate",resolution:W.request.resolution})},_.current=W=>{const{generationTimestamp:Y,requestId:q}=W;new Array(4).fill(0).forEach((V,Q)=>{B({timestampString:Y.toString(),requestId:q,imageIndex:Q})})},w.current=W=>{j(W.generationTimestamp,{failureMessage:Ih})},()=>{y.current=null,_.current=null,w.current=null}),[G,i.contextWindow.element.data.position.x,i.contextWindow.element.data.position.y,i.contextWindow.element.data.size.h,i.contextWindow.element.data.size.w,j,B,_,y,w,Z]);const ee=l.useCallback((W,Y)=>{Y?(E(W,Y),Y.requestId?B({timestampString:W.toString(),requestId:Y.requestId,imageIndex:0}):Y.rejectedPromptId&&j(W,{failureMessage:Ih})):j(W)},[j,E,B]),te=l.useCallback(async W=>{var ae;const{imageFile:Y,prompt:q}=W,V=T(q);if(!V)return;const Q={...V,colorPalette:R.color_palette,imageWeight:((ae=R.variation_input)==null?void 0:ae.image_weight)??50},K=S({request:Q});G({id:String(K),type:"context_window_remix"});try{const ce=await(v==null?void 0:v.postRemixImageFromFile({imageRequest:Q,imageFile:Y}));ee(K,ce)}catch{e({eventKey:"CANVAS_REMIX_REUQEST_ERROR"}),j(K)}},[G,S,R.color_palette,(X=R.variation_input)==null?void 0:X.image_weight,v,T,j,ee,e]),$=l.useCallback(async W=>{const{imageFile:Y,mask:q,prompt:V}=W,Q=T(V);if(!Q)return;const K=S({request:Q});Z({imageSrc:URL.createObjectURL(Y),maskSrc:URL.createObjectURL(q),timestamp:K}),G({id:String(K),type:"inpaint"});try{const ae=await(v==null?void 0:v.postInpaint({imageRequest:Q,imageFile:Y,mask:q}));ee(K,ae)}catch(ae){if(e({eventKey:"CANVAS_MAGIC_FILL_REUQEST_ERROR"}),ae instanceof Yr){try{const ce=await ae.response.json(),ve=Y2(ce);j(K,ve)}catch{j(K)}return}j(K)}},[G,S,v,T,j,ee,Z,e]);return{handleRemixGeneration:te,handleInpaintGeneration:$,retryMagicFillCanvasDataRef:O}},WR="rgba(0, 0, 0, 0.40)";class $R{constructor({size:e,position:n,allowedAspects:o,currentAspectRatio:i}){ke(this,"placementInitialized",!1);this.element=this.createContextWindowElement(n,e??new Ue(1024,1024),o),this.allowedAspects=o,this.currentAspectRatio=i}elementId(){return this.element.data.id}position(){return this.element.data.position}setPosition(e){this.element.data.position=e,this.element.data.position.x=Math.round(e.x),this.element.data.position.y=Math.round(e.y)}setCenterPosition(e){this.element.data.position=e.subtract(this.element.data.size.multiply(.5).as_xy())}size(){return this.element.data.size}setSize(e){this.element.data.size=e,this.element.data.size.w=Math.round(e.w),this.element.data.size.h=Math.round(e.h)}fitBBox(e){const n=e.size.w/e.size.h,{allowedAspects:o}=this,i=[...o].sort((a,s)=>Math.abs(a-n)>Math.abs(s-n)?1:-1)[0];if(i>n){const a=e.size.w/i,s=e.size.h-a;e.position.y+=s/2,e.size.h=a}else{const a=e.size.h*i,s=e.size.w-a;e.position.x+=s/2,e.size.w=a}this.setPosition(e.position),this.setSize(e.size)}createContextWindowElement(e,n,o){return new er({name:"Context window",position:e,size:n,borderLineWidth:4,borderPosition:"center",allowedAspects:new Set(o)})}overlapsContent(e){return e.getCanvasElements().some(n=>n.getFullBBox().overlapsBox(this.element.getFullBBox()))}containedByImage(e){return e.getCanvasElements().some(n=>n.getFullBBox().overlapsBox(this.element.getFullBBox()))}contextWindowBorderGradient(e){const n=this.element.bbox();return xd(e,n)}renderOverlay(e){const n=this.element.getFullBBox();e.save(),e.fillStyle=WR;const o=new Path2D;o.rect(-ut,-ut,ut*2,ut+n.top()),o.rect(-ut,n.bottom(),ut*2,ut*2),o.rect(-ut,-ut,ut+n.left(),2*ut),o.rect(n.right(),-ut,ut-n.right(),2*ut),e.clip(o),e.fillRect(-ut,-ut,2*ut,2*ut),e.restore()}render(e){this.renderOverlay(e),this.element.borderGradient=this.contextWindowBorderGradient(e),this.element.render(e,{})}}const wa=class wa extends Fo{constructor(){super({position:new Re(0,0),size:new Ue(0,0),uncroppedSize:new Ue(0,0),type:Mt.MASK_INVERT})}defaultName(){return`Invert ${wa.defaultNameIdx++}`}renderFill(){}};ke(wa,"defaultNameIdx",1);let dc=wa;class cr{constructor({id:e,name:n="",elements:o=[],visible:i=!0}){this.data={id:e||Yg(),name:n,elements:o,visible:i}}static deserialize(e,n){return new cr({...e,elements:e.elements.map(o=>hm(o,n))})}getSerializedData(){return Fa({id:this.data.id,name:this.data.name,elements:this.data.elements.map(e=>e.getSerializedData()),visible:this.data.visible})}elementsSortedByZIndex(){return this.data.elements.slice().sort((n,o)=>n.zIndex()-o.zIndex())}maxZIndex(){return Math.max(...this.data.elements.map(e=>e.zIndex()))}minZIndex(){return Math.min(...this.data.elements.map(e=>e.zIndex()))}render(e,n){const o=this.data.id===Mo,i={hideUI:n.hideUI,ignoreBorder:n.hideUI,ignoreLoading:n.hideUI};this.elementsSortedByZIndex().forEach(a=>{const s={...i,maskDisplay:n.maskBrushCreation&&o&&a.inCreation};if(n.maskBrushCreation&&(!o||!a.inCreation)||n.skipMaskCreation&&o&&a.inCreation&&!a.data.erase)return;const c=e.globalCompositeOperation;if(a instanceof dc){e.globalCompositeOperation="source-out";const d=new er({position:new Re(-ut,-ut),size:new Ue(2*ut,2*ut)});d.data.fillColor="rgba(0, 0, 0, 1)",d.renderFill(e,s),e.globalCompositeOperation=c;return}a.data.erase&&!n.maskBrushCreation&&(e.globalCompositeOperation="destination-out"),a.render(e,s),e.globalCompositeOperation=c})}copy(){return es.cloneDeep(this)}}const ut=1e5,Mo="global-mask-layer";class vd{constructor(e,n){ke(this,"camera",new gR);var o,i,a,s,c;this.data={dimension:((o=e==null?void 0:e.data)==null?void 0:o.dimension)??new Ue(1024,1024),backgroundColor:((i=e==null?void 0:e.data)==null?void 0:i.backgroundColor)??"#FFF",layers:((a=e==null?void 0:e.data)==null?void 0:a.layers)??[],boards:((s=e==null?void 0:e.data)==null?void 0:s.boards)??[],config:((c=e==null?void 0:e.data)==null?void 0:c.config)??{}},this.contextWindow=new $R({size:e==null?void 0:e.contextWindowOptions.contextWindowSize,position:this.data.dimension.multiply(-.5).as_xy(),allowedAspects:(e==null?void 0:e.contextWindowOptions.contextWindowAllowedAspects)??new Set([1]),currentAspectRatio:(e==null?void 0:e.contextWindowOptions.currentAspectRatio)??"1:1"}),this.activeLayerId=e==null?void 0:e.activeLayerId,this._updateUiScale(),this.hydratedCanvasId=n}_updateUiScale(){const e=1/this.camera.scale;this.data.layers.forEach(n=>{n.data.elements.forEach(o=>{o.uiScale=e})}),this.data.boards.forEach(n=>{n.uiScale=e}),this.contextWindow.element.uiScale=e}static deserialize(e,n){var s,c;const o=e.serializedData.layers.filter(d=>d.id!==Mo).map(d=>cr.deserialize(d,e.imageStore));o.length===0&&o.push(new cr({name:"Base Layer",elements:[]}));const i=(e.serializedData.boards??[]).map(d=>hm(d,e.imageStore));return new vd({contextWindowOptions:e.contextWindowOptions,data:{...e.serializedData,dimension:Ue.deserialize(e.serializedData.dimension),layers:o,boards:i},activeLayerId:(c=(s=o.filter(d=>d.data.id!==Mo)[0])==null?void 0:s.data)==null?void 0:c.id},n)}getSerializedData(){return Fa({dimension:this.data.dimension.getSerializedData(),backgroundColor:this.data.backgroundColor,boards:this.data.boards.map(e=>e.getSerializedData()),layers:this.data.layers.filter(e=>e.data.id!==Mo).map(e=>e.getSerializedData()),config:this.data.config})}getMaskLayer(){const e=this.data.layers.find(o=>o.data.id===Mo);if(e)return e;const n=new cr({id:Mo});return this.data.layers.push(n),n}getLayer(e){return this.data.layers.find(n=>n.data.id===e)}getElementLayer(e){return this.data.layers.find(n=>n.data.elements.some(o=>o.data.id===e))}getLastLayer(){const e=[...this.data.layers].reverse().find(o=>o.data.id!==Mo);if(e)return e;const n=new cr({});return this.data.layers.push(n),this.activeLayerId=n.data.id,n}getActiveLayer(){if(!this.activeLayerId)return this.getLastLayer();const e=this.data.layers.find(o=>o.data.id===this.activeLayerId);if(e)return e;const n=new cr({});return this.data.layers.push(n),this.activeLayerId=n.data.id,n}getElement(e){if(e===this.contextWindow.element.data.id)return this.contextWindow.element;const n=this.data.boards.find(o=>o.data.id===e);return n||this.data.layers.flatMap(o=>o.data.elements).find(o=>o.data.id===e)}getActiveBoard(){return this.data.boards.find(e=>e.data.id===this.activeBoardId)}getAssetRequests(){var o;const e=[],n=(o=this.getActiveBoard())==null?void 0:o.getFullBBox();return n&&e.push(n),e.push(this.contextWindow.element.getFullBBox()),this.getAllElements().filter(i=>i instanceof Hi).map(i=>{const a=i.getAssetRequest(this.camera,e);if(a)return{id:i.data.id,...a}}).filter(i=>i!==void 0)}setActiveBoardId(e){const n=this.getActiveBoard();n&&(n.isActive=!1),this.activeBoardId=e;const o=this.getActiveBoard();o&&(o.isActive=!0)}deleteElement(e){this.data.layers.forEach(n=>{n.data.elements=n.data.elements.filter(o=>o.data.id!==e)})}getCanvasElements(){const e=[];return this.data.layers.filter(n=>n.data.id!==Mo).forEach(n=>{n.data.elements.forEach(o=>{e.push(o)})}),e}getCanvasImageElements(){return this.getCanvasElements().filter(e=>e.data.type===Mt.IMAGE)}getAllElements(){const e=[];return this.data.layers.forEach(n=>{n.data.elements.forEach(o=>{e.push(o)})}),e}getMaskElements(){return this.getMaskLayer().data.elements}setElement(e,n){n.uiScale=1/this.camera.scale,this.data.layers.some(o=>o.data.elements.some((i,a)=>i.data.id!==e?!1:(o.data.elements[a]=n,!0)))}addElement(e,n){e.uiScale=1/this.camera.scale,e.data.zIndex=this.largestZIndex()+(e.zIndex()??0);let o;n&&(o=this.data.layers.find(i=>i.data.id===n)),o||(o=this.getLastLayer()),o.data.elements.push(e)}addMaskElement(e){const n=this.getMaskLayer();this.addElement(e,n.data.id)}clearMaskLayer(){const e=this.getMaskLayer();e.data.elements=[]}setCameraScale(e,n){this.camera.scale!==e&&(this.camera.setCameraScale(e,n),this._updateUiScale())}setCameraTranslate(e){this.camera.setCameraTranslate(e)}getMinimumBoundingBox(){const e=this.getCanvasElements().map(n=>n.getFullBBox());return In.maxMiniOverBoundingBoxes(e,0)}getAndMoveToGenerationPosition(){const{h:e,w:n}=this.contextWindow.size(),o=4*n+3*cc,i=this.camera.translate.subtract(new Re(o/2,e/2)),a=this.getCanvasElements().length===0?i:this.getMinimumBoundingBox().bottomLeft().add(new Re(0,cc)),s=new In({position:a,size:new Ue(e,o)});return this.camera.focusCameraIfOutOfView(s,1),a}largestZIndex(){return this.getCanvasElements().length===0?0:Math.max(...this.getCanvasElements().map(n=>n.data.zIndex??0))}renderBoards(e){this.data.boards.forEach(n=>{(n.isActive||this.data.config.alwaysDisplayBoards)&&n.render(e,{})})}renderDebug(e){e.fillStyle="rgba(0, 255, 0, 0.3)",e.fillRect(0,0,300,300)}copy(){return es.cloneDeep(this)}render(e,n={},o){const i=this.getMaskLayer(),a=this.data.layers.filter(c=>c.data.id!==i.data.id),s=!n.hideUI;if(a.forEach(c=>{c.render(e,{hideUI:n.hideUI})}),s&&this.renderBoards(e),n.showMaskUI&&o&&o.length>=2){const c=o[0],d=o[1];c.setTransform(e.getTransform()),d.setTransform(e.getTransform());const u=this.camera.getCameraViewBBox();c.globalCompositeOperation="source-over",i.render(c,{skipMaskCreation:!n.backgroundRemovalMask});const{canvasWidth:h,canvasHeight:p}=this.camera,g=this.contextWindow.element.getFullBBox(),m=g.intersection(u),v=e.getTransform(),x=new DOMPoint(m.left(),m.top()).matrixTransform(v),y=v.a*m.width(),_=v.d*m.height();if(n.showMaskBackgroundUI&&(a.forEach(w=>{w.render(d,{hideUI:!0})}),d.fillStyle="rgba(0, 0, 0, 1)",d.globalCompositeOperation="source-out",d.fillRect(u.left(),u.top(),u.width(),u.height()),c.drawImage(d.canvas,x.x,x.y,y,_,m.left(),m.top(),m.width(),m.height())),n.backgroundRemovalMask){d.globalCompositeOperation="source-over",OR(d,g),c.globalCompositeOperation="source-atop",c.drawImage(d.canvas,0,0,h,p,u.left(),u.top(),u.width(),u.height()),e.clearRect(m.left(),m.top(),m.width(),m.height());const w=this.getElement(n.backgroundRemovalElementId??"");w&&w.render(e,{hideUI:!0,ignoreLoading:!0})}else{const w=xd(c,u,.95,6);c.globalCompositeOperation="source-in",c.fillStyle=w,c.fillRect(u.left(),u.top(),u.width(),u.height())}c.globalCompositeOperation="source-over",n.showMaskOnlyInCtx?e.drawImage(c.canvas,x.x,x.y,y,_,m.left(),m.top(),m.width(),m.height()):e.drawImage(c.canvas,0,0,h,p,u.left(),u.top(),u.width(),u.height()),s&&i.render(e,{maskBrushCreation:!0})}s&&n.showContextWindow&&this.contextWindow.render(e)}}class Q9{constructor(e,n,o,i,a){this.mouseEvent=e,this.position=n,this.isOverCanvas=a,this.cameraState=Ut.cloneDeep(o),this.targetElement=Ut.cloneDeep(i??null)}}let Vo=function(t){return t[t.BRUSH=0]="BRUSH",t[t.PAN=1]="PAN",t[t.ELLIPSE=2]="ELLIPSE",t[t.EYEDROP=3]="EYEDROP",t[t.GENERATE=4]="GENERATE",t[t.IMAGE=5]="IMAGE",t[t.INPAINT=6]="INPAINT",t[t.INPAINT_BRUSH=7]="INPAINT_BRUSH",t[t.INPAINT_ELLIPSE=8]="INPAINT_ELLIPSE",t[t.INPAINT_LASSO=9]="INPAINT_LASSO",t[t.INPAINT_RECT=10]="INPAINT_RECT",t[t.LASSO=11]="LASSO",t[t.RECT=12]="RECT",t[t.REMIX=13]="REMIX",t[t.SELECT=14]="SELECT",t[t.ADD_TEXT=15]="ADD_TEXT",t[t.UPSCALE=16]="UPSCALE",t[t.INITIAL_PLACEHOLDER=17]="INITIAL_PLACEHOLDER",t}({});const VR=new Set([Vo.INPAINT,Vo.INPAINT_BRUSH,Vo.INPAINT_ELLIPSE,Vo.INPAINT_LASSO,Vo.INPAINT_RECT]),Z9=t=>VR.has(t);class KR{constructor({type:e=Vo.INITIAL_PLACEHOLDER,mouseDownEvent:n=null,mouseUpEvent:o=null,appendAction:i}){ke(this,"selectedElementIds",new Set);ke(this,"startInteractionElements",new Map);ke(this,"resizeInlineDimension",null);ke(this,"activeColor","black");ke(this,"isMaskLayer",!1);ke(this,"showContextWindow",!1);ke(this,"mouseState","up");ke(this,"pan",!1);ke(this,"erase",!1);ke(this,"eyedropMode","none");this.type=e,this.mouseDownEvent=n,this.mouseUpEvent=o,this.appendAction=i}cancel(e){}render(e,n){}handleOnMouseDown(e,n){this.mouseDownEvent=e,this.mouseState="down"}handleOnDoubleClick(e,n){}handleArrow(e,n,o){}handleOnMouseUp(e,n){this.mouseUpEvent=e,this.mouseState="up"}handleOnMouseMove(e,n){var o;this.mouseOverTargetType=(o=e.targetElement)==null?void 0:o.data.type}handleContextMenu(e){}handleKeyDown(e,n){}isMovingElements(){return!1}isResizingElements(){return!1}_getSelectedBBox(e){if(!this.selectedElementIds.size)return null;let n=1/0,o=1/0,i=-1/0,a=-1/0;return[...this.selectedElementIds].forEach(s=>{const c=e(s);if(c){const d=c.getFullBBox().topLeft();o=Math.min(o,d.x),n=Math.min(n,d.y);const u=c.getFullBBox().bottomRight();a=Math.max(a,u.x),i=Math.max(i,u.y)}}),new In({position:new Re(o,n),size:new Ue(i-n,a-o),borderHitWidth:16})}getSelectedInitialBBox(){const e=n=>this.startInteractionElements.get(n);return this._getSelectedBBox(e)}getSelectedBBox(e){const n=o=>e.getElement(o);return this._getSelectedBBox(n)}syncToInput(e){}copy(){return Ut.cloneDeep(this)}}navigator.userAgent.match(/SAMSUNG|Samsung|SGH-[I|N|T]|GT-[I|N]|SM-[A|N|P|T|Z]|SHV-E|SCH-[I|J|R|S]|SPH-L/i);const uc=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,hc=uc||navigator.userAgent.includes("Mac"),Sh=t=>hc&&t.metaKey||!hc&&t.ctrlKey,eF=hc?"⌘":"Ctrl",JR="#D4D4D8",XR="white",YR="#E6E6E7",ba=class ba extends Fo{constructor({position:n,size:o,selected:i,uncroppedSize:a}){super({type:Mt.HANDLE,position:n,size:o,uncroppedSize:a});ke(this,"selected",!1);this.selected=i??!1}renderFill(n,o){if(o.hideUI)return;const i=this.bbox(),{x:a,y:s}=i.position,{w:c,h:d}=i.size;n.fillStyle=this.selected?YR:XR,n.setLineDash([]),n.beginPath(),n.roundRect(a,s,c,d,[c,c,c,c]),n.strokeStyle=JR,n.lineWidth=2*this.uiScale,n.stroke(),n.shadowColor="#000",n.shadowBlur=4,n.fill(),n.shadowBlur=0}defaultName(){return`Handle ${ba.defaultNameIdx++}`}};ke(ba,"defaultNameIdx",1);let ea=ba;const fm=f("IdeogramPink"),QR="#3F3F46";function ZR(t){const{element:e,ctx:n,area:o,onlyShowInteractionArea:i}=t,a=new Ue(e.borderUIWidth(),e.borderUIWidth()),s=e.getFullBBox();[{position:s.topLeft().subtract(a.multiply(.5).as_xy()),size:a,uncroppedSize:a,selected:o==="TL"},{position:s.topRight().subtract(a.multiply(.5).as_xy()),size:a,uncroppedSize:a,selected:o==="TR"},{position:s.bottomRight().subtract(a.multiply(.5).as_xy()),size:a,uncroppedSize:a,selected:o==="BR"},{position:s.bottomLeft().subtract(a.multiply(.5).as_xy()),size:a,uncroppedSize:a,selected:o==="BL"}].filter(d=>!i||d.selected).forEach(d=>{const u=new ea(d);u.uiScale=e.uiScale,u.render(n,{})})}function eT(t){const{element:e,ctx:n,area:o,onlyShowInteractionArea:i}=t,a=new Ue(2*e.borderUIWidth(),.5*e.borderUIWidth()),s=new Ue(.5*e.borderUIWidth(),2*e.borderUIWidth()),c=e.getFullBBox(),d={position:c.centerLeft().subtract(a.multiply(.5).as_xy()),size:a,uncroppedSize:a,selected:o==="L"},u={position:c.centerRight().subtract(a.multiply(.5).as_xy()),size:a,uncroppedSize:a,selected:o==="R"},h={position:c.centerTop().subtract(s.multiply(.5).as_xy()),size:s,uncroppedSize:s,selected:o==="T"},p={position:c.centerBottom().subtract(s.multiply(.5).as_xy()),size:s,uncroppedSize:s,selected:o==="B"},g=[];a.h*2<c.height()&&(g.push(d),g.push(u)),s.w*2<c.width()&&(t.noTopBottom||(g.push(h),g.push(p))),g.filter(m=>!i||m.selected).forEach(m=>{const v=new ea(m);v.uiScale=e.uiScale,v.render(n,{})})}function Rh(t){eT(t),ZR(t)}function vl(t,e){const n=t.getFullBBox(),{uiScale:o}=t,i=n.topLeft();if(e.lineJoin="miter",t.data.type===Mt.BOARD){const a=t.hover&&t.hover!=="BOX";e.lineWidth=(a?2:1)*o,e.strokeStyle="#FFF",e.strokeRect(i.x,i.y,n.width(),n.height()),e.setLineDash([4*o,4*o]),e.strokeStyle=QR,e.strokeRect(i.x,i.y,n.width(),n.height());return}e.strokeStyle=fm,e.setLineDash([]),e.lineWidth=1*o,e.strokeRect(i.x,i.y,n.width(),n.height())}function tT(t,e){if(t.inCreation)return;const n=t.getFullBBox(),{uiScale:o}=t,i=n.topLeft();e.lineJoin="miter",e.strokeStyle=fm,e.setLineDash([]),e.lineWidth=2*o,e.strokeRect(i.x,i.y,n.width(),n.height())}const nT=t=>{t.setTextInputConfig(e=>{const n=um(e.fontFamily);let o=Qg;return n.includes(700)&&(!e.fontWeight||e.fontWeight!=="Bold")&&(o="Bold"),{...e,fontWeight:o}})},oT=t=>{t.setTextInputConfig(e=>{const n=qR(e.fontFamily);let o="normal";return n&&(!e.fontStyle||e.fontStyle==="normal")&&(o="italic"),{...e,fontStyle:o}})},gm=(t,e)=>{if(!(t instanceof yd))return null;const n=t.selectedElementIds;if(n.size!==1)return null;const o=e.getElement([...n][0]);return o&&o.data.type===Mt.TEXT?o:null};function rT(t){return`#${t[0].toString(16).padStart(2,"0")}${t[1].toString(16).padStart(2,"0")}${t[2].toString(16).padStart(2,"0")}`}class iT extends KR{constructor({appendAction:n,type:o}){super({type:o,appendAction:n});ke(this,"movedElement",!1);ke(this,"resizedElement",!1)}handleOnMouseMoveDrag(n,o){const i=this.mouseDownEvent.position.unnormalized.subtract(n.position.unnormalized).multiply(1/o.camera.scale);o.setCameraTranslate(this.mouseDownEvent.cameraState.translate.add(i))}handleOnMouseMove(n,o){if(this.mouseState==="down"&&this.mouseDownEvent){this.handleOnMouseMoveDrag(n,o);return}}handleOnMouseUp(n,o){this.mouseUpEvent=n,this.mouseState="up"}}const mm=(t,e)=>{var i,a,s,c,d,u;const n={start:0,end:((i=t.data.text)==null?void 0:i.length)??0},o=Ii((a=t.data.textConfig)==null?void 0:a.segmentConfig,e?n:t.getSelectionRange());return{fontFamily:(s=o==null?void 0:o.fontConfig)==null?void 0:s.family,fontStyle:(c=o==null?void 0:o.fontConfig)==null?void 0:c.style,fontSize:o==null?void 0:o.textSize,fontColor:o==null?void 0:o.textColor,fontWeight:wR.get(((d=o==null?void 0:o.fontConfig)==null?void 0:d.weight)??0),textAlign:((u=t.data.textConfig)==null?void 0:u.textAlign)??"left"}},tF=t=>{const{toolState:e,canvasState:n,setCanvasState:o,setToolState:i,textareaRef:a}=t,[s,c]=l.useState(!1),[d,u]=l.useState({}),h=l.useMemo(()=>s?e instanceof yd&&e.selectInteraction==="text_edit":!1,[e,s]),p=l.useMemo(()=>gm(e,n),[e,n]);l.useEffect(()=>{if(!p)return;const v=mm(p,!0);u(v)},[p]),l.useEffect(()=>{a.current&&(h?a.current.focus():a.current.blur(),i(v=>v.copy()))},[h,i,a]);const g=l.useCallback(v=>{a.current&&(a.current.value=v)},[a]),m=l.useCallback((v,x)=>{a.current&&(a.current.selectionStart=Math.min(v,x),a.current.selectionEnd=Math.max(v,x))},[a]);return l.useEffect(()=>{i(v=>(o(x=>(v.syncToInput(x),x)),v))},[o,i,d]),{textInputConfig:d,setTextInputConfig:u,setHiddenText:g,setHiddenSelection:m,focusHiddenText:h,setFocusHiddenText:c}};class sT{constructor({textInputSync:e,textElement:n}){ke(this,"elementId",null);ke(this,"originalSerializedElement","");this.textInputSync=e,this.originalSerializedElement=JSON.stringify(n.getSerializedData()),this.elementId=n.data.id,n.enterUI();const o=n.data.text??"";e.setHiddenText(o),e.setHiddenSelection(0,o.length),n.selectionStart=0,n.selectionEnd=o.length,this.updateSyncConfig(n)}updateSyncConfig(e){const n=mm(e);this.textInputSync.setTextInputConfig(n)}exit(e,n){this.textInputSync.setFocusHiddenText(!1);const o=this.getTextElement(e);if(!o)return;if(o.exitUI(),o.data.text===""){e.deleteElement(o.data.id),n("DELETE",e);return}const i=JSON.stringify(o.getSerializedData());this.originalSerializedElement!==i&&n("EDIT_TEXT",e)}syncToInput(e){const n=this.getTextElement(e);if(n){const o=n.getSelectionRange();this.textInputSync.setTextInputConfig(i=>(n.applyInputConfig(i,o),n.updateTextFormatting(),i))}}getTextElement(e){return this.elementId?e.getElement(this.elementId)??null:null}handleDrag(e,n){if(!this.elementId)return;const o=n.getElement(this.elementId);if(o instanceof gr){const i=o.getCursorPosition(e.position.canonical);this.textInputSync.setHiddenSelection(o.selectionStart??0,i),o.selectionEnd=i,this.updateSyncConfig(o)}}handleOnMouseDown(e,n){var d;const o=this.getTextElement(n);if(!o)return;const i=e.mouseEvent.detail,a=o.getCursorPosition(e.position.canonical);let s=a,c=a;if(i===2){const u=o.getWordSegmentRange(a);s=u.start,c=u.end}i===3&&(s=0,c=((d=o.data.text)==null?void 0:d.length)??0),!(i>3)&&(this.textInputSync.setHiddenSelection(s,c),o.selectionStart=s,o.selectionEnd=c,o.resetBlink(),this.updateSyncConfig(o),e.mouseEvent.preventDefault())}handleOnTextChange(e,n,o){var h,p;const i=this.getTextElement(o);if(!i)return;const a=i.getSelectionRange(),s=e.length-(((h=i.data.text)==null?void 0:h.length)??0),c=kR(a,n,s);i.selectionStart=n.start,i.selectionEnd=n.end;const u=(((p=i.data.textConfig)==null?void 0:p.segmentConfig)??[]).map(g=>(g.range&&(c.rangeRemoved&&(g.range=RR(g.range,c.rangeRemoved)),c.rangeAdded&&g.range&&(g.range=TR(g.range,c.rangeAdded))),g));i.data.textConfig&&(i.data.textConfig.segmentConfig=u.filter(g=>!g.range||g.range.end>g.range.start)),i.data.text=e,i.resetBlink(),i.updateTextFormatting()}handleOnSelectionChange(e,n,o){const i=this.getTextElement(o);i&&(i.selectionStart=e,i.selectionEnd=n,i.resetBlink(),this.updateSyncConfig(i))}}const aT=(t,e)=>{const n=[],{x:o,y:i}=t.position,{w:a,h:s}=t.size;return e.forEach(c=>{const d=c.getFullBBox(),{x:u,y:h}=d.position,{w:p,h:g}=d.size,m=Math.max(u,u+p,o,o+a),v=Math.min(u,u+p,o,o+a);n.push({y:h,x1:v,x2:m}),n.push({y:h+g/2,x1:v,x2:m}),n.push({y:h+g,x1:v,x2:m});const x=Math.max(h,h+g,i,i+s),y=Math.min(h,h+g,i,i+s);n.push({x:u,y1:y,y2:x}),n.push({x:u+p/2,y1:y,y2:x}),n.push({x:u+p,y1:y,y2:x})}),n},lT=f("IdeogramPink"),Th=(t,e)=>{t.beginPath(),t.moveTo(e.x1,e.y),t.lineTo(e.x2,e.y),t.stroke()},Eh=(t,e)=>{t.beginPath(),t.moveTo(e.x,e.y1),t.lineTo(e.x,e.y2),t.stroke()},cT=(t,e,n,o)=>{n.lineWidth=1*o,n.lineCap="round",n.setLineDash([3*o,2*o]);const i=new Map,a=new Map;e==null||e.filter(s=>s.nearZero).forEach(s=>{if("y"in s){const c=i.get(s.y)??[];c.push(s),i.set(s.y,c)}if("x"in s){const c=a.get(s.x)??[];c.push(s),a.set(s.x,c)}}),n.strokeStyle=lT;for(const[s,c]of i){const d=[...c.map(g=>g.x1),...c.map(g=>g.x2)],u=Math.min(...d),h=Math.max(...d);u<t.center().x&&h<t.center().x?Th(n,{y:s,x1:h,x2:u}):Th(n,{y:s,x1:u,x2:h})}for(const[s,c]of a){const d=[...c.map(g=>g.y1),...c.map(g=>g.y2),t.top(),t.bottom()],u=Math.min(...d),h=Math.max(...d);u<t.center().y&&h<t.center().y?Eh(n,{x:s,y1:h,y2:u}):Eh(n,{x:s,y1:u,y2:h})}},dT=t=>{const{parentBBox:e,candidates:n,tolerance:o,yOffsetOverrides:i,xOffsetOverrides:a}=t,{w:s,h:c}=e.size,{x:d,y:u}=e.topLeft(),h=.001,p=n.filter(S=>"y"in S);let g=[],m=1/0,v=0;const x=i??[0,c/2,c];p.forEach(S=>{x.forEach(E=>{const N=S.y-(u+E),k=Math.abs(N);if(k<o){const A=Math.abs(m-k)<h;m-k>=h?(g=[S],m=k,v=N):A&&g.push(S)}})}),m<h&&g.forEach(S=>{S.nearZero=!0});const y=n.filter(S=>"x"in S);let _=[],w=1/0,I=0;const R=a??[0,s/2,s];return y.forEach(S=>{R.forEach(E=>{const N=S.x-(d+E),k=Math.abs(N);if(k<o){const A=Math.abs(w-k)<h;w-k>=h?(_=[S],w=k,I=N):A&&_.push(S)}})}),w<h&&_.forEach(S=>{S.nearZero=!0}),e.topLeft().add(new Re(I??0,v??0))},uT=t=>{const{initBBox:e,beforeSnapSize:n,resizeArea:o,getSnapResizePosition:i,allowedAspects:a}=t;if(!o)return n;const s=n.w-e.size.w,c=n.h-e.size.h,d=new Re(e.position.x+(im.has(o)?-s:0),e.position.y+(am.has(o)?-c:0)),u=new In({position:d,size:n}),h=u.position,g=i(u).subtract(h);let m=g;if(rm.has(o)){const x=Math.abs(g.x),y=Math.abs(g.y);let _=x>0,w=y>0;_&&w&&(_=x<y,w=!_),_?m=new Re(g.x,(["TL","BR"].includes(o)?1:-1)*(g.x*e.size.h)/e.size.w):w&&(m=new Re((["TL","BR"].includes(o)?1:-1)*(g.y*e.size.w)/e.size.h,g.y))}let v=new Re(n.w+(sm.has(o)?m.x:-m.x),n.h+(lm.has(o)?m.y:-m.y)).as_hw();if(a!=null&&a.size){const x=v.w/v.h;let y=0,_=1/0;[...a].forEach(w=>{const I=Math.abs(x-w);I<_&&(y=w,_=I)}),["T","B"].includes(o)?v=new Ue(v.w/y,v.w):v=new Ue(v.h,y*v.h)}return v},yl=(t,e)=>{const n=e.contextWindow.elementId(),o=e.getMaskElements();return[...t].every(i=>i===n||o.find(a=>a.data.id===i))},kh=64,hT=5,pT=new Set(["TL","TR","BL","BR","L","T","R","B"]);class yd extends iT{constructor({appendAction:n,imageStore:o,inputSync:i,type:a=Vo.SELECT}){super({type:a,appendAction:n});ke(this,"selectInteraction","none");ke(this,"textEditInteraction",null);ke(this,"startSelectedIds",new Set);ke(this,"mouseDragEvent",null);ke(this,"movedElement",!1);ke(this,"resizedElement",!1);ke(this,"interactActiveBoard",!1);ke(this,"snapConstraints",null);this.imageStore=o,this.inputSync=i}startSelectInteraction(n,o,i){var s;this.selectInteraction=n,n==="text_edit"&&i&&((s=this.inputSync)!=null&&s.text)&&(this.textEditInteraction=new sT({textInputSync:this.inputSync.text,textElement:i}),this.inputSync.text.setFocusHiddenText(!0),this.selectedElementIds.clear(),this.selectedElementIds.add(i.data.id)),this.startInteractionElements=new Map,[...this.selectedElementIds].forEach(c=>{const d=o.getElement(c);d&&this.startInteractionElements.set(d.data.id,d.copy())});const a=o.getActiveBoard();a&&this.interactActiveBoard&&this.startInteractionElements.set(a.data.id,a.copy()),this.startSelectedIds=new Set(this.selectedElementIds)}endSelectInteraction(n){var o;this.movedElement=!1,this.resizedElement=!1,(o=this.textEditInteraction)==null||o.exit(n,this.appendAction),this.textEditInteraction=null,this.selectInteraction="none",this.activeInteractionArea=void 0,this.startInteractionElements.clear(),this.resizeInlineDimension=null,this.snapConstraints=null,this.startSelectedIds.clear(),this.mouseDragEvent=null}syncToInput(n){var o;if(this.textEditInteraction)this.textEditInteraction.syncToInput(n);else{const i=gm(this,n);if(i){const a={start:0,end:((o=i.data.text)==null?void 0:o.length)??0};this.inputSync.text.setTextInputConfig(s=>(i.applyInputConfig(s,a),i.updateTextFormatting(),s))}}}cancel(n){var o;(o=this.inputSync)==null||o.board.updateBoardInputConfig({activeBoardId:void 0}),this.endSelectInteraction(n)}render(n,o){var d,u;const i=1/n.camera.scale;this.renderSnapConstraints(n,o);const a=h=>{h&&(o.lineDashOffset=Math.floor(-80*new Date().getTime()/1e3)%Math.round(7.5*i),o.lineWidth=.5*i,o.strokeStyle="#00a",o.setLineDash([5*i,2.5*i]),o.strokeRect(h.position.x,h.position.y,h.size.w,h.size.h),o.setLineDash([]))};n.getAllElements().forEach(h=>{(h.hover||this.selectedElementIds.has(h.data.id))&&vl(h,o)});const s=n.getActiveBoard(),c=s??n.data.boards.some(h=>this.selectedElementIds.has(h.data.id));if(this.selectedElementIds.size>=1&&this.selectInteraction!=="move_elements"&&!c){const h=this.selectedElementIds.has(n.contextWindow.elementId()),p=this.getSelectedBBox(n),g=new er({position:p==null?void 0:p.position,size:p==null?void 0:p.size,borderLineWidth:16});g.uiScale=1/n.camera.scale,h||(this.selectedElementIds.has(this.hoverElementId??"")||this.mouseLastInMultiSelect?tT(g,o):vl(g,o));const v=this.selectedElementIds.has(this.hoverElementId??"")?this.hoverInteractionArea:void 0,x=this.selectInteraction==="resize_elements",y=[...this.selectedElementIds].some(w=>{var I;return((I=n.getElement(w))==null?void 0:I.data.type)===Mt.TEXT}),_=this.selectedElementIds.size===1&&y;Rh({element:g,ctx:o,area:v,onlyShowInteractionArea:x,noTopBottom:_})}if(s&&(vl(s,o),this.selectInteraction!=="move_elements")){const h=this.selectInteraction==="resize_elements";Rh({element:s,ctx:o,area:this.interactActiveBoard?this.hoverInteractionArea:void 0,onlyShowInteractionArea:h})}if(this.selectInteraction==="multi_select"){const h=(d=this.mouseDownEvent)==null?void 0:d.position.canonical,p=(u=this.mouseDragEvent)==null?void 0:u.position.canonical;if(h&&p){const g=new In({position:h,size:new Ue(p.y-h.y,p.x-h.x),borderHitWidth:0});a(g)}}}renderSnapConstraints(n,o){if(!this.snapBehaviorActive)return;const i=this.getSelectedBBox(n);if(!i||!["resize_elements","move_elements"].includes(this.selectInteraction))return;const a=1/n.camera.scale;cT(i,this.snapConstraints??[],o,a)}isInMultiSelectArea(n,o){const i=this.getSelectedBBox(o);return!!(i!=null&&i.inBox(n.position.canonical,10/o.camera.scale))}handleOnMouseDown(n,o){var d,u,h,p,g;if(this.pan){super.handleOnMouseDown(n,o);return}if(this.eyedropMode==="select")return;this.selectInteraction==="text_edit"&&(this.hoverInteractionArea==="BOX"&&((d=this.textEditInteraction)==null?void 0:d.elementId)===((u=n.targetElement)==null?void 0:u.data.id)?(h=this.textEditInteraction)==null||h.handleOnMouseDown(n,o):this.endSelectInteraction(o));const i=this.getHoverTarget(n,o),a=this.selectedElementIds.has((i==null?void 0:i.data.id)??"");(!this.isInMultiSelectArea(n,o)||i&&!a)&&!n.mouseEvent.shiftKey&&!o.getActiveBoard()&&(this.selectedElementIds.clear(),i&&(this.hoverInteractionArea=i.getInteractionArea(n.position.canonical),this.selectedElementIds.add(i.data.id)));const s=o.getActiveBoard(),c=o.data.config.alwaysDisplayBoards&&o.data.boards.find(m=>m.isInPill(n.position.canonical));c&&!c.isActive?(this.selectedElementIds.clear(),(p=this.inputSync)==null||p.board.updateBoardInputConfig({activeBoardId:c.data.id})):s?(this.selectedElementIds.clear(),this.interactActiveBoard?(this.activeInteractionArea=this.hoverInteractionArea,this.selectedElementIds.add(s.data.id)):(g=this.inputSync)==null||g.board.updateBoardInputConfig({activeBoardId:void 0})):this.isInMultiSelectArea(n,o)?this.activeInteractionArea=this.hoverInteractionArea:i!=null&&i.hover?this.activeInteractionArea=i.hover:this.selectInteraction==="none"&&(this.activeInteractionArea=void 0,this.startSelectInteraction("multi_select",o),n.mouseEvent.shiftKey||(this.startSelectedIds.clear(),this.selectedElementIds.clear())),this.mouseDownEvent=n,this.mouseState="down"}snapPosition(n,o,i,a){const s=8/o.camera.scale,c=aT(n,this.getSnappableElements(o));return this.snapConstraints=c,c.length?dT({parentBBox:n,candidates:c,tolerance:s,xOffsetOverrides:i,yOffsetOverrides:a}):n.topLeft()}snapResizePosition(n,o,i){const{w:a,h:s}=n.size,c=[],d=[];return im.has(i)&&c.push(0),sm.has(i)&&c.push(a),am.has(i)&&d.push(0),lm.has(i)&&d.push(s),this.snapPosition(n,o,c,d)}handleOnMouseMoveDragElements(n,o){if(!this.mouseDownEvent)return;const i=this.getSelectedInitialBBox();if(!i)return;const a=1/o.camera.scale,s=this.mouseDownEvent.position.unnormalized.subtract(n.position.unnormalized).multiply(a),c=new er({position:i.position.copy(),size:i.size});c.data.position=c.data.position.subtract(s);let d=c.data.position.copy();n.mouseEvent.shiftKey?this.snapBehaviorActive=!1:(this.snapBehaviorActive=!0,d=this.snapPosition(c.getFullBBox(),o));const h=o.camera.clampPosition(d,i.size).subtract(i.position);this.getSelectableElements(o).map(g=>{const m=this.startInteractionElements.get(g.data.id);return m?{initialElement:m,currentElement:g}:null}).forEach(g=>{if(!g)return;const{initialElement:m,currentElement:v}=g,x=m.data.position.add(h);v.setPosition(x),!m.data.position.equals(v.data.position)&&(this.movedElement=!0)});const p=new In({position:i.position.add(h),size:i.size});this.snapPosition(p,o)}handleOnMouseMoveResizeElements(n,o){var k,A;const i=this.activeInteractionArea;if(!this.mouseDownEvent||this.startInteractionElements.size===0||!i)return;const a=this.getSelectedInitialBBox();if(!a)return;const s=new er({position:a.position.copy(),size:a.size}),{w:c,h:d}=s.data.size,u=n.position.unnormalized.subtract(this.mouseDownEvent.position.unnormalized).multiply(1/o.camera.scale);let h=a.topLeft();i==="TR"?(h=a.bottomLeft(),u.y=-u.y):i==="TL"?(h=a.bottomRight(),u.x=-u.x,u.y=-u.y):i==="BL"?(h=a.topRight(),u.x=-u.x):i==="R"?(h=a.centerLeft(),u.y=0):i==="L"?(h=a.centerRight(),u.x=-u.x,u.y=0):i==="T"?(h=a.centerBottom(),u.y=-u.y,u.x=0):i==="B"&&(h=a.centerTop(),u.x=0),u.x=Math.max(u.x,kh-c),u.y=Math.max(u.y,kh-d);const p=[...this.startInteractionElements].some(([,D])=>D instanceof gr),g=n.mouseEvent.shiftKey&&!p||["T","L","B","R"].includes(i),m=n.mouseEvent.shiftKey||["T","L","B","R"].includes(i);if(!g){const D=u.proj(a.size.as_xy());u.x=D.x,u.y=D.y}const v=new Ue(d+u.y,c+u.x);let x=v;const y=this.selectedElementIds.has(o.contextWindow.element.data.id);let _;y&&(_=o.contextWindow.element.allowedAspects),!n.mouseEvent.shiftKey||y?(x=uT({initBBox:a,beforeSnapSize:v,resizeArea:i,getSnapResizePosition:D=>this.snapResizePosition(D,o,i),allowedAspects:_}),this.snapBehaviorActive=!0,u.x=x.w-a.width(),u.y=x.h-a.height()):this.snapBehaviorActive=!1;const w=x.elementWiseDivide(a.size).as_xy(),I=(D,O)=>{const L=D.data.cropInsets??{},P=D.data.scaledCropInsets??{},{left:G,right:B,top:M,bottom:z}=L,{left:F,right:T,top:j,bottom:Z}=P,{originalElementHeight:ee,originalElementWidth:te}=this.imageStore.getImageMeta(D.data.id),$=new Ue(ee??0,te??0),X=$.w/D.data.uncroppedSize.w,W=$.h/D.data.uncroppedSize.h,Y=(q,V)=>Math.max(0,V-q);if(i==="R"){const q=B??0,V=u.x,Q=Y(V,q);O.data.cropInsets={...L,right:Q},O.data.scaledCropInsets={...P,right:Math.max(0,(T??0)-V*X)}}else if(i==="L"){const q=G??0,V=u.x,Q=Y(V,q);O.data.cropInsets={...L,left:Q},O.data.scaledCropInsets={...P,left:Math.max(0,(F??0)-V*X)}}else if(i==="T"){const q=M??0,V=u.y,Q=Y(V,q);O.data.cropInsets={...L,top:Q},O.data.scaledCropInsets={...P,top:Math.max(0,(j??0)-V*W)}}else if(i==="B"){const q=z??0,V=u.y,Q=Y(V,q);O.data.cropInsets={...L,bottom:Q},O.data.scaledCropInsets={...P,bottom:Math.max(0,(Z??0)-V*W)}}else if(i==="TL"){const q=G??0,V=u.x,Q=Y(V,q),K=M??0,ae=u.y,ce=Y(ae,K);O.data.cropInsets={...L,top:ce,left:Q},O.data.scaledCropInsets={...P,top:Math.max(0,(j??0)-ae*W),left:Math.max(0,(F??0)-V*X)}}else if(i==="TR"){const q=B??0,V=u.x,Q=Y(V,q),K=M??0,ae=u.y,ce=Y(ae,K);O.data.cropInsets={...L,top:ce,right:Q},O.data.scaledCropInsets={...P,top:Math.max(0,(j??0)-ae*W),right:Math.max(0,(T??0)-V*X)}}else if(i==="BL"){const q=G??0,V=u.x,Q=Y(V,q),K=z??0,ae=u.y,ce=Y(ae,K);O.data.cropInsets={...L,bottom:ce,left:Q},O.data.scaledCropInsets={...P,bottom:Math.max(0,(Z??0)-ae*W),left:Math.max(0,(F??0)-V*X)}}else if(i==="BR"){const q=B??0,V=u.x,Q=Y(V,q),K=z??0,ae=u.y,ce=Y(ae,K);O.data.cropInsets={...L,bottom:ce,right:Q},O.data.scaledCropInsets={...P,bottom:Math.max(0,(Z??0)-ae*W),right:Math.max(0,(T??0)-V*X)}}};this.getSelectableElements(o).forEach(D=>{var j,Z,ee,te;const O=this.startInteractionElements.get(D.data.id);if(!O)return;m&&I(O,D);const L=O.data.position.subtract(h),P=u.elementWiseMultiply(L);P.x/=c,P.y/=d;const G=O.data.position.add(P);D.data.position=G;const B=O.data.size,M=new Ue(w.y*B.h,w.x*B.w);D.data.size=M,D instanceof gr&&O instanceof gr&&rm.has(i)&&D.scaleTextSize(O,w.x);const z=($,X,W)=>{const Y=((W==null?void 0:W.top)??0)*$,q=((W==null?void 0:W.bottom)??0)*$,V=((W==null?void 0:W.left)??0)*X,Q=((W==null?void 0:W.right)??0)*X;return{top:Y,bottom:q,left:V,right:Q}};if(!m){const $=z(w.y,w.x,O.data.cropInsets);D.data.cropInsets=$}const F=new Ue(M.h+(((j=D.data.cropInsets)==null?void 0:j.top)??0)+(((Z=D.data.cropInsets)==null?void 0:Z.bottom)??0),M.w+(((ee=D.data.cropInsets)==null?void 0:ee.left)??0)+(((te=D.data.cropInsets)==null?void 0:te.right)??0));D.data.uncroppedSize=F,D.data.positions&&O.data.positions&&(D.data.positions=O.data.positions.map($=>$.subtract(h).elementWiseMultiply(w).add(h))),D.updatePositionAndSize(),!O.data.size.equals(D.data.size)&&(this.resizedElement=!0)});const R=a.position.subtract(h),S=u.elementWiseMultiply(R);S.x/=c,S.y/=d;const E=a.position.add(S);this.resizeInlineDimension={position:E,size:x,interaction:i};const N=new In({position:E,size:x});if(this.snapResizePosition(N,o,i),this.selectedElementIds.size===1&&this.selectedElementIds.has(((k=o.getActiveBoard())==null?void 0:k.data.id)??"")){const D=Math.round(N.size.w),O=Math.round(N.size.h);(A=this.inputSync)==null||A.board.updateBoardInputConfig({width:D,height:O,inputWidth:String(D),inputHeight:String(O)})}}handleOnMouseMoveDrag(n,o){var s,c;if(this.pan){super.handleOnMouseMoveDrag(n,o);return}const i=this.getHoverTarget(n,o);if((this.mouseDownEvent??n).position.unnormalized.subtract(n.position.unnormalized).length()>=hT&&this.selectedElementIds.size&&this.selectInteraction==="none"){const u=pT.has(this.activeInteractionArea??"BOX")?"resize_elements":"move_elements";n.mouseEvent.shiftKey&&(i!=null&&i.data.id)&&!this.interactActiveBoard&&this.selectedElementIds.add(i.data.id),this.startSelectInteraction(u,o)}if(this.selectInteraction==="move_elements")this.handleOnMouseMoveDragElements(n,o);else if(this.selectInteraction==="resize_elements")this.handleOnMouseMoveResizeElements(n,o);else if(this.selectInteraction==="multi_select"){const d=(s=this.mouseDownEvent)==null?void 0:s.position.canonical,u=n.position.canonical;if(d&&u){const h=new Set(this.startSelectedIds),p=new In({position:d,size:new Ue(u.y-d.y,u.x-d.x),borderHitWidth:0});o.getCanvasElements().forEach(m=>{m.getFullBBox().overlapsBox(p)&&h.add(m.data.id)}),this.selectedElementIds=h}}else this.selectInteraction==="text_edit"&&((c=this.textEditInteraction)==null||c.handleDrag(n,o))}getSelectableElements(n){const o=n.getActiveBoard();if(o)return[o];const i=n.getCanvasElements().slice(0);return this.showContextWindow&&i.push(n.contextWindow.element),i}getSnappableElements(n){const o=n.getCanvasElements().slice(0);n.data.config.alwaysDisplayBoards&&n.data.boards.forEach(a=>{o.push(a)}),this.showContextWindow&&o.push(n.contextWindow.element);const i=n.camera.getCameraViewBBox();return o.filter(a=>a.getFullBBox().overlapsBox(i)&&!this.selectedElementIds.has(a.data.id))}getBoardSnapX(n){const o=[];return n.data.boards.forEach(i=>{if(i.data.id!==n.activeBoardId){const a=i.bbox(),s=a.position.x,c=a.width();o.push(s),o.push(s+c/2),o.push(s+c)}}),o}getBoardSnapY(n){const o=[];return n.data.boards.forEach(i=>{if(i.data.id!==n.activeBoardId){const a=i.bbox(),s=a.position.y,c=a.height();o.push(s),o.push(s+c/2),o.push(s+c)}}),o}getHoverTarget(n,o){const i=this.getSelectedBBox(o),a=i==null?void 0:i.getInteractionArea(n.position.canonical);if(i&&a&&a!=="BOX")for(const d of this.selectedElementIds){const u=o.getElement(d),h=u==null?void 0:u.getInteractionArea(n.position.canonical);if(u&&h&&h!=="BOX")return u}const s=this.hoverElementId?o.getElement(this.hoverElementId):void 0,c=s==null?void 0:s.getInteractionArea(n.position.canonical);return s&&c&&c!=="BOX"?s:n.targetElement}handleOnMouseMove(n,o){var c,d;if(this.mouseOverTargetType=(c=n.targetElement)==null?void 0:c.data.type,this.pan){super.handleOnMouseMove(n,o);return}if(this.eyedropMode==="select"){this.eyedropColor=n.canvasHoverColor;return}if(this.mouseLastInMultiSelect=this.isInMultiSelectArea(n,o),this.mouseState==="down"&&this.mouseDownEvent){this.handleOnMouseMoveDrag(n,o),this.mouseDragEvent=n;return}if(!n.isOverCanvas)return;const i=(d=this.getHoverTarget(n,o))==null?void 0:d.data.id;this.hoverElementId=i,[...o.getAllElements(),o.contextWindow.element].forEach(u=>{u.hover=void 0}),o.data.boards.forEach(u=>{u.hover=void 0}),this.hoverInteractionArea=void 0,this.interactActiveBoard=!1;const a=o.getActiveBoard();if(a){const u=a==null?void 0:a.getInteractionArea(n.position.canonical);u&&(a.hover=u,this.hoverInteractionArea=u,this.interactActiveBoard=!0);return}const s=o.data.config.alwaysDisplayBoards&&o.data.boards.find(u=>u.isInPill(n.position.canonical));if(s){s.hover="CLICK",this.hoverInteractionArea="CLICK";return}if(this.mouseLastInMultiSelect&&this.selectedElementIds.size>1){const u=this.getSelectedBBox(o);if(u){u.borderHitWidth=32/o.camera.scale,this.hoverInteractionArea=u.getInteractionArea(n.position.canonical)??"BOX";return}}this.getSelectableElements(o).filter(u=>u.data.id===i).forEach(u=>{const h=u.getInteractionArea(n.position.canonical);this.hoverInteractionArea=h,u.hover=h})}handleOnMouseUp(n,o){var c;const i=!n.isOverCanvas&&this.selectInteraction==="none";if(this.pan||i){super.handleOnMouseUp(n,o);return}if(this.mouseUpEvent=n,this.mouseState="up",this.eyedropMode==="select"){this.eyedropMode="none",this.eyedropColor&&this.inputSync.text.setTextInputConfig(d=>({...d,...this.eyedropColor&&{fontColor:rT(this.eyedropColor)}}));return}let a=(c=this.getHoverTarget(n,o))==null?void 0:c.data.id;const s=o.getActiveBoard();if(s&&s.data.id!==a&&(a=void 0),this.isInMultiSelectArea(n,o)||n.mouseEvent.shiftKey?this.selectInteraction==="none"&&(a?n.mouseEvent.shiftKey?this.selectedElementIds.has(a)?this.selectedElementIds.delete(a):this.selectedElementIds.add(a):(this.selectedElementIds.clear(),this.selectedElementIds.add(a)):n.mouseEvent.shiftKey||this.selectedElementIds.clear()):this.selectInteraction==="none"&&n.isOverCanvas&&(this.selectedElementIds.clear(),a&&this.selectedElementIds.add(a)),this.movedElement||this.resizedElement){const d=o.getActiveBoard();o.getAllElements().filter(u=>u.data.type===Mt.IMAGE).concat([o.contextWindow.element]).concat(d?[d]:[]).forEach(u=>{u.data.position.x=Math.round(u.data.position.x),u.data.position.y=Math.round(u.data.position.y),u.data.size.w=Math.round(u.data.size.w),u.data.size.h=Math.round(u.data.size.h)})}if(this.movedElement){const d=yl(new Set(this.startInteractionElements.keys()),o);this.appendAction(d?"INPAINT_MOVE":"MOVE",o)}if(this.resizedElement){const d=yl(new Set(this.startInteractionElements.keys()),o);this.appendAction(d?"INPAINT_RESIZE":"RESIZE",o)}if(["resize_elements","move_elements","multi_select"].includes(this.selectInteraction)||!n.isOverCanvas){this.endSelectInteraction(o);return}}handleOnDoubleClick(n,o){var i;if(((i=n.targetElement)==null?void 0:i.data.type)===Mt.TEXT&&n.targetElement.hover==="BOX"&&this.selectInteraction==="none"){const a=o.getElement(n.targetElement.data.id);this.startSelectInteraction("text_edit",o,a)}}handleContextMenu(n){var o;if(!(this.selectedElementIds.size>1)&&n.targetElement){const i=(o=n.targetElement)==null?void 0:o.data.id;this.selectedElementIds=new Set([i]),this.startInteractionElements=new Map([[i,n.targetElement]])}}handleKeyDown(n,o){if(Sh(n)&&n.key==="b"&&nT(this.inputSync.text),Sh(n)&&n.key==="i"&&oT(this.inputSync.text),n.key==="Escape"&&(this.eyedropMode="none"),n.target instanceof HTMLCanvasElement){if(n.key==="Backspace"||n.key==="Delete"){let a=!1;const s=yl(this.selectedElementIds,o);o.data.layers.forEach(c=>{const d=c.data.elements.filter(u=>!this.selectedElementIds.has(u.data.id));a=a||d.length<c.data.elements.length,c.data.elements=d}),this.startInteractionElements.clear(),this.selectedElementIds.clear(),a&&this.appendAction(s?"INPAINT_DELETE":"DELETE",o)}if(n.key==="Enter"){const a=o.getElement([...this.selectedElementIds][0]);this.selectedElementIds.size===1&&a&&a.data.type===Mt.TEXT&&(n.preventDefault(),this.startSelectInteraction("text_edit",o,a))}}}handleArrow(n,o,i){if(this.selectInteraction!=="none")return;const a=o?8:1,s=a*(n==="left"?-1:n==="right"?1:0),c=a*(n==="up"?-1:n==="down"?1:0);this.getSelectableElements(i).filter(d=>this.selectedElementIds.has(d.data.id)||d.data.id===i.activeBoardId).forEach(d=>{d.translate(new Re(s,c))})}isMovingElements(){return this.mouseState==="down"&&this.selectInteraction==="move_elements"&&this.startInteractionElements.size>0}isResizingElements(){return this.mouseState==="down"&&this.selectInteraction==="resize_elements"&&this.startInteractionElements.size>0}}class fT extends yd{constructor({appendAction:e,imageStore:n,inputSync:o}){super({type:Vo.GENERATE,appendAction:e,imageStore:n,inputSync:o})}}const gT=()=>{const{generationInput:t}=l.useContext(ye),{allowedAspectObjects:e}=pm(),n=l.useMemo(()=>new Set([...e].map(a=>a.width/a.height)),[e]),o=l.useCallback(a=>[...e].sort((c,d)=>Math.abs(c.width/c.height-a)-Math.abs(d.width/d.height-a))[0],[e]),i=l.useCallback(()=>{let a=new Ue(1024,1024),s="1:1";if(t.selected_aspect_ratio_v2){const{height:c,width:d,aspectRatio:u}=t.selected_aspect_ratio_v2;a=new Ue(c,d),s=u}else if(t.aspectRatio){const{height:c,width:d}=Hn[t.aspectRatio];a=new Ue(c,d),s=t.aspectRatio}return{aspectRatio:s,size:a}},[t.aspectRatio,t.selected_aspect_ratio_v2]);return{allowedAspectNumbers:n,getInitialContextWindowSize:i,allowedAspectObjects:e,getGenerationInputAspect:o}},Gs=(t,e,n)=>{const{x:o,y:i}=t.position,{w:a,h:s}=t.size;let c=a,d=s;a>e&&a>=s?(c=e,d=Math.round(e*s/a)):s>e&&(d=e,c=Math.round(e*a/s));const u=c/a,h=d/s,p=document.createElement("canvas");p.width=c,p.height=d;const g=p.getContext("2d");return n&&(g.fillStyle=n,g.fillRect(0,0,c,d)),g.scale(u,h),g.translate(-o,-i),{canvas:p,ctx:g}},nF=t=>{const{eCanvas:e}=t,{setAlertText:n}=l.useContext(Tn),o=l.useCallback((p,g,m)=>{const v=p.contextWindow.element.getFullBBox(),{canvas:x,ctx:y}=Gs(v,2048,g),_=p.getMaskLayer(),w=p.data.layers.filter(I=>I.data.id!==Mo);if(m==="mask-save"){const{ctx:I}=Gs(v,2048),{ctx:R}=Gs(v,2048);return I.globalCompositeOperation="source-over",[...w].forEach(S=>{S.render(I,{hideUI:!0})}),I.globalCompositeOperation="source-out",I.fillStyle="rgba(0, 0, 0, 1)",I.fillRect(-ut,-ut,2*ut,2*ut),R.globalCompositeOperation="source-over",_.render(R,{hideUI:!0}),I.globalCompositeOperation="source-over",I.drawImage(R.canvas,0,0,x.width,x.height,v.left(),v.top(),v.width(),v.height()),I.globalCompositeOperation="source-out",I.fillStyle="rgba(0, 0, 0, 1)",I.fillRect(-ut,-ut,2*ut,2*ut),I.canvas}return w.forEach(I=>{I.render(y,{hideUI:!0})}),x},[]),i=l.useCallback(()=>xm(e).toDataURL("image/png"),[e]),a=l.useCallback((p="image/png")=>mT(e,p).toDataURL(p),[e]),s=l.useCallback(()=>o(e,e.data.backgroundColor,"canvas-save").toDataURL("image/png"),[e,o]),c=l.useCallback(()=>{const p=o(e.copy(),"transparent","mask-save"),g=p.getContext("2d"),m=g.getImageData(0,0,p.width,p.height),{width:v,height:x}=m,y=m.data;let _=!1;for(let w=0;w<v*x;w++)y[4*w+3]<225?(y[4*w]=0,y[4*w+1]=0,y[4*w+2]=0,y[4*w+3]=0,_=!0):(y[4*w]=255,y[4*w+1]=255,y[4*w+2]=255,y[4*w+3]=255);if(!_){n("Adjust the window to include space to extend into.",{autoDismissMs:3e3});return}return g==null||g.putImageData(m,0,0),p.toDataURL("image/png")},[e,o,n]),d=l.useCallback(()=>{const p=o(e,e.data.backgroundColor,"canvas-save"),g=p.getContext("2d");if(!g)return;const m=o(e,"transparent","mask-save"),v=e.contextWindow.element.getFullBBox();return g.globalCompositeOperation="destination-in",g.drawImage(m,0,0,p.width,p.height,v.left(),v.top(),v.width(),v.height()),p},[e,o]),u=l.useCallback(()=>{const p=d();if(p)return p.toDataURL("image/png")},[d]),h=l.useCallback(p=>{const g=d();g&&g.toBlob(p)},[d]);return{maskDataUrl:c,getContextWindowDataUrl:s,canvasThumbnailDataUrl:i,canvasActiveBoardUrl:a,getBackgroundRemovedDataUrl:u,getBackgroundRemovedBlob:h}},xm=t=>{const e=t.getMinimumBoundingBox(),n=document.createElement("canvas"),o=1024,i=32,a=Math.max(e.width(),e.height()),s=(o-i)/a;n.width=o,n.height=o;const c=n.getContext("2d");c.fillStyle="white",c.fillRect(0,0,o,o),c.translate(i/2,i/2),c.scale(s,s);let d=-e.position.x,u=-e.position.y;a>e.width()?d+=(a-e.width())/2:a>e.height()&&(u+=(a-e.height())/2),c.translate(d,u);for(const h of t.data.layers)h.render(c,{hideUI:!0});return n},mT=(t,e)=>{const n=t.getActiveBoard(),o=n.bbox();let i;e==="image/jpeg"&&(i=n.data.fillColor??"#FFF");const{canvas:a,ctx:s}=Gs(o,4096,i);for(const c of t.data.layers)c.render(s,{hideUI:!0});return a},xT="Untitled",Ah=50,vm=t=>{if(t===void 0||t===""){const e=new Date,n={month:"short",day:"numeric"},o=e.toLocaleDateString(void 0,n),i=e.toLocaleTimeString(void 0,{timeStyle:"short"});return`${xT} ${o} ${i}`}return t.length<=Ah?t:`${t.substring(0,Ah-1).trim()}…`},jh=5e3,oF=t=>{const{canvasState:e,setCanvasState:n,initializeActions:o,canvasRef:i,canvasTransactionIdMapRef:a,imageStore:s,inputSync:c,setToolState:d,appendAction:u,isLoadingInitialImage:h}=t,p=Ee(),{allowedAspectNumbers:g,getInitialContextWindowSize:m}=gT(),{canvas_id:v}=an(),{setAlertContent:x}=l.useContext(Tn),{canvasApi:y}=l.useContext(ge),{setBackdropLoading:_}=l.useContext(Do),w=l.useRef(new Map),I=l.useRef(new Map),{data:R,isFetching:S,error:E}=Ve(["getCanvas",v],()=>y.getCanvas({canvasId:v}),{enabled:!!v&&!!y,staleTime:0,retryDelay:100,refetchOnWindowFocus:!1}),N=l.useCallback(async(X,W)=>{if(!y)return;const Y=X.getCanvasImageElements().map(q=>s.getImageMeta(q.data.id).assetId).filter(q=>q!==void 0);await y.pruneCanvasAssets({canvasId:W,postPruneCanvasAssetsRequest:{assetIdsToKeep:Y}}).then(q=>a.current.set(W,q.currentTransactionId))},[y,a,s]);l.useEffect(()=>{var ve,se;const{canvasJson:X,canvasId:W,currentTransactionId:Y}=(R==null?void 0:R.canvas)??{};if(!W||!X||!y||e.hydratedCanvasId===W||S)return;w.current.set(W,X),I.current.set(W,Date.now()),M.current=!1,Y&&a.current.set(W,Y);const q=JSON.parse(X),{size:V,aspectRatio:Q}=m(),K=vd.deserialize({serializedData:q,imageStore:s,contextWindowOptions:{contextWindowSize:V,contextWindowAllowedAspects:g,currentAspectRatio:Q}},W);N(K,W);const ae=K.getMinimumBoundingBox();if(K.camera.canvasWidth=((ve=i.current)==null?void 0:ve.width)??1024,K.camera.canvasHeight=((se=i.current)==null?void 0:se.height)??1024,K.camera.setCameraBox(ae,"fit"),!(K.data.boards.length>0)){const H=K.getCanvasElements().length>0,me=K.getMinimumBoundingBox(),ne=new Ue(1024,1024),ue=ne.as_xy().multiply(-.5),fe=new cm({position:H?me.position:ue,size:H?me.size:ne});K.data.boards.push(fe)}K._updateUiScale(),n(K),K.getCanvasElements().length===0&&d(new fT({appendAction:u,imageStore:s,inputSync:c})),o(K)},[g,y,R,e.hydratedCanvasId,m,o,S,n,p,i,s,d,u,N,a,c]);const[k,A]=l.useState(!document.hidden),D=()=>{A(!document.hidden)};l.useEffect(()=>(document.addEventListener("visibilitychange",D),()=>{document.removeEventListener("visibilitychange",D)}),[]);const[O,L]=l.useState("blocked"),P=s.getSerializedMetadata(),G=l.useMemo(()=>_h(e.getSerializedData())||P,[e,P]),B=l.useCallback(async(X,W)=>{const q=await y.getCanvas({canvasId:X}),V=!w.current.get(X)||w.current.get(X)===q.canvas.canvasJson;return!V&&W&&x(r.jsx(pR,{}),{showClose:!1,backgroundColor:hR}),V},[y,x]);l.useEffect(()=>{k&&v&&B(v,!0)},[v,k,B]);const M=l.useRef(!1),z=l.useRef(async X=>{M.current=!0;const{canvasId:W,serializedCanvas:Y,autoSave:q}=X;if(!await B(W,q))return;const V=y.putCanvas({putCanvasRequest:{canvasId:W,canvasJson:Y}}),Q=await V;return Q.canvas.canvasJson&&(w.current.set(W,Q.canvas.canvasJson),I.current.set(W,Date.now()),M.current=!1),Q.canvas.currentTransactionId&&a.current.set(X.canvasId,Q.canvas.currentTransactionId),V}),{data:F,isFetching:T,error:j}=Ve(["saveCanvas",v,G],()=>{if(!e.hydratedCanvasId||e.hydratedCanvasId!==v||!R)return L("blocked"),null;if(w.current.get(v)===G)return L("saved"),null;L("saving");const X=I.current.get(v);return M.current||X!==void 0&&X+jh>Date.now()?null:z.current({canvasId:v,serializedCanvas:G,autoSave:!0})??null},{enabled:!!v&&!!y&&k&&!S&&!h&&!!R,refetchInterval:jh,staleTime:1/0}),Z=l.useCallback(async(X,W)=>{try{const q=xm(X).toDataURL("image/png"),V=await(await Le(q)).blob(),Q=async K=>{const{init:ae}=K,ce={...ae,headers:{...ae.headers,"Content-Type":"image/png"}};return Promise.resolve(ce)};y==null||y.postCanvasThumbnail({canvasId:W,body:V},Q)}catch{p({eventKey:"CANVAS_SAVE_THUMBNAIL_ERROR"})}},[y,p]);l.useEffect(()=>{S||T||!(F!=null&&F.canvas.canvasJson)||!v||(G===F.canvas.canvasJson?L(X=>(X==="saving"&&Z(e,v),"saved")):L("saving"))},[e,v,T,F,G,Z,S]);const ee=l.useCallback(X=>{X.hydratedCanvasId&&z.current({canvasId:X.hydratedCanvasId,serializedCanvas:_h(X.getSerializedData()),autoSave:!1}).then(W=>{W!=null&&W.canvas.canvasId&&W.canvas.currentTransactionId&&a.current.set(W.canvas.canvasId,W.canvas.currentTransactionId)})},[a]),te=l.useRef(!1);l.useEffect(()=>{h&&(te.current=!0),te.current&&!h&&v&&v===e.hydratedCanvasId&&ee(e)},[v,e,ee,h]),l.useEffect(()=>{const X=()=>{v&&ee(e)};return window.addEventListener("beforeunload",X),()=>{window.removeEventListener("beforeunload",X)}},[v,e,ee]),l.useEffect(()=>{e.hydratedCanvasId&&e.hydratedCanvasId!==v&&(ee(e),n(X=>(X.hydratedCanvasId=void 0,X.copy())))},[v,e,e.hydratedCanvasId,ee,n,a]);const{showBoundary:$}=Yf();return l.useEffect(()=>{E&&(p({eventKey:"CANVAS_LOAD_CANVAS_ERROR"}),$(new Error("Canvas not found.")),_(!1)),j&&p({eventKey:"CANVAS_SAVE_CANVAS_ERROR"})},[E,j,_,$,p]),l.useEffect(()=>{if(O==="saved")return;const X=W=>{W.preventDefault()};return window.addEventListener("beforeunload",X),()=>{window.removeEventListener("beforeunload",X)}},[O]),{autoSaveStatus:O,initialCanvasData:R==null?void 0:R.canvas,isFetchingGetCanvas:S}},ym={version:"0.0.1",dimension:{w:1024,h:1024},layers:[],backgroundColor:"#FFF",config:{}},vT=l.createContext({expanded:!1,setExpanded:()=>{},canvasListItems:null,handleDeleteCanvas:()=>{},navigateToCanvas:()=>{},activeCanvasId:void 0,canvasTransactionIdMapRef:{current:new Map([])},createNewCanvas:()=>{},canvasJsonData:void 0,updateCanvasName:()=>{}}),rF=t=>{const{children:e,canvasTransactionIdMapRef:n,expanded:o,setExpanded:i}=t,a=Ee(),{canvasApi:s}=l.useContext(ge),{navigate:c}=l.useContext($e),{canvas_id:d}=an(),{data:u,refetch:h,error:p}=Ve(["getCanvas",d],()=>s.getCanvas({canvasId:d}),{enabled:!!d&&!!s,staleTime:0,refetchOnWindowFocus:!1,onSuccess:S=>{d&&S.canvas.currentTransactionId&&n.current.set(d,S.canvas.currentTransactionId)}}),[g,m]=l.useState(null),{data:v,refetch:x,error:y}=Ve(["getListCanvases"],()=>s.getListCanvases(),{enabled:!!s,staleTime:6e4});l.useEffect(()=>{x()},[x]),l.useEffect(()=>{v&&v.canvasListItems!==void 0&&m(v.canvasListItems)},[v]);const _=l.useCallback(S=>{c(oe.CANVAS.replace(":canvas_id",S))},[c]),w=l.useCallback(async()=>{if(s)try{const S=await(s==null?void 0:s.putCanvas({putCanvasRequest:{title:vm(),canvasJson:JSON.stringify(ym)}}));S.canvas.canvasId&&S.canvas.currentTransactionId&&n.current.set(S.canvas.canvasId,S.canvas.currentTransactionId),x(),c(oe.CANVAS.replace(":canvas_id",S.canvas.canvasId??""))}catch{}},[s,c,x,n]),I=l.useCallback(S=>{s==null||s.deleteCanvas({canvasId:S}).catch(()=>{a({eventKey:"CANVAS_DELETE_CANVAS_ERROR"})}).finally(()=>{if(x(),d===S){const E=g==null?void 0:g.find(N=>N.canvasId!==d);E?_(E.canvasId):w()}})},[s,a,x,d,g,_,w]),R=l.useCallback(async(S,E)=>{try{const N=await s.putCanvas({putCanvasRequest:{canvasId:S,title:E}});N.canvas.currentTransactionId&&n.current.set(S,N.canvas.currentTransactionId),h(),x()}catch(N){N instanceof Yr&&N.response.status}},[s,h,x,n]);return l.useEffect(()=>{p&&a({eventKey:"CANVAS_LOAD_CANVAS_ERROR"}),y&&a({eventKey:"CANVAS_LOAD_LIST_ERROR"})},[p,y,a]),r.jsx(vT.Provider,{value:{expanded:o,setExpanded:i,canvasListItems:g,handleDeleteCanvas:I,activeCanvasId:d,canvasTransactionIdMapRef:n,navigateToCanvas:_,createNewCanvas:w,canvasJsonData:u,updateCanvasName:R},children:e})};let Ft=function(t){return t.STARTED="STARTED",t.INTERMEDIATE="INTERMEDIATE",t.DONE="DONE",t.DISMISSED="DISMISSED",t}({});const yT=new Map([["DEFAULT","General"],["PHOTO","Realistic"],["ANIME","Anime"],["ILLUSTRATION","Design"],["RENDER_3D","3D"]]),wm=new Map([["AUTO",ar.Auto],["DEFAULT",ar.General],["PHOTO",ar.Realistic],["ANIME",ar.Anime],["ILLUSTRATION",ar.Design],["RENDER_3D",ar.Render3D]]),xo={prompt:"",model_version:"V_1_5",use_autoprompt:"AUTO",style_expert:"AUTO",selected_aspect_ratio_v2:{width:1024,height:1024,aspectRatio:"1:1"},generation_speed:0},ye=l.createContext({inSessionGenerations:[],markGenerationResponded:()=>null,clearPromptError:()=>null,clearSuccessGeneration:()=>null,getAndClearGenerationInput:()=>null,setGenerationInput:()=>null,generationInput:xo,promptErrorData:null,isSubmitDisabled:!0,handleSubmitGeneration:()=>{},generationThrottle:!1,suggestions:[],setSuggestions:()=>{},addImagePrompt:()=>{},generationBlocked:!1,generationThrottleCountDown:30,generationInProgress:!1,setLatestGeneration:()=>{},setGenerationSetting:()=>{},lastSwitchTabGenerationTimestamp:void 0,setLastSwitchTabGenerationTimestamp:()=>{},serverErrorReason:null,showEmptyPromptWarning:Date.now(),generatedInSession:!1,imageEditState:{url:!1,defaultPrivate:!1},hasImagePrompt:!1,isRetryInpaint:!1,generationInputOpen:!1,setGenerationInputOpen:()=>{},imageDescription:null,setImageDescription:()=>{},showAdvancedFeatures:!1,setShowAdvancedFeatures:()=>{},handleDescribeImage:()=>{},loadingDescription:!1,descriptionMap:new Map,setDescriptionMap:()=>{},imageUploadLocalSrc:null,setImageUploadLocalSrc:()=>{},pushInNewPrompt:()=>{},hasPrevPrompt:!1,prevPromptClick:()=>"",hasNextPrompt:!1,nextPromptClick:()=>"",uploadError:null,setUploadError:()=>{},handleUploadImage:()=>{},uploadedImageId:null,describeError:!1,setDescribeError:()=>{},showRemixAspectRatioWarning:!1,setShowRemixAspectRatioWarning:()=>{},generationInputMode:"generate",setGenerationInputMode:()=>{},selectedInputBox:"generate",setSelectedInputBox:()=>{},customColorPalette:{members:[]},setCustomColorPalette:()=>{},dismissedGenerationProgressAt:0,setDismissedGenerationProgressAt:()=>{},generationPreviewOpen:!0,openEditor:()=>{},openCanvas:()=>{},closeEditor:()=>{},onGenerationSubmitRef:{current:null},onGenerationRespondedRef:{current:null},onPromptRejectedRef:{current:null},addInProgressCanvasGeneration:()=>0,markCanvasGenerationResponded:()=>{},deleteInSessionGeneration:()=>{},refreshUserTaskQuotaStatsOnSample:()=>{},inflightRequestStateSynced:!0,queuedRequestStatsLoading:!0,createCanvasLocked:!1,showGenerationPreview:!1,setShowGenerationPreview:()=>{},autoSearchPrompt:null,setAutoSearchPrompt:()=>{},isFetchingUserTaskQuotaStats:!1}),wT=({children:t})=>{var uu,hu,pu,fu,gu,mu,xu,vu;const e=Ee(),{showPayWallModel:n}=$t(),{userProfileState:o,subscriptionStatus:i,hasAccessToAdvancedFeatures:a,userSettings:s,visionApi:c,hasAccessToTiling:d,generationsApi:u,canvasApi:h,mediaApi:p,hasAccessToModel21:g}=l.useContext(ge),{navigate:m}=l.useContext($e),{setBackdropLoading:v}=l.useContext(Do),{setAlertContent:x}=l.useContext(Tn),[y,_]=l.useState({url:!1,defaultPrivate:!1}),[w,I]=l.useState([]),[R,S]=l.useState(!1),[E,N]=l.useState(null),[k,A]=l.useState({...xo,private:((uu=i==null?void 0:i.subscriptionQuota)==null?void 0:uu.privateGeneration)&&(s==null?void 0:s.default_to_private_generation_if_available),model_version:(s==null?void 0:s.default_model_version)??xo.model_version,generation_speed:i!=null&&i.activeSubscription?s==null?void 0:s.default_sampling_speed:void 0}),[D,O]=l.useState(null),[L,P]=l.useState(!1),[G,B]=l.useState(!1),[M,z]=l.useState(new Map),[F,T]=l.useState(null),[j,Z]=l.useState(null),[ee,te]=l.useState(null),[$,X]=l.useState("generate"),[W,Y]=l.useState(null),q=l.useRef(null),V=l.useRef(null),Q=l.useRef(null),K=l.useMemo(()=>{const re=new Map([[-2,"QUALITY"],[0,"BALANCED"],[2,"FAST"]]).get(k.generation_speed??0)??"BALANCED";let be="GENERATE";return $==="upscale"?be="UPSCALE":$==="remix"?be="REMIX":k.tiling_preset&&k.model_version==="V_0_3"&&(be="TILE"),{modelVersion:be==="UPSCALE"?"V_0_3":k.model_version,samplingSpeed:re,requestAction:be}},[k.generation_speed,k.model_version,k.tiling_preset,$]),{data:ae}=Ve(["getRequestCost",K.modelVersion,K.requestAction,K.samplingSpeed],()=>u==null?void 0:u.getRequestCostRaw(K).then(ie=>ie.value()),{enabled:!!o&&!!u,retry:3,staleTime:36e5,keepPreviousData:!0}),ce=l.useMemo(()=>{var ie,re;return(re=(ie=ae==null?void 0:ae.evaluatedCosts)==null?void 0:ie[0])==null?void 0:re.amount},[ae]),{slowCredit:ve,priorityCredit:se,refreshUserTaskQuotaStatsOnSample:H,isGenerationBlocked:me,serverErrorReason:ne,generationThrottle:ue,generationThrottleCountDown:fe,isFetchingUserTaskQuotaStats:Se}=I5(K);Ve(["getAvailableResolutions","V_0_3"],()=>u==null?void 0:u.getAvailableResolutions({modelVersion:"V_0_3"}),{enabled:!!o,staleTime:1/0}),Ve(["getAvailableResolutions","V_1_5"],()=>u==null?void 0:u.getAvailableResolutions({modelVersion:"V_1_5"}),{enabled:!!o,staleTime:1/0}),Ve(["getAvailableResolutions","V_2_1"],()=>u==null?void 0:u.getAvailableResolutions({modelVersion:"V_2_1"}),{enabled:!!o&&g,staleTime:1/0});const{mutateAsync:je}=wo({mutationFn:async ie=>await Hg(ie),onSuccess:ie=>{if(!ie.success){T(null),Z("UNEXPECTED");return}Z(null),ie.id?te(ie.id):(T(null),Z("UNEXPECTED"))},onError:ie=>{ie.status===403&&Lt(),T(null),Z("UNEXPECTED")},retryDelay:200,retry:(ie,re)=>re.status===403&&ie<5});l.useEffect(()=>{te(null),F&&Le(F).then(ie=>ie.blob()).then(ie=>je({file:new File([ie],"name")}))},[F,je]);const[qe,De]=l.useState(!1),Ye=l.useCallback(async ie=>{var Ce,ft,Ze,Vt,un,ho;if(!c||L)return;const{image_id:re,response_id:be}=ie??{};P(re??be??((Ce=k.variation_input)==null?void 0:Ce.response_id)??((ft=k.variation_input)==null?void 0:ft.image_id)??""),De(!1);let Me=null;re?Me={describeImageRequest:{imageId:re}}:be?Me={describeImageRequest:{responseId:be}}:Me={describeImageRequest:{responseId:(Ze=k.variation_input)==null?void 0:Ze.response_id,imageId:(Vt=k.variation_input)==null?void 0:Vt.image_id}};const ze=await c.describeImage(Me).catch(tl=>{tl.response.json().then(pi=>{pi.detail==="Failed to process request. User does not have enough prompts to use Describe."&&pi.status===400&&(i!=null&&i.noActiveSubscription)?De("quota"):De(!0),P(!1)})});if(!ze)return;const He=ze==null?void 0:ze.data[0].caption;He?(re?(M.set(re,{caption:He,descriptionId:ze.descriptionId}),z(new Map(M))):be?(M.set(be,{caption:He,descriptionId:ze.descriptionId}),z(new Map(M))):(un=k.variation_input)!=null&&un.response_id?(M.set(k.variation_input.response_id,{caption:He,descriptionId:ze.descriptionId}),z(new Map(M))):(ho=k.variation_input)!=null&&ho.image_id&&(M.set(k.variation_input.image_id,{caption:He,descriptionId:ze.descriptionId}),z(new Map(M))),O(He)):De(!0),P(!1)},[c,L,(hu=k.variation_input)==null?void 0:hu.response_id,(pu=k.variation_input)==null?void 0:pu.image_id,i==null?void 0:i.noActiveSubscription,M]),[nt,ct]=l.useState(!1),[he,Fe]=l.useState(null),[Ge,st]=l.useState([]),[bt,En]=l.useState(),We=l.useMemo(()=>ue||!!ne||me,[ue,me,ne]),vt=l.useRef(w),Qt=l.useRef("V_0_2");l.useEffect(()=>{Qt.current=k.model_version},[k.model_version]),l.useEffect(()=>{vt.current=w},[w]),l.useEffect(()=>{he!=null&&he.prompt&&A(ie=>({...ie,prompt:he.prompt}))},[he]),l.useEffect(()=>{ne&&ne.length>0&&I(ie=>ie.filter(re=>re.stage!==Ft.STARTED))},[ne]);const kt=l.useMemo(()=>w.filter(ie=>{var re;return(!!((re=ie.data.res)!=null&&re.request_id)||!!ie.data.generation.request_id)&&!ie.data.generation.is_completed}),[w]),{data:Ct,refetch:so}=Ve(["retrieveRequestsInFlight"],()=>p==null?void 0:p.retrieveRequestsInFlight(),{enabled:!!o,staleTime:1/0}),{isLoading:gn,refetch:Dn}=Ve(["generationsGetRequestStatsPost"],()=>u==null?void 0:u.generationsGetRequestStatsPost({retrieveGenerationRequestsStatsRequest:{includeInactive:!1}}),{enabled:!!u&&!!o}),kn=l.useCallback(ie=>{const re={};for(const be of Object.values(ie)){const Me=vt.current.find(He=>{var Ce;return(((Ce=He.data.res)==null?void 0:Ce.request_id)??He.data.generation.request_id)===be.request_id}),{is_completed:ze}=be;if(Me&&be.request_id){const He={...Me,stage:ze?Ft.DONE:Ft.INTERMEDIATE,data:{...Me==null?void 0:Me.data,generation:be}};re[be.request_id]=He}}return re},[]),[An,Vn]=l.useState(!1);l.useEffect(()=>{if(Ct!==void 0){if(Object.keys(Ct.samplingRequests).length>0){Ct.samplingRequests.some(Me=>!Me.job_id&&!0||Me.job_id&&Me.has_started)&&ct(!0);const ie=Object.values(Ct.samplingRequests),re=[],be=kn(ie);ie.forEach((Me,ze)=>{const He=vt.current.find(ft=>{var Ze;return((Ze=ft.data.res)==null?void 0:Ze.request_id)===Me.request_id}),{is_completed:Ce}=Me;if(!He){const ft={stage:Ce?Ft.DONE:Ft.INTERMEDIATE,data:{timestamp:Date.now()+ze,generation:Me}};re.push(ft)}}),I(Me=>[...Me.map(ze=>ze.data.generation.request_id&&be[ze.data.generation.request_id]?be[ze.data.generation.request_id]:ze),...re])}Vn(!0)}},[kn,Ct]);const{data:mn}=Ve(["retrieveRequestsController"],()=>p==null?void 0:p.retrieveRequestsController({retrieveRequestsRequest:{requestIds:kt.map(ie=>{var re;return((re=ie.data.res)==null?void 0:re.request_id)??ie.data.generation.request_id}).filter(ie=>ie!==void 0)}}),{enabled:!!o&&kt.length>0,staleTime:1/0,refetchInterval:2e3});l.useEffect(()=>{if(mn){const ie=kn(Object.values(mn.samplingRequests));I(re=>re.map(be=>be.data.generation.request_id&&ie[be.data.generation.request_id]?ie[be.data.generation.request_id]:be))}},[kn,mn]);const ln=l.useCallback(()=>(A({...xo,use_autoprompt:k.use_autoprompt,variation_input:k.variation_input,aspectRatio:k.aspectRatio,private:k.private,model_version:k.model_version,tiling_preset:k.tiling_preset,selected_aspect_ratio_v2:k.selected_aspect_ratio_v2,generation_speed:k.generation_speed,timestamp:Date.now()}),k),[k]),cn=l.useCallback(ie=>{var Ce,ft,Ze,Vt,un,ho;const{request:re,parent:be,autoCropAspectRatio:Me}=ie,ze=Date.now();(Ce=q.current)==null||Ce.call(q,{generationTimestamp:ze,request:re});const He=(ft=re.aspect_ratio)==null?void 0:ft.split(":");return I([...vt.current,{stage:Ft.STARTED,data:{timestamp:ze,req:re,generation:{creation_time_float:Date.now()/1e3,user_prompt:re.prompt??"",user:{display_handle:o.displayHandle,photo_url:o.externalPhotoUrl,user_id:o.userId,subscription_plan_id:null,badge:null},aspect_ratio:re.aspect_ratio??(re.resolution?`${re.resolution.width}:${re.resolution.height}`:"1:1"),private:!!re.private,request_type:((Ze=re.parent)==null?void 0:Ze.type)==="SUPER_RES"?"SUPER_RES":re.tiling_preset!==void 0?"TILING":"TEXT_TO_IMAGE",can_upscale:!1,width:((Vt=re.resolution)==null?void 0:Vt.width)??parseInt((He==null?void 0:He[0])??"1"),height:((un=re.resolution)==null?void 0:un.height)??parseInt((He==null?void 0:He[1])??"1"),parent:{...re.parent,should_hide:!1,weight:((ho=re.parent)==null?void 0:ho.weight)??50}},parent:be,autoCropAspectRatio:Me}}]),ze},[o]),Fn=l.useCallback(ie=>{var ze,He,Ce;const{request:re}=ie,be=Date.now(),Me={user_id:o.userId,model_version:re.model};return I([...vt.current,{stage:Ft.STARTED,data:{timestamp:be,req:Me,generation:{creation_time_float:Date.now()/1e3,user_prompt:re.prompt??"",user:{display_handle:o.displayHandle,photo_url:o.externalPhotoUrl,user_id:o.userId,subscription_plan_id:null,badge:null},aspect_ratio:((ze=re.resolution)==null?void 0:ze.aspectRatio)??(re.resolution?`${re.resolution.width}:${re.resolution.height}`:"1:1"),private:!!re._private,request_type:"TEXT_TO_IMAGE",can_upscale:!1,width:((He=re.resolution)==null?void 0:He.width)??1,height:((Ce=re.resolution)==null?void 0:Ce.height)??1}}}]),be},[o]),Zt=l.useCallback((ie,re)=>{var ze;if(!re.request_id)return;const be=vt.current.find(He=>He.data.timestamp===ie);if(!be)return;const Me={stage:Ft.INTERMEDIATE,data:{...be.data,res:re,generation:{creation_time_float:Date.now()/1e3,request_id:re.request_id,responses:re.response_ids.map(He=>({response_id:He,self_like:!1,num_likes:0,num_remixes:0})),user_prompt:re.caption,user:{display_handle:o.displayHandle,photo_url:o.externalPhotoUrl,user_id:o.userId,subscription_plan_id:null,badge:null},aspect_ratio:re.aspect_ratio,private:!!be.data.generation.private,request_type:be.data.generation.request_type}}};I(vt.current.map(He=>He.data.timestamp===ie?Me:He)),(ze=V.current)==null||ze.call(V,{generationTimestamp:ie,requestId:re.request_id})},[o]),St=l.useCallback((ie,re)=>{var ft;if(!re.requestId)return;const be=vt.current.find(Ze=>Ze.data.timestamp===ie);if(!be)return;const Me=eS(re.resolution),{width:ze,height:He}=tS(Me),Ce={stage:Ft.INTERMEDIATE,data:{...be.data,res:{caption:"",request_id:re.requestId,response_ids:[],user_id:o.userId,rejected_prompt_id:re.rejectedPromptId,aspect_ratio:Me},generation:{creation_time_float:Date.now()/1e3,request_id:re.requestId,responses:[],user_prompt:"",user:{display_handle:o.displayHandle,photo_url:o.externalPhotoUrl,user_id:o.userId,subscription_plan_id:null,badge:null},aspect_ratio:Me,private:!!be.data.generation.private,request_type:be.data.generation.request_type,can_upscale:!1,width:ze,height:He}}};I(Ze=>Ze.map(Vt=>Vt.data.timestamp===ie?Ce:Vt)),(ft=V.current)==null||ft.call(V,{generationTimestamp:ie,requestId:re.requestId})},[o]),dn=l.useCallback(ie=>{I(re=>re.filter(be=>be.data.timestamp!==ie))},[]),Dt=l.useCallback((ie,re)=>{const be=vt.current.find(Me=>Me.data.timestamp===ie);if(be&&re){const Me=be.data.generation.user_prompt;Fe({prompt:Me??"",rejectedPromptId:re}),du(Date.now()),I(vt.current.filter(ze=>ze.data.timestamp!==ie))}},[]),At=l.useCallback(()=>{Fe(null)},[]),xn=l.useCallback(ie=>{A(ie)},[]),jn=l.useCallback(()=>{I(vt.current.filter(ie=>ie.stage!==Ft.DONE))},[]),vn=l.useCallback(async ie=>{ie.status===403?Lt():ie.status===503?H(!0):ne||(e({eventKey:"UNEXPECTED_SAMPLE_ERROR"}),x("Something went wrong. Please try again later.")),I(vt.current.filter(re=>re.stage!==Ft.STARTED))},[H,ne,x,e]),{mutateAsync:Gt}=wo({mutationFn:fS,onSuccess:({timestamp:ie,res:re})=>{var be;re.rejected_prompt_id?(Dt(ie,re.rejected_prompt_id),(be=Q.current)==null||be.call(Q,{generationTimestamp:ie})):Zt(ie,re)},onError:vn,retry:(ie,re)=>re.status===403&&ie<3});l.useEffect(()=>{k.prompt&&k.prompt.length>0&&N(null)},[N,k.prompt]);const en=l.useMemo(()=>{var ie,re;return!!((ie=k==null?void 0:k.variation_input)!=null&&ie.image_id)||!!((re=k==null?void 0:k.variation_input)!=null&&re.response_id)},[(fu=k==null?void 0:k.variation_input)==null?void 0:fu.image_id,(gu=k==null?void 0:k.variation_input)==null?void 0:gu.response_id]),Kn=l.useMemo(()=>!!k.retry_inpaint_data,[k.retry_inpaint_data]);l.useEffect(()=>{!en&&$!=="generate"&&X("generate")},[en,$,X]);const[ao,de]=l.useState(!1),Pe=l.useCallback(ie=>{if(!u)return;const{response_id:re,configs:be}=ie,{prompt:Me,style_expert:ze,use_autoprompt:He,aspect_ratio:Ce}=be;if(!Me||Me.length===0){N(Date.now);return}H();const ft=cn({request:{prompt:Me,user_id:(o==null?void 0:o.userId)??"",aspect_ratio:Ce,private:k.private,model_version:"V_1_5",use_autoprompt:He},parent:void 0,autoCropAspectRatio:Ce});u.postRetryGeneration({postRetryGenerationRequest:{samplingResponseId:re,prompt:Me,magicPromptOption:He,styleType:ze?wm.get(ze):void 0,_private:k.private}}).then(Ze=>{var Vt;Ze.rejectedPromptId?(Dt(ft,Ze.rejectedPromptId),(Vt=Q.current)==null||Vt.call(Q,{generationTimestamp:ft})):St(ft,Ze)}).catch(vn)},[cn,k.private,u,vn,St,Dt,o==null?void 0:o.userId,H]),J=l.useCallback(ie=>{if(ie){if(T(""),Z(null),xn({...k,timestamp:Date.now()}),!ie.type.startsWith("image")||ie.type.endsWith("svg+xml")||ie.type.endsWith("avif")){Z("FILE_TYPE");return}if(ie.size/1024/1024>Gi){Z("FILE_SIZE");return}T(URL.createObjectURL(ie))}else{Z("UNEXPECTED");return}},[k,xn]),U=l.useCallback(ie=>{var wu,bu,Cu,_u,Iu,Su,Ru,Tu,Eu,ku,Au,ju,Pu;if(We||!(o!=null&&o.userId)||ue)return;let{prompt:re,autoCropAspectRatio:be}=ie;const{callback:Me,generationDataOverride:ze,generationInputModeOverride:He}=ie;re=re==null?void 0:re.replace(/^\s*/,""),re=re==null?void 0:re.replace(/\s*,*\s*$/,"");const Ce=ze??k;if(Ce.retry_inpaint_data){Pe({response_id:Ce.retry_inpaint_data.response_id,configs:{prompt:re??Ce.prompt??"",use_autoprompt:Ce.use_autoprompt,style_expert:Ce.style_expert,aspect_ratio:Ce.aspectRatio}});return}let ft=(re??Ce.prompt??"").split(", ").reverse();if(ft.filter(po=>po.length>0).length===0&&(He??$)!=="upscale"){N(Date.now),A({...Ce,prompt:""});return}H();let Ze;(He??$)==="upscale"?Ze="SUPER_RES":((He??$)==="remix"||Ce!=null&&Ce.variation_input)&&(Ze="VARIATION");let Vt;if(Ze){const po=((wu=Ce.variation_input)==null?void 0:wu.image_weight)??(Ze==="SUPER_RES"?100:50);(bu=Ce==null?void 0:Ce.variation_input)!=null&&bu.request_id&&(Ce!=null&&Ce.variation_input.response_id)?Vt={request_id:Ce==null?void 0:Ce.variation_input.request_id,response_id:Ce==null?void 0:Ce.variation_input.response_id,weight:po,type:Ze}:(Cu=Ce==null?void 0:Ce.variation_input)!=null&&Cu.image_id&&(Vt={image_id:Ce==null?void 0:Ce.variation_input.image_id,weight:po,type:Ze})}const un=Ze==="SUPER_RES"?"V_0_3":Ce.model_version;ft=ft.slice(0,Math.max(0,ft.findIndex(po=>!Ys.includes(po))));const ho=rs(un)?Ge.filter(po=>!ft.includes(po)):[],tl=re??Ce.prompt?`${re??Ce.prompt}${ho.length>0?`, ${ho.join(", ")}`:""}`:void 0,pi=Ce.selected_aspect_ratio_v2&&Yn(un)?Vt&&((_u=Ce.imageParent)!=null&&_u.width)&&((Iu=Ce.imageParent)!=null&&Iu.height)?{width:(Su=Ce.imageParent)==null?void 0:Su.width,height:(Ru=Ce.imageParent)==null?void 0:Ru.height}:{width:Ce.selected_aspect_ratio_v2.width,height:Ce.selected_aspect_ratio_v2.height}:void 0,Xx=Ce.aspectRatio??"1:1",yu={prompt:tl,user_id:o.userId,aspect_ratio:pi?void 0:Xx,resolution:pi,private:((Tu=i==null?void 0:i.subscriptionQuota)==null?void 0:Tu.privateGeneration)&&!!Ce.private,model_version:un,use_autoprompt:Ze==="SUPER_RES"?"OFF":Ce.use_autoprompt,seed:Ce.seed,negative_prompt:Ce.negative_prompt,sampling_speed:Ce.generation_speed,num_steps:Ce.num_steps,tiling_preset:un!=="V_0_3"||Ze==="SUPER_RES"?void 0:Ce.tiling_preset,parent:Vt,upscale_details_weight:Ze==="SUPER_RES"?Ce.upscale_details_weight:void 0,style_expert:un==="V_1_5"||un==="V_2_1"?Ce.style_expert:void 0,color_palette:un==="V_1_5"?(Eu=Ce.color_palette)==null?void 0:Eu.members:void 0};if(At(),Ze==="SUPER_RES"&&!be&&((ku=Ce.imageParent)!=null&&ku.width)&&((Au=Ce.imageParent)!=null&&Au.height)){const po=(((ju=Ce.imageParent)==null?void 0:ju.width)/((Pu=Ce.imageParent)==null?void 0:Pu.height)).toFixed(3);be=dr[Ug(po)]}const Yx=cn({request:yu,parent:Ze?Ce.imageParent:void 0,autoCropAspectRatio:be});ct(!0),Me==null||Me(),Gt({timestamp:Yx,req:yu})},[We,o==null?void 0:o.userId,ue,k,$,Ge,(mu=i==null?void 0:i.subscriptionQuota)==null?void 0:mu.privateGeneration,At,cn,Gt,Pe,H]),pe=l.useCallback(ie=>{var un;const{response_id:re,parent:be}=ie,Me=be.request_id,ze=!!be.private,He=(un=be.responses)==null?void 0:un.find(ho=>ho.response_id===re),Ce=He!=null&&He.prompt&&(be.use_autoprompt||He.is_autoprompt)?He.prompt:be.user_prompt,ft=La(Ce),Ze=be.aspect_ratio,Vt={...k,variation_input:{request_id:Me,response_id:re,private:ze},prompt:ft.prompt,timestamp:Date.now(),aspectRatio:Ze,negative_prompt:a?be.user_negative_prompt:void 0,model_version:!Yn(k.model_version)&&!["16:10","1:1","10:16"].includes(Ze)?"V_1_5":k.model_version,tiling_preset:d?be.tiling_preset:void 0,imageParent:be,retry_inpaint_data:void 0};xn(Vt),st(ft.styles),!d&&be.tiling_preset?x(r.jsxs(r.Fragment,{children:["Tile setting from the generation cannot be added. Get"," ",r.jsx(xh,{})," to get access."]})):a||be.user_negative_prompt&&x(r.jsxs(r.Fragment,{children:["Negative prompt from the generation cannot be added. Get"," ",r.jsx(xh,{})," to get access."]}))},[k,a,d,xn,x]);l.useEffect(()=>{var ie,re;k.imageParent||((ie=k.variation_input)!=null&&ie.request_id?ud(k.variation_input.request_id).then(be=>{A({...k,imageParent:be})}):(re=k.variation_input)!=null&&re.image_id&&Da(k.variation_input.image_id).then(be=>{A({...k,imageParent:be})}))},[k,A]);const Te=l.useMemo(()=>!!w.length&&w[0].stage!==Ft.DONE,[w]),Ie=l.useCallback(ie=>{I(re=>re.length===0?re:[{...re[0],data:{...re[0].data,generation:ie}},...re.slice(1)])},[]),[Ke,dt]=l.useState(!0),ot=l.useCallback(ie=>{var ze;const re=ie.model_version??k.model_version,be=re!=="V_0_2"?ie.selected_aspect_ratio_v2??k.selected_aspect_ratio_v2:void 0;let Me=ie.aspectRatio??k.aspectRatio;be?Me=be.aspectRatio:en||(Me=Me?zg(Me,re):(ze=ie.selected_aspect_ratio_v2)==null?void 0:ze.aspectRatio),Pg({default_to_private_generation_if_available:ie.private??k.private,default_model_version:re,default_aspect_ratio:Me,default_autoprompt_option:ie.use_autoprompt??k.use_autoprompt,default_resolution:be,default_sampling_speed:ie.generation_speed??k.generation_speed,default_generation_preview_expanded:ie.default_generation_preview_expanded??Ke}),dt(ie.default_generation_preview_expanded??Ke),A({...k,...ie,aspectRatio:Me})},[k,en,Ke]);l.useEffect(()=>{A(ie=>{var re,be;return{...ie,private:((re=i==null?void 0:i.subscriptionQuota)==null?void 0:re.privateGeneration)&&(s==null?void 0:s.default_to_private_generation_if_available),aspectRatio:(s==null?void 0:s.default_aspect_ratio)??xo.aspectRatio,model_version:!(s!=null&&s.default_model_version)||(s==null?void 0:s.default_model_version)==="V_0_2"?xo.model_version:s==null?void 0:s.default_model_version,use_autoprompt:(s==null?void 0:s.default_autoprompt_option)??xo.use_autoprompt,selected_aspect_ratio_v2:s!=null&&s.default_resolution&&(s!=null&&s.default_aspect_ratio)?{width:s.default_resolution.width,height:s.default_resolution.height,aspectRatio:s.default_aspect_ratio}:xo.selected_aspect_ratio_v2,generation_speed:(be=i==null?void 0:i.activeSubscription)!=null&&be.planId?(s==null?void 0:s.default_sampling_speed)??xo.generation_speed:xo.generation_speed}}),dt((s==null?void 0:s.default_generation_preview_expanded)??!0)},[s==null?void 0:s.default_to_private_generation_if_available,s==null?void 0:s.default_model_version,s==null?void 0:s.default_autoprompt_option,(xu=i==null?void 0:i.subscriptionQuota)==null?void 0:xu.privateGeneration,s==null?void 0:s.default_aspect_ratio,s==null?void 0:s.default_resolution,s==null?void 0:s.default_sampling_speed,(vu=i==null?void 0:i.activeSubscription)==null?void 0:vu.planId,s==null?void 0:s.default_generation_preview_expanded]);const[jt,To]=l.useState(!1),[at,yn]=l.useState([]),[tn,Go]=l.useState(0),Ya=l.useMemo(()=>tn>0,[tn]),Fx=l.useCallback(ie=>{if(Ya)return tn===at.length?yn([...at,ie]):(at[tn]=ie,yn(at)),Go(tn-1),at[tn-1]},[tn,Go,Ya,at,yn]),Qa=l.useMemo(()=>tn<at.length-1,[tn,at.length]),zx=l.useCallback(ie=>{if(Qa)return at[tn]=ie,yn([...at]),Go(tn+1),at[tn+1]},[tn,Go,Qa,yn,at]),ui=l.useCallback(ie=>{tn>=at.length&&k.prompt&&k.prompt.length?(yn([...at,k.prompt,ie]),Go(at.length+1)):at.length>0&&at[at.length-1].length===0&&ie.length!==0?(at[at.length-1]=ie,yn([...at]),Go(at.length-1)):(yn([...at,ie]),Go(at.length)),A({...k,prompt:ie,timestamp:Date.now()})},[tn,Go,k,yn,at]),Za=l.useRef(!1);l.useEffect(()=>{L&&k.prompt!==""&&!Za.current&&(ui(""),Za.current=!0)},[L,ui,k.prompt]),l.useEffect(()=>{D&&(O(null),ui(D),Za.current=!1,T(null))},[D,ui,T]),l.useEffect(()=>{T(null)},[T,k.imageParent]);const[Ux,Gx]=l.useState(pt(oe.SEARCH,window.location.pathname)?"search":"generate"),[Hx,qx]=l.useState({members:[]}),[Wx,du]=l.useState(Date.now()),{data:hi}=Ve(["getListCanvases"],()=>h.getListCanvases(),{enabled:!!h&&!!o,staleTime:6e4}),el=l.useMemo(()=>!!(i!=null&&i.noActiveSubscription)&&!!(hi!=null&&hi.canvasListItems)&&hi.canvasListItems.length>=2,[hi,i==null?void 0:i.noActiveSubscription]),$x=l.useCallback((ie,re)=>{const{responseId:be,requestId:Me,imageId:ze,title:He}=ie;if(el&&(be||ze)){n("CANVAS_COUNT_LIMIT");return}v(!0);try{h.getListCanvases().then(Ce=>{if(i!=null&&i.noActiveSubscription&&(Ce!=null&&Ce.canvasListItems)&&Ce.canvasListItems.length>=2&&(be||ze)){n("CANVAS_COUNT_LIMIT"),v(!1);return}else if(Ce.canvasListItems&&Ce.canvasListItems.length>0&&!be&&!ze){const ft=Ce.canvasListItems[0].canvasId;m(oe.CANVAS.replace(":canvas_id",ft))}else h==null||h.putCanvas({putCanvasRequest:{title:vm(He),canvasJson:JSON.stringify(ym)}}).then(ft=>{const Ze=be&&Me?{response_id:be,request_id:Me}:ze?{image_id:ze}:void 0;re&&Ze&&(Ze.action=re),m(oe.CANVAS.replace(":canvas_id",ft.canvas.canvasId??""),{searchParams:new URLSearchParams(Ze)})})})}catch{e({eventKey:"CANVAS_OPEN_ERROR"})}},[h,el,m,v,n,i==null?void 0:i.noActiveSubscription,e]),Vx=l.useCallback(ie=>{const{responseId:re,imageId:be,defaultPrivate:Me,parentInfo:ze}=ie;_(re?{url:Pt(re,"balanced","response"),defaultPrivate:!!Me,parentInfo:ze}:be?{url:Pt(be,"balanced","edit"),defaultPrivate:!!Me,parentInfo:ze}:{url:!0,defaultPrivate:!!Me})},[]),Kx=l.useCallback(()=>{_({url:!1,defaultPrivate:!1})},[]),Jx={inSessionGenerations:w.sort((ie,re)=>re.data.timestamp-ie.data.timestamp),markGenerationResponded:Zt,clearPromptError:At,clearSuccessGeneration:jn,getAndClearGenerationInput:ln,setGenerationInput:xn,generationInput:k,promptErrorData:he,isSubmitDisabled:We,handleSubmitGeneration:U,generationThrottle:ue,suggestions:Ge,setSuggestions:st,addImagePrompt:pe,generationBlocked:me||!!ne,generationThrottleCountDown:fe>0?fe:0,generationInProgress:Te,setLatestGeneration:Ie,setGenerationSetting:ot,lastSwitchTabGenerationTimestamp:bt,setLastSwitchTabGenerationTimestamp:En,serverErrorReason:ne,showEmptyPromptWarning:E,generatedInSession:nt,imageEditState:y,hasImagePrompt:en,isRetryInpaint:Kn,generationInputOpen:R,setGenerationInputOpen:S,imageDescription:D,setImageDescription:O,showAdvancedFeatures:jt,setShowAdvancedFeatures:To,loadingDescription:L,handleDescribeImage:Ye,descriptionMap:M,imageUploadLocalSrc:F,setImageUploadLocalSrc:T,pushInNewPrompt:ui,hasPrevPrompt:Ya,prevPromptClick:Fx,hasNextPrompt:Qa,nextPromptClick:zx,setDescriptionMap:z,uploadError:j,setUploadError:Z,uploadedImageId:ee,setDescribeError:De,describeError:qe,showRemixAspectRatioWarning:ao,setShowRemixAspectRatioWarning:de,generationInputMode:$,setGenerationInputMode:X,selectedInputBox:Ux,setSelectedInputBox:Gx,customColorPalette:Hx,setCustomColorPalette:qx,dismissedGenerationProgressAt:Wx,setDismissedGenerationProgressAt:du,creditCost:ce,generationPreviewOpen:Ke,openEditor:Vx,openCanvas:$x,closeEditor:Kx,onGenerationSubmitRef:q,onGenerationRespondedRef:V,onPromptRejectedRef:Q,addInProgressCanvasGeneration:Fn,markCanvasGenerationResponded:St,deleteInSessionGeneration:dn,refreshUserTaskQuotaStatsOnSample:H,inflightRequestStateSynced:An,queuedRequestStatsLoading:gn,refetchQueuedRequestStats:Dn,refetchRequestsInFlight:so,createCanvasLocked:el,showGenerationPreview:G,setShowGenerationPreview:B,handleUploadImage:J,slowCredit:ve,priorityCredit:se,autoSearchPrompt:W,setAutoSearchPrompt:Y,isFetchingUserTaskQuotaStats:Se};return r.jsx(ye.Provider,{value:Jx,children:t})},Xe=t=>{const{eventKey:e,metaData:n}=t,o={path:window.location.pathname,triggeredUtcTime:Date.now(),userAgent:window.navigator.userAgent,isMobileLayout:window.innerWidth<900,...n},i={event_key:e,metadata:JSON.stringify(o)};Vc(e,o),Le("/api/e/submit",{headers:{"Content-Type":"application/json",...Ne},method:"POST",body:JSON.stringify(i)})},Ee=()=>{const{userProfileState:t,sessionId:e,location:n}=l.useContext(ge),{generationInProgress:o}=l.useContext(ye),i=l.useCallback(()=>({path:window.location.pathname,triggeredUtcTime:Date.now(),userAgent:window.navigator.userAgent,isMobileLayout:window.innerWidth<900,userHandle:t==null?void 0:t.displayHandle,userId:t==null?void 0:t.userId,sessionId:e,location:n,generationInProgress:o}),[t==null?void 0:t.displayHandle,t==null?void 0:t.userId,e,n,o]);return l.useCallback(s=>{const{eventKey:c,metaData:d}=s,u={...i(),...d},h={event_key:c,metadata:JSON.stringify(u)};Vc(c,u),Le("/api/e/submit",{headers:{"Content-Type":"application/json",...Ne},method:"POST",body:JSON.stringify(h)})},[i])},bT=t=>{const{type:e}=t,n=we(),o=Nt(),i=xe(n.breakpoints.down("md")),a=Ee(),[s,c]=l.useState(!1),{slowCredit:d}=l.useContext(ye),u=l.useMemo(()=>{if(e){if(e==="FREE_USER_ZERO_SLOW_PROMPT")return d?r.jsxs(Eo,{children:[r.jsx(zn,{children:"You reached your Free plan limit."})," Please wait for your weekly limit to reset in"," ",zi(d.refresh),", or"," ",r.jsx(zn,{href:oe.PRICING,onClick:m=>{m.preventDefault(),a({eventKey:"PROMPT_LIMIT_BANNER_V2_UPGRADE_CLICK"}),o({conversionReason:lt.DailyLimitBannerV2})},children:"upgrade your plan."})]}):r.jsxs(Eo,{children:[r.jsx(zn,{children:"You reached your Free plan limit."})," Please wait for your daily limit to reset in"," ",th(),", or"," ",r.jsx(zn,{href:oe.PRICING,onClick:m=>{m.preventDefault(),a({eventKey:"PROMPT_LIMIT_BANNER_V2_UPGRADE_CLICK"}),o({conversionReason:lt.DailyLimitBannerV2})},children:"upgrade your plan."})]});if(e==="BASIC_SUBSCRIBER_ZERO_PRIORITY_PROMPT")return r.jsxs(Eo,{children:[r.jsx(zn,{children:"You ran out of priority credits."})," You’re now in the slow queue until the next billing cycle. Skip the wait with a top-up, or"," ",r.jsx(zn,{href:oe.PRICING,onClick:m=>{m.preventDefault(),a({eventKey:"PROMPT_LIMIT_BANNER_V2_UPGRADE_CLICK"}),o({conversionReason:lt.Unknown})},children:"get Plus for more priority credits."})]});if(e==="BASIC_SUBSCRIBER_ZERO_SLOW_PROMPT")return r.jsxs(Eo,{children:[r.jsx(zn,{children:"You reached your slow credit limit."})," Your daily limit resets in ",th(),". Top up now to skip the wait, or"," ",r.jsx(zn,{href:oe.PRICING,onClick:m=>{m.preventDefault(),a({eventKey:"PROMPT_LIMIT_BANNER_V2_UPGRADE_CLICK"}),o({conversionReason:lt.Unknown})},children:"get Plus for more priority credits."})]});if(e==="PLUS_SUBSCRIBER_ZERO_PRIORITY_PROMPT")return r.jsxs(Eo,{children:[r.jsx(zn,{children:"You ran out of priority credits."})," You’re now in the slow queue until the next billing cycle. Skip the wait with a top-up, or"," ",r.jsx(zn,{href:oe.PRICING,onClick:m=>{m.preventDefault(),a({eventKey:"PROMPT_LIMIT_BANNER_V2_UPGRADE_CLICK"}),o({conversionReason:lt.Unknown})},children:"get Pro for more priority credits."})]});if(e==="PRO_SUBSCRIBER_ZERO_PRIORITY_PROMPT")return r.jsxs(Eo,{children:[r.jsx(zn,{children:"You ran out of priority credits."})," You’re now in the slow queue until the next billing cycle. Top up now to skip the wait."]});if(e==="FREE_USER_SLOW_QUEUE_FULL"||e==="SUBSCRIBER_SLOW_QUEUE_FULL")return r.jsxs(Eo,{children:["Our slow queue is currently full. Please try again later, or"," ",r.jsx(zn,{href:oe.PRICING,onClick:m=>{m.preventDefault(),a({eventKey:"SLOW_QUEUE_FULL_BANNER_V2_UPGRADE_CLICK"}),o({conversionReason:lt.SlowQueueFullBannerV2})},children:"upgrade your plan to use the priority queue."})]});if(e==="BEST_PLAN_SLOW_QUEUE_FULL")return r.jsxs(Eo,{children:["Our slow queue is currently full. Please try again later, or"," ",r.jsx(zn,{children:"get a top-up to use the priority queue."})]})}else return null},[e,d,a,o]),h=l.useMemo(()=>r.jsx(It,{label:i?"Top up":"Top up credits",fullWidth:i,onClick:()=>{a({eventKey:"PROMPT_LIMIT_BANNER_V2_TOP_UP_CLICK"}),c(!0)}}),[i,a]),p=l.useMemo(()=>r.jsx(ht,{label:i?"Top up":"Top up credits",fullWidth:i,onClick:()=>{a({eventKey:"PROMPT_LIMIT_BANNER_V2_TOP_UP_CLICK"}),c(!0)}}),[i,a]),g=l.useMemo(()=>{if(e){if(e==="FREE_USER_ZERO_SLOW_PROMPT")return r.jsx(ht,{label:"See plans",fullWidth:i,onClick:()=>{a({eventKey:"PROMPT_LIMIT_BANNER_V2_UPGRADE_CLICK"}),o({conversionReason:lt.DailyLimitBannerV2})}});if(e==="BASIC_SUBSCRIBER_ZERO_PRIORITY_PROMPT"||e==="BASIC_SUBSCRIBER_ZERO_SLOW_PROMPT")return r.jsxs(r.Fragment,{children:[h,r.jsx(C,{width:8}),r.jsx(ht,{label:"See plans",fullWidth:i,onClick:()=>{a({eventKey:"PROMPT_LIMIT_BANNER_V2_UPGRADE_CLICK"}),o({conversionReason:lt.Unknown})}})]});if(e==="PLUS_SUBSCRIBER_ZERO_PRIORITY_PROMPT")return r.jsxs(r.Fragment,{children:[h,r.jsx(C,{width:8}),r.jsx(ht,{label:"See plans",fullWidth:i,onClick:()=>{a({eventKey:"PROMPT_LIMIT_BANNER_V2_UPGRADE_CLICK"}),o({conversionReason:lt.Unknown})}})]});if(e==="PRO_SUBSCRIBER_ZERO_PRIORITY_PROMPT")return p;if(e==="FREE_USER_SLOW_QUEUE_FULL")return r.jsx(ht,{label:"See plans",fullWidth:i,onClick:()=>{a({eventKey:"SLOW_QUEUE_FULL_BANNER_V2_UPGRADE_CLICK"}),o({conversionReason:lt.SlowQueueFullBannerV2})}});if(e==="SUBSCRIBER_SLOW_QUEUE_FULL")return r.jsxs(r.Fragment,{children:[h,r.jsx(C,{width:8}),r.jsx(ht,{label:"See plans",fullWidth:i,onClick:()=>{a({eventKey:"SLOW_QUEUE_FULL_BANNER_V2_UPGRADE_CLICK"}),o({conversionReason:lt.Unknown})}})]});if(e==="BEST_PLAN_SLOW_QUEUE_FULL")return p}else return null},[e,i,a,o,h,p]);return!u&&!g?null:r.jsxs(CT,{flexDirection:i?"column":"row",alignItems:i?void 0:"center",children:[r.jsxs(_T,{children:[r.jsx(Eo,{marginRight:1,children:e&&["FREE_USER_SLOW_QUEUE_FULL","SUBSCRIBER_SLOW_QUEUE_FULL","BEST_PLAN_SLOW_QUEUE_FULL"].includes(e)?"🐢":"🪫"}),u]}),r.jsx(IT,{marginTop:i?"12px":0,children:g}),s&&r.jsx(yr,{open:s,onClose:()=>c(!1),topUpReason:vr.PromptLimitTopUp})]})},Eo=b(le)(()=>({fontSize:16,lineHeight:"24px",color:f("secondary")})),zn=b("a")(()=>({color:f("primary"),fontWeight:600})),CT=b(C)({display:"flex",justifyContent:"center"}),_T=b(C)({display:"flex",justifyContent:"center",alignItems:"flex-start"}),IT=b(C)({display:"flex",justifyContent:"center",alignItems:"center",marginLeft:24,minWidth:"max-content"}),ST=["BASIC_SUBSCRIBER_ZERO_PRIORITY_PROMPT","PLUS_SUBSCRIBER_ZERO_PRIORITY_PROMPT","PRO_SUBSCRIBER_ZERO_PRIORITY_PROMPT"],Ph="latestZeroPriorityPromptTimestampStorageKey",RT=1296e6,TT=t=>{const{setBannerContent:e,setOnDismiss:n}=t,o=Rn(),{subscriptionStatus:i,isBasicSubscriber:a,isPlusSubscriber:s,isProSubscriber:c,isTeamSubscriber:d,isFetchingUserSubscriptionStatus:u}=l.useContext(ge),{serverErrorReason:h,priorityCredit:p,slowCredit:g,isFetchingUserTaskQuotaStats:m}=l.useContext(ye),v=l.useMemo(()=>{if(p)return p.total??0},[p]),x=l.useMemo(()=>{if(g)return Math.max(g.total,0)},[g]),y=l.useMemo(()=>{const w=localStorage.getItem(Ph);return!w||!parseInt(w)?!0:parseInt(w)+RT<Date.now()},[]),_=l.useMemo(()=>{if(!(u||m||pt(oe.PRICING,o.pathname)||pt(oe.API_MANAGEMENT,o.pathname)||!i)){if(h===qn.ServerBusy)return i!=null&&i.noActiveSubscription?"FREE_USER_SLOW_QUEUE_FULL":c||d?"BEST_PLAN_SLOW_QUEUE_FULL":"SUBSCRIBER_SLOW_QUEUE_FULL";if(i!=null&&i.noActiveSubscription&&(h===qn.LimitReached||h===qn.InsufficientFunds||x===0))return"FREE_USER_ZERO_SLOW_PROMPT";if(a&&v===0&&!(h===qn.LimitReached||h===qn.InsufficientFunds||x===0)&&y)return"BASIC_SUBSCRIBER_ZERO_PRIORITY_PROMPT";if(a&&v===0&&(h===qn.LimitReached||x===0))return"BASIC_SUBSCRIBER_ZERO_SLOW_PROMPT";if(s&&v===0&&y)return"PLUS_SUBSCRIBER_ZERO_PRIORITY_PROMPT";if((c||d)&&v===0&&y)return"PRO_SUBSCRIBER_ZERO_PRIORITY_PROMPT"}},[u,m,o.pathname,i,h,x,a,v,y,s,c,d]);l.useEffect(()=>{_?(ST.includes(_)&&n(()=>localStorage.setItem(Ph,Date.now().toString())),e(r.jsx(bT,{type:_}))):e(null)},[_,e,n])},bm=l.forwardRef((t,e)=>{const{dismissBanner:n,bannerContent:o}=t,i=we(),a=xe(i.breakpoints.down("md"));return o?r.jsxs(kT,{ref:e,sx:{alignItems:a?"flex-start":"center",zIndex:s=>s.zIndex.drawer+137},children:[r.jsx(ET,{paddingLeft:a?0:6,children:o}),r.jsx(C,{width:8}),r.jsx("div",{style:{transform:a?"translateX(8px) translateY(-8px)":void 0},children:r.jsx(Be,{icon:r.jsx(wt,{color:f("quietButtonText")}),onClick:n})})]}):null});bm.displayName="AppBanner";const ET=b(C)({flex:1,display:"flex",justifyContent:"center",alignItems:"center"}),kT=b(C)(()=>({position:"sticky",width:"100%",top:0,backgroundColor:f("infoCardBackground"),outlineColor:f("borderHighlight"),outlineWidth:.5,outlineStyle:"solid",display:"flex",flexDirection:"row",justifyContent:"space-between",padding:16})),zo=l.createContext({bannerHeight:0}),AT=({children:t})=>{const e=l.useRef(null),[n,o]=l.useState(0),[i,a]=l.useState(null),[s,c]=l.useState(!1),d=l.useRef(null),u=l.useCallback(m=>d.current=m,[]);TT({setBannerContent:a,setOnDismiss:u});const h=l.useCallback(()=>{var m;o(0),a(null),(m=d.current)==null||m.call(d),c(!0)},[o,a,c]),p=l.useCallback(()=>{e.current?o(e.current.offsetHeight):o(0)},[o]);l.useEffect(()=>(p(),window.removeEventListener("resize",p),window.addEventListener("resize",p),()=>{window.removeEventListener("resize",p)}),[p,i,s]);const g={bannerHeight:n};return r.jsxs(zo.Provider,{value:g,children:[!s&&!!i&&r.jsx(bm,{ref:e,dismissBanner:h,bannerContent:i}),t]})},jT=b(C)(()=>({backgroundColor:f("background"),width:"100%"})),Mh=["/assets/publicly-available/image-1.jpg","/assets/publicly-available/image-2.jpg","/assets/publicly-available/image-3.jpg","/assets/publicly-available/image-4.jpg","/assets/publicly-available/image-5.jpg","/assets/publicly-available/image-6.jpg","/assets/publicly-available/image-7.jpg","/assets/publicly-available/image-8.jpg","/assets/publicly-available/image-9.jpg","/assets/publicly-available/image-10.jpg","/assets/publicly-available/image-11.jpg","/assets/publicly-available/image-13.jpg","/assets/publicly-available/image-14.jpg","/assets/publicly-available/image-15.jpg","/assets/publicly-available/image-16.jpg"],PT=()=>{const[t,e]=l.useState(0);return l.useEffect(()=>{const n=setInterval(()=>e(o=>(o+1)%Mh.length),2e3);return()=>{clearInterval(n)}},[]),r.jsx(MT,{children:r.jsx(ss,{width:"100%",children:Mh.map((n,o)=>r.jsx(xr,{in:o===t,timeout:1e3,children:r.jsx(OT,{src:n})},n))})})},MT=b(C)({marginTop:16,marginBottom:16,width:"100%"}),OT=b("img")(()=>({position:"absolute",width:"100%",height:"100%",top:0,left:0,backgroundColor:f("skeleton"),borderStyle:"none",borderRadius:4})),BT=["Generation not found.","Profile not found.","Canvas not found."],LT=({error:t})=>r.jsx(jT,{children:r.jsxs(C,{minHeight:"100dvh",maxWidth:"80%",width:"400px",marginX:"auto",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[r.jsxs(Kf,{children:[r.jsx("title",{children:"Ideogram"}),r.jsx("meta",{name:"title",content:"Free Image Generation"}),r.jsx("meta",{name:"description",content:"Join our global community of creators."})]}),r.jsx(le,{fontSize:16,fontWeight:500,children:t&&BT.includes(t.message)?t.message:"Something went wrong"}),r.jsx(PT,{}),r.jsx(NT,{variant:"contained",disableRipple:!0,onClick:()=>window.location.href="/",children:"Back to home"})]})}),NT=b(gt)(()=>({color:f("solid"),textTransform:"none",backgroundColor:f("primary"),"&:hover":{backgroundColor:f("primary")}})),DT="modulepreload",FT=function(t){return"/"+t},Oh={},oo=function(e,n,o){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),c=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=Promise.allSettled(n.map(d=>{if(d=FT(d),d in Oh)return;Oh[d]=!0;const u=d.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":DT,u||(p.as="script"),p.crossOrigin="",p.href=d,c&&p.setAttribute("nonce",c),document.head.appendChild(p),u)return new Promise((g,m)=>{p.addEventListener("load",g),p.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(s){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=s,window.dispatchEvent(c),!c.defaultPrevented)throw s}return i.then(s=>{for(const c of s||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})},Cm=t=>{var w,I,R,S,E,N;const{saveBrowsingPaginationState:e,getBrowsingData:n,getBrowsingKey:o}=l.useContext($e),{loadPage:i,onNewPageLoaded:a}=t,s=l.useRef(((I=(w=n())==null?void 0:w.paginationState)==null?void 0:I.page)??1),[c,d]=l.useState(!1),u=l.useRef(!1),h=l.useRef(((S=(R=n())==null?void 0:R.paginationState)==null?void 0:S.offset)??0),p=l.useRef(window.location.pathname),g=l.useRef(((N=(E=n())==null?void 0:E.paginationState)==null?void 0:N.reachedEnd)??!1),m=l.useCallback(()=>{e({page:s.current,reachedEnd:g.current,offset:h.current},o())},[o,e]),v=l.useRef(window.location.pathname),x=l.useCallback(async()=>{if(c||u.current||g.current||!i)return;u.current=!0,d(!0),v.current=window.location.pathname;const k=await i({offset:h.current,page:s.current});if(v.current!==window.location.pathname)return;const A=Array.isArray(k)?k:k==null?void 0:k.results;(A===void 0||A.length<8)&&(g.current=!0),s.current>=1&&A.length>0&&(a==null||a(A)),s.current=s.current+1,Array.isArray(k)||(h.current=(k==null?void 0:k.offset)??0),p.current===window.location.pathname&&m(),d(!1),u.current=!1},[c,i,a,m]),y=l.useCallback(()=>{s.current=1,g.current=!1,h.current=0,m()},[m]),_=l.useCallback(k=>{h.current=k,m()},[m]);return{loadNextPage:x,loadingNewPage:c,resetPage:y,setOffset:_}},Si="related",zT=t=>{const{clearHomePageData:e,setExploreFilter:n,exploreFilter:o}=t,{isFeatureEnabled:i,mediaApi:a,subscriptionStatus:s}=l.useContext(ge),{inSessionGenerations:c,autoSearchPrompt:d,setAutoSearchPrompt:u}=l.useContext(ye),{pathname:h}=Rn(),p=l.useRef(Date.now());l.useEffect(()=>{o===Si&&!d&&n(void 0)},[d,o,n]);const g=l.useMemo(()=>!!(s!=null&&s.activeSubscription)&&i(Bt.auto_search_demo),[i,s==null?void 0:s.activeSubscription]),m=l.useMemo(()=>h.startsWith("/t/explore"),[h]),{data:v,refetch:x,isFetching:y,error:_}=Ve(["autoSearch",prompt],()=>a==null?void 0:a.globalSearch({searchRequest:{searchQuery:d,context:zs.AutoSearch}}),{staleTime:1/0,enabled:g&&m&&!!d&&o===Si,retry:3,cacheTime:0});l.useEffect(()=>{(_==null?void 0:_.status)===403&&Lt()},[_]),l.useEffect(()=>{if(!g||!m)return;const R=c.at(0);if(!R)return;const S=R.data.timestamp;S<=p.current||(p.current=S,u(R.data.generation.user_prompt),n(Si),e())},[e,c,g,m,u,n]);const w=l.useCallback(()=>{u(null),n(void 0),e()},[e,u,n]);return l.useMemo(()=>({autoSearchData:d&&!y?v:void 0,refetchAutoSearchData:x,isFetchingAutoSearch:y,showAutoSearchTab:!!d&&m,shouldLoadAutoSearchData:m&&!!d&&o===Si,clearAutoSearchPrompt:w}),[v,d,w,o,y,m,x])},Ae={explore:"explore",my_images:"my-images",labelling:"labelling"},UT=["general","realistic","design","3d","anime"],GT=["public","private","pinned","grid"],_m=l.createContext({setTab:()=>{},setTabFilter:()=>{},resetPage:()=>{},columnDataFetching:!1,loadNextPage:()=>new Promise(()=>{}),loadingNewPage:!1,setColumnData:()=>{},defaultTab:"explore",tabBottomRef:{current:null},searchPromptValue:"",setSearchPromptValue:()=>{},reloadPageData:()=>{},exploreFilter:"",setExploreFilter:()=>{},myImagesTypeFilter:"",setMyImagesTypeFilter:()=>{},shouldLoadFollowingData:!1,shouldLoadPinnedData:!1,handleExploreTabClick:()=>{},handleMyImagesTabClick:()=>{},showAutoSearchTab:!1,shouldLoadAutoSearchData:!1,clearAutoSearchPrompt:()=>{},clearHomePageData:()=>{}}),wl="q",Ar="f",iF=t=>{var de,Pe;const{children:e}=t,n=Ee(),o=we(),i=xe(o.breakpoints.down("md")),a=l.useRef(null),{replace:s,getBrowsingData:c,saveCurrentGenerationListData:d,getBrowsingKey:u,resetCollapsedGenerations:h,clearGenerationDecorator:p,setQueryParam:g,deleteQueryParam:m,homePageTab:v,setHomePageTab:x,columnDataDirty:y,setColumnDataDirty:_,saveCreationsVirtualColumnData:w,saveFeedVirtualColumnData:I}=l.useContext($e),{inSessionGenerations:R,clearSuccessGeneration:S}=l.useContext(ye),{userProfileState:E,isFeatureEnabled:N,mediaApi:k,subscriptionStatus:A,userPublicProfileData:D}=l.useContext(ge),{bannerHeight:O}=l.useContext(zo),[L]=ts(),{tab:P,filter:G}=an(),B=l.useMemo(()=>"explore",[]),[M,z]=l.useState((Pe=(de=c())==null?void 0:de.generationList)==null?void 0:Pe.filter(J=>!!J.image_id||J.is_completed)),[F,T]=l.useState(L.get(wl)??"");l.useEffect(()=>{A!=null&&A.noActiveSubscription&&P===Ae.explore&&F&&!RI(D==null?void 0:D.join_time_float)&&T("")},[F,A==null?void 0:A.noActiveSubscription,P,D==null?void 0:D.join_time_float]);const[j,Z]=l.useState(P===Ae.explore?L.get(Ar)??void 0:void 0),[ee,te]=l.useState(P===Ae.my_images?L.get(Ar)??void 0:void 0),$=l.useRef(u());l.useEffect(()=>{M&&d(M,$.current)},[M,d]);const X=l.useRef(!1),W=l.useMemo(()=>F?zs.Search:j?zs.Top:zs.Explore,[j,F]),Y=l.useMemo(()=>{if(G==="general")return fi.Painting;if(G==="realistic")return fi.Photo;if(G==="design")return fi.Design;if(G==="3d")return fi._3D;if(G==="anime")return fi.Anime},[G]),q=l.useMemo(()=>{if(!F){if(j==="hour")return ys.Hour;if(j==="day")return ys.Day;if(j==="week")return ys.Week;if(j==="month")return ys.Month}},[j,F]),V=l.useMemo(()=>({searchQuery:F||void 0,context:W,filters:{categories:Y&&W==="TOP"?[Y]:void 0},timeline:q}),[Y,W,F,q]),Q=l.useMemo(()=>G==="pinned"&&P===Ae.my_images&&!!(E!=null&&E.displayHandle),[G,P,E==null?void 0:E.displayHandle]),K=l.useMemo(()=>E!=null&&E.displayHandle&&!Q&&F?{userHandle:E.displayHandle,searchPrompt:F,private:G==="private"?!0:void 0,all_privacy:G===void 0?!0:void 0}:void 0,[F,G,E,Q]),ae=l.useMemo(()=>E!=null&&E.displayHandle&&!F&&P===Ae.my_images&&!Q?{userId:E.displayHandle,filter:ee??null,private:G==="private"?!0:void 0,all_privacy:G===void 0?!0:void 0}:void 0,[E==null?void 0:E.displayHandle,F,P,Q,ee,G]),ce=l.useMemo(()=>j==="following"&&!F&&P===Ae.explore||P==="following",[j,F,P]),ve=l.useMemo(()=>({model_name:L.get("model")??"labelling_clustering_model",cluster_name:L.get("cluster")??"logos_v6",lookback_seconds:L.get("lookback_seconds")??86400*90,score_minimum:L.get("min_score")??0,shuffle:L.get("shuffle")??!1}),[L]),{loadNextPage:se,loadingNewPage:H,resetPage:me,setOffset:ne}=Cm({loadPage:!M||ce||j===Si||P&&!["top",Ae.explore,Ae.my_images,Ae.labelling].includes(P)?void 0:({page:J,offset:U})=>{if(!ce){if(P===Ae.explore)return We?ah(J??0):k==null?void 0:k.globalSearch({searchRequest:{offset:U,...V}});if(P===Ae.my_images){if(Q)return hh(E.displayHandle,J);if(F&&K)return ch({...K,offset:U});if(!F&&ae)return dh({...ae,page:J})}else if(P===Ae.labelling)return lh({page:J,...ve})}},onNewPageLoaded:J=>{P!=="explore"&&P!=="top"&&P!==Ae.my_images&&P!==Ae.labelling||M===void 0||X.current||z([...M,...J])}}),ue=l.useCallback(()=>{if(!a.current)return;const J=a.current.getBoundingClientRect().top;i&&J-O<0?window.scrollTo({top:0}):J-O<72&&window.scrollTo({top:J+window.scrollY-120-O,behavior:"smooth"})},[O,i]),fe=l.useCallback(()=>{X.current=!0,ue(),z(void 0),h(),p(),w(void 0,u()),I(void 0,u()),me()},[p,u,h,me,w,I,ue]),Se=l.useRef(P===Ae.explore?G:void 0),je=l.useRef(P===Ae.my_images?G:void 0);l.useEffect(()=>{P===Ae.explore?Se.current=G:P===Ae.my_images&&(je.current=G)},[P,G]);const qe=l.useCallback(J=>{fe(),(P!==J||G)&&(S(),s(oe.HOME_TAB.replace(":tab",J)))},[fe,S,s,G,P]),De=l.useCallback((J,U)=>{fe(),S(),s(oe.HOME_TAB_FILTER.replace(":tab",J).replace(":filter",U))},[fe,S,s]),{autoSearchData:Ye,refetchAutoSearchData:nt,isFetchingAutoSearch:ct,showAutoSearchTab:he,shouldLoadAutoSearchData:Fe,clearAutoSearchPrompt:Ge}=zT({clearHomePageData:fe,setExploreFilter:Z,exploreFilter:j}),st=l.useCallback(()=>{n({eventKey:"HOME_V2_EXPLORE_CLICK"}),P!==Ae.explore&&T(""),G&&P===Ae.explore?De(Ae.explore,G):Se.current?De(Ae.explore,Se.current):qe(Ae.explore)},[qe,De,n,G,P]),bt=l.useCallback(()=>{n({eventKey:"HOME_V2_MY_IMAGES_CLICK"}),P!==Ae.my_images&&T(""),G&&P===Ae.my_images?De(Ae.my_images,G):je.current?De(Ae.my_images,je.current):qe(Ae.my_images)},[qe,De,n,G,P]);l.useEffect(()=>{v&&(v===Ae.explore?st():v===Ae.my_images&&bt(),x(null))},[st,bt,v,x,qe]);const En=l.useCallback(()=>{fe()},[fe]);l.useEffect(()=>{E&&(!P||!Object.values(Ae).includes(P)||P===Ae.explore&&G&&!UT.includes(G)||P===Ae.my_images&&G&&!GT.includes(G))&&qe(B)},[P,G,N,E,B,De,qe]);const We=l.useMemo(()=>P==="explore"&&F===""&&j===void 0,[j,F,P]),{data:vt,refetch:Qt,isFetching:kt}=Ve(["myImagesSearch",G,F],()=>ch(K),{enabled:!!K&&!!E&&!M&&P===Ae.my_images,staleTime:1/0,retry:3,cacheTime:0,onError:J=>{J.status===403&&Lt()}}),{data:Ct,refetch:so,isFetching:gn}=Ve(["myImages",G,ee],()=>dh(ae),{enabled:!!ae&&!!E&&!M&&P===Ae.my_images,staleTime:1/0,retry:3,cacheTime:0,onError:J=>{J.status===403&&Lt()}}),{data:Dn,refetch:kn,isFetching:An}=Ve(["explore_v2",Y,W,F,q],()=>k==null?void 0:k.globalSearch({searchRequest:V}),{staleTime:1/0,enabled:!We&&!!E&&!!k&&!M&&P==="explore",retry:3,cacheTime:0,onError:J=>{J.status===403&&Lt()}}),{data:Vn,refetch:mn,isFetching:ln}=Ve(["explore"],()=>ah(0),{staleTime:1/0,enabled:We&&!M,retry:3,cacheTime:0,onError:J=>{J.status===403&&Lt()}}),{data:cn,refetch:Fn,isFetching:Zt}=Ve(["labelling"],()=>lh(ve),{staleTime:1/0,enabled:P===Ae.labelling&&F===""&&!M,retry:3,cacheTime:0,onError:J=>{J.status===403&&Lt()}}),{data:St,refetch:dn,isFetching:Dt}=Ve(["followingGenerations"],()=>mS(),{staleTime:1/0,enabled:!!E&&!M&&ce,retry:3,cacheTime:0,onError:J=>{J.status===403&&Lt()}}),{data:At,refetch:xn,isFetching:jn}=Ve(["pinnedGenerations"],()=>hh(E.displayHandle,0),{enabled:!!E&&!!(E!=null&&E.displayHandle)&&!M&&Q,staleTime:1/0,retry:3,cacheTime:0,onError:J=>{J.status===403&&Lt()}});l.useEffect(()=>{M!==void 0||!E||(F?g({name:wl,value:F}):m(wl),F?m(Ar):j&&P===Ae.explore?g({name:Ar,value:j}):ee&&P===Ae.my_images?g({name:Ar,value:ee}):m(Ar),P===Ae.explore?ce?dn():We?mn():Fe?nt==null||nt():kn():P===Ae.my_images?Q?xn():F?Qt():so():P===Ae.labelling&&Fn(),_(!1))},[P,M,dn,mn,Fn,E,kn,F,g,m,We,j,ce,ee,Qt,so,Q,xn,_,nt,Fe]),l.useEffect(()=>{!Dt&&!ln&&!An&&!kt&&!gn&&!jn&&!ct&&!Zt&&(X.current=!1)},[Dt,ln,An,kt,gn,jn,ct,Zt]),l.useEffect(()=>{M!==void 0||X.current||(Q&&At&&!jn?z(At):ce&&St&&!Dt?z(St):We&&Vn&&!ln?z(Vn):Fe&&Ye&&!ct&&!F?z(Ye.results):P===Ae.explore&&Dn&&!An?(z(Dn.results),ne(Dn.offset)):P===Ae.my_images&&F&&vt&&!kt?(z(vt.results),ne(vt.offset)):P===Ae.my_images&&!F&&Ct&&!gn?z(Ct):P===Ae.labelling&&cn&&!Zt&&z(cn))},[M,P,z,St,Dt,Vn,cn,ln,Dn,An,ne,We,ce,vt,kt,F,Ct,gn,Q,At,jn,Ye,Fe,ct,Zt]);const vn=l.useMemo(()=>M===void 0,[M]),Gt=l.useMemo(()=>R.map(J=>{const{data:U}=J;return U.generation}).filter(J=>!(J.job_id&&!J.has_started)),[R]),en=l.useMemo(()=>Gt.filter(J=>!J.private),[Gt]),Kn=l.useMemo(()=>Gt.filter(J=>J.private),[Gt]),ao=l.useMemo(()=>{if(G==="pinned"||P!==Ae.my_images)return[];const J=(M==null?void 0:M.filter(U=>!!U.request_id&&U.is_completed).map(U=>U.request_id))??[];if(P===Ae.my_images&&ee!=="edits"&&ee!=="uploads"){let U=[];return G==="public"?U=en:G==="private"?U=Kn:U=Gt,U.filter(pe=>!J.includes(pe.request_id))}return[]},[Gt,M,ee,Kn,en,G,P]);return l.useEffect(()=>{y&&(S(),fe())},[fe,S,y]),r.jsx(_m.Provider,{value:{setTab:qe,setTabFilter:De,resetPage:me,columnDataFetching:vn,loadNextPage:se,loadingNewPage:H,columnData:M?[...ao,...M??[]]:void 0,setColumnData:z,defaultTab:B,tabBottomRef:a,searchPromptValue:F,setSearchPromptValue:T,reloadPageData:En,exploreFilter:j,setExploreFilter:Z,shouldLoadFollowingData:ce,shouldLoadPinnedData:Q,myImagesTypeFilter:ee,setMyImagesTypeFilter:te,handleExploreTabClick:st,handleMyImagesTabClick:bt,showAutoSearchTab:he,clearAutoSearchPrompt:Ge,shouldLoadAutoSearchData:Fe,clearHomePageData:fe},children:e})},HT=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{userPublicProfileData:n,isFeatureEnabled:o}=l.useContext(ge),{decorateGeneration:i,navigate:a}=l.useContext($e),{inSessionGenerations:s}=l.useContext(ye),c=l.useMemo(()=>{var u;if(e)return(u=s.find(h=>!i(h.data.generation).deleted))==null?void 0:u.data.timestamp},[i,s,e]),d=l.useRef(c);l.useEffect(()=>{d.current===c||!(o(Bt.mobile_jump_to_creations)||Mg(n==null?void 0:n.join_time_float))||(window.location.pathname.startsWith("/t/my-images")?window.scrollTo({top:0,behavior:"smooth"}):(a(oe.HOME_TAB.replace(":tab",Ae.my_images)),window.scrollTo({top:0,behavior:"instant"})),d.current=c)},[o,c,a,n==null?void 0:n.join_time_float])};function Uo({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",children:r.jsx("path",{fill:n??"inherit",d:"M10.733 19.79a.75.75 0 101.034-1.085L5.516 12.75H20.25a.75.75 0 000-1.5H5.516l6.251-5.955a.75.75 0 00-1.034-1.086l-7.42 7.067a.995.995 0 00-.3.58.753.753 0 00.001.289.995.995 0 00.3.579l7.419 7.067z"})})}function za({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",children:r.jsx("g",{children:r.jsx("path",{fill:n??"inherit",stroke:n??"inherit",strokeWidth:"0.4",d:"M18.53 10.371c-.236-.447-.734-.704-1.366-.704H13.75V3.523c0-.9-.361-1.198-.665-1.289-.3-.09-.765-.045-1.26.696L9.658 6.15c-.354.528-.868 1.28-1.32 1.94L5.687 11.93c-.482.707-.34 1.217-.213 1.457.13.247.484.662 1.382.662h3.609v6.435c0 .271 0 1.095.618 1.282a.728.728 0 00.213.033c.505 0 .87-.544 1.004-.747l2.067-3.228.14-.208c.505-.755 1.233-1.844 1.698-2.527l2.13-3.156c.365-.538.437-1.107.197-1.563zm-1.102.947l-2.131 3.157c-.465.682-1.196 1.774-1.701 2.532l-2.037 3.168v-6.674a.547.547 0 00-.547-.548H6.856c-.277 0-.4-.063-.41-.068-.006-.025.011-.142.143-.334l2.655-3.844c.453-.662.97-1.42 1.324-1.949l2.088-3.1v6.557c0 .303.245.547.548.547h3.96c.23 0 .368.063.4.123.032.063.005.225-.136.433z"})})})}function Im({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 20 20",children:r.jsx("g",{id:"Icon / Team",children:r.jsx("path",{fill:n??"inherit",d:"M12.295 8.333c.805 0 1.458.653 1.458 1.459v3.957a3.75 3.75 0 1 1-7.501 0V9.792c0-.806.653-1.459 1.458-1.459zm0 1.25H7.71a.21.21 0 0 0-.208.209v3.957a2.5 2.5 0 1 0 5.001 0V9.792a.21.21 0 0 0-.208-.209m-9.17-1.25h2.818a2.3 2.3 0 0 0-.515 1.25H3.125a.21.21 0 0 0-.208.209v2.707a2.084 2.084 0 0 0 2.568 2.028c.07.42.2.82.377 1.193a3.334 3.334 0 0 1-4.196-3.221V9.792c0-.806.654-1.459 1.459-1.459m10.937 0h2.813c.805 0 1.458.653 1.458 1.459V12.5a3.333 3.333 0 0 1-4.192 3.222 4.5 4.5 0 0 0 .38-1.194q.23.054.479.055c1.15 0 2.083-.932 2.083-2.083V9.792a.21.21 0 0 0-.208-.209h-2.298a2.3 2.3 0 0 0-.515-1.25M10 2.5a2.5 2.5 0 1 1 0 5 2.5 2.5 0 0 1 0-5m5.417.833a2.083 2.083 0 1 1 0 4.167 2.083 2.083 0 0 1 0-4.167m-10.834 0a2.083 2.083 0 1 1 0 4.167 2.083 2.083 0 0 1 0-4.167M10 3.75a1.25 1.25 0 1 0 0 2.5 1.25 1.25 0 0 0 0-2.5m5.417.833a.833.833 0 1 0 0 1.667.833.833 0 0 0 0-1.667m-10.834 0a.833.833 0 1 0 0 1.667.833.833 0 0 0 0-1.667"})})})}const qT=[{title:"1,500 priority credits",description:"As a member of a Team plan, you get 1,500 monthly priority credits to use in the team space. This balance is separate from your personal space, which may have its own plan.",icon:r.jsx(za,{width:20,height:20,color:f("secondary")})},{title:"Switch between your personal and team spaces",description:"Your personal and team spaces have different credit balances, so be sure to switch to the right one before you generate.",icon:r.jsx(Im,{width:20,height:20,color:f("secondary")})}],WT=t=>{const{teamName:e}=t,{setModalContent:n}=l.useContext(Tt),o=we(),i=xe(o.breakpoints.down(560));return r.jsxs($T,{children:[r.jsx(ZT,{children:r.jsx(Be,{onClick:()=>n(null),icon:i?r.jsx(Uo,{color:f("secondary")}):r.jsx(wt,{color:f("secondary")})})}),r.jsx(YT,{children:r.jsxs(XT,{children:["Welcome to ",e]})}),r.jsx(QT,{sx:{flexDirection:"column"},children:qT.map((a,s)=>r.jsxs(VT,{children:[r.jsx(C,{sx:{marginTop:"3px"},children:a.icon}),r.jsxs(C,{sx:{display:"flex",flexDirection:"column"},children:[r.jsx(KT,{children:a.title}),r.jsx(JT,{children:a.description})]})]},s))})]})},$T=b(C)(({theme:t})=>({display:"flex",flexDirection:"column",position:"relative",maxHeight:"96dvh",color:f("infoCardBackground"),backgroundColor:f("backgroundSurface"),boxShadow:"0px 4px 6px -1px rgba(9, 9, 11, 0.10), 0px 2px 4px -2px rgba(9, 9, 11, 0.10)",outlineColor:f("borderHighlight"),outlineStyle:"solid",padding:"24px 24px 32px 24px",gap:"32px",width:"505px",height:"100%",overflow:"hidden",[t.breakpoints.down(720)]:{width:"100%",paddingTop:"72px",maxHeight:"100vh"}})),VT=b(C)(()=>({display:"flex",flexDirection:"row",fontSize:"14px",gap:"10px",alignItems:"flex-start",justifyContent:"flex-start",paddingRight:"24px",fontWeight:400,lineHeight:"20px",letterSpacing:"-0.14px"})),KT=b(le)(()=>({color:f("primary"),userSelect:"text",fontSize:16,fontWeight:600,lineHeight:"24px",letterSpacing:"-0.64px"})),JT=b(C)(()=>({color:f("secondary"),fontFamily:"Manrope, sans-serif",fontSize:14,userSelect:"text",fontWeight:400,letterSpacing:"-0.14px"})),XT=b(le)(()=>({color:f("primary"),userSelect:"text",fontSize:"20px",fontWeight:700,lineHeight:"24px",letterSpacing:"-0.8px"})),YT=b(C)({display:"flex",flexDirection:"column"}),QT=b(C)({display:"flex",flexDirection:"column",gap:"32px",height:"100%",overflow:"hidden"}),ZT=b(C)(({theme:t})=>({position:"absolute",top:16,right:16,zIndex:1,[t.breakpoints.down(560)]:{top:8,left:16}})),eE=t=>{const{setModalContent:e}=l.useContext(Tt);return r.jsx(Rr,{open:!0,content:r.jsx(WT,{...t}),handleClose:()=>{e(null)},mobileFullScreen:!0})},Sm=()=>{const{setModalContent:t}=l.useContext(Tt);return l.useCallback(n=>{t(r.jsx(eE,{teamName:n.teamName}))},[t])},pc=t=>{const{title:e,text:n}=t;return r.jsxs(tE,{children:[e&&r.jsx(nE,{children:e}),n]})},tE=b(C)(()=>({display:"flex",alignItems:"center",gap:"12px",fontSize:"14px",fontFamily:"Manrope, sans-serif",color:f("reverseSecondary")})),nE=b("span")(()=>({fontWeight:600,color:f("reverseSecondary")}));var Vr=function(t){return t.INVITE_EXPIRED="INVITE_EXPIRED",t.INVITE_NOT_FOUND="INVITE_NOT_FOUND",t.WRONG_ACCOUNT="WRONG_ACCOUNT",t.GENERIC_ERROR="GENERIC_ERROR",t}(Vr||{});const oE=t=>{let e="Cannot join team",n="Please ask your team to resend the invitation.";switch(t){case Vr.INVITE_EXPIRED:e="Invitation expired";break;case Vr.INVITE_NOT_FOUND:e="Invitation not found";break;case Vr.WRONG_ACCOUNT:n="This invitation is linked to a different account.";break;default:n="Invalid invitation."}return{alertTitle:e,alertText:n}},Rm=t=>{const{showBackdropLoading:e=!1,navigateHomeOnError:n=!0,ignoreNotification:o}=t,{organizationApi:i,updateChosenOrganization:a}=l.useContext(ge),[s,c]=l.useState(!1),d=Sm(),{setAlertContent:u}=l.useContext(Tn),h=ja(),{setBackdropLoading:p}=l.useContext(Do),g=l.useCallback(v=>{const{alertTitle:x,alertText:y}=oE(v);u(r.jsx(pc,{title:x,text:y}),{showClose:!1,autoDismissMs:2e3,backgroundColor:f("primary")})},[u]);return{acceptInvitation:l.useCallback(async v=>{var x,y,_,w,I;if(!(!i||!v)){c(!0),e&&p(!0);try{const R=await i.acceptOrganizationInvite({acceptOrganizationInviteRequest:{organizationInviteId:v}});a({chosenOrganizationId:(x=R==null?void 0:R.organization)==null?void 0:x.organizationId,isPersonalOrganization:!1,name:((y=R==null?void 0:R.organization)==null?void 0:y.name)||"",role:Wr.Writer,avatar:(w=(_=R==null?void 0:R.organization)==null?void 0:_.avatar)==null?void 0:w.avatarUrl}),o==null||o(),d({teamName:((I=R==null?void 0:R.organization)==null?void 0:I.name)||"Team"}),h(oe.HOME,{replace:!0})}catch(R){if(R instanceof Yr){const S=await R.response.json();g((S==null?void 0:S.error_type)??Vr.GENERIC_ERROR)}else g(Vr.GENERIC_ERROR)}finally{c(!1),n&&h(oe.HOME,{replace:!0}),e&&p(!1)}}},[i,e,p,a,o,d,h,g,n]),isLoading:s}},rE=()=>{const{organizationApi:t,userProfileState:e}=l.useContext(ge),[n]=ts(),o=l.useRef(!1),{acceptInvitation:i}=Rm({showBackdropLoading:!0});l.useEffect(()=>{const a=n.get("invitation-id");o.current||!a||!e||!t||(o.current=!0,i(a))},[i,t,n,e])},iE=(t,e,n)=>{const o=l.useRef(null),i=l.useRef(null),a=l.useCallback(()=>{i.current&&clearTimeout(i.current),o.current&&clearInterval(o.current)},[]),s=l.useCallback(()=>{a(),i.current=setTimeout(()=>{a()},n),o.current=setInterval(async()=>{await t()&&a()},e)},[t,e,a,n]);return l.useEffect(()=>()=>a(),[a]),{startPolling:s,stopPolling:a}},bl=1e4,sE=1e3,aE="organization-id",lE=()=>{const{organizationApi:t,userProfileState:e,chosenOrganization:n,setChosenOrganization:o}=l.useContext(ge),[i]=ts(),{setAlertContent:a}=l.useContext(Tn),s=Sm(),c=ja(),d=l.useRef(!1),u=i.get(aE),h=l.useCallback(async()=>{var x;if(!u||!t)return!1;const m=await t.getOrganizations(),v=(x=m==null?void 0:m.organizations)==null?void 0:x.find(y=>y.organizationId===u);return v?(o({chosenOrganizationId:u,isPersonalOrganization:v.type===gg.Private,name:v.name}),v.role!=="OWNER"?(s({teamName:v.name}),c(oe.HOME,{replace:!0})):pt(window.location.pathname,oe.TEAM_BILLING)&&c(oe.TEAM_BILLING,{replace:!0}),a(null),!0):!1},[u,t,a,o,c,s]),{startPolling:p,stopPolling:g}=iE(h,sE,bl);l.useEffect(()=>{if(!u||!e||!n||d.current)return;a(r.jsx(pc,{title:"",text:"Creating your new team..."}),{showClose:!1,autoDismissMs:bl,backgroundColor:f("primary")}),d.current=!0,p();const m=setTimeout(()=>{g(),a(r.jsx(pc,{title:"Couldn't create team.",text:r.jsxs("span",{children:["There seems to be an issue on our end. Please contact"," ",r.jsx(iv,{href:"mailto:support@ideogram.ai",color:f("reverseSecondary"),children:"support@ideogram.ai"}),"."]})}),{showClose:!0,backgroundColor:f("primary")}),c(oe.PRICING,{replace:!0})},bl);return()=>{g(),clearTimeout(m)}},[u,p,g,a,e,n,c])},cE=()=>{rE(),lE()},dE=t=>{const{marginTop:e}=t,[n,o]=l.useState(window.scrollY<=(e??16));return l.useEffect(()=>{const i=()=>{o(window.scrollY<=(e??16))};return window.addEventListener("scroll",i),()=>{window.removeEventListener("scroll",i)}},[e]),{scrolledToTop:n}},uE=t=>{const e=Ee(),n=we(),o=xe(n.breakpoints.down(720)),{handleClose:i,demoVideoSrc:a}=t,{isProSubscriber:s,isTeamSubscriber:c}=l.useContext(ge),d=Nt(),{navigate:u}=l.useContext($e),{showPayWallModel:h}=$t();return r.jsxs(mE,{children:[r.jsx(wE,{children:r.jsx(Be,{onClick:i,icon:r.jsx(wt,{color:f("quietButtonText")})})}),r.jsx(vE,{children:r.jsxs(gE,{fontSize:26,children:["Introducing ",r.jsx("b",{children:"Batch Generation"})]})}),r.jsx(xE,{children:r.jsx("video",{autoPlay:!0,muted:!0,loop:!0,playsInline:!0,src:a,style:{aspectRatio:"16 / 9",objectFit:"cover",width:"100%"}})}),r.jsxs(yE,{sx:o?{flexDirection:"column"}:{flexDirection:"row",alignItems:"center"},children:[r.jsxs(pE,{children:["Save time and create in bulk with"," ",r.jsx(Bh,{children:"Batch Generation."})," Simply upload a spreadsheet with your prompts and come back to finished images. Only available for"," ",r.jsx(Bh,{children:"Ideogram Pro."})," ",r.jsx(fE,{href:"https://about.ideogram.ai/batch",target:"_blank",children:"Learn more"})]}),r.jsx(C,{width:32,height:16}),r.jsxs(hE,{children:[(s||c)&&r.jsx(ht,{fullWidth:!0,brandColorHighlight:!0,label:"Start using Batch Generation",onClick:()=>{e({eventKey:"START_USING_BATCH_GENERATION_DEMO_MODAL_CLICK"}),i(),u(oe.BATCH_GENERATION)},size:"small"}),!s&&!c&&r.jsxs(r.Fragment,{children:[r.jsx(It,{fullWidth:!0,label:"See all plans",onClick:()=>{e({eventKey:"BATCH_GENERATION_DEMO_MODAL_PRICING_CLICK"}),i(),d({newTab:!1,conversionReason:lt.NewFeatureDemoModal})},size:"small"}),r.jsx(ht,{fullWidth:!0,brandColorHighlight:!0,label:"Upgrade to Pro",onClick:()=>{e({eventKey:"BATCH_GENERATION_DEMO_MODAL_UPGRADE_TO_PRO_CLICK"}),i(),h("CSV","Pro")},size:"small"})]})]})]})]})},hE=b(C)({display:"flex",alignItems:"center",justifyContent:"flex-end",minWidth:238,gap:8}),pE=b(le)(()=>({color:f("staticContent"),userSelect:"text",fontSize:14,fontWeight:400,lineHeight:"20px",letterSpacing:"-0.14px"})),Bh=b("span")(()=>({color:f("primary"),fontWeight:600,lineHeight:"20px",letterSpacing:"-0.56px"})),fE=b("a")(()=>({color:f("IdeogramPinkText"),fontWeight:600,lineHeight:"20px",letterSpacing:"-0.56px"})),gE=b(le)(()=>({color:f("staticTitle"),userSelect:"text"})),mE=b(C)(()=>({display:"flex",flexDirection:"column",position:"relative",maxHeight:"96dvh",backgroundColor:f("surface")})),xE=b(C)({width:"100%"}),vE=b(C)({display:"flex",flexDirection:"column",padding:24}),yE=b(C)({display:"flex",justifyContent:"space-between",padding:"24px",gap:"32px"}),wE=b(C)({position:"absolute",top:8,right:8,zIndex:1}),bE=t=>{if(location.pathname!==oe.PRICING)for(const e of t){const{show:n,dismissKey:o}=e;if(n&&!localStorage.getItem(o))return e}},CE=()=>{const t=Ee(),e=we(),n=xe(e.breakpoints.down(900)),{userProfileState:o,isFeatureEnabled:i,isBatchGenerationLaunchModalEnabled:a}=l.useContext(ge),{setModalContent:s}=l.useContext(Tt),[c,d]=l.useState(!1),[u,h]=l.useState(!1),p=l.useCallback(()=>o?[{dismissKey:"DISMISSED_BATCH_GENERATION_DEMO_MODAL_2024_12_17",videoSrc:"https://storage.googleapis.com/ideogram-static/Batch%20Generation_v8_16x9.mp4",contentComponent:uE,show:a&&!rn()}]:[],[a,o]),g=l.useMemo(()=>bE(p()),[p]);l.useEffect(()=>{o!=null&&o.userId&&g&&Oa(o.userId).then(v=>{Date.now()/1e3-v.join_time_float>86400&&d(!0)})},[g,i,n,o==null?void 0:o.userId]),l.useEffect(()=>{if(!c||!o||!g)return;const v=document.createElement("video");v.addEventListener("canplaythrough",()=>{h(!0)}),v.src=g.videoSrc,v.load()},[g,h,c,o]);const m=l.useCallback(()=>{t({eventKey:"CLOSE_FEATURE_DEMO_MODAL"}),g&&(localStorage.setItem(g==null?void 0:g.dismissKey,"true"),d(!1),s(null))},[g,s,t]);l.useEffect(()=>{c&&o&&u&&g&&s(r.jsx(Rr,{open:!0,handleClose:m,content:r.jsx(g.contentComponent,{handleClose:m,demoVideoSrc:g.videoSrc}),border:!0,maxWidth:Math.floor(Math.max(Math.min((Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)-320)*1.77,960),600))}))},[g,m,s,c,o,u])},_E=t=>{const{handleAccept:e,handleReject:n}=t;return r.jsxs(SE,{children:[r.jsxs(RE,{children:["We use analytics tools to understand how users interact with our site and improve your experience in accordance with our"," ",r.jsx(TE,{href:On.privacy,target:"_blank",children:"Privacy Policy."})]}),r.jsxs(IE,{children:[r.jsx(It,{size:"small",label:"Decline",onClick:n,fullWidth:!0}),r.jsx(ht,{size:"small",label:"Accept",onClick:e,fullWidth:!0})]})]})},IE=ii(C)({display:"flex",alignItems:"stretch",justifyContent:"center",gap:8,width:"100%"}),SE=ii(C)({display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"stretch",gap:16,width:"100%"}),RE=ii(le)(()=>({color:f("secondary"),fontSize:14,fontWeight:400,lineHeight:"20px",letterSpacing:"-0.14px"})),TE=ii("a")(()=>({fontSize:14,lineHeight:"20px",letterSpacing:"-0.14px",textDecorationLine:"underline",cursor:"pointer",color:f("Interactive"),"&:hover":{color:f("InteractiveHover")},"&:active":{color:f("InteractiveActive")}}));var Tm="[Amplitude]",EE="".concat(Tm," Session Replay ID"),kE=0,AE=Wl.US,jE="".concat(Tm," Session Replay Debug"),PE="amp-block",Em="amp-mask",ME="amp-unmask",OE="https://api-sr.amplitude.com/sessions/v2/track",BE="https://api-sr.eu.amplitude.com/sessions/v2/track",LE="https://api-sr.stag2.amplitude.com/sessions/v2/track",NE=1*1e6,DE=3e4,FE=6e4,zE=500,UE=10*1e3,km=1024,ta;(function(t){t.GET_SR_PROPS="get-sr-props",t.DEBUG_INFO="debug-info"})(ta||(ta={}));var Am=function(){return{flushMaxRetries:2,logLevel:kv.Warn,loggerProvider:new $l,transportProvider:new Av}},GE=function(t){$c(e,t);function e(n,o){var i=this,a,s=Am();return i=t.call(this,xt(xt({transportProvider:s.transportProvider},o),{apiKey:n}))||this,i.flushMaxRetries=o.flushMaxRetries!==void 0&&o.flushMaxRetries<=s.flushMaxRetries?o.flushMaxRetries:s.flushMaxRetries,i.apiKey=n,i.sampleRate=o.sampleRate||kE,i.serverZone=o.serverZone||AE,i.configEndpointUrl=o.configEndpointUrl,i.shouldInlineStylesheet=o.shouldInlineStylesheet,i.version=o.version,i.performanceConfig=o.performanceConfig,i.storeType=(a=o.storeType)!==null&&a!==void 0?a:"idb",o.privacyConfig&&(i.privacyConfig=o.privacyConfig),o.debugMode&&(i.debugMode=o.debugMode),i}return e}(jv),zt;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(zt||(zt={}));function HE(t){return t.nodeType===t.ELEMENT_NODE}function Ai(t){const e=t==null?void 0:t.host;return(e==null?void 0:e.shadowRoot)===t}function ji(t){return Object.prototype.toString.call(t)==="[object ShadowRoot]"}function qE(t){return t.includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),t}function WE(t){const{cssText:e}=t;if(e.split('"').length<3)return e;const n=["@import",`url(${JSON.stringify(t.href)})`];return t.layerName===""?n.push("layer"):t.layerName&&n.push(`layer(${t.layerName})`),t.supportsText&&n.push(`supports(${t.supportsText})`),t.media.length&&n.push(t.media.mediaText),n.join(" ")+";"}function na(t){try{const e=t.rules||t.cssRules;return e?qE(Array.from(e,jm).join("")):null}catch{return null}}function jm(t){let e;if(VE(t))try{e=na(t.styleSheet)||WE(t)}catch{}else if(KE(t)&&t.selectorText.includes(":"))return $E(t.cssText);return e||t.cssText}function $E(t){const e=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return t.replace(e,"$1\\$2")}function VE(t){return"styleSheet"in t}function KE(t){return"selectorText"in t}class Pm{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var n;if(!e)return-1;const o=(n=this.getMeta(e))===null||n===void 0?void 0:n.id;return o??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(o=>this.removeNodeFromMap(o))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,n){const o=n.id;this.idNodeMap.set(o,e),this.nodeMetaMap.set(e,n)}replace(e,n){const o=this.getNode(e);if(o){const i=this.nodeMetaMap.get(o);i&&this.nodeMetaMap.set(n,i)}this.idNodeMap.set(e,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function JE(){return new Pm}function wd({element:t,maskInputOptions:e,tagName:n,type:o,value:i,maskInputFn:a}){let s=i||"";const c=o&&wr(o);return(e[n.toLowerCase()]||c&&e[c])&&(a?s=a(s,t):s="*".repeat(s.length)),s}function wr(t){return t.toLowerCase()}const Lh="__rrweb_original__";function XE(t){const e=t.getContext("2d");if(!e)return!0;const n=50;for(let o=0;o<t.width;o+=n)for(let i=0;i<t.height;i+=n){const a=e.getImageData,s=Lh in a?a[Lh]:a;if(new Uint32Array(s.call(e,o,i,Math.min(n,t.width-o),Math.min(n,t.height-i)).data.buffer).some(d=>d!==0))return!1}return!0}function bd(t){const e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?wr(e):null}let YE=1;const QE=new RegExp("[^a-z0-9-_:]"),qi=-2;function Mm(){return YE++}function ZE(t){if(t instanceof HTMLFormElement)return"form";const e=wr(t.tagName);return QE.test(e)?"div":e}function e4(t){let e="";return t.indexOf("//")>-1?e=t.split("/").slice(0,3).join("/"):e=t.split("/")[0],e=e.split("?")[0],e}let jr,Nh;const t4=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,n4=/^(?:[a-z+]+:)?\/\//i,o4=/^www\..*/i,r4=/^(data:)([^,]*),(.*)/i;function oa(t,e){return(t||"").replace(t4,(n,o,i,a,s,c)=>{const d=i||s||c,u=o||a||"";if(!d)return n;if(n4.test(d)||o4.test(d))return`url(${u}${d}${u})`;if(r4.test(d))return`url(${u}${d}${u})`;if(d[0]==="/")return`url(${u}${e4(e)+d}${u})`;const h=e.split("/"),p=d.split("/");h.pop();for(const g of p)g!=="."&&(g===".."?h.pop():h.push(g));return`url(${u}${h.join("/")}${u})`})}const i4=/^[^ \t\n\r\u000c]+/,s4=/^[, \t\n\r\u000c]+/;function a4(t,e){if(e.trim()==="")return e;let n=0;function o(a){let s;const c=a.exec(e.substring(n));return c?(s=c[0],n+=s.length,s):""}const i=[];for(;o(s4),!(n>=e.length);){let a=o(i4);if(a.slice(-1)===",")a=Ur(t,a.substring(0,a.length-1)),i.push(a);else{let s="";a=Ur(t,a);let c=!1;for(;;){const d=e.charAt(n);if(d===""){i.push((a+s).trim());break}else if(c)d===")"&&(c=!1);else if(d===","){n+=1,i.push((a+s).trim());break}else d==="("&&(c=!0);s+=d,n+=1}}}return i.join(", ")}function Ur(t,e){if(!e||e.trim()==="")return e;const n=t.createElement("a");return n.href=e,n.href}function l4(t){return!!(t.tagName==="svg"||t.ownerSVGElement)}function Cd(){const t=document.createElement("a");return t.href="",t.href}function Om(t,e,n,o){return o&&(n==="src"||n==="href"&&!(e==="use"&&o[0]==="#")||n==="xlink:href"&&o[0]!=="#"||n==="background"&&(e==="table"||e==="td"||e==="th")?Ur(t,o):n==="srcset"?a4(t,o):n==="style"?oa(o,Cd()):e==="object"&&n==="data"?Ur(t,o):o)}function Bm(t,e,n){return(t==="video"||t==="audio")&&e==="autoplay"}function c4(t,e,n){try{if(typeof e=="string"){if(t.classList.contains(e))return!0}else for(let o=t.classList.length;o--;){const i=t.classList[o];if(e.test(i))return!0}if(n)return t.matches(n)}catch{}return!1}function ra(t,e,n){if(!t)return!1;if(t.nodeType!==t.ELEMENT_NODE)return n?ra(t.parentNode,e,n):!1;for(let o=t.classList.length;o--;){const i=t.classList[o];if(e.test(i))return!0}return n?ra(t.parentNode,e,n):!1}function Lm(t,e,n){try{const o=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(o===null)return!1;if(typeof e=="string"){if(o.classList.contains(e)||o.closest(`.${e}`))return!0}else if(ra(o,e,!0))return!0;if(n&&(o.matches(n)||o.closest(n)))return!0}catch{}return!1}function d4(t,e,n){const o=t.contentWindow;if(!o)return;let i=!1,a;try{a=o.document.readyState}catch{return}if(a!=="complete"){const c=setTimeout(()=>{i||(e(),i=!0)},n);t.addEventListener("load",()=>{clearTimeout(c),i=!0,e()});return}const s="about:blank";if(o.location.href!==s||t.src===s||t.src==="")return setTimeout(e,0),t.addEventListener("load",e);t.addEventListener("load",e)}function u4(t,e,n){let o=!1,i;try{i=t.sheet}catch{return}if(i)return;const a=setTimeout(()=>{o||(e(),o=!0)},n);t.addEventListener("load",()=>{clearTimeout(a),o=!0,e()})}function h4(t,e){const{doc:n,mirror:o,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:c,inlineStylesheet:d,maskInputOptions:u={},maskTextFn:h,maskInputFn:p,dataURLOptions:g={},inlineImages:m,recordCanvas:v,keepIframeSrcFn:x,newlyAddedElement:y=!1}=e,_=p4(n,o);switch(t.nodeType){case t.DOCUMENT_NODE:return t.compatMode!=="CSS1Compat"?{type:zt.Document,childNodes:[],compatMode:t.compatMode}:{type:zt.Document,childNodes:[]};case t.DOCUMENT_TYPE_NODE:return{type:zt.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:_};case t.ELEMENT_NODE:return g4(t,{doc:n,blockClass:i,blockSelector:a,inlineStylesheet:d,maskInputOptions:u,maskInputFn:p,dataURLOptions:g,inlineImages:m,recordCanvas:v,keepIframeSrcFn:x,newlyAddedElement:y,rootId:_});case t.TEXT_NODE:return f4(t,{maskTextClass:s,maskTextSelector:c,maskTextFn:h,rootId:_});case t.CDATA_SECTION_NODE:return{type:zt.CDATA,textContent:"",rootId:_};case t.COMMENT_NODE:return{type:zt.Comment,textContent:t.textContent||"",rootId:_};default:return!1}}function p4(t,e){if(!e.hasNode(t))return;const n=e.getId(t);return n===1?void 0:n}function f4(t,e){var n;const{maskTextClass:o,maskTextSelector:i,maskTextFn:a,rootId:s}=e,c=t.parentNode&&t.parentNode.tagName;let d=t.textContent;const u=c==="STYLE"?!0:void 0,h=c==="SCRIPT"?!0:void 0;if(u&&d){try{t.nextSibling||t.previousSibling||!((n=t.parentNode.sheet)===null||n===void 0)&&n.cssRules&&(d=na(t.parentNode.sheet))}catch(p){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${p}`,t)}d=oa(d,Cd())}return h&&(d="SCRIPT_PLACEHOLDER"),!u&&!h&&d&&Lm(t,o,i)&&(d=a?a(d,t.parentElement):d.replace(/[\S]/g,"*")),{type:zt.Text,textContent:d||"",isStyle:u,rootId:s}}function g4(t,e){const{doc:n,blockClass:o,blockSelector:i,inlineStylesheet:a,maskInputOptions:s={},maskInputFn:c,dataURLOptions:d={},inlineImages:u,recordCanvas:h,keepIframeSrcFn:p,newlyAddedElement:g=!1,rootId:m}=e,v=c4(t,o,i),x=ZE(t);let y={};const _=t.attributes.length;for(let w=0;w<_;w++){const I=t.attributes[w];Bm(x,I.name,I.value)||(y[I.name]=Om(n,x,wr(I.name),I.value))}if(x==="link"&&a){const w=Array.from(n.styleSheets).find(R=>R.href===t.href);let I=null;w&&(I=na(w)),I&&(delete y.rel,delete y.href,y._cssText=oa(I,w.href))}if(x==="style"&&t.sheet&&!(t.innerText||t.textContent||"").trim().length){const w=na(t.sheet);w&&(y._cssText=oa(w,Cd()))}if(x==="input"||x==="textarea"||x==="select"){const w=t.value,I=t.checked;y.type!=="radio"&&y.type!=="checkbox"&&y.type!=="submit"&&y.type!=="button"&&w?y.value=wd({element:t,type:bd(t),tagName:x,value:w,maskInputOptions:s,maskInputFn:c}):I&&(y.checked=I)}if(x==="option"&&(t.selected&&!s.select?y.selected=!0:delete y.selected),x==="canvas"&&h){if(t.__context==="2d")XE(t)||(y.rr_dataURL=t.toDataURL(d.type,d.quality));else if(!("__context"in t)){const w=t.toDataURL(d.type,d.quality),I=document.createElement("canvas");I.width=t.width,I.height=t.height;const R=I.toDataURL(d.type,d.quality);w!==R&&(y.rr_dataURL=w)}}if(x==="img"&&u){jr||(jr=n.createElement("canvas"),Nh=jr.getContext("2d"));const w=t,I=w.crossOrigin;w.crossOrigin="anonymous";const R=()=>{w.removeEventListener("load",R);try{jr.width=w.naturalWidth,jr.height=w.naturalHeight,Nh.drawImage(w,0,0),y.rr_dataURL=jr.toDataURL(d.type,d.quality)}catch(S){console.warn(`Cannot inline img src=${w.currentSrc}! Error: ${S}`)}I?y.crossOrigin=I:w.removeAttribute("crossorigin")};w.complete&&w.naturalWidth!==0?R():w.addEventListener("load",R)}if((x==="audio"||x==="video")&&(y.rr_mediaState=t.paused?"paused":"played",y.rr_mediaCurrentTime=t.currentTime),g||(t.scrollLeft&&(y.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(y.rr_scrollTop=t.scrollTop)),v){const{width:w,height:I}=t.getBoundingClientRect();y={class:y.class,rr_width:`${w}px`,rr_height:`${I}px`}}return x==="iframe"&&!p(y.src)&&(t.contentDocument||(y.rr_src=y.src),delete y.src),{type:zt.Element,tagName:x,attributes:y,childNodes:[],isSVG:l4(t)||void 0,needBlock:v,rootId:m}}function yt(t){return t==null?"":t.toLowerCase()}function m4(t,e){if(e.comment&&t.type===zt.Comment)return!0;if(t.type===zt.Element){if(e.script&&(t.tagName==="script"||t.tagName==="link"&&(t.attributes.rel==="preload"||t.attributes.rel==="modulepreload")&&t.attributes.as==="script"||t.tagName==="link"&&t.attributes.rel==="prefetch"&&typeof t.attributes.href=="string"&&t.attributes.href.endsWith(".js")))return!0;if(e.headFavicon&&(t.tagName==="link"&&t.attributes.rel==="shortcut icon"||t.tagName==="meta"&&(yt(t.attributes.name).match(/^msapplication-tile(image|color)$/)||yt(t.attributes.name)==="application-name"||yt(t.attributes.rel)==="icon"||yt(t.attributes.rel)==="apple-touch-icon"||yt(t.attributes.rel)==="shortcut icon")))return!0;if(t.tagName==="meta"){if(e.headMetaDescKeywords&&yt(t.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(yt(t.attributes.property).match(/^(og|twitter|fb):/)||yt(t.attributes.name).match(/^(og|twitter):/)||yt(t.attributes.name)==="pinterest"))return!0;if(e.headMetaRobots&&(yt(t.attributes.name)==="robots"||yt(t.attributes.name)==="googlebot"||yt(t.attributes.name)==="bingbot"))return!0;if(e.headMetaHttpEquiv&&t.attributes["http-equiv"]!==void 0)return!0;if(e.headMetaAuthorship&&(yt(t.attributes.name)==="author"||yt(t.attributes.name)==="generator"||yt(t.attributes.name)==="framework"||yt(t.attributes.name)==="publisher"||yt(t.attributes.name)==="progid"||yt(t.attributes.property).match(/^article:/)||yt(t.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&(yt(t.attributes.name)==="google-site-verification"||yt(t.attributes.name)==="yandex-verification"||yt(t.attributes.name)==="csrf-token"||yt(t.attributes.name)==="p:domain_verify"||yt(t.attributes.name)==="verify-v1"||yt(t.attributes.name)==="verification"||yt(t.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function Gr(t,e){const{doc:n,mirror:o,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:c,skipChild:d=!1,inlineStylesheet:u=!0,maskInputOptions:h={},maskTextFn:p,maskInputFn:g,slimDOMOptions:m,dataURLOptions:v={},inlineImages:x=!1,recordCanvas:y=!1,onSerialize:_,onIframeLoad:w,iframeLoadTimeout:I=5e3,onStylesheetLoad:R,stylesheetLoadTimeout:S=5e3,keepIframeSrcFn:E=()=>!1,newlyAddedElement:N=!1}=e;let{preserveWhiteSpace:k=!0}=e;const A=h4(t,{doc:n,mirror:o,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:c,inlineStylesheet:u,maskInputOptions:h,maskTextFn:p,maskInputFn:g,dataURLOptions:v,inlineImages:x,recordCanvas:y,keepIframeSrcFn:E,newlyAddedElement:N});if(!A)return console.warn(t,"not serialized"),null;let D;o.hasNode(t)?D=o.getId(t):m4(A,m)||!k&&A.type===zt.Text&&!A.isStyle&&!A.textContent.replace(/^\s+|\s+$/gm,"").length?D=qi:D=Mm();const O=Object.assign(A,{id:D});if(o.add(t,O),D===qi)return null;_&&_(t);let L=!d;if(O.type===zt.Element){L=L&&!O.needBlock,delete O.needBlock;const P=t.shadowRoot;P&&ji(P)&&(O.isShadowHost=!0)}if((O.type===zt.Document||O.type===zt.Element)&&L){m.headWhitespace&&O.type===zt.Element&&O.tagName==="head"&&(k=!1);const P={doc:n,mirror:o,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:c,skipChild:d,inlineStylesheet:u,maskInputOptions:h,maskTextFn:p,maskInputFn:g,slimDOMOptions:m,dataURLOptions:v,inlineImages:x,recordCanvas:y,preserveWhiteSpace:k,onSerialize:_,onIframeLoad:w,iframeLoadTimeout:I,onStylesheetLoad:R,stylesheetLoadTimeout:S,keepIframeSrcFn:E};if(!(O.type===zt.Element&&O.tagName==="textarea"&&O.attributes.value!==void 0))for(const G of Array.from(t.childNodes)){const B=Gr(G,P);B&&O.childNodes.push(B)}if(HE(t)&&t.shadowRoot)for(const G of Array.from(t.shadowRoot.childNodes)){const B=Gr(G,P);B&&(ji(t.shadowRoot)&&(B.isShadow=!0),O.childNodes.push(B))}}return t.parentNode&&Ai(t.parentNode)&&ji(t.parentNode)&&(O.isShadow=!0),O.type===zt.Element&&O.tagName==="iframe"&&d4(t,()=>{const P=t.contentDocument;if(P&&w){const G=Gr(P,{doc:P,mirror:o,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:c,skipChild:!1,inlineStylesheet:u,maskInputOptions:h,maskTextFn:p,maskInputFn:g,slimDOMOptions:m,dataURLOptions:v,inlineImages:x,recordCanvas:y,preserveWhiteSpace:k,onSerialize:_,onIframeLoad:w,iframeLoadTimeout:I,onStylesheetLoad:R,stylesheetLoadTimeout:S,keepIframeSrcFn:E});G&&w(t,G)}},I),O.type===zt.Element&&O.tagName==="link"&&O.attributes.rel==="stylesheet"&&u4(t,()=>{if(R){const P=Gr(t,{doc:n,mirror:o,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:c,skipChild:!1,inlineStylesheet:u,maskInputOptions:h,maskTextFn:p,maskInputFn:g,slimDOMOptions:m,dataURLOptions:v,inlineImages:x,recordCanvas:y,preserveWhiteSpace:k,onSerialize:_,onIframeLoad:w,iframeLoadTimeout:I,onStylesheetLoad:R,stylesheetLoadTimeout:S,keepIframeSrcFn:E});P&&R(t,P)}},S),O}function x4(t,e){const{mirror:n=new Pm,blockClass:o="rr-block",blockSelector:i=null,maskTextClass:a="rr-mask",maskTextSelector:s=null,inlineStylesheet:c=!0,inlineImages:d=!1,recordCanvas:u=!1,maskAllInputs:h=!1,maskTextFn:p,maskInputFn:g,slimDOM:m=!1,dataURLOptions:v,preserveWhiteSpace:x,onSerialize:y,onIframeLoad:_,iframeLoadTimeout:w,onStylesheetLoad:I,stylesheetLoadTimeout:R,keepIframeSrcFn:S=()=>!1}=e||{};return Gr(t,{doc:t,mirror:n,blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:s,skipChild:!1,inlineStylesheet:c,maskInputOptions:h===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:h===!1?{password:!0}:h,maskTextFn:p,maskInputFn:g,slimDOMOptions:m===!0||m==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:m==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:m===!1?{}:m,dataURLOptions:v,inlineImages:d,recordCanvas:u,preserveWhiteSpace:x,onSerialize:y,onIframeLoad:_,iframeLoadTimeout:w,onStylesheetLoad:I,stylesheetLoadTimeout:R,keepIframeSrcFn:S,newlyAddedElement:!1})}var it=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(it||{}),rt=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t))(rt||{}),Pn=(t=>(t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel",t))(Pn||{}),Po=(t=>(t[t.Mouse=0]="Mouse",t[t.Pen=1]="Pen",t[t.Touch=2]="Touch",t))(Po||{}),ei=(t=>(t[t["2D"]=0]="2D",t[t.WebGL=1]="WebGL",t[t.WebGL2=2]="WebGL2",t))(ei||{});function Cn(t,e,n=document){const o={capture:!0,passive:!0};return n.addEventListener(t,e,o),()=>n.removeEventListener(t,e,o)}const Nr=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let Dh={map:{},getId(){return console.error(Nr),-1},getNode(){return console.error(Nr),null},removeNodeFromMap(){console.error(Nr)},has(){return console.error(Nr),!1},reset(){console.error(Nr)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(Dh=new Proxy(Dh,{get(t,e,n){return e==="map"&&console.error(Nr),Reflect.get(t,e,n)}}));function Wi(t,e,n={}){let o=null,i=0;return function(...a){const s=Date.now();!i&&n.leading===!1&&(i=s);const c=e-(s-i),d=this;c<=0||c>e?(o&&(clearTimeout(o),o=null),i=s,t.apply(d,a)):!o&&n.trailing!==!1&&(o=setTimeout(()=>{i=n.leading===!1?0:Date.now(),o=null,t.apply(d,a)},c))}}function Ua(t,e,n,o,i=window){const a=i.Object.getOwnPropertyDescriptor(t,e);return i.Object.defineProperty(t,e,o?n:{set(s){setTimeout(()=>{n.set.call(this,s)},0),a&&a.set&&a.set.call(this,s)}}),()=>Ua(t,e,a||{},!0)}function ls(t,e,n){try{if(!(e in t))return()=>{};const o=t[e],i=n(o);return typeof i=="function"&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__rrweb_original__:{enumerable:!1,value:o}})),t[e]=i,()=>{t[e]=o}}catch{return()=>{}}}let ia=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(ia=()=>new Date().getTime());function _d(t){var e,n,o,i,a,s;const c=t.document;return{left:c.scrollingElement?c.scrollingElement.scrollLeft:t.pageXOffset!==void 0?t.pageXOffset:(c==null?void 0:c.documentElement.scrollLeft)||((n=(e=c==null?void 0:c.body)===null||e===void 0?void 0:e.parentElement)===null||n===void 0?void 0:n.scrollLeft)||((o=c==null?void 0:c.body)===null||o===void 0?void 0:o.scrollLeft)||0,top:c.scrollingElement?c.scrollingElement.scrollTop:t.pageYOffset!==void 0?t.pageYOffset:(c==null?void 0:c.documentElement.scrollTop)||((a=(i=c==null?void 0:c.body)===null||i===void 0?void 0:i.parentElement)===null||a===void 0?void 0:a.scrollTop)||((s=c==null?void 0:c.body)===null||s===void 0?void 0:s.scrollTop)||0}}function Id(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Sd(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Nm(t){return t?t.nodeType===t.ELEMENT_NODE?t:t.parentElement:null}function _n(t,e,n,o){if(!t)return!1;const i=Nm(t);if(!i)return!1;try{if(typeof e=="string"){if(i.classList.contains(e)||o&&i.closest("."+e)!==null)return!0}else if(ra(i,e,o))return!0}catch{}return!!(n&&(i.matches(n)||o&&i.closest(n)!==null))}function v4(t,e){return e.getId(t)!==-1}function Cl(t,e){return e.getId(t)===qi}function Dm(t,e){if(Ai(t))return!1;const n=e.getId(t);return e.has(n)?t.parentNode&&t.parentNode.nodeType===t.DOCUMENT_NODE?!1:t.parentNode?Dm(t.parentNode,e):!0:!0}function fc(t){return!!t.changedTouches}function y4(t=window){"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let n=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}function Fm(t,e){return!!(t.nodeName==="IFRAME"&&e.getMeta(t))}function zm(t,e){return!!(t.nodeName==="LINK"&&t.nodeType===t.ELEMENT_NODE&&t.getAttribute&&t.getAttribute("rel")==="stylesheet"&&e.getMeta(t))}function gc(t){return!!(t!=null&&t.shadowRoot)}class w4{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var n;return(n=this.styleIDMap.get(e))!==null&&n!==void 0?n:-1}has(e){return this.styleIDMap.has(e)}add(e,n){if(this.has(e))return this.getId(e);let o;return n===void 0?o=this.id++:o=n,this.styleIDMap.set(e,o),this.idStyleMap.set(o,e),o}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function Um(t){var e,n;let o=null;return((n=(e=t.getRootNode)===null||e===void 0?void 0:e.call(t))===null||n===void 0?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&t.getRootNode().host&&(o=t.getRootNode().host),o}function b4(t){let e=t,n;for(;n=Um(e);)e=n;return e}function C4(t){const e=t.ownerDocument;if(!e)return!1;const n=b4(t);return e.contains(n)}function Gm(t){const e=t.ownerDocument;return e?e.contains(t)||C4(t):!1}let Pi;function _4(t){Pi=t}function I4(){Pi=void 0}const et=t=>Pi?(...n)=>{try{return t(...n)}catch(o){if(Pi&&Pi(o)===!0)return;throw o}}:t;function Fh(t){return(...e)=>{try{return t(...e)}catch(n){try{n._external_=!0}catch{}throw n}}}class zh{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,n,o,i){const a=o||this.getIdToRemoteIdMap(e),s=i||this.getRemoteIdToIdMap(e);let c=a.get(n);return c||(c=this.generateIdFn(),a.set(n,c),s.set(c,n)),c}getIds(e,n){const o=this.getIdToRemoteIdMap(e),i=this.getRemoteIdToIdMap(e);return n.map(a=>this.getId(e,a,o,i))}getRemoteId(e,n,o){const i=o||this.getRemoteIdToIdMap(e);if(typeof n!="number")return n;const a=i.get(n);return a||-1}getRemoteIds(e,n){const o=this.getRemoteIdToIdMap(e);return n.map(i=>this.getRemoteId(e,i,o))}reset(e){if(!e){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let n=this.iframeIdToRemoteIdMap.get(e);return n||(n=new Map,this.iframeIdToRemoteIdMap.set(e,n)),n}getRemoteIdToIdMap(e){let n=this.iframeRemoteIdToIdMap.get(e);return n||(n=new Map,this.iframeRemoteIdToIdMap.set(e,n)),n}}class S4{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new zh(Mm),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new zh(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,n){var o;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:n}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(o=this.loadListener)===null||o===void 0||o.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){const n=e;if(n.data.type!=="rrweb"||n.origin!==n.data.origin||!e.source)return;const i=this.crossOriginIframeMap.get(e.source);if(!i)return;const a=this.transformCrossOriginEvent(i,n.data.event);a&&this.wrappedEmit(a,n.data.isCheckout)}transformCrossOriginEvent(e,n){var o;switch(n.type){case it.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(n.data.node,e);const i=n.data.node.id;return this.crossOriginIframeRootIdMap.set(e,i),this.patchRootIdOnNode(n.data.node,i),{timestamp:n.timestamp,type:it.IncrementalSnapshot,data:{source:rt.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:n.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case it.Meta:case it.Load:case it.DomContentLoaded:return!1;case it.Plugin:return n;case it.Custom:return this.replaceIds(n.data.payload,e,["id","parentId","previousId","nextId"]),n;case it.IncrementalSnapshot:switch(n.data.source){case rt.Mutation:return n.data.adds.forEach(i=>{this.replaceIds(i,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(i.node,e);const a=this.crossOriginIframeRootIdMap.get(e);a&&this.patchRootIdOnNode(i.node,a)}),n.data.removes.forEach(i=>{this.replaceIds(i,e,["parentId","id"])}),n.data.attributes.forEach(i=>{this.replaceIds(i,e,["id"])}),n.data.texts.forEach(i=>{this.replaceIds(i,e,["id"])}),n;case rt.Drag:case rt.TouchMove:case rt.MouseMove:return n.data.positions.forEach(i=>{this.replaceIds(i,e,["id"])}),n;case rt.ViewportResize:return!1;case rt.MediaInteraction:case rt.MouseInteraction:case rt.Scroll:case rt.CanvasMutation:case rt.Input:return this.replaceIds(n.data,e,["id"]),n;case rt.StyleSheetRule:case rt.StyleDeclaration:return this.replaceIds(n.data,e,["id"]),this.replaceStyleIds(n.data,e,["styleId"]),n;case rt.Font:return n;case rt.Selection:return n.data.ranges.forEach(i=>{this.replaceIds(i,e,["start","end"])}),n;case rt.AdoptedStyleSheet:return this.replaceIds(n.data,e,["id"]),this.replaceStyleIds(n.data,e,["styleIds"]),(o=n.data.styles)===null||o===void 0||o.forEach(i=>{this.replaceStyleIds(i,e,["styleId"])}),n}}}replace(e,n,o,i){for(const a of i)!Array.isArray(n[a])&&typeof n[a]!="number"||(Array.isArray(n[a])?n[a]=e.getIds(o,n[a]):n[a]=e.getId(o,n[a]));return n}replaceIds(e,n,o){return this.replace(this.crossOriginIframeMirror,e,n,o)}replaceStyleIds(e,n,o){return this.replace(this.crossOriginIframeStyleMirror,e,n,o)}replaceIdOnNode(e,n){this.replaceIds(e,n,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach(o=>{this.replaceIdOnNode(o,n)})}patchRootIdOnNode(e,n){e.type!==zt.Document&&!e.rootId&&(e.rootId=n),"childNodes"in e&&e.childNodes.forEach(o=>{this.patchRootIdOnNode(o,n)})}}function Uh(t){return"__ln"in t}class R4{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let n=this.head;for(let o=0;o<e;o++)n=(n==null?void 0:n.next)||null;return n}addNode(e){const n={value:e,previous:null,next:null};if(e.__ln=n,e.previousSibling&&Uh(e.previousSibling)){const o=e.previousSibling.__ln.next;n.next=o,n.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=n,o&&(o.previous=n)}else if(e.nextSibling&&Uh(e.nextSibling)&&e.nextSibling.__ln.previous){const o=e.nextSibling.__ln.previous;n.previous=o,n.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=n,o&&(o.next=n)}else this.head&&(this.head.previous=n),n.next=this.head,this.head=n;n.next===null&&(this.tail=n),this.length++}removeNode(e){const n=e.__ln;this.head&&(n.previous?(n.previous.next=n.next,n.next?n.next.previous=n.previous:this.tail=n.previous):(this.head=n.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const Gh=(t,e)=>`${t}@${e}`;class T4{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],n=new Set,o=new R4,i=d=>{let u=d,h=qi;for(;h===qi;)u=u&&u.nextSibling,h=u&&this.mirror.getId(u);return h},a=d=>{if(!d.parentNode||!Gm(d)||d.parentNode.tagName==="TEXTAREA")return;const u=Ai(d.parentNode)?this.mirror.getId(Um(d)):this.mirror.getId(d.parentNode),h=i(d);if(u===-1||h===-1)return o.addNode(d);const p=Gr(d,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:g=>{Fm(g,this.mirror)&&this.iframeManager.addIframe(g),zm(g,this.mirror)&&this.stylesheetManager.trackLinkElement(g),gc(d)&&this.shadowDomManager.addShadowRoot(d.shadowRoot,this.doc)},onIframeLoad:(g,m)=>{this.iframeManager.attachIframe(g,m),this.shadowDomManager.observeAttachShadow(g)},onStylesheetLoad:(g,m)=>{this.stylesheetManager.attachLinkElement(g,m)}});p&&(e.push({parentId:u,nextId:h,node:p}),n.add(p.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const d of this.movedSet)Hh(this.removes,d,this.mirror)&&!this.movedSet.has(d.parentNode)||a(d);for(const d of this.addedSet)!qh(this.droppedSet,d)&&!Hh(this.removes,d,this.mirror)||qh(this.movedSet,d)?a(d):this.droppedSet.add(d);let s=null;for(;o.length;){let d=null;if(s){const u=this.mirror.getId(s.value.parentNode),h=i(s.value);u!==-1&&h!==-1&&(d=s)}if(!d){let u=o.tail;for(;u;){const h=u;if(u=u.previous,h){const p=this.mirror.getId(h.value.parentNode);if(i(h.value)===-1)continue;if(p!==-1){d=h;break}else{const m=h.value;if(m.parentNode&&m.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const v=m.parentNode.host;if(this.mirror.getId(v)!==-1){d=h;break}}}}}}if(!d){for(;o.head;)o.removeNode(o.head.value);break}s=d.previous,o.removeNode(d.value),a(d.value)}const c={texts:this.texts.map(d=>{const u=d.node;return u.parentNode&&u.parentNode.tagName==="TEXTAREA"&&this.genTextAreaValueMutation(u.parentNode),{id:this.mirror.getId(u),value:d.value}}).filter(d=>!n.has(d.id)).filter(d=>this.mirror.has(d.id)),attributes:this.attributes.map(d=>{const{attributes:u}=d;if(typeof u.style=="string"){const h=JSON.stringify(d.styleDiff),p=JSON.stringify(d._unchangedStyles);h.length<u.style.length&&(h+p).split("var(").length===u.style.split("var(").length&&(u.style=d.styleDiff)}return{id:this.mirror.getId(d.node),attributes:u}}).filter(d=>!n.has(d.id)).filter(d=>this.mirror.has(d.id)),removes:this.removes,adds:e};!c.texts.length&&!c.attributes.length&&!c.removes.length&&!c.adds.length||(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(c))},this.genTextAreaValueMutation=e=>{let n=this.attributeMap.get(e);n||(n={node:e,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(n),this.attributeMap.set(e,n)),n.attributes.value=Array.from(e.childNodes,o=>o.textContent||"").join("")},this.processMutation=e=>{if(!Cl(e.target,this.mirror))switch(e.type){case"characterData":{const n=e.target.textContent;!_n(e.target,this.blockClass,this.blockSelector,!1)&&n!==e.oldValue&&this.texts.push({value:Lm(e.target,this.maskTextClass,this.maskTextSelector)&&n?this.maskTextFn?this.maskTextFn(n,Nm(e.target)):n.replace(/[\S]/g,"*"):n,node:e.target});break}case"attributes":{const n=e.target;let o=e.attributeName,i=e.target.getAttribute(o);if(o==="value"){const s=bd(n);i=wd({element:n,maskInputOptions:this.maskInputOptions,tagName:n.tagName,type:s,value:i,maskInputFn:this.maskInputFn})}if(_n(e.target,this.blockClass,this.blockSelector,!1)||i===e.oldValue)return;let a=this.attributeMap.get(e.target);if(n.tagName==="IFRAME"&&o==="src"&&!this.keepIframeSrcFn(i))if(!n.contentDocument)o="rr_src";else return;if(a||(a={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(a),this.attributeMap.set(e.target,a)),o==="type"&&n.tagName==="INPUT"&&(e.oldValue||"").toLowerCase()==="password"&&n.setAttribute("data-rr-is-password","true"),!Bm(n.tagName,o)&&(a.attributes[o]=Om(this.doc,wr(n.tagName),wr(o),i),o==="style")){let s;try{s=document.implementation.createHTMLDocument()}catch{s=this.doc}const c=s.createElement("span");e.oldValue&&c.setAttribute("style",e.oldValue);for(const d of Array.from(n.style)){const u=n.style.getPropertyValue(d),h=n.style.getPropertyPriority(d);u!==c.style.getPropertyValue(d)||h!==c.style.getPropertyPriority(d)?h===""?a.styleDiff[d]=u:a.styleDiff[d]=[u,h]:a._unchangedStyles[d]=[u,h]}for(const d of Array.from(c.style))n.style.getPropertyValue(d)===""&&(a.styleDiff[d]=!1)}break}case"childList":{if(_n(e.target,this.blockClass,this.blockSelector,!0))return;if(e.target.tagName==="TEXTAREA"){this.genTextAreaValueMutation(e.target);return}e.addedNodes.forEach(n=>this.genAdds(n,e.target)),e.removedNodes.forEach(n=>{const o=this.mirror.getId(n),i=Ai(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);_n(e.target,this.blockClass,this.blockSelector,!1)||Cl(n,this.mirror)||!v4(n,this.mirror)||(this.addedSet.has(n)?(mc(this.addedSet,n),this.droppedSet.add(n)):this.addedSet.has(e.target)&&o===-1||Dm(e.target,this.mirror)||(this.movedSet.has(n)&&this.movedMap[Gh(o,i)]?mc(this.movedSet,n):this.removes.push({parentId:i,id:o,isShadow:Ai(e.target)&&ji(e.target)?!0:void 0})),this.mapRemoves.push(n))});break}}},this.genAdds=(e,n)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!(this.addedSet.has(e)||this.movedSet.has(e))){if(this.mirror.hasNode(e)){if(Cl(e,this.mirror))return;this.movedSet.add(e);let o=null;n&&this.mirror.hasNode(n)&&(o=this.mirror.getId(n)),o&&o!==-1&&(this.movedMap[Gh(this.mirror.getId(e),o)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);_n(e,this.blockClass,this.blockSelector,!1)||(e.childNodes.forEach(o=>this.genAdds(o)),gc(e)&&e.shadowRoot.childNodes.forEach(o=>{this.processedNodeManager.add(o,this),this.genAdds(o,e)}))}}}init(e){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(n=>{this[n]=e[n]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function mc(t,e){t.delete(e),e.childNodes.forEach(n=>mc(t,n))}function Hh(t,e,n){return t.length===0?!1:Hm(t,e,n)}function Hm(t,e,n){const{parentNode:o}=e;if(!o)return!1;const i=n.getId(o);return t.some(a=>a.id===i)?!0:Hm(t,o,n)}function qh(t,e){return t.size===0?!1:qm(t,e)}function qm(t,e){const{parentNode:n}=e;return n?t.has(n)?!0:qm(t,n):!1}const ur=[];function cs(t){try{if("composedPath"in t){const e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0]}catch{}return t&&t.target}function Wm(t,e){var n,o;const i=new T4;ur.push(i),i.init(t);let a=window.MutationObserver||window.__rrMutationObserver;const s=(o=(n=window==null?void 0:window.Zone)===null||n===void 0?void 0:n.__symbol__)===null||o===void 0?void 0:o.call(n,"MutationObserver");s&&window[s]&&(a=window[s]);const c=new a(et(i.processMutations.bind(i)));return c.observe(e,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),c}function E4({mousemoveCb:t,sampling:e,doc:n,mirror:o}){if(e.mousemove===!1)return()=>{};const i=typeof e.mousemove=="number"?e.mousemove:50,a=typeof e.mousemoveCallback=="number"?e.mousemoveCallback:500;let s=[],c;const d=Wi(et(p=>{const g=Date.now()-c;t(s.map(m=>(m.timeOffset-=g,m)),p),s=[],c=null}),a),u=et(Wi(et(p=>{const g=cs(p),{clientX:m,clientY:v}=fc(p)?p.changedTouches[0]:p;c||(c=ia()),s.push({x:m,y:v,id:o.getId(g),timeOffset:ia()-c}),d(typeof DragEvent<"u"&&p instanceof DragEvent?rt.Drag:p instanceof MouseEvent?rt.MouseMove:rt.TouchMove)}),i,{trailing:!1})),h=[Cn("mousemove",u,n),Cn("touchmove",u,n),Cn("drag",u,n)];return et(()=>{h.forEach(p=>p())})}function k4({mouseInteractionCb:t,doc:e,mirror:n,blockClass:o,blockSelector:i,sampling:a}){if(a.mouseInteraction===!1)return()=>{};const s=a.mouseInteraction===!0||a.mouseInteraction===void 0?{}:a.mouseInteraction,c=[];let d=null;const u=h=>p=>{const g=cs(p);if(_n(g,o,i,!0))return;let m=null,v=h;if("pointerType"in p){switch(p.pointerType){case"mouse":m=Po.Mouse;break;case"touch":m=Po.Touch;break;case"pen":m=Po.Pen;break}m===Po.Touch?Pn[h]===Pn.MouseDown?v="TouchStart":Pn[h]===Pn.MouseUp&&(v="TouchEnd"):Po.Pen}else fc(p)&&(m=Po.Touch);m!==null?(d=m,(v.startsWith("Touch")&&m===Po.Touch||v.startsWith("Mouse")&&m===Po.Mouse)&&(m=null)):Pn[h]===Pn.Click&&(m=d,d=null);const x=fc(p)?p.changedTouches[0]:p;if(!x)return;const y=n.getId(g),{clientX:_,clientY:w}=x;et(t)(Object.assign({type:Pn[v],id:y,x:_,y:w},m!==null&&{pointerType:m}))};return Object.keys(Pn).filter(h=>Number.isNaN(Number(h))&&!h.endsWith("_Departed")&&s[h]!==!1).forEach(h=>{let p=wr(h);const g=u(h);if(window.PointerEvent)switch(Pn[h]){case Pn.MouseDown:case Pn.MouseUp:p=p.replace("mouse","pointer");break;case Pn.TouchStart:case Pn.TouchEnd:return}c.push(Cn(p,g,e))}),et(()=>{c.forEach(h=>h())})}function $m({scrollCb:t,doc:e,mirror:n,blockClass:o,blockSelector:i,sampling:a}){const s=et(Wi(et(c=>{const d=cs(c);if(!d||_n(d,o,i,!0))return;const u=n.getId(d);if(d===e&&e.defaultView){const h=_d(e.defaultView);t({id:u,x:h.left,y:h.top})}else t({id:u,x:d.scrollLeft,y:d.scrollTop})}),a.scroll||100));return Cn("scroll",s,e)}function A4({viewportResizeCb:t},{win:e}){let n=-1,o=-1;const i=et(Wi(et(()=>{const a=Id(),s=Sd();(n!==a||o!==s)&&(t({width:Number(s),height:Number(a)}),n=a,o=s)}),200));return Cn("resize",i,e)}function Wh(t,e){const n=Object.assign({},t);return e||delete n.userTriggered,n}const j4=["INPUT","TEXTAREA","SELECT"],$h=new WeakMap;function P4({inputCb:t,doc:e,mirror:n,blockClass:o,blockSelector:i,ignoreClass:a,ignoreSelector:s,maskInputOptions:c,maskInputFn:d,sampling:u,userTriggeredOnInput:h}){function p(w){let I=cs(w);const R=w.isTrusted,S=I&&I.tagName;if(I&&S==="OPTION"&&(I=I.parentElement),!I||!S||j4.indexOf(S)<0||_n(I,o,i,!0)||I.classList.contains(a)||s&&I.matches(s))return;let E=I.value,N=!1;const k=bd(I)||"";k==="radio"||k==="checkbox"?N=I.checked:(c[S.toLowerCase()]||c[k])&&(E=wd({element:I,maskInputOptions:c,tagName:S,type:k,value:E,maskInputFn:d})),g(I,et(Wh)({text:E,isChecked:N,userTriggered:R},h));const A=I.name;k==="radio"&&A&&N&&e.querySelectorAll(`input[type="radio"][name="${A}"]`).forEach(D=>{D!==I&&g(D,et(Wh)({text:D.value,isChecked:!N,userTriggered:!1},h))})}function g(w,I){const R=$h.get(w);if(!R||R.text!==I.text||R.isChecked!==I.isChecked){$h.set(w,I);const S=n.getId(w);et(t)(Object.assign(Object.assign({},I),{id:S}))}}const v=(u.input==="last"?["change"]:["input","change"]).map(w=>Cn(w,et(p),e)),x=e.defaultView;if(!x)return()=>{v.forEach(w=>w())};const y=x.Object.getOwnPropertyDescriptor(x.HTMLInputElement.prototype,"value"),_=[[x.HTMLInputElement.prototype,"value"],[x.HTMLInputElement.prototype,"checked"],[x.HTMLSelectElement.prototype,"value"],[x.HTMLTextAreaElement.prototype,"value"],[x.HTMLSelectElement.prototype,"selectedIndex"],[x.HTMLOptionElement.prototype,"selected"]];return y&&y.set&&v.push(..._.map(w=>Ua(w[0],w[1],{set(){et(p)({target:this,isTrusted:!1})}},!1,x))),et(()=>{v.forEach(w=>w())})}function sa(t){const e=[];function n(o,i){if(Cs("CSSGroupingRule")&&o.parentRule instanceof CSSGroupingRule||Cs("CSSMediaRule")&&o.parentRule instanceof CSSMediaRule||Cs("CSSSupportsRule")&&o.parentRule instanceof CSSSupportsRule||Cs("CSSConditionRule")&&o.parentRule instanceof CSSConditionRule){const s=Array.from(o.parentRule.cssRules).indexOf(o);i.unshift(s)}else if(o.parentStyleSheet){const s=Array.from(o.parentStyleSheet.cssRules).indexOf(o);i.unshift(s)}return i}return n(t,e)}function Wo(t,e,n){let o,i;return t?(t.ownerNode?o=e.getId(t.ownerNode):i=n.getId(t),{styleId:i,id:o}):{}}function M4({styleSheetRuleCb:t,mirror:e,stylesheetManager:n},{win:o}){if(!o.CSSStyleSheet||!o.CSSStyleSheet.prototype)return()=>{};const i=o.CSSStyleSheet.prototype.insertRule;o.CSSStyleSheet.prototype.insertRule=new Proxy(i,{apply:et((h,p,g)=>{const[m,v]=g,{id:x,styleId:y}=Wo(p,e,n.styleMirror);return(x&&x!==-1||y&&y!==-1)&&t({id:x,styleId:y,adds:[{rule:m,index:v}]}),Fh(()=>h.apply(p,g))()})});const a=o.CSSStyleSheet.prototype.deleteRule;o.CSSStyleSheet.prototype.deleteRule=new Proxy(a,{apply:et((h,p,g)=>{const[m]=g,{id:v,styleId:x}=Wo(p,e,n.styleMirror);return(v&&v!==-1||x&&x!==-1)&&t({id:v,styleId:x,removes:[{index:m}]}),Fh(()=>h.apply(p,g))()})});let s;o.CSSStyleSheet.prototype.replace&&(s=o.CSSStyleSheet.prototype.replace,o.CSSStyleSheet.prototype.replace=new Proxy(s,{apply:et((h,p,g)=>{const[m]=g,{id:v,styleId:x}=Wo(p,e,n.styleMirror);return(v&&v!==-1||x&&x!==-1)&&t({id:v,styleId:x,replace:m}),h.apply(p,g)})}));let c;o.CSSStyleSheet.prototype.replaceSync&&(c=o.CSSStyleSheet.prototype.replaceSync,o.CSSStyleSheet.prototype.replaceSync=new Proxy(c,{apply:et((h,p,g)=>{const[m]=g,{id:v,styleId:x}=Wo(p,e,n.styleMirror);return(v&&v!==-1||x&&x!==-1)&&t({id:v,styleId:x,replaceSync:m}),h.apply(p,g)})}));const d={};_s("CSSGroupingRule")?d.CSSGroupingRule=o.CSSGroupingRule:(_s("CSSMediaRule")&&(d.CSSMediaRule=o.CSSMediaRule),_s("CSSConditionRule")&&(d.CSSConditionRule=o.CSSConditionRule),_s("CSSSupportsRule")&&(d.CSSSupportsRule=o.CSSSupportsRule));const u={};return Object.entries(d).forEach(([h,p])=>{u[h]={insertRule:p.prototype.insertRule,deleteRule:p.prototype.deleteRule},p.prototype.insertRule=new Proxy(u[h].insertRule,{apply:et((g,m,v)=>{const[x,y]=v,{id:_,styleId:w}=Wo(m.parentStyleSheet,e,n.styleMirror);return(_&&_!==-1||w&&w!==-1)&&t({id:_,styleId:w,adds:[{rule:x,index:[...sa(m),y||0]}]}),g.apply(m,v)})}),p.prototype.deleteRule=new Proxy(u[h].deleteRule,{apply:et((g,m,v)=>{const[x]=v,{id:y,styleId:_}=Wo(m.parentStyleSheet,e,n.styleMirror);return(y&&y!==-1||_&&_!==-1)&&t({id:y,styleId:_,removes:[{index:[...sa(m),x]}]}),g.apply(m,v)})})}),et(()=>{o.CSSStyleSheet.prototype.insertRule=i,o.CSSStyleSheet.prototype.deleteRule=a,s&&(o.CSSStyleSheet.prototype.replace=s),c&&(o.CSSStyleSheet.prototype.replaceSync=c),Object.entries(d).forEach(([h,p])=>{p.prototype.insertRule=u[h].insertRule,p.prototype.deleteRule=u[h].deleteRule})})}function Vm({mirror:t,stylesheetManager:e},n){var o,i,a;let s=null;n.nodeName==="#document"?s=t.getId(n):s=t.getId(n.host);const c=n.nodeName==="#document"?(o=n.defaultView)===null||o===void 0?void 0:o.Document:(a=(i=n.ownerDocument)===null||i===void 0?void 0:i.defaultView)===null||a===void 0?void 0:a.ShadowRoot,d=c!=null&&c.prototype?Object.getOwnPropertyDescriptor(c==null?void 0:c.prototype,"adoptedStyleSheets"):void 0;return s===null||s===-1||!c||!d?()=>{}:(Object.defineProperty(n,"adoptedStyleSheets",{configurable:d.configurable,enumerable:d.enumerable,get(){var u;return(u=d.get)===null||u===void 0?void 0:u.call(this)},set(u){var h;const p=(h=d.set)===null||h===void 0?void 0:h.call(this,u);if(s!==null&&s!==-1)try{e.adoptStyleSheets(u,s)}catch{}return p}}),et(()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:d.configurable,enumerable:d.enumerable,get:d.get,set:d.set})}))}function O4({styleDeclarationCb:t,mirror:e,ignoreCSSAttributes:n,stylesheetManager:o},{win:i}){const a=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(a,{apply:et((c,d,u)=>{var h;const[p,g,m]=u;if(n.has(p))return a.apply(d,[p,g,m]);const{id:v,styleId:x}=Wo((h=d.parentRule)===null||h===void 0?void 0:h.parentStyleSheet,e,o.styleMirror);return(v&&v!==-1||x&&x!==-1)&&t({id:v,styleId:x,set:{property:p,value:g,priority:m},index:sa(d.parentRule)}),c.apply(d,u)})});const s=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(s,{apply:et((c,d,u)=>{var h;const[p]=u;if(n.has(p))return s.apply(d,[p]);const{id:g,styleId:m}=Wo((h=d.parentRule)===null||h===void 0?void 0:h.parentStyleSheet,e,o.styleMirror);return(g&&g!==-1||m&&m!==-1)&&t({id:g,styleId:m,remove:{property:p},index:sa(d.parentRule)}),c.apply(d,u)})}),et(()=>{i.CSSStyleDeclaration.prototype.setProperty=a,i.CSSStyleDeclaration.prototype.removeProperty=s})}function B4({mediaInteractionCb:t,blockClass:e,blockSelector:n,mirror:o,sampling:i,doc:a}){const s=et(d=>Wi(et(u=>{const h=cs(u);if(!h||_n(h,e,n,!0))return;const{currentTime:p,volume:g,muted:m,playbackRate:v}=h;t({type:d,id:o.getId(h),currentTime:p,volume:g,muted:m,playbackRate:v})}),i.media||500)),c=[Cn("play",s(0),a),Cn("pause",s(1),a),Cn("seeked",s(2),a),Cn("volumechange",s(3),a),Cn("ratechange",s(4),a)];return et(()=>{c.forEach(d=>d())})}function L4({fontCb:t,doc:e}){const n=e.defaultView;if(!n)return()=>{};const o=[],i=new WeakMap,a=n.FontFace;n.FontFace=function(d,u,h){const p=new a(d,u,h);return i.set(p,{family:d,buffer:typeof u!="string",descriptors:h,fontSource:typeof u=="string"?u:JSON.stringify(Array.from(new Uint8Array(u)))}),p};const s=ls(e.fonts,"add",function(c){return function(d){return setTimeout(et(()=>{const u=i.get(d);u&&(t(u),i.delete(d))}),0),c.apply(this,[d])}});return o.push(()=>{n.FontFace=a}),o.push(s),et(()=>{o.forEach(c=>c())})}function N4(t){const{doc:e,mirror:n,blockClass:o,blockSelector:i,selectionCb:a}=t;let s=!0;const c=et(()=>{const d=e.getSelection();if(!d||s&&(d!=null&&d.isCollapsed))return;s=d.isCollapsed||!1;const u=[],h=d.rangeCount||0;for(let p=0;p<h;p++){const g=d.getRangeAt(p),{startContainer:m,startOffset:v,endContainer:x,endOffset:y}=g;_n(m,o,i,!0)||_n(x,o,i,!0)||u.push({start:n.getId(m),startOffset:v,end:n.getId(x),endOffset:y})}a({ranges:u})});return c(),Cn("selectionchange",c)}function D4(t,e){const{mutationCb:n,mousemoveCb:o,mouseInteractionCb:i,scrollCb:a,viewportResizeCb:s,inputCb:c,mediaInteractionCb:d,styleSheetRuleCb:u,styleDeclarationCb:h,canvasMutationCb:p,fontCb:g,selectionCb:m}=t;t.mutationCb=(...v)=>{e.mutation&&e.mutation(...v),n(...v)},t.mousemoveCb=(...v)=>{e.mousemove&&e.mousemove(...v),o(...v)},t.mouseInteractionCb=(...v)=>{e.mouseInteraction&&e.mouseInteraction(...v),i(...v)},t.scrollCb=(...v)=>{e.scroll&&e.scroll(...v),a(...v)},t.viewportResizeCb=(...v)=>{e.viewportResize&&e.viewportResize(...v),s(...v)},t.inputCb=(...v)=>{e.input&&e.input(...v),c(...v)},t.mediaInteractionCb=(...v)=>{e.mediaInteaction&&e.mediaInteaction(...v),d(...v)},t.styleSheetRuleCb=(...v)=>{e.styleSheetRule&&e.styleSheetRule(...v),u(...v)},t.styleDeclarationCb=(...v)=>{e.styleDeclaration&&e.styleDeclaration(...v),h(...v)},t.canvasMutationCb=(...v)=>{e.canvasMutation&&e.canvasMutation(...v),p(...v)},t.fontCb=(...v)=>{e.font&&e.font(...v),g(...v)},t.selectionCb=(...v)=>{e.selection&&e.selection(...v),m(...v)}}function F4(t,e={}){const n=t.doc.defaultView;if(!n)return()=>{};D4(t,e);let o;t.recordDOM&&(o=Wm(t,t.doc));const i=E4(t),a=k4(t),s=$m(t),c=A4(t,{win:n}),d=P4(t),u=B4(t);let h=()=>{},p=()=>{},g=()=>{},m=()=>{};t.recordDOM&&(h=M4(t,{win:n}),p=Vm(t,t.doc),g=O4(t,{win:n}),t.collectFonts&&(m=L4(t)));const v=N4(t),x=[];for(const y of t.plugins)x.push(y.observer(y.callback,n,y.options));return et(()=>{ur.forEach(y=>y.reset()),o==null||o.disconnect(),i(),a(),s(),c(),d(),u(),h(),p(),g(),m(),v(),x.forEach(y=>y())})}function Cs(t){return typeof window[t]<"u"}function _s(t){return!!(typeof window[t]<"u"&&window[t].prototype&&"insertRule"in window[t].prototype&&"deleteRule"in window[t].prototype)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function z4(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(t);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(t,o[i])&&(n[o[i]]=t[o[i]]);return n}function U4(t,e,n,o){function i(a){return a instanceof n?a:new n(function(s){s(a)})}return new(n||(n=Promise))(function(a,s){function c(h){try{u(o.next(h))}catch(p){s(p)}}function d(h){try{u(o.throw(h))}catch(p){s(p)}}function u(h){h.done?a(h.value):i(h.value).then(c,d)}u((o=o.apply(t,[])).next())})}function G4(t,e){var n=e===void 0?null:e,o=t.toString(),i=o.split(`
`);i.pop(),i.shift();for(var a=i[0].search(/\S/),s=/(['"])__worker_loader_strict__(['"])/g,c=0,d=i.length;c<d;++c)i[c]=i[c].substring(a).replace(s,"$1use strict$2")+`
`;return n&&i.push("//# sourceMappingURL="+n+`
`),i}function H4(t,e){var n=G4(t,e),o=new Blob(n,{type:"application/javascript"});return URL.createObjectURL(o)}function q4(t,e){var n;return function(i){return n=n||H4(t,e),new Worker(n,i)}}var W4=q4(function(){(function(){"__worker_loader_strict__";/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function t(u,h,p,g){function m(v){return v instanceof p?v:new p(function(x){x(v)})}return new(p||(p=Promise))(function(v,x){function y(I){try{w(g.next(I))}catch(R){x(R)}}function _(I){try{w(g.throw(I))}catch(R){x(R)}}function w(I){I.done?v(I.value):m(I.value).then(y,_)}w((g=g.apply(u,[])).next())})}for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=typeof Uint8Array>"u"?[]:new Uint8Array(256),o=0;o<e.length;o++)n[e.charCodeAt(o)]=o;var i=function(u){var h=new Uint8Array(u),p,g=h.length,m="";for(p=0;p<g;p+=3)m+=e[h[p]>>2],m+=e[(h[p]&3)<<4|h[p+1]>>4],m+=e[(h[p+1]&15)<<2|h[p+2]>>6],m+=e[h[p+2]&63];return g%3===2?m=m.substring(0,m.length-1)+"=":g%3===1&&(m=m.substring(0,m.length-2)+"=="),m};const a=new Map,s=new Map;function c(u,h,p){return t(this,void 0,void 0,function*(){const g=`${u}-${h}`;if("OffscreenCanvas"in globalThis){if(s.has(g))return s.get(g);const m=new OffscreenCanvas(u,h);m.getContext("2d");const x=yield(yield m.convertToBlob(p)).arrayBuffer(),y=i(x);return s.set(g,y),y}else return""})}const d=self;d.onmessage=function(u){return t(this,void 0,void 0,function*(){if("OffscreenCanvas"in globalThis){const{id:h,bitmap:p,width:g,height:m,dataURLOptions:v}=u.data,x=c(g,m,v),y=new OffscreenCanvas(g,m);y.getContext("2d").drawImage(p,0,0),p.close();const w=yield y.convertToBlob(v),I=w.type,R=yield w.arrayBuffer(),S=i(R);if(!a.has(h)&&(yield x)===S)return a.set(h,S),d.postMessage({id:h});if(a.get(h)===S)return d.postMessage({id:h});d.postMessage({id:h,type:I,base64:S,width:g,height:m}),a.set(h,S)}else return d.postMessage({id:u.data.id})})}})()},null),Hr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$4=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Is=0;Is<Hr.length;Is++)$4[Hr.charCodeAt(Is)]=Is;var V4=function(t){var e=new Uint8Array(t),n,o=e.length,i="";for(n=0;n<o;n+=3)i+=Hr[e[n]>>2],i+=Hr[(e[n]&3)<<4|e[n+1]>>4],i+=Hr[(e[n+1]&15)<<2|e[n+2]>>6],i+=Hr[e[n+2]&63];return o%3===2?i=i.substring(0,i.length-1)+"=":o%3===1&&(i=i.substring(0,i.length-2)+"=="),i};const Vh=new Map;function K4(t,e){let n=Vh.get(t);return n||(n=new Map,Vh.set(t,n)),n.has(e)||n.set(e,[]),n.get(e)}const Km=(t,e,n)=>{if(!t||!(Xm(t,e)||typeof t=="object"))return;const o=t.constructor.name,i=K4(n,o);let a=i.indexOf(t);return a===-1&&(a=i.length,i.push(t)),a};function Hs(t,e,n){if(t instanceof Array)return t.map(o=>Hs(o,e,n));if(t===null)return t;if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray)return{rr_type:t.constructor.name,args:[Object.values(t)]};if(t instanceof ArrayBuffer){const o=t.constructor.name,i=V4(t);return{rr_type:o,base64:i}}else{if(t instanceof DataView)return{rr_type:t.constructor.name,args:[Hs(t.buffer,e,n),t.byteOffset,t.byteLength]};if(t instanceof HTMLImageElement){const o=t.constructor.name,{src:i}=t;return{rr_type:o,src:i}}else if(t instanceof HTMLCanvasElement){const o="HTMLImageElement",i=t.toDataURL();return{rr_type:o,src:i}}else{if(t instanceof ImageData)return{rr_type:t.constructor.name,args:[Hs(t.data,e,n),t.width,t.height]};if(Xm(t,e)||typeof t=="object"){const o=t.constructor.name,i=Km(t,e,n);return{rr_type:o,index:i}}}}return t}const Jm=(t,e,n)=>[...t].map(o=>Hs(o,e,n)),Xm=(t,e)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(i=>typeof e[i]=="function").find(i=>t instanceof e[i]);function J4(t,e,n,o){const i=[],a=Object.getOwnPropertyNames(e.CanvasRenderingContext2D.prototype);for(const s of a)try{if(typeof e.CanvasRenderingContext2D.prototype[s]!="function")continue;const c=ls(e.CanvasRenderingContext2D.prototype,s,function(d){return function(...u){return _n(this.canvas,n,o,!0)||setTimeout(()=>{const h=Jm([...u],e,this);t(this.canvas,{type:ei["2D"],property:s,args:h})},0),d.apply(this,u)}});i.push(c)}catch{const d=Ua(e.CanvasRenderingContext2D.prototype,s,{set(u){t(this.canvas,{type:ei["2D"],property:s,args:[u],setter:!0})}});i.push(d)}return()=>{i.forEach(s=>s())}}function X4(t){return t==="experimental-webgl"?"webgl":t}function Kh(t,e,n,o){const i=[];try{const a=ls(t.HTMLCanvasElement.prototype,"getContext",function(s){return function(c,...d){if(!_n(this,e,n,!0)){const u=X4(c);if("__context"in this||(this.__context=u),o&&["webgl","webgl2"].includes(u))if(d[0]&&typeof d[0]=="object"){const h=d[0];h.preserveDrawingBuffer||(h.preserveDrawingBuffer=!0)}else d.splice(0,1,{preserveDrawingBuffer:!0})}return s.apply(this,[c,...d])}});i.push(a)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{i.forEach(a=>a())}}function Jh(t,e,n,o,i,a,s){const c=[],d=Object.getOwnPropertyNames(t);for(const u of d)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(u))try{if(typeof t[u]!="function")continue;const h=ls(t,u,function(p){return function(...g){const m=p.apply(this,g);if(Km(m,s,this),"tagName"in this.canvas&&!_n(this.canvas,o,i,!0)){const v=Jm([...g],s,this),x={type:e,property:u,args:v};n(this.canvas,x)}return m}});c.push(h)}catch{const p=Ua(t,u,{set(g){n(this.canvas,{type:e,property:u,args:[g],setter:!0})}});c.push(p)}return c}function Y4(t,e,n,o,i){const a=[];return a.push(...Jh(e.WebGLRenderingContext.prototype,ei.WebGL,t,n,o,i,e)),typeof e.WebGL2RenderingContext<"u"&&a.push(...Jh(e.WebGL2RenderingContext.prototype,ei.WebGL2,t,n,o,i,e)),()=>{a.forEach(s=>s())}}class Q4{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(d,u)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(d)||this.pendingCanvasMutations.set(d,[]),this.pendingCanvasMutations.get(d).push(u)};const{sampling:n="all",win:o,blockClass:i,blockSelector:a,recordCanvas:s,dataURLOptions:c}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,s&&n==="all"&&this.initCanvasMutationObserver(o,i,a),s&&typeof n=="number"&&this.initCanvasFPSObserver(n,o,i,a,{dataURLOptions:c})}initCanvasFPSObserver(e,n,o,i,a){const s=Kh(n,o,i,!0),c=new Map,d=new W4;d.onmessage=v=>{const{id:x}=v.data;if(c.set(x,!1),!("base64"in v.data))return;const{base64:y,type:_,width:w,height:I}=v.data;this.mutationCb({id:x,type:ei["2D"],commands:[{property:"clearRect",args:[0,0,w,I]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:y}],type:_}]},0,0]}]})};const u=1e3/e;let h=0,p;const g=()=>{const v=[];return n.document.querySelectorAll("canvas").forEach(x=>{_n(x,o,i,!0)||v.push(x)}),v},m=v=>{if(h&&v-h<u){p=requestAnimationFrame(m);return}h=v,g().forEach(x=>U4(this,void 0,void 0,function*(){var y;const _=this.mirror.getId(x);if(c.get(_))return;if(c.set(_,!0),["webgl","webgl2"].includes(x.__context)){const I=x.getContext(x.__context);((y=I==null?void 0:I.getContextAttributes())===null||y===void 0?void 0:y.preserveDrawingBuffer)===!1&&I.clear(I.COLOR_BUFFER_BIT)}const w=yield createImageBitmap(x);d.postMessage({id:_,bitmap:w,width:x.width,height:x.height,dataURLOptions:a.dataURLOptions},[w])})),p=requestAnimationFrame(m)};p=requestAnimationFrame(m),this.resetObservers=()=>{s(),cancelAnimationFrame(p)}}initCanvasMutationObserver(e,n,o){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const i=Kh(e,n,o,!1),a=J4(this.processMutation.bind(this),e,n,o),s=Y4(this.processMutation.bind(this),e,n,o,this.mirror);this.resetObservers=()=>{i(),a(),s()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const e=n=>{this.rafStamps.latestId=n,requestAnimationFrame(e)};requestAnimationFrame(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((e,n)=>{const o=this.mirror.getId(n);this.flushPendingCanvasMutationFor(n,o)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(e,n){if(this.frozen||this.locked)return;const o=this.pendingCanvasMutations.get(e);if(!o||n===-1)return;const i=o.map(s=>z4(s,["type"])),{type:a}=o[0];this.mutationCb({id:n,type:a,commands:i}),this.pendingCanvasMutations.delete(e)}}class Z4{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame(()=>{this.clear(),this.loop&&this.periodicallyClear()})}inOtherBuffer(e,n){const o=this.nodeMap.get(e);return o&&Array.from(o).some(i=>i!==n)}add(e,n){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(n))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}class ek{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,n){if(!ji(e)||this.shadowDoms.has(e))return;this.shadowDoms.add(e);const o=Wm(Object.assign(Object.assign({},this.bypassOptions),{doc:n,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e);this.restoreHandlers.push(()=>o.disconnect()),this.restoreHandlers.push($m(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}))),setTimeout(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(Vm({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))},0)}observeAttachShadow(e){!e.contentWindow||!e.contentDocument||this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,n){const o=this;this.restoreHandlers.push(ls(e.prototype,"attachShadow",function(i){return function(a){const s=i.call(this,a);return this.shadowRoot&&Gm(this)&&o.addShadowRoot(this.shadowRoot,n),s}}))}reset(){this.restoreHandlers.forEach(e=>{try{e()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}class tk{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new w4,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,n){"_cssText"in n.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:n.id,attributes:n.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,n){if(e.length===0)return;const o={id:n,styleIds:[]},i=[];for(const a of e){let s;this.styleMirror.has(a)?s=this.styleMirror.getId(a):(s=this.styleMirror.add(a),i.push({styleId:s,rules:Array.from(a.rules||CSSRule,(c,d)=>({rule:jm(c),index:d}))})),o.styleIds.push(s)}i.length>0&&(o.styles=i),this.adoptedStyleSheetCb(o)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}function Ht(t){return Object.assign(Object.assign({},t),{timestamp:ia()})}let Ot,qs,_l,aa=!1;const lo=JE();function br(t={}){const{emit:e,checkoutEveryNms:n,checkoutEveryNth:o,blockClass:i="rr-block",blockSelector:a=null,ignoreClass:s="rr-ignore",ignoreSelector:c=null,maskTextClass:d="rr-mask",maskTextSelector:u=null,inlineStylesheet:h=!0,maskAllInputs:p,maskInputOptions:g,slimDOMOptions:m,maskInputFn:v,maskTextFn:x,hooks:y,packFn:_,sampling:w={},dataURLOptions:I={},mousemoveWait:R,recordDOM:S=!0,recordCanvas:E=!1,recordCrossOriginIframes:N=!1,recordAfter:k=t.recordAfter==="DOMContentLoaded"?t.recordAfter:"load",userTriggeredOnInput:A=!1,collectFonts:D=!1,inlineImages:O=!1,plugins:L,keepIframeSrcFn:P=()=>!1,ignoreCSSAttributes:G=new Set([]),errorHandler:B}=t;_4(B);const M=N?window.parent===window:!0;let z=!1;if(!M)try{window.parent.document&&(z=!1)}catch{z=!0}if(M&&!e)throw new Error("emit function is required");R!==void 0&&w.mousemove===void 0&&(w.mousemove=R),lo.reset();const F=p===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:g!==void 0?g:{password:!0},T=m===!0||m==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:m==="all",headMetaDescKeywords:m==="all"}:m||{};y4();let j,Z=0;const ee=K=>{for(const ae of L||[])ae.eventProcessor&&(K=ae.eventProcessor(K));return _&&!z&&(K=_(K)),K};Ot=(K,ae)=>{var ce;if(!((ce=ur[0])===null||ce===void 0)&&ce.isFrozen()&&K.type!==it.FullSnapshot&&!(K.type===it.IncrementalSnapshot&&K.data.source===rt.Mutation)&&ur.forEach(ve=>ve.unfreeze()),M)e==null||e(ee(K),ae);else if(z){const ve={type:"rrweb",event:ee(K),origin:window.location.origin,isCheckout:ae};window.parent.postMessage(ve,"*")}if(K.type===it.FullSnapshot)j=K,Z=0;else if(K.type===it.IncrementalSnapshot){if(K.data.source===rt.Mutation&&K.data.isAttachIframe)return;Z++;const ve=o&&Z>=o,se=n&&K.timestamp-j.timestamp>n;(ve||se)&&qs(!0)}};const te=K=>{Ot(Ht({type:it.IncrementalSnapshot,data:Object.assign({source:rt.Mutation},K)}))},$=K=>Ot(Ht({type:it.IncrementalSnapshot,data:Object.assign({source:rt.Scroll},K)})),X=K=>Ot(Ht({type:it.IncrementalSnapshot,data:Object.assign({source:rt.CanvasMutation},K)})),W=K=>Ot(Ht({type:it.IncrementalSnapshot,data:Object.assign({source:rt.AdoptedStyleSheet},K)})),Y=new tk({mutationCb:te,adoptedStyleSheetCb:W}),q=new S4({mirror:lo,mutationCb:te,stylesheetManager:Y,recordCrossOriginIframes:N,wrappedEmit:Ot});for(const K of L||[])K.getMirror&&K.getMirror({nodeMirror:lo,crossOriginIframeMirror:q.crossOriginIframeMirror,crossOriginIframeStyleMirror:q.crossOriginIframeStyleMirror});const V=new Z4;_l=new Q4({recordCanvas:E,mutationCb:X,win:window,blockClass:i,blockSelector:a,mirror:lo,sampling:w.canvas,dataURLOptions:I});const Q=new ek({mutationCb:te,scrollCb:$,bypassOptions:{blockClass:i,blockSelector:a,maskTextClass:d,maskTextSelector:u,inlineStylesheet:h,maskInputOptions:F,dataURLOptions:I,maskTextFn:x,maskInputFn:v,recordCanvas:E,inlineImages:O,sampling:w,slimDOMOptions:T,iframeManager:q,stylesheetManager:Y,canvasManager:_l,keepIframeSrcFn:P,processedNodeManager:V},mirror:lo});qs=(K=!1)=>{if(!S)return;Ot(Ht({type:it.Meta,data:{href:window.location.href,width:Sd(),height:Id()}}),K),Y.reset(),Q.init(),ur.forEach(ce=>ce.lock());const ae=x4(document,{mirror:lo,blockClass:i,blockSelector:a,maskTextClass:d,maskTextSelector:u,inlineStylesheet:h,maskAllInputs:F,maskTextFn:x,maskInputFn:v,slimDOM:T,dataURLOptions:I,recordCanvas:E,inlineImages:O,onSerialize:ce=>{Fm(ce,lo)&&q.addIframe(ce),zm(ce,lo)&&Y.trackLinkElement(ce),gc(ce)&&Q.addShadowRoot(ce.shadowRoot,document)},onIframeLoad:(ce,ve)=>{q.attachIframe(ce,ve),Q.observeAttachShadow(ce)},onStylesheetLoad:(ce,ve)=>{Y.attachLinkElement(ce,ve)},keepIframeSrcFn:P});if(!ae)return console.warn("Failed to snapshot the document");Ot(Ht({type:it.FullSnapshot,data:{node:ae,initialOffset:_d(window)}}),K),ur.forEach(ce=>ce.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&Y.adoptStyleSheets(document.adoptedStyleSheets,lo.getId(document))};try{const K=[],ae=ve=>{var se;return et(F4)({mutationCb:te,mousemoveCb:(H,me)=>Ot(Ht({type:it.IncrementalSnapshot,data:{source:me,positions:H}})),mouseInteractionCb:H=>Ot(Ht({type:it.IncrementalSnapshot,data:Object.assign({source:rt.MouseInteraction},H)})),scrollCb:$,viewportResizeCb:H=>Ot(Ht({type:it.IncrementalSnapshot,data:Object.assign({source:rt.ViewportResize},H)})),inputCb:H=>Ot(Ht({type:it.IncrementalSnapshot,data:Object.assign({source:rt.Input},H)})),mediaInteractionCb:H=>Ot(Ht({type:it.IncrementalSnapshot,data:Object.assign({source:rt.MediaInteraction},H)})),styleSheetRuleCb:H=>Ot(Ht({type:it.IncrementalSnapshot,data:Object.assign({source:rt.StyleSheetRule},H)})),styleDeclarationCb:H=>Ot(Ht({type:it.IncrementalSnapshot,data:Object.assign({source:rt.StyleDeclaration},H)})),canvasMutationCb:X,fontCb:H=>Ot(Ht({type:it.IncrementalSnapshot,data:Object.assign({source:rt.Font},H)})),selectionCb:H=>{Ot(Ht({type:it.IncrementalSnapshot,data:Object.assign({source:rt.Selection},H)}))},blockClass:i,ignoreClass:s,ignoreSelector:c,maskTextClass:d,maskTextSelector:u,maskInputOptions:F,inlineStylesheet:h,sampling:w,recordDOM:S,recordCanvas:E,inlineImages:O,userTriggeredOnInput:A,collectFonts:D,doc:ve,maskInputFn:v,maskTextFn:x,keepIframeSrcFn:P,blockSelector:a,slimDOMOptions:T,dataURLOptions:I,mirror:lo,iframeManager:q,stylesheetManager:Y,shadowDomManager:Q,processedNodeManager:V,canvasManager:_l,ignoreCSSAttributes:G,plugins:((se=L==null?void 0:L.filter(H=>H.observer))===null||se===void 0?void 0:se.map(H=>({observer:H.observer,options:H.options,callback:me=>Ot(Ht({type:it.Plugin,data:{plugin:H.name,payload:me}}))})))||[]},y)};q.addLoadListener(ve=>{try{K.push(ae(ve.contentDocument))}catch(se){console.warn(se)}});const ce=()=>{qs(),K.push(ae(document)),aa=!0};return document.readyState==="interactive"||document.readyState==="complete"?ce():(K.push(Cn("DOMContentLoaded",()=>{Ot(Ht({type:it.DomContentLoaded,data:{}})),k==="DOMContentLoaded"&&ce()})),K.push(Cn("load",()=>{Ot(Ht({type:it.Load,data:{}})),k==="load"&&ce()},window))),()=>{K.forEach(ve=>ve()),V.destroy(),aa=!1,I4()}}catch(K){console.warn(K)}}br.addCustomEvent=(t,e)=>{if(!aa)throw new Error("please add custom event after start recording");Ot(Ht({type:it.Custom,data:{tag:t,payload:e}}))};br.freezePage=()=>{ur.forEach(t=>t.freeze())};br.takeFullSnapshot=t=>{if(!aa)throw new Error("please take full snapshot after start recording");qs(t)};br.mirror=lo;var Qn=Uint8Array,Sn=Uint16Array,$i=Uint32Array,Rd=new Qn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Td=new Qn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Xh=new Qn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ym=function(t,e){for(var n=new Sn(31),o=0;o<31;++o)n[o]=e+=1<<t[o-1];for(var i=new $i(n[30]),o=1;o<30;++o)for(var a=n[o];a<n[o+1];++a)i[a]=a-n[o]<<5|o;return[n,i]},Qm=Ym(Rd,2),nk=Qm[0],xc=Qm[1];nk[28]=258,xc[258]=28;var ok=Ym(Td,0),Yh=ok[1],vc=new Sn(32768);for(var _t=0;_t<32768;++_t){var Ho=(_t&43690)>>>1|(_t&21845)<<1;Ho=(Ho&52428)>>>2|(Ho&13107)<<2,Ho=(Ho&61680)>>>4|(Ho&3855)<<4,vc[_t]=((Ho&65280)>>>8|(Ho&255)<<8)>>>1}var Mi=function(t,e,n){for(var o=t.length,i=0,a=new Sn(e);i<o;++i)++a[t[i]-1];var s=new Sn(e);for(i=0;i<e;++i)s[i]=s[i-1]+a[i-1]<<1;var c;if(n){c=new Sn(1<<e);var d=15-e;for(i=0;i<o;++i)if(t[i])for(var u=i<<4|t[i],h=e-t[i],p=s[t[i]-1]++<<h,g=p|(1<<h)-1;p<=g;++p)c[vc[p]>>>d]=u}else for(c=new Sn(o),i=0;i<o;++i)c[i]=vc[s[t[i]-1]++]>>>15-t[i];return c},Cr=new Qn(288);for(var _t=0;_t<144;++_t)Cr[_t]=8;for(var _t=144;_t<256;++_t)Cr[_t]=9;for(var _t=256;_t<280;++_t)Cr[_t]=7;for(var _t=280;_t<288;++_t)Cr[_t]=8;var la=new Qn(32);for(var _t=0;_t<32;++_t)la[_t]=5;var rk=Mi(Cr,9,0),ik=Mi(la,5,0),Zm=function(t){return(t/8>>0)+(t&7&&1)},e0=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var o=new(t instanceof Sn?Sn:t instanceof $i?$i:Qn)(n-e);return o.set(t.subarray(e,n)),o},ko=function(t,e,n){n<<=e&7;var o=e/8>>0;t[o]|=n,t[o+1]|=n>>>8},gi=function(t,e,n){n<<=e&7;var o=e/8>>0;t[o]|=n,t[o+1]|=n>>>8,t[o+2]|=n>>>16},Il=function(t,e){for(var n=[],o=0;o<t.length;++o)t[o]&&n.push({s:o,f:t[o]});var i=n.length,a=n.slice();if(!i)return[new Qn(0),0];if(i==1){var s=new Qn(n[0].s+1);return s[n[0].s]=1,[s,1]}n.sort(function(S,E){return S.f-E.f}),n.push({s:-1,f:25001});var c=n[0],d=n[1],u=0,h=1,p=2;for(n[0]={s:-1,f:c.f+d.f,l:c,r:d};h!=i-1;)c=n[n[u].f<n[p].f?u++:p++],d=n[u!=h&&n[u].f<n[p].f?u++:p++],n[h++]={s:-1,f:c.f+d.f,l:c,r:d};for(var g=a[0].s,o=1;o<i;++o)a[o].s>g&&(g=a[o].s);var m=new Sn(g+1),v=yc(n[h-1],m,0);if(v>e){var o=0,x=0,y=v-e,_=1<<y;for(a.sort(function(E,N){return m[N.s]-m[E.s]||E.f-N.f});o<i;++o){var w=a[o].s;if(m[w]>e)x+=_-(1<<v-m[w]),m[w]=e;else break}for(x>>>=y;x>0;){var I=a[o].s;m[I]<e?x-=1<<e-m[I]++-1:++o}for(;o>=0&&x;--o){var R=a[o].s;m[R]==e&&(--m[R],++x)}v=e}return[new Qn(m),v]},yc=function(t,e,n){return t.s==-1?Math.max(yc(t.l,e,n+1),yc(t.r,e,n+1)):e[t.s]=n},Qh=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Sn(++e),o=0,i=t[0],a=1,s=function(d){n[o++]=d},c=1;c<=e;++c)if(t[c]==i&&c!=e)++a;else{if(!i&&a>2){for(;a>138;a-=138)s(32754);a>2&&(s(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(s(i),--a;a>6;a-=6)s(8304);a>2&&(s(a-3<<5|8208),a=0)}for(;a--;)s(i);a=1,i=t[c]}return[n.subarray(0,o),e]},mi=function(t,e){for(var n=0,o=0;o<e.length;++o)n+=t[o]*e[o];return n},wc=function(t,e,n){var o=n.length,i=Zm(e+2);t[i]=o&255,t[i+1]=o>>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<o;++a)t[i+a+4]=n[a];return(i+4+o)*8},Zh=function(t,e,n,o,i,a,s,c,d,u,h){ko(e,h++,n),++i[256];for(var p=Il(i,15),g=p[0],m=p[1],v=Il(a,15),x=v[0],y=v[1],_=Qh(g),w=_[0],I=_[1],R=Qh(x),S=R[0],E=R[1],N=new Sn(19),k=0;k<w.length;++k)N[w[k]&31]++;for(var k=0;k<S.length;++k)N[S[k]&31]++;for(var A=Il(N,7),D=A[0],O=A[1],L=19;L>4&&!D[Xh[L-1]];--L);var P=u+5<<3,G=mi(i,Cr)+mi(a,la)+s,B=mi(i,g)+mi(a,x)+s+14+3*L+mi(N,D)+(2*N[16]+3*N[17]+7*N[18]);if(P<=G&&P<=B)return wc(e,h,t.subarray(d,d+u));var M,z,F,T;if(ko(e,h,1+(B<G)),h+=2,B<G){M=Mi(g,m,0),z=g,F=Mi(x,y,0),T=x;var j=Mi(D,O,0);ko(e,h,I-257),ko(e,h+5,E-1),ko(e,h+10,L-4),h+=14;for(var k=0;k<L;++k)ko(e,h+3*k,D[Xh[k]]);h+=3*L;for(var Z=[w,S],ee=0;ee<2;++ee)for(var te=Z[ee],k=0;k<te.length;++k){var $=te[k]&31;ko(e,h,j[$]),h+=D[$],$>15&&(ko(e,h,te[k]>>>5&127),h+=te[k]>>>12)}}else M=rk,z=Cr,F=ik,T=la;for(var k=0;k<c;++k)if(o[k]>255){var $=o[k]>>>18&31;gi(e,h,M[$+257]),h+=z[$+257],$>7&&(ko(e,h,o[k]>>>23&31),h+=Rd[$]);var X=o[k]&31;gi(e,h,F[X]),h+=T[X],X>3&&(gi(e,h,o[k]>>>5&8191),h+=Td[X])}else gi(e,h,M[o[k]]),h+=z[o[k]];return gi(e,h,M[256]),h+z[256]},sk=new $i([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ak=function(t,e,n,o,i,a){var s=t.length,c=new Qn(o+s+5*(1+Math.floor(s/7e3))+i),d=c.subarray(o,c.length-i),u=0;if(!e||s<8)for(var h=0;h<=s;h+=65535){var p=h+65535;p<s?u=wc(d,u,t.subarray(h,p)):(d[h]=a,u=wc(d,u,t.subarray(h,s)))}else{for(var g=sk[e-1],m=g>>>13,v=g&8191,x=(1<<n)-1,y=new Sn(32768),_=new Sn(x+1),w=Math.ceil(n/3),I=2*w,R=function(ve){return(t[ve]^t[ve+1]<<w^t[ve+2]<<I)&x},S=new $i(25e3),E=new Sn(288),N=new Sn(32),k=0,A=0,h=0,D=0,O=0,L=0;h<s;++h){var P=R(h),G=h&32767,B=_[P];if(y[G]=B,_[P]=G,O<=h){var M=s-h;if((k>7e3||D>24576)&&M>423){u=Zh(t,d,0,S,E,N,A,D,L,h-L,u),D=k=A=0,L=h;for(var z=0;z<286;++z)E[z]=0;for(var z=0;z<30;++z)N[z]=0}var F=2,T=0,j=v,Z=G-B&32767;if(M>2&&P==R(h-Z))for(var ee=Math.min(m,M)-1,te=Math.min(32767,h),$=Math.min(258,M);Z<=te&&--j&&G!=B;){if(t[h+F]==t[h+F-Z]){for(var X=0;X<$&&t[h+X]==t[h+X-Z];++X);if(X>F){if(F=X,T=Z,X>ee)break;for(var W=Math.min(Z,X-2),Y=0,z=0;z<W;++z){var q=h-Z+z+32768&32767,V=y[q],Q=q-V+32768&32767;Q>Y&&(Y=Q,B=q)}}}G=B,B=y[G],Z+=G-B+32768&32767}if(T){S[D++]=268435456|xc[F]<<18|Yh[T];var K=xc[F]&31,ae=Yh[T]&31;A+=Rd[K]+Td[ae],++E[257+K],++N[ae],O=h+F,++k}else S[D++]=t[h],++E[t[h]]}}u=Zh(t,d,a,S,E,N,A,D,L,h-L,u)}return e0(c,0,o+Zm(u)+i)},lk=function(){var t=1,e=0;return{p:function(n){for(var o=t,i=e,a=n.length,s=0;s!=a;){for(var c=Math.min(s+5552,a);s<c;++s)o+=n[s],i+=o;o%=65521,i%=65521}t=o,e=i},d:function(){return(t>>>8<<16|(e&255)<<8|e>>>8)+((t&255)<<23)*2}}},ck=function(t,e,n,o,i){return ak(t,e.level==null?6:e.level,e.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):12+e.mem,n,o,!i)},dk=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},uk=function(t,e){var n=e.level,o=n==0?0:n<6?1:n==9?3:2;t[0]=120,t[1]=o<<6|(o?32-2*o:1)};function hk(t,e){e===void 0&&(e={});var n=lk();n.p(t);var o=ck(t,e,2,4);return uk(o,e),dk(o,o.length-4,n.d()),o}function pk(t,e){var n=t.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(t);for(var o=new Qn(t.length+(t.length>>>1)),i=0,a=function(u){o[i++]=u},s=0;s<n;++s){if(i+5>o.length){var c=new Qn(i+8+(n-s<<1));c.set(o),o=c}var d=t.charCodeAt(s);d<128||e?a(d):d<2048?(a(192|d>>>6),a(128|d&63)):d>55295&&d<57344?(d=65536+(d&1047552)|t.charCodeAt(++s)&1023,a(240|d>>>18),a(128|d>>>12&63),a(128|d>>>6&63),a(128|d&63)):(a(224|d>>>12),a(128|d>>>6&63),a(128|d&63))}return e0(o,0,i)}function fk(t,e){for(var n="",o=0;o<t.length;){var i=t[o++];i<128||e?n+=String.fromCharCode(i):i<224?n+=String.fromCharCode((i&31)<<6|t[o++]&63):i<240?n+=String.fromCharCode((i&15)<<12|(t[o++]&63)<<6|t[o++]&63):(i=((i&15)<<18|(t[o++]&63)<<12|(t[o++]&63)<<6|t[o++]&63)-65536,n+=String.fromCharCode(55296|i>>10,56320|i&1023))}return n}const gk="v1",mk=t=>{const e=Object.assign(Object.assign({},t),{v:gk});return fk(hk(pk(JSON.stringify(e))),!0)};var bc="medium",ep;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(ep||(ep={}));function xk(t){return t.toLowerCase()}function vk(t){const e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?xk(e):null}var t0=function(t,e,n){switch(e){case"light":{if(t!=="input")return!0;var o=n?vk(n):"";return o?!!(["password","hidden","email","tel"].includes(o)||n.autocomplete.startsWith("cc-")):!1}case"medium":case"conservative":return!0;default:return t0(t,bc,n)}},yk=function(t,e,n){var o,i,a;if(e===void 0&&(e={defaultMaskLevel:bc}),n){if(n.closest("."+Em))return!0;var s=((o=e.maskSelector)!==null&&o!==void 0?o:[]).some(function(d){return n.closest(d)});if(s)return!0;if(n.closest("."+ME))return!1;var c=((i=e.unmaskSelector)!==null&&i!==void 0?i:[]).some(function(d){return n.closest(d)});if(c)return!1}return t0(t,(a=e.defaultMaskLevel)!==null&&a!==void 0?a:bc,n)},tp=function(t,e){return function(n,o){return yk(t,e,o)?n.replace(/[^\s]/g,"*"):n}},n0=function(t){var e=0;if(t.length===0)return e;for(var n=0;n<t.length;n++){var o=t.charCodeAt(n);e=(e<<5)-e+o,e|=0}return e},wk=function(t,e){var n=n0(t.toString()),o=Math.abs(n),i=o*31,a=i%1e6;return a/1e6<e},bk=function(){var t=_o();return t!=null&&t.location?t.location.href:""},Ck=function(t,e){return"".concat(e,"/").concat(t)},o0=function(t){return t===Wl.STAGING?LE:t===Wl.EU?BE:OE},r0=function(){return Qe(void 0,void 0,void 0,function(){var t,e,n,o,i,a,s;return Je(this,function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),t=_o(),t?[4,t.navigator.storage.estimate()]:[3,2];case 1:return e=c.sent(),n=e.usage,o=e.quota,i=e.usageDetails,a=n?Math.round(n/km):0,s=n&&o?Math.round((n/o+Number.EPSILON)*1e3)/1e3:0,[2,{totalStorageSize:a,percentOfQuota:s,usageDetails:JSON.stringify(i)}];case 2:return[3,4];case 3:return c.sent(),[3,4];case 4:return[2,{totalStorageSize:0,percentOfQuota:0,usageDetails:""}]}})})},i0=function(t){var e=xt({},t),n=e.apiKey;return e.apiKey="****".concat(n.substring(n.length-4)),e},_k=function(t,e){var n=document.createDocumentFragment(),o=function(i){if(i===void 0&&(i=[]),typeof i=="string"&&(i=[i]),i=i.filter(function(a){try{n.querySelector(a)}catch{return e.warn('[session-replay-browser] omitting selector "'.concat(a,'" because it is invalid')),!1}return!0}),i.length!==0)return i};return t.blockSelector=o(t.blockSelector),t.maskSelector=o(t.maskSelector),t.unmaskSelector=o(t.unmaskSelector),t},Ik=function(){function t(e,n){this.localConfig=n,this.remoteConfigFetch=e}return t.prototype.generateJoinedConfig=function(e){var n,o,i;return Qe(this,void 0,void 0,function(){var a,s,c,d,u,h,p,g,m,v,x,y,_,w,I,R,S,E,N,k;return Je(this,function(A){switch(A.label){case 0:a=xt({},this.localConfig),a.optOut=this.localConfig.optOut,a.captureEnabled=!0,A.label=1;case 1:return A.trys.push([1,5,,6]),[4,this.remoteConfigFetch.getRemoteConfig("sessionReplay","sr_sampling_config",e)];case 2:return c=A.sent(),[4,this.remoteConfigFetch.getRemoteConfig("sessionReplay","sr_privacy_config",e)];case 3:return d=A.sent(),u=a,[4,this.remoteConfigFetch.getRemoteConfig("sessionReplay","sr_interaction_config",e)];case 4:return u.interactionConfig=A.sent(),(c||d)&&(s={},c&&(s.sr_sampling_config=c),d&&(s.sr_privacy_config=d)),[3,6];case 5:return h=A.sent(),p=h,this.localConfig.loggerProvider.warn(p.message),a.captureEnabled=!1,[3,6];case 6:if(!s)return[2,a];if(g=s.sr_sampling_config,m=s.sr_privacy_config,g&&Object.keys(g).length>0?(Object.prototype.hasOwnProperty.call(g,"capture_enabled")?a.captureEnabled=g.capture_enabled:a.captureEnabled=!1,Object.prototype.hasOwnProperty.call(g,"sample_rate")&&(a.sampleRate=g.sample_rate)):(a.captureEnabled=!0,this.localConfig.loggerProvider.debug("Remote config successfully fetched, but no values set for project, Session Replay capture enabled.")),m){v=(n=a.privacyConfig)!==null&&n!==void 0?n:{},x={defaultMaskLevel:(i=(o=m.defaultMaskLevel)!==null&&o!==void 0?o:v.defaultMaskLevel)!==null&&i!==void 0?i:"medium",blockSelector:[],maskSelector:[],unmaskSelector:[]},y=function(D){var O,L,P,G,B,M,z,F,T,j={};typeof D.blockSelector=="string"&&(D.blockSelector=[D.blockSelector]);try{for(var Z=yo((z=D.blockSelector)!==null&&z!==void 0?z:[]),ee=Z.next();!ee.done;ee=Z.next()){var te=ee.value;j[te]="block"}}catch(q){O={error:q}}finally{try{ee&&!ee.done&&(L=Z.return)&&L.call(Z)}finally{if(O)throw O.error}}try{for(var $=yo((F=D.maskSelector)!==null&&F!==void 0?F:[]),X=$.next();!X.done;X=$.next()){var te=X.value;j[te]="mask"}}catch(q){P={error:q}}finally{try{X&&!X.done&&(G=$.return)&&G.call($)}finally{if(P)throw P.error}}try{for(var W=yo((T=D.unmaskSelector)!==null&&T!==void 0?T:[]),Y=W.next();!Y.done;Y=W.next()){var te=Y.value;j[te]="unmask"}}catch(q){B={error:q}}finally{try{Y&&!Y.done&&(M=W.return)&&M.call(W)}finally{if(B)throw B.error}}return j},_=xt(xt({},y(v)),y(m));try{for(w=yo(Object.entries(_)),I=w.next();!I.done;I=w.next())R=Bo(I.value,2),S=R[0],E=R[1],E==="mask"?x.maskSelector.push(S):E==="block"?x.blockSelector.push(S):E==="unmask"&&x.unmaskSelector.push(S)}catch(D){N={error:D}}finally{try{I&&!I.done&&(k=w.return)&&k.call(w)}finally{if(N)throw N.error}}a.privacyConfig=_k(x,this.localConfig.loggerProvider)}return this.localConfig.loggerProvider.debug(JSON.stringify({name:"session replay joined config",config:i0(a)},null,2)),[2,a]}})})},t}(),Sk=function(t,e){return Qe(void 0,void 0,void 0,function(){var n,o;return Je(this,function(i){switch(i.label){case 0:return n=new GE(t,e),[4,Pv({localConfig:n,configKeys:["sessionReplay"]})];case 1:return o=i.sent(),[2,new Ik(o,n)]}})})},Rk="Unexpected error occurred",Tk="Network error occurred, event batch rejected",Ek="Session replay event batch rejected due to exceeded retry count",Pr="Failed to store session replay events in IndexedDB",kk="Session replay event batch not sent due to missing device ID",Ak="Session replay event batch not sent due to missing api key",s0="1.15.0",jk=function(){function t(e){var n=e.loggerProvider,o=e.payloadBatcher;this.storageKey="",this.retryTimeout=1e3,this.scheduled=null,this.queue=[],this.loggerProvider=n,this.payloadBatcher=o||function(i){return i}}return t.prototype.sendEventsList=function(e){this.addToQueue(xt(xt({},e),{attempts:0,timeout:0}))},t.prototype.addToQueue=function(){for(var e=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var i=n.filter(function(a){return a.attempts<(a.flushMaxRetries||0)?(a.attempts+=1,!0):(e.completeRequest({context:a,err:Ek}),!1)});i.forEach(function(a){if(e.queue=e.queue.concat(a),a.timeout===0){e.schedule(0);return}setTimeout(function(){a.timeout=0,e.schedule(0)},a.timeout)})},t.prototype.schedule=function(e){var n=this;this.scheduled||(this.scheduled=setTimeout(function(){n.flush(!0).then(function(){n.queue.length>0&&n.schedule(e)})},e))},t.prototype.flush=function(e){return e===void 0&&(e=!1),Qe(this,void 0,void 0,function(){var n,o,i=this;return Je(this,function(a){switch(a.label){case 0:return n=[],o=[],this.queue.forEach(function(s){return s.timeout===0?n.push(s):o.push(s)}),this.queue=o,this.scheduled&&(clearTimeout(this.scheduled),this.scheduled=null),[4,Promise.all(n.map(function(s){return i.send(s,e)}))];case 1:return a.sent(),[2]}})})},t.prototype.send=function(e,n){var o,i;return n===void 0&&(n=!0),Qe(this,void 0,void 0,function(){var a,s,c,d,u,h,p,g,m,v,x,y,_;return Je(this,function(w){switch(w.label){case 0:if(a=e.apiKey,!a)return[2,this.completeRequest({context:e,err:Ak})];if(s=e.deviceId,!s)return[2,this.completeRequest({context:e,err:kk})];if(c=bk(),d=s0,u=e.sampleRate,h=new URLSearchParams({device_id:s,session_id:"".concat(e.sessionId),type:"".concat(e.type)}),p="".concat(((o=e.version)===null||o===void 0?void 0:o.type)||"standalone","/").concat(((i=e.version)===null||i===void 0?void 0:i.version)||d),g=this.payloadBatcher({version:1,events:e.events}),g.events.length===0)return this.completeRequest({context:e}),[2];w.label=1;case 1:return w.trys.push([1,3,,4]),m={headers:{"Content-Type":"application/json",Accept:"*/*",Authorization:"Bearer ".concat(a),"X-Client-Version":d,"X-Client-Library":p,"X-Client-Url":c,"X-Client-Sample-Rate":"".concat(u)},body:JSON.stringify(g),method:"POST"},v="".concat(o0(e.serverZone),"?").concat(h.toString()),[4,fetch(v,m)];case 2:if(x=w.sent(),x===null)return this.completeRequest({context:e,err:Rk}),[2];if(n)this.handleReponse(x.status,e);else{y="";try{y=JSON.stringify(x.body,null,2)}catch{}this.completeRequest({context:e,success:"".concat(x.status,": ").concat(y)})}return[3,4];case 3:return _=w.sent(),this.completeRequest({context:e,err:_}),[3,4];case 4:return[2]}})})},t.prototype.handleReponse=function(e,n){var o=new Mv().buildStatus(e);switch(o){case Ou.Success:this.handleSuccessResponse(n);break;case Ou.Failed:this.handleOtherResponse(n);break;default:this.completeRequest({context:n,err:Tk})}},t.prototype.handleSuccessResponse=function(e){var n=Math.round(new Blob(e.events).size/km);this.completeRequest({context:e,success:"Session replay event batch tracked successfully for session id ".concat(e.sessionId,", size of events: ").concat(n," KB")})},t.prototype.handleOtherResponse=function(e){this.addToQueue(xt(xt({},e),{timeout:e.attempts*this.retryTimeout}))},t.prototype.completeRequest=function(e){var n=e.context,o=e.err,i=e.success;n.onComplete(),o?this.loggerProvider.warn(o):i&&this.loggerProvider.log(i)},t}();const Cc=(t,e)=>e.some(n=>t instanceof n);let np,op;function Pk(){return np||(np=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Mk(){return op||(op=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const _c=new WeakMap,Sl=new WeakMap,Ga=new WeakMap;function Ok(t){const e=new Promise((n,o)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",s)},a=()=>{n(mr(t.result)),i()},s=()=>{o(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",s)});return Ga.set(e,t),e}function Bk(t){if(_c.has(t))return;const e=new Promise((n,o)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",s),t.removeEventListener("abort",s)},a=()=>{n(),i()},s=()=>{o(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",s),t.addEventListener("abort",s)});_c.set(t,e)}let Ic={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return _c.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return mr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function a0(t){Ic=t(Ic)}function Lk(t){return Mk().includes(t)?function(...e){return t.apply(Sc(this),e),mr(this.request)}:function(...e){return mr(t.apply(Sc(this),e))}}function Nk(t){return typeof t=="function"?Lk(t):(t instanceof IDBTransaction&&Bk(t),Cc(t,Pk())?new Proxy(t,Ic):t)}function mr(t){if(t instanceof IDBRequest)return Ok(t);if(Sl.has(t))return Sl.get(t);const e=Nk(t);return e!==t&&(Sl.set(t,e),Ga.set(e,t)),e}const Sc=t=>Ga.get(t);function Dk(t,e,{blocked:n,upgrade:o,blocking:i,terminated:a}={}){const s=indexedDB.open(t,e),c=mr(s);return o&&s.addEventListener("upgradeneeded",d=>{o(mr(s.result),d.oldVersion,d.newVersion,mr(s.transaction),d)}),n&&s.addEventListener("blocked",d=>n(d.oldVersion,d.newVersion,d)),c.then(d=>{a&&d.addEventListener("close",()=>a()),i&&d.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),c}const Fk=["get","getKey","getAll","getAllKeys","count"],zk=["put","add","delete","clear"],Rl=new Map;function rp(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Rl.get(e))return Rl.get(e);const n=e.replace(/FromIndex$/,""),o=e!==n,i=zk.includes(n);if(!(n in(o?IDBIndex:IDBObjectStore).prototype)||!(i||Fk.includes(n)))return;const a=async function(s,...c){const d=this.transaction(s,i?"readwrite":"readonly");let u=d.store;return o&&(u=u.index(c.shift())),(await Promise.all([u[n](...c),i&&d.done]))[0]};return Rl.set(e,a),a}a0(t=>({...t,get:(e,n,o)=>rp(e,n)||t.get(e,n,o),has:(e,n)=>!!rp(e,n)||t.has(e,n)}));const Uk=["continue","continuePrimaryKey","advance"],ip={},Rc=new WeakMap,l0=new WeakMap,Gk={get(t,e){if(!Uk.includes(e))return t[e];let n=ip[e];return n||(n=ip[e]=function(...o){Rc.set(this,l0.get(this)[e](...o))}),n}};async function*Hk(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const n=new Proxy(e,Gk);for(l0.set(n,e),Ga.set(n,Sc(e));e;)yield n,e=await(Rc.get(n)||e.continue()),Rc.delete(n)}function sp(t,e){return e===Symbol.asyncIterator&&Cc(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&Cc(t,[IDBIndex,IDBObjectStore])}a0(t=>({...t,get(e,n,o){return sp(e,n)?Hk:t.get(e,n,o)},has(e,n){return sp(e,n)||t.has(e,n)}}));var c0=function(){function t(e){var n=this,o,i,a;this.minInterval=zE,this.maxInterval=UE,this.maxPersistedEventsSize=NE,this.interval=this.minInterval,this._timeAtLastSplit=Date.now(),this.shouldSplitEventsList=function(s,c){var d=new Blob([c]).size,u=new Blob(s).size;return u+d>=n.maxPersistedEventsSize?!0:Date.now()-n.timeAtLastSplit>n.interval&&s.length?(n.interval=Math.min(n.maxInterval,n.interval+n.minInterval),n._timeAtLastSplit=Date.now(),!0):!1},this.loggerProvider=e.loggerProvider,this.minInterval=(o=e.minInterval)!==null&&o!==void 0?o:this.minInterval,this.maxInterval=(i=e.maxInterval)!==null&&i!==void 0?i:this.maxInterval,this.maxPersistedEventsSize=(a=e.maxPersistedEventsSize)!==null&&a!==void 0?a:this.maxPersistedEventsSize}return Object.defineProperty(t.prototype,"timeAtLastSplit",{get:function(){return this._timeAtLastSplit},enumerable:!1,configurable:!0}),t}(),ca;(function(t){t.RECORDING="recording",t.SENT="sent"})(ca||(ca={}));var Oi="sessionCurrentSequence",Bi="sequencesToSend",qk=function(){var t=_o();return new Promise(function(e,n){if(!t)return n(new Error("Global scope not found"));if(!t.indexedDB)return n(new Error("Session Replay: cannot find indexedDB"));try{var o=t.indexedDB.open("keyval-store");o.onupgradeneeded=function(){o.result.version===1&&(o.result.close(),o.transaction&&o.transaction.abort(),t.indexedDB.deleteDatabase("keyval-store"),e())},o.onsuccess=function(){e(o.result)}}catch(i){n(i)}})},ap=function(t){return Qe(void 0,void 0,void 0,function(){var e,n;return Je(this,function(o){switch(o.label){case 0:return t.length>0?(e=10,n=t.splice(0,e),[4,Promise.all(n)]):[3,2];case 1:return o.sent(),[3,0];case 2:return[2]}})})},Wk=function(t){var e,n;return t.objectStoreNames.contains(Oi)||(n=t.createObjectStore(Oi,{keyPath:"sessionId"})),t.objectStoreNames.contains(Bi)||(e=t.createObjectStore(Bi,{keyPath:"sequenceId",autoIncrement:!0}),e.createIndex("sessionId","sessionId")),{sequencesStore:e,currentSequenceStore:n}},$k=function(t){return Qe(void 0,void 0,void 0,function(){return Je(this,function(e){switch(e.label){case 0:return[4,Dk(t,1,{upgrade:Wk})];case 1:return[2,e.sent()]}})})},Vk=function(t){$c(e,t);function e(n){var o=t.call(this,n)||this;return o.getSequencesToSend=function(){return Qe(o,void 0,void 0,function(){var i,a,s,c,d,u;return Je(this,function(h){switch(h.label){case 0:return h.trys.push([0,5,,6]),i=[],[4,this.db.transaction("sequencesToSend").store.openCursor()];case 1:a=h.sent(),h.label=2;case 2:return a?(s=a.value,c=s.sessionId,d=s.events,i.push({events:d,sequenceId:a.key,sessionId:c}),[4,a.continue()]):[3,4];case 3:return a=h.sent(),[3,2];case 4:return[2,i];case 5:return u=h.sent(),this.loggerProvider.warn("".concat(Pr,": ").concat(u)),[3,6];case 6:return[2,void 0]}})})},o.storeCurrentSequence=function(i){return Qe(o,void 0,void 0,function(){var a,s,c;return Je(this,function(d){switch(d.label){case 0:return d.trys.push([0,4,,5]),[4,this.db.get(Oi,i)];case 1:return a=d.sent(),a?[4,this.db.put(Bi,{sessionId:i,events:a.events})]:[2,void 0];case 2:return s=d.sent(),[4,this.db.put(Oi,{sessionId:i,events:[]})];case 3:return d.sent(),[2,xt(xt({},a),{sessionId:i,sequenceId:s})];case 4:return c=d.sent(),this.loggerProvider.warn("".concat(Pr,": ").concat(c)),[3,5];case 5:return[2,void 0]}})})},o.addEventToCurrentSequence=function(i,a){return Qe(o,void 0,void 0,function(){var s,c,d,u,h,p;return Je(this,function(g){switch(g.label){case 0:return g.trys.push([0,10,,11]),s=this.db.transaction(Oi,"readwrite"),[4,s.store.get(i)];case 1:return c=g.sent(),c?[3,3]:[4,s.store.put({sessionId:i,events:[a]})];case 2:return g.sent(),[2];case 3:return d=void 0,this.shouldSplitEventsList(c.events,a)?(d=c.events,[4,s.store.put({sessionId:i,events:[a]})]):[3,5];case 4:return g.sent(),[3,7];case 5:return u=c.events.concat(a),[4,s.store.put({sessionId:i,events:u})];case 6:g.sent(),g.label=7;case 7:return[4,s.done];case 8:return g.sent(),d?[4,this.storeSendingEvents(i,d)]:[2,void 0];case 9:return h=g.sent(),h?[2,{events:d,sessionId:i,sequenceId:h}]:[2,void 0];case 10:return p=g.sent(),this.loggerProvider.warn("".concat(Pr,": ").concat(p)),[3,11];case 11:return[2,void 0]}})})},o.storeSendingEvents=function(i,a){return Qe(o,void 0,void 0,function(){var s,c;return Je(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,this.db.put(Bi,{sessionId:i,events:a})];case 1:return s=d.sent(),[2,s];case 2:return c=d.sent(),this.loggerProvider.warn("".concat(Pr,": ").concat(c)),[3,3];case 3:return[2,void 0]}})})},o.cleanUpSessionEventsStore=function(i,a){return Qe(o,void 0,void 0,function(){var s;return Je(this,function(c){switch(c.label){case 0:if(!a)return[2];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.db.delete(Bi,a)];case 2:return c.sent(),[3,4];case 3:return s=c.sent(),this.loggerProvider.warn("".concat(Pr,": ").concat(s)),[3,4];case 4:return[2]}})})},o.transitionFromKeyValStore=function(i){return Qe(o,void 0,void 0,function(){var a,s,c,d,u,h,p,g,m=this;return Je(this,function(v){switch(v.label){case 0:return v.trys.push([0,6,,7]),[4,qk()];case 1:if(a=v.sent(),!a)return[2];s=function(x,y){return Qe(m,void 0,void 0,function(){var _,w,I=this;return Je(this,function(R){switch(R.label){case 0:return _=y.sessionSequences,w=[],Object.keys(_).forEach(function(S){var E=parseInt(S,10),N=_[E];if(E===y.currentSequenceId){var k=N.events.map(function(A){return Qe(I,void 0,void 0,function(){return Je(this,function(D){return[2,this.addEventToCurrentSequence(x,A)]})})});w.concat(k)}else N.status!==ca.SENT&&w.push(I.storeSendingEvents(x,N.events))}),[4,ap(w)];case 1:return R.sent(),[2]}})})},c="".concat(Ov,"_").concat(this.apiKey.substring(0,10)),v.label=2;case 2:return v.trys.push([2,4,,5]),d=a.transaction("keyval").objectStore("keyval").getAll(c),u=new Promise(function(x){d.onsuccess=function(y){return Qe(m,void 0,void 0,function(){var _,w,I,R=this;return Je(this,function(S){switch(S.label){case 0:return _=y&&y.target.result,w=_&&_[0],w?(I=[],Object.keys(w).forEach(function(E){var N=parseInt(E,10),k=w[N];if(i===N)I.push(s(N,k));else{var A=k.sessionSequences;Object.keys(A).forEach(function(D){var O=parseInt(D,10);A[O].status!==ca.SENT&&I.push(R.storeSendingEvents(N,A[O].events))})}}),[4,ap(I)]):[3,2];case 1:S.sent(),S.label=2;case 2:return x(),[2]}})})}}),[4,u];case 3:return v.sent(),h=_o(),h&&h.indexedDB.deleteDatabase("keyval-store"),[3,5];case 4:return p=v.sent(),this.loggerProvider.warn("Failed to transition session replay events from keyval to new store: ".concat(p)),[3,5];case 5:return[3,7];case 6:return g=v.sent(),this.loggerProvider.warn("Failed to access keyval store: ".concat(g,". For more information, visit: https://www.docs.developers.amplitude.com/session-replay/sdks/standalone/#indexeddb-best-practices")),[3,7];case 7:return[2]}})})},o.apiKey=n.apiKey,o.db=n.db,o}return e.new=function(n,o,i){return Qe(this,void 0,void 0,function(){var a,s,c,d,u;return Je(this,function(h){switch(h.label){case 0:return h.trys.push([0,3,,4]),a=n==="replay"?"":"_".concat(n),s="".concat(o.apiKey.substring(0,10),"_amp_session_replay_events").concat(a),[4,$k(s)];case 1:return c=h.sent(),d=new e(xt(xt({},o),{db:c})),[4,d.transitionFromKeyValStore(i)];case 2:return h.sent(),[2,d];case 3:return u=h.sent(),o.loggerProvider.warn("".concat(Pr,": ").concat(u)),[3,4];case 4:return[2]}})})},e.prototype.getCurrentSequenceEvents=function(n){return Qe(this,void 0,void 0,function(){var s,o,i,a,s,c,d,u;return Je(this,function(h){switch(h.label){case 0:return n?[4,this.db.get("sessionCurrentSequence",n)]:[3,2];case 1:return s=h.sent(),s?[2,[s]]:[2,void 0];case 2:o=[],h.label=3;case 3:return h.trys.push([3,8,9,10]),[4,this.db.getAll("sessionCurrentSequence")];case 4:i=yo.apply(void 0,[h.sent()]),a=i.next(),h.label=5;case 5:if(a.done)return[3,7];s=a.value,o.push(s),h.label=6;case 6:return a=i.next(),[3,5];case 7:return[3,10];case 8:return c=h.sent(),d={error:c},[3,10];case 9:try{a&&!a.done&&(u=i.return)&&u.call(i)}finally{if(d)throw d.error}return[7];case 10:return[2,o]}})})},e}(c0),Kk=function(t){$c(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.finalizedSequences={},n.sequences={},n.sequenceId=0,n}return e.prototype.resetCurrentSequence=function(n){this.sequences[n]=[]},e.prototype.addSequence=function(n){var o=this.sequenceId++,i=Xr([],Bo(this.sequences[n]),!1);return this.finalizedSequences[o]={sessionId:n,events:i},this.resetCurrentSequence(n),{sequenceId:o,events:i,sessionId:n}},e.prototype.getSequencesToSend=function(){return Qe(this,void 0,void 0,function(){return Je(this,function(n){return[2,Object.entries(this.finalizedSequences).map(function(o){var i=Bo(o,2),a=i[0],s=i[1],c=s.sessionId,d=s.events;return{sequenceId:Number(a),sessionId:c,events:d}})]})})},e.prototype.storeCurrentSequence=function(n){return Qe(this,void 0,void 0,function(){return Je(this,function(o){return this.sequences[n]?[2,this.addSequence(n)]:[2,void 0]})})},e.prototype.addEventToCurrentSequence=function(n,o){return Qe(this,void 0,void 0,function(){var i;return Je(this,function(a){return this.sequences[n]||this.resetCurrentSequence(n),this.shouldSplitEventsList(this.sequences[n],o)&&(i=this.addSequence(n)),this.sequences[n].push(o),[2,i]})})},e.prototype.storeSendingEvents=function(n,o){return Qe(this,void 0,void 0,function(){return Je(this,function(i){return this.finalizedSequences[this.sequenceId]={sessionId:n,events:o},[2,this.sequenceId++]})})},e.prototype.cleanUpSessionEventsStore=function(n,o){return Qe(this,void 0,void 0,function(){return Je(this,function(i){return o!==void 0&&delete this.finalizedSequences[o],[2]})})},e}(c0),lp=function(t){var e=t.config,n=t.sessionId,o=t.minInterval,i=t.maxInterval,a=t.type,s=t.payloadBatcher,c=t.storeType;return Qe(void 0,void 0,void 0,function(){function d(w){return w===void 0&&(w=!1),Qe(this,void 0,void 0,function(){return Je(this,function(I){return[2,u.flush(w)]})})}var u,h,p,g,m,v,x,y,_;return Je(this,function(w){switch(w.label){case 0:return u=new jk({loggerProvider:e.loggerProvider,payloadBatcher:s}),h=function(){return new Kk({loggerProvider:e.loggerProvider,maxInterval:i,minInterval:o})},p=function(){return Qe(void 0,void 0,void 0,function(){var I;return Je(this,function(R){switch(R.label){case 0:return[4,Vk.new(a,{loggerProvider:e.loggerProvider,minInterval:o,maxInterval:i,apiKey:e.apiKey},n)];case 1:return I=R.sent(),e.loggerProvider.log("Failed to initialize idb store, falling back to memory store."),[2,I??h()]}})})},c!=="idb"?[3,2]:[4,p()];case 1:return m=w.sent(),[3,3];case 2:m=h(),w.label=3;case 3:return g=m,v=function(I){var R=I.events,S=I.sessionId,E=I.deviceId,N=I.sequenceId;e.debugMode&&r0().then(function(k){var A=k.totalStorageSize,D=k.percentOfQuota,O=k.usageDetails;e.loggerProvider.debug("Total storage size: ".concat(A," KB, percentage of quota: ").concat(D,"%, usage details: ").concat(O))}).catch(function(){}),u.sendEventsList({events:R,sessionId:S,flushMaxRetries:e.flushMaxRetries,apiKey:e.apiKey,deviceId:E,sampleRate:e.sampleRate,serverZone:e.serverZone,version:e.version,type:a,onComplete:function(){return Qe(void 0,void 0,void 0,function(){return Je(this,function(k){switch(k.label){case 0:return[4,g.cleanUpSessionEventsStore(S,N)];case 1:return k.sent(),[2]}})})}})},x=function(I){var R=I.sessionId,S=I.deviceId;g.storeCurrentSequence(R).then(function(E){E&&v({sequenceId:E.sequenceId,events:E.events,sessionId:E.sessionId,deviceId:S})}).catch(function(E){e.loggerProvider.warn("Failed to get current sequence of session replay events for session:",E)})},y=function(I){var R=I.deviceId;return Qe(void 0,void 0,void 0,function(){var S;return Je(this,function(E){switch(E.label){case 0:return[4,g.getSequencesToSend()];case 1:return S=E.sent(),S&&S.forEach(function(N){v({sequenceId:N.sequenceId,events:N.events,sessionId:N.sessionId,deviceId:R})}),[2]}})})},_=function(I){var R=I.event,S=I.sessionId,E=I.deviceId;g.addEventToCurrentSequence(S,R.data).then(function(N){return N&&v({sequenceId:N.sequenceId,events:N.events,sessionId:N.sessionId,deviceId:E})}).catch(function(N){e.loggerProvider.warn("Failed to add event to session replay capture:",N)})},[2,{sendCurrentSequenceEvents:x,addEvent:_,sendStoredEvents:y,flush:d}]}})})},cp=function(){function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=new Map;e.forEach(function(i){o.set(i.name,i.manager)}),this.managers=o}return t.prototype.sendStoredEvents=function(e){return Qe(this,void 0,void 0,function(){var n;return Je(this,function(o){switch(o.label){case 0:return n=[],this.managers.forEach(function(i){n.push(i.sendStoredEvents(e))}),[4,Promise.all(n)];case 1:return o.sent(),[2]}})})},t.prototype.addEvent=function(e){var n,o=e.sessionId,i=e.event,a=e.deviceId;(n=this.managers.get(i.type))===null||n===void 0||n.addEvent({sessionId:o,event:i,deviceId:a})},t.prototype.sendCurrentSequenceEvents=function(e){var n=e.sessionId,o=e.deviceId;this.managers.forEach(function(i){i.sendCurrentSequenceEvents({sessionId:n,deviceId:o})})},t.prototype.flush=function(e){return Qe(this,void 0,void 0,function(){var n;return Je(this,function(o){switch(o.label){case 0:return n=[],this.managers.forEach(function(i){n.push(i.flush(e))}),[4,Promise.all(n)];case 1:return o.sent(),[2]}})})},t}(),d0=(t=>(t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel",t))(d0||{}),Zn,Ed,u0;function Jk(t,e){if(u0=new Date,t.nodeType!==Node.ELEMENT_NODE)throw new Error("Can't generate CSS selector for non-element node type.");if(t.tagName.toLowerCase()==="html")return"html";var n={root:document.body,idName:function(a){return!0},className:function(a){return!0},tagName:function(a){return!0},attr:function(a,s){return!1},seedMinLength:1,optimizedMinLength:2,threshold:1e3,maxNumberOfTries:1e4,timeoutMs:void 0};Zn=xt(xt({},n),e),Ed=Xk(Zn.root,n);var o=Ss(t,"all",function(){return Ss(t,"two",function(){return Ss(t,"one",function(){return Ss(t,"none")})})});if(o){var i=f0(g0(o,t));return i.length>0&&(o=i[0]),Ha(o)}else throw new Error("Selector was not found.")}function Xk(t,e){return t.nodeType===Node.DOCUMENT_NODE?t:t===e.root?t.ownerDocument:t}function Ss(t,e,n){for(var o=null,i=[],a=t,s=0,c=function(){var u,h,p=new Date().getTime()-u0.getTime();if(Zn.timeoutMs!==void 0&&p>Zn.timeoutMs)throw new Error("Timeout: Can't find a unique selector after ".concat(p,"ms"));var g=Ts(Yk(a))||Ts.apply(void 0,Xr([],Bo(Qk(a)),!1))||Ts.apply(void 0,Xr([],Bo(Zk(a)),!1))||Ts(eA(a))||[hp()],m=tA(a);if(e=="all")m&&(g=g.concat(g.filter(Tl).map(function(w){return Rs(w,m)})));else if(e=="two")g=g.slice(0,1),m&&(g=g.concat(g.filter(Tl).map(function(w){return Rs(w,m)})));else if(e=="one"){var v=Bo(g=g.slice(0,1),1),x=v[0];m&&Tl(x)&&(g=[Rs(x,m)])}else e=="none"&&(g=[hp()],m&&(g=[Rs(g[0],m)]));try{for(var y=(u=void 0,yo(g)),_=y.next();!_.done;_=y.next()){var x=_.value;x.level=s}}catch(w){u={error:w}}finally{try{_&&!_.done&&(h=y.return)&&h.call(y)}finally{if(u)throw u.error}}if(i.push(g),i.length>=Zn.seedMinLength&&(o=dp(i,n),o))return"break";a=a.parentElement,s++};a;){var d=c();if(d==="break")break}return o||(o=dp(i,n)),!o&&n?n():o}function dp(t,e){var n,o,i=f0(p0(t));if(i.length>Zn.threshold)return e?e():null;try{for(var a=yo(i),s=a.next();!s.done;s=a.next()){var c=s.value;if(h0(c))return c}}catch(d){n={error:d}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return null}function Ha(t){for(var e=t[0],n=e.name,o=1;o<t.length;o++){var i=t[o].level||0;e.level===i-1?n="".concat(t[o].name," > ").concat(n):n="".concat(t[o].name," ").concat(n),e=t[o]}return n}function up(t){return t.map(function(e){return e.penalty}).reduce(function(e,n){return e+n},0)}function h0(t){var e=Ha(t);switch(Ed.querySelectorAll(e).length){case 0:throw new Error("Can't select any node with this selector: ".concat(e));case 1:return!0;default:return!1}}function Yk(t){var e=t.getAttribute("id");return e&&Zn.idName(e)?{name:"#"+CSS.escape(e),penalty:0}:null}function Qk(t){var e=Array.from(t.attributes).filter(function(n){return Zn.attr(n.name,n.value)});return e.map(function(n){return{name:"[".concat(CSS.escape(n.name),'="').concat(CSS.escape(n.value),'"]'),penalty:.5}})}function Zk(t){var e=Array.from(t.classList).filter(Zn.className);return e.map(function(n){return{name:"."+CSS.escape(n),penalty:1}})}function eA(t){var e=t.tagName.toLowerCase();return Zn.tagName(e)?{name:e,penalty:2}:null}function hp(){return{name:"*",penalty:3}}function tA(t){var e=t.parentNode;if(!e)return null;var n=e.firstChild;if(!n)return null;for(var o=0;n&&(n.nodeType===Node.ELEMENT_NODE&&o++,n!==t);)n=n.nextSibling;return o}function Rs(t,e){return{name:t.name+":nth-child(".concat(e,")"),penalty:t.penalty+1}}function Tl(t){return t.name!=="html"&&!t.name.startsWith("#")}function Ts(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.filter(nA);return n.length>0?n:null}function nA(t){return t!=null}function p0(t,e){var n,o,i,a,s,c;return e===void 0&&(e=[]),Je(this,function(d){switch(d.label){case 0:if(!(t.length>0))return[3,9];d.label=1;case 1:d.trys.push([1,6,7,8]),n=yo(t[0]),o=n.next(),d.label=2;case 2:return o.done?[3,5]:(i=o.value,[5,yo(p0(t.slice(1,t.length),e.concat(i)))]);case 3:d.sent(),d.label=4;case 4:return o=n.next(),[3,2];case 5:return[3,8];case 6:return a=d.sent(),s={error:a},[3,8];case 7:try{o&&!o.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 8:return[3,11];case 9:return[4,e];case 10:d.sent(),d.label=11;case 11:return[2]}})}function f0(t){return Xr([],Bo(t),!1).sort(function(e,n){return up(e)-up(n)})}function g0(t,e,n){var o,i,a;return n===void 0&&(n={counter:0,visited:new Map}),Je(this,function(s){switch(s.label){case 0:if(!(t.length>2&&t.length>Zn.optimizedMinLength))return[3,5];o=1,s.label=1;case 1:return o<t.length-1?n.counter>Zn.maxNumberOfTries?[2]:(n.counter+=1,i=Xr([],Bo(t),!1),i.splice(o,1),a=Ha(i),n.visited.has(a)?[2]:h0(i)&&oA(i,e)?[4,i]:[3,4]):[3,5];case 2:return s.sent(),n.visited.set(a,!0),[5,yo(g0(i,e,n))];case 3:s.sent(),s.label=4;case 4:return o++,[3,1];case 5:return[2]}})}function oA(t,e){return Ed.querySelector(Ha(t))===e}var rA=36e5,iA=function(t){var e=t.version,n=t.events,o=[];return n.forEach(function(i){var a=JSON.parse(i);a.count=1,a.type==="click"&&o.push(a)}),{version:e,events:o}},sA=function(t){var e=t.version,n=t.events,o=[];n.forEach(function(a){var s=JSON.parse(a);s.type==="click"&&o.push(s)});var i=o.reduce(function(a,s){var c=s.x,d=s.y,u=s.selector,h=s.timestamp,p=h-h%rA,g="".concat(c,":").concat(d,":").concat(u??"",":").concat(p);return a[g]?a[g].count+=1:a[g]=xt(xt({},s),{timestamp:p,count:1}),a},{});return{version:e,events:Object.values(i)}},aA=function(t){var e=t.eventsManager,n=t.sessionId,o=t.deviceIdFn;return function(i){if(i.type===d0.Click){var a=_o();if(a){var s=a.location,c=a.innerHeight,d=a.innerWidth;if(s){var u=i.x,h=i.y,p=br.mirror.getNode(i.id),g;p&&(g=Jk(p));var m=_d(a),v=m.left,x=m.top,y={x:u+v,y:h+x,selector:g,viewportHeight:c,viewportWidth:d,pageUrl:s.href,timestamp:Date.now(),type:"click"},_=o();_&&e.addEvent({sessionId:n,event:{type:"interaction",data:JSON.stringify(y)},deviceId:_})}}}}},lA=function(){function t(e,n){var o=_o();o&&o.navigator&&typeof o.navigator.sendBeacon=="function"?this.sendBeacon=function(i,a){try{if(o.navigator.sendBeacon(i,JSON.stringify(a)))return!0}catch{}return!1}:this.sendBeacon=function(){return!1},this.sendXhr=function(i,a){var s=new XMLHttpRequest;return s.open("POST",i,!0),s.setRequestHeader("Accept","*/*"),s.send(JSON.stringify(a)),!0},this.basePageUrl=o0(n.serverZone),this.apiKey=n.apiKey,this.context=e}return t.prototype.send=function(e,n){var o=this.context,i=o.sessionId,a=o.type,s=new URLSearchParams({device_id:e,session_id:String(i),type:String(a),api_key:this.apiKey}),c="".concat(this.basePageUrl,"?").concat(s.toString());this.sendBeacon(c,n)||this.sendXhr(c,n)},t}(),El=Id,kl=Sd,cA=function(){function t(e){var n=this;this.timestamp=Date.now(),this.hook=function(o){n.update(o)},this.send=function(o){return function(i){var a=o(),s=_o();s&&a&&n.transport.send(a,{version:1,events:[{maxScrollX:n._maxScrollX,maxScrollY:n._maxScrollY,maxScrollWidth:n._maxScrollWidth,maxScrollHeight:n._maxScrollHeight,viewportHeight:El(),viewportWidth:kl(),pageUrl:s.location.href,timestamp:n.timestamp,type:"scroll"}]})}},this._maxScrollX=0,this._maxScrollY=0,this._maxScrollWidth=kl(),this._maxScrollHeight=El(),this.transport=e}return t.default=function(e,n){return new t(new lA(e,n))},Object.defineProperty(t.prototype,"maxScrollX",{get:function(){return this._maxScrollX},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxScrollY",{get:function(){return this._maxScrollY},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxScrollWidth",{get:function(){return this._maxScrollWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxScrollHeight",{get:function(){return this._maxScrollHeight},enumerable:!1,configurable:!0}),t.prototype.update=function(e){var n=Date.now();if(e.x>this._maxScrollX){var o=kl();this._maxScrollX=e.x;var i=e.x+o;i>this._maxScrollWidth&&(this._maxScrollWidth=i),this.timestamp=n}if(e.y>this._maxScrollY){var a=El();this._maxScrollY=e.y;var s=e.y+a;s>this._maxScrollHeight&&(this._maxScrollHeight=s),this.timestamp=n}},t}(),pp=function(){function t(e){var n=e.sessionId,o=e.deviceId;this.deviceId=o,this.sessionId=n,n&&o&&(this.sessionReplayId=Ck(n,o))}return t}(),dA=2e3,uA=function(){function t(e,n,o){var i=this,a;this.taskQueue=[],this.isProcessing=!1,this.compressEvent=function(c){var d=mk(c);return JSON.stringify(d)},this.addCompressedEvent=function(c,d){var u=i.compressEvent(c);i.eventsManager&&i.deviceId&&i.eventsManager.addEvent({event:{type:"replay",data:u},sessionId:d,deviceId:i.deviceId})};var s=_o();this.canUseIdleCallback=s&&"requestIdleCallback"in s,this.eventsManager=e,this.config=n,this.deviceId=o,this.timeout=((a=n.performanceConfig)===null||a===void 0?void 0:a.timeout)||dA}return t.prototype.scheduleIdleProcessing=function(){var e=this;this.isProcessing||(this.isProcessing=!0,requestIdleCallback(function(n){e.processQueue(n)},{timeout:this.timeout}))},t.prototype.enqueueEvent=function(e,n){var o;this.canUseIdleCallback&&(!((o=this.config.performanceConfig)===null||o===void 0)&&o.enabled)?(this.config.loggerProvider.debug("Enqueuing event for processing during idle time."),this.taskQueue.push({event:e,sessionId:n}),this.scheduleIdleProcessing()):(this.config.loggerProvider.debug("Processing event without idle callback."),this.addCompressedEvent(e,n))},t.prototype.processQueue=function(e){for(var n=this;this.taskQueue.length>0&&(e.timeRemaining()>0||e.didTimeout);){var o=this.taskQueue.shift();if(o){var i=o.event,a=o.sessionId;this.addCompressedEvent(i,a)}}this.taskQueue.length>0?requestIdleCallback(function(s){n.processQueue(s)},{timeout:this.timeout}):this.isProcessing=!1},t}(),hA=function(){function t(){var e=this;this.name="@amplitude/session-replay-browser",this.recordCancelCallback=null,this.eventCount=0,this.pageLeaveFns=[],this.teardownEventListeners=function(n){var o=_o();o&&(o.removeEventListener("blur",e.blurListener),o.removeEventListener("focus",e.focusListener),!n&&o.addEventListener("blur",e.blurListener),!n&&o.addEventListener("focus",e.focusListener),o.self&&"onpagehide"in o.self?(o.removeEventListener("pagehide",e.pageLeaveListener),!n&&o.addEventListener("pagehide",e.pageLeaveListener)):(o.removeEventListener("beforeunload",e.pageLeaveListener),!n&&o.addEventListener("beforeunload",e.pageLeaveListener)))},this.blurListener=function(){e.sendEvents()},this.focusListener=function(){e.recordEvents()},this.pageLeaveListener=function(n){e.pageLeaveFns.forEach(function(o){o(n)})},this.addCustomRRWebEvent=function(n,o,i){return o===void 0&&(o={}),i===void 0&&(i=!0),Qe(e,void 0,void 0,function(){var a,s,c,d;return Je(this,function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),a=void 0,s=this.config,s?(a={config:i0(s),version:s0},i?[4,r0()]:[3,2]):[3,2];case 1:c=u.sent(),a=xt(xt({},c),a),u.label=2;case 2:return this.recordCancelCallback?br.addCustomEvent(n,xt(xt({},o),a)):this.loggerProvider.debug("Not able to add custom replay capture event ".concat(n," due to no ongoing recording.")),[3,4];case 3:return d=u.sent(),this.loggerProvider.debug("Error while adding custom replay capture event: ",d),[3,4];case 4:return[2]}})})},this.stopRecordingEvents=function(){try{e.loggerProvider.log("Session Replay capture stopping."),e.recordCancelCallback&&e.recordCancelCallback(),e.recordCancelCallback=null}catch(o){var n=o;e.loggerProvider.warn("Error occurred while stopping replay capture: ".concat(n.toString()))}},this.loggerProvider=new $l}return t.prototype.init=function(e,n){return Bu(this._init(e,n))},t.prototype._init=function(e,n){var o,i,a,s;return Qe(this,void 0,void 0,function(){var c,d,u,h,p,g,m,_,v,x,y,_;return Je(this,function(w){switch(w.label){case 0:return this.loggerProvider=n.loggerProvider||new $l,Object.prototype.hasOwnProperty.call(n,"logLevel")&&this.loggerProvider.enable(n.logLevel),this.identifiers=new pp({sessionId:n.sessionId,deviceId:n.deviceId}),c=this,[4,Sk(e,n)];case 1:return c.joinedConfigGenerator=w.sent(),d=this,[4,this.joinedConfigGenerator.generateJoinedConfig(this.identifiers.sessionId)];case 2:d.config=w.sent(),n.sessionId&&(!((o=this.config.interactionConfig)===null||o===void 0)&&o.enabled)&&(u=cA.default({sessionId:n.sessionId,type:"interaction"},this.config),this.pageLeaveFns=[u.send(this.getDeviceId.bind(this)).bind(u)],this.scrollHook=u.hook.bind(u)),h=[],p=this.config.storeType,p==="idb"&&!(!((i=_o())===null||i===void 0)&&i.indexedDB)&&(p="memory",this.loggerProvider.warn("Could not use preferred indexedDB storage, reverting to in memory option.")),this.loggerProvider.log("Using ".concat(p," for event storage.")),w.label=3;case 3:return w.trys.push([3,5,,6]),[4,lp({config:this.config,sessionId:this.identifiers.sessionId,type:"replay",storeType:p})];case 4:return g=w.sent(),h.push({name:"replay",manager:g}),[3,6];case 5:return m=w.sent(),_=m,this.loggerProvider.warn("Error occurred while creating replay events manager: ".concat(_.toString())),[3,6];case 6:if(!(!((a=this.config.interactionConfig)===null||a===void 0)&&a.enabled))return[3,10];v=this.config.interactionConfig.batch?sA:iA,w.label=7;case 7:return w.trys.push([7,9,,10]),[4,lp({config:this.config,sessionId:this.identifiers.sessionId,type:"interaction",minInterval:(s=this.config.interactionConfig.trackEveryNms)!==null&&s!==void 0?s:DE,maxInterval:FE,payloadBatcher:v,storeType:p})];case 8:return x=w.sent(),h.push({name:"interaction",manager:x}),[3,10];case 9:return y=w.sent(),_=y,this.loggerProvider.warn("Error occurred while creating interaction events manager: ".concat(_.toString())),[3,10];case 10:return this.eventsManager=new(cp.bind.apply(cp,Xr([void 0],Bo(h),!1))),this.eventCompressor=new uA(this.eventsManager,this.config,this.getDeviceId()),this.loggerProvider.log("Installing @amplitude/session-replay-browser."),this.teardownEventListeners(!1),this.initialize(!0),[2]}})})},t.prototype.setSessionId=function(e,n){return Bu(this.asyncSetSessionId(e,n))},t.prototype.asyncSetSessionId=function(e,n){return Qe(this,void 0,void 0,function(){var o,i,a;return Je(this,function(s){switch(s.label){case 0:return o=this.identifiers&&this.identifiers.sessionId,o&&this.sendEvents(o),i=n||this.getDeviceId(),this.identifiers=new pp({sessionId:e,deviceId:i}),this.joinedConfigGenerator&&o?(a=this,[4,this.joinedConfigGenerator.generateJoinedConfig(this.identifiers.sessionId)]):[3,2];case 1:a.config=s.sent(),s.label=2;case 2:return this.recordEvents(),[2]}})})},t.prototype.getSessionReplayProperties=function(){var e,n=this.config,o=this.identifiers;if(!n||!o)return this.loggerProvider.warn("Session replay init has not been called, cannot get session replay properties."),{};var i=this.getShouldRecord(),a={};return i&&(a=(e={},e[EE]=o.sessionReplayId?o.sessionReplayId:null,e),n.debugMode&&(a[jE]=JSON.stringify({appHash:n0(n.apiKey).toString()}))),this.addCustomRRWebEvent(ta.GET_SR_PROPS,{shouldRecord:i,eventProperties:a},this.eventCount===10),this.eventCount===10&&(this.eventCount=0),this.eventCount++,a},t.prototype.sendEvents=function(e){var n,o=e||((n=this.identifiers)===null||n===void 0?void 0:n.sessionId),i=this.getDeviceId();this.eventsManager&&o&&i&&this.eventsManager.sendCurrentSequenceEvents({sessionId:o,deviceId:i})},t.prototype.initialize=function(e){var n;if(e===void 0&&(e=!1),!(!((n=this.identifiers)===null||n===void 0)&&n.sessionId)){this.loggerProvider.log("Session is not being recorded due to lack of session id.");return}var o=this.getDeviceId();if(!o){this.loggerProvider.log("Session is not being recorded due to lack of device id.");return}this.eventsManager&&e&&this.eventsManager.sendStoredEvents({deviceId:o}),this.recordEvents()},t.prototype.shouldOptOut=function(){var e,n,o;if(!((e=this.config)===null||e===void 0)&&e.instanceName){var i=Bv(this.config.instanceName).identityStore;o=i.getIdentity().optOut}return o!==void 0?o:(n=this.config)===null||n===void 0?void 0:n.optOut},t.prototype.getShouldRecord=function(){if(!this.identifiers||!this.config||!this.identifiers.sessionId)return this.loggerProvider.warn("Session is not being recorded due to lack of config, please call sessionReplay.init."),!1;if(!this.config.captureEnabled)return this.loggerProvider.log("Session ".concat(this.identifiers.sessionId," not being captured due to capture being disabled for project or because the remote config could not be fetched.")),!1;if(this.shouldOptOut())return this.loggerProvider.log("Opting session ".concat(this.identifiers.sessionId," out of recording due to optOut config.")),!1;var e=wk(this.identifiers.sessionId,this.config.sampleRate);return e||this.loggerProvider.log("Opting session ".concat(this.identifiers.sessionId," out of recording due to sample rate.")),e},t.prototype.getBlockSelectors=function(){var e,n,o,i=(o=(n=(e=this.config)===null||e===void 0?void 0:e.privacyConfig)===null||n===void 0?void 0:n.blockSelector)!==null&&o!==void 0?o:[];if(i.length!==0)return i},t.prototype.getMaskTextSelectors=function(){var e,n,o,i;if(((n=(e=this.config)===null||e===void 0?void 0:e.privacyConfig)===null||n===void 0?void 0:n.defaultMaskLevel)==="conservative")return"*";var a=(i=(o=this.config)===null||o===void 0?void 0:o.privacyConfig)===null||i===void 0?void 0:i.maskSelector;if(a)return a},t.prototype.recordEvents=function(){var e=this,n,o=this.config,i=this.getShouldRecord(),a=(n=this.identifiers)===null||n===void 0?void 0:n.sessionId;if(!(!i||!a||!o)){this.stopRecordingEvents();var s=o.privacyConfig;this.loggerProvider.log("Session Replay capture beginning for ".concat(a,".")),this.recordCancelCallback=br({emit:function(c){if(e.shouldOptOut()){e.loggerProvider.log("Opting session ".concat(a," out of recording due to optOut config.")),e.stopRecordingEvents(),e.sendEvents();return}e.eventCompressor&&e.eventCompressor.enqueueEvent(c,a)},inlineStylesheet:o.shouldInlineStylesheet,hooks:{mouseInteraction:this.eventsManager&&aA({eventsManager:this.eventsManager,sessionId:a,deviceIdFn:this.getDeviceId.bind(this)}),scroll:this.scrollHook},maskAllInputs:!0,maskTextClass:Em,blockClass:PE,blockSelector:this.getBlockSelectors(),maskInputFn:tp("input",s),maskTextFn:tp("text",s),maskTextSelector:this.getMaskTextSelectors(),recordCanvas:!1,errorHandler:function(c){var d=c;if(d.message.includes("insertRule")&&d.message.includes("CSSStyleSheet")||d._external_)throw d;return e.loggerProvider.warn("Error while capturing replay: ",d.toString()),!0}}),this.addCustomRRWebEvent(ta.DEBUG_INFO)}},t.prototype.getDeviceId=function(){var e;return(e=this.identifiers)===null||e===void 0?void 0:e.deviceId},t.prototype.getSessionId=function(){var e;return(e=this.identifiers)===null||e===void 0?void 0:e.sessionId},t.prototype.flush=function(e){var n;return e===void 0&&(e=!1),Qe(this,void 0,void 0,function(){return Je(this,function(o){return[2,(n=this.eventsManager)===null||n===void 0?void 0:n.flush(e)]})})},t.prototype.shutdown=function(){this.teardownEventListeners(!0),this.stopRecordingEvents(),this.sendEvents()},t}(),Mr=function(t){return function(){var e=t.config,n=e||Am(),o=n.loggerProvider,i=n.logLevel;return{logger:o,logLevel:i}}},pA=function(){var t=new hA;return{init:Tr(t.init.bind(t),"init",Mr(t)),setSessionId:Tr(t.setSessionId.bind(t),"setSessionId",Mr(t)),getSessionId:Tr(t.getSessionId.bind(t),"getSessionId",Mr(t)),getSessionReplayProperties:Tr(t.getSessionReplayProperties.bind(t),"getSessionReplayProperties",Mr(t)),flush:Tr(t.flush.bind(t),"flush",Mr(t)),shutdown:Tr(t.shutdown.bind(t),"shutdown",Mr(t))}};const ds=pA();var fA=ds.init,gA=ds.setSessionId,mA=ds.getSessionId,fp=ds.getSessionReplayProperties,xA=ds.shutdown,gp="1.8.0",vA=function(){function t(e){this.name="@amplitude/plugin-session-replay-browser",this.type="enrichment",this.options=xt({},e),this.options.forceSessionTracking!==!1&&(this.options.forceSessionTracking=!0)}return t.prototype.setup=function(e){var n,o,i,a;return Qe(this,void 0,void 0,function(){return Je(this,function(s){switch(s.label){case 0:return e.loggerProvider.log("Installing @amplitude/plugin-session-replay, version ".concat(gp,".")),this.config=e,this.options.forceSessionTracking&&(typeof e.defaultTracking=="boolean"?e.defaultTracking===!1&&(e.defaultTracking={pageViews:!1,formInteractions:!1,fileDownloads:!1,sessions:!0}):e.defaultTracking=xt(xt({},e.defaultTracking),{sessions:!0})),[4,fA(e.apiKey,{instanceName:this.config.instanceName,deviceId:this.config.deviceId,optOut:this.config.optOut,sessionId:this.config.sessionId,loggerProvider:this.config.loggerProvider,logLevel:this.config.logLevel,flushMaxRetries:this.config.flushMaxRetries,serverZone:this.config.serverZone,sampleRate:this.options.sampleRate,privacyConfig:{blockSelector:(n=this.options.privacyConfig)===null||n===void 0?void 0:n.blockSelector,maskSelector:(o=this.options.privacyConfig)===null||o===void 0?void 0:o.maskSelector,unmaskSelector:(i=this.options.privacyConfig)===null||i===void 0?void 0:i.unmaskSelector,defaultMaskLevel:(a=this.options.privacyConfig)===null||a===void 0?void 0:a.defaultMaskLevel},debugMode:this.options.debugMode,configEndpointUrl:this.options.configEndpointUrl,shouldInlineStylesheet:this.options.shouldInlineStylesheet,version:{type:"plugin",version:gp},performanceConfig:this.options.performanceConfig,storeType:this.options.storeType}).promise];case 1:return s.sent(),[2]}})})},t.prototype.execute=function(e){return Qe(this,void 0,void 0,function(){var n;return Je(this,function(o){switch(o.label){case 0:return this.config.sessionId&&this.config.sessionId!==mA()?[4,gA(this.config.sessionId).promise]:[3,2];case 1:o.sent(),o.label=2;case 2:return this.config.sessionId&&this.config.sessionId===e.session_id&&(n=fp(),e.event_properties=xt(xt({},e.event_properties),n)),[2,Promise.resolve(e)]}})})},t.prototype.teardown=function(){return Qe(this,void 0,void 0,function(){return Je(this,function(e){return xA(),this.config=null,[2]})})},t.prototype.getSessionReplayProperties=function(){return fp()},t}(),yA=function(t){return new vA(t)};const mp="SESSION_REPLAY_REJECTED_LOCAL_KEY",wA=.005,bA=5e-4,CA=()=>{const t=Ee(),{pathname:e}=Rn(),{userProfileState:n,userPublicProfileData:o,isLoginLoading:i,isFeatureEnabled:a,accountApi:s}=l.useContext(ge),[c,d]=l.useState(!!(n!=null&&n.sessionReplayEnabled)),[u,h]=l.useState(!1);l.useEffect(()=>d(!!(n!=null&&n.sessionReplayEnabled)),[n==null?void 0:n.sessionReplayEnabled]);const p=l.useMemo(()=>pt(oe.TEAM_BILLING,e)?1:o&&Ql(o.join_time_float*1e3)<=1?wA:bA,[e,o]),g=l.useMemo(()=>{if(n&&o)return yA({sampleRate:p})},[p,n,o]),m=l.useRef(!1),v=l.useCallback(async()=>{g&&(m.current&&await Lu(g.name??"").promise,await Nu(g).promise,m.current=!0)},[g]),x=l.useCallback(async()=>{!m.current||!g||(await Nu(g).promise,await Lu(g.name??"").promise,m.current=!1)},[g]),y=l.useCallback(()=>{if(n!=null&&n.sessionReplayEnabled){d(!0);return}localStorage.getItem(mp)!=="true"&&h(!0)},[n==null?void 0:n.sessionReplayEnabled]);l.useEffect(()=>{!a(Bt.session_replay)||!n||i||!g||(c?v():(y(),x()))},[x,a,i,y,g,v,c,n]);const _=l.useCallback(()=>{t({eventKey:"OPT_IN_SESSION_REPLAY"}),s==null||s.optInSessionReplay(),d(!0),h(!1)},[s,t]),w=l.useCallback(()=>{t({eventKey:"REJECT_SESSION_REPLAY"}),localStorage.setItem(mp,"true"),h(!1)},[t]);return{handleAccept:_,handleReject:w,showOptInConsent:u}},_A=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{handleAccept:n,handleReject:o,showOptInConsent:i}=CA(),{modalContent:a}=l.useContext(Tt);return!i||a?null:r.jsx(IA,{sx:e?{borderRadius:"12px 12px 0px 0px",borderTop:`1px solid ${f("batchGenerationButtonBorder")}`,bottom:0,marginLeft:0,marginRight:0,margin:"auto"}:{borderRadius:"12px",border:`1px solid ${f("batchGenerationButtonBorder")}`,maxWidth:"360px",bottom:8,right:8},children:r.jsx(_E,{handleAccept:n,handleReject:o})})},IA=b(C)(()=>({backgroundColor:f("backgroundSurface"),boxShadow:"0px 10px 15px -3px rgba(9, 9, 11, 0.10), 0px 4px 6px -4px rgba(9, 9, 11, 0.10)",padding:"16px",position:"fixed",zIndex:1333})),Es=t=>{const e=we(),n=xe(e.breakpoints.down("md")),{children:o,verticalAppNavigation:i}=t,{bannerHeight:a}=l.useContext(zo);return n?r.jsx(r.Fragment,{children:o}):r.jsxs(r.Fragment,{children:[r.jsx(SA,{top:a,height:`calc(100% - ${a}px)`,children:i}),r.jsx(RA,{children:o})]})},SA=b(C)({position:"fixed",left:0,zIndex:1333}),RA=b(C)({width:"100%",minHeight:"100dvh",paddingLeft:80,position:"relative"}),TA=b(C)(()=>({padding:8,display:"flex",flexDirection:"column",alignItems:"stretch",borderRight:`1px solid ${f("border")}`,backgroundColor:f("promptBoxColor"),zIndex:1303,height:"100%",overflow:"auto"})),m0=t=>{const{width:e,color:n,strokeWidth:o}=t;return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",style:{fill:"none",stroke:n,strokeWidth:o??68,strokeLinecap:"round",strokeLinejoin:"round"},viewBox:"0 0 900 900",width:e,height:e,children:[r.jsx("path",{d:"M377.87 204.445H237.224M377.87 696.305H237.224M44.007 450.582h334.226M390.122 816.411H355.82zm0-244.024c67.386 0 122.013 54.627 122.013 122.012 0 67.386-54.627 122.012-122.013 122.012m0-732.922H355.82zm0 488.898H117.421m272.701-244.874H117.421m272.701 0c9.259 0 18.276 1.88 26.944 3.834 54.421 12.267 95.069 60.9 95.069 119.028 0 67.385-54.627 122.012-122.013 122.012m0-488.898c67.386 0 122.013 54.627 122.013 122.012 0 67.386-54.627 122.012-122.013 122.012"}),r.jsx("path",{d:"M665.607 313.656c0-36.554-20.93-69.879-53.858-85.751a95.194 95.194 0 0 0-100.631 11.28m297.28-7.97a95.194 95.194 0 0 0-95.193 0 95.194 95.194 0 0 0-47.598 82.441M667.655 523.686a95.193 95.193 0 0 0-140.773-64.862l.046.02a95.03 95.03 0 0 0-16.274 11.72m157.001 53.122c8.904 42.224 45 72.918 87.63 75.374l-.017.11a95.154 95.154 0 0 0 26.509-2.166"}),r.jsx("path",{d:"M474.213 798.357a95.597 95.597 0 0 1-4.59-10.63m306.374-567.765A210.825 210.825 0 0 0 673.055 76.897a210.824 210.824 0 0 0-222.857 9.3M760.802 408.85c38.502 0 73.214-23.193 87.948-58.766 14.734-35.571 6.588-76.516-20.637-103.741a95.194 95.194 0 0 0-52.116-26.38M651.123 730.766c22.06 33.771 63.01 49.972 102.204 40.435 39.194-9.537 68.122-42.74 72.199-82.872 3.713-36.594-13.99-72.054-45.469-91.08 46.652-9.636 78.999-52.274 75.71-99.796-3.462-49.897-44.948-88.605-94.965-88.604M474.526 798.955c22.257 43.26 73.552 62.778 118.936 45.253 45.385-17.524 70.253-66.45 57.661-113.441M450.198 86.197a210.67 210.67 0 0 0-8.922 6.704"})]})},EA=t=>{we();const{onClick:e}=t;return r.jsx(kA,{onClick:e,sx:{cursor:"pointer"},children:r.jsx(m0,{width:30,color:f("primary")})})},kA=b(C)({minWidth:64,minHeight:64,display:"flex",alignItems:"center",justifyContent:"center"});function x0({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",children:r.jsx("path",{fill:n??"inherit",d:"M12 1.996a7.49 7.49 0 017.496 7.25l.004.25v4.097l1.38 3.156a1.249 1.249 0 01-1.145 1.751L15 18.502a3 3 0 01-5.995.176L9 18.499l-4.725.001a1.25 1.25 0 01-1.147-1.748L4.5 13.594V9.496c0-4.155 3.352-7.5 7.5-7.5zM13.5 18.5l-3 .003a1.5 1.5 0 002.993.144l.007-.147zM12 3.496c-3.32 0-6 2.675-6 6v4.41L4.656 17h14.697L18 13.907V9.509l-.004-.225A5.988 5.988 0 0012 3.496z"})})}function v0({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",children:r.jsx("g",{children:r.jsx("path",{fill:n??"inherit",d:"M3 17h18a1 1 0 01.117 1.993L21 19H3a1 1 0 01-.117-1.993L3 17h18H3zm0-6l18-.002a1 1 0 01.117 1.993l-.117.007L3 13a1 1 0 01-.117-1.993L3 11l18-.002L3 11zm0-6h18a1 1 0 01.117 1.993L21 7H3a1 1 0 01-.117-1.993L3 5h18H3z"})})})}function y0({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",children:r.jsx("g",{children:r.jsx("path",{fill:n??"inherit",d:"M2.753 18h18.5a.75.75 0 01.101 1.493l-.101.007h-18.5a.75.75 0 01-.102-1.494L2.753 18h18.5-18.5zm0-6.497h18.5a.75.75 0 01.101 1.493l-.101.007h-18.5a.75.75 0 01-.102-1.494l.102-.006h18.5-18.5zm-.001-6.5h18.5a.75.75 0 01.102 1.493l-.102.007h-18.5A.75.75 0 012.65 5.01l.102-.007h18.5-18.5z"})})})}const li=l.createContext({showTeamSelectionOptions:!1,setShowTeamSelectionOptions:()=>{},menuHeight:{current:0},onSwitchTeam:()=>{}}),w0=t=>{const{children:e}=t,[n,o]=l.useState(!1),{updateChosenOrganization:i}=l.useContext(ge),a=l.useRef(0),s=l.useCallback(c=>{var g;const{organizationId:d,name:u,role:h,type:p}=c;i({chosenOrganizationId:d,isPersonalOrganization:p==="PRIVATE",name:u,role:h,avatar:(g=c.avatar)==null?void 0:g.avatarUrl})},[i]);return r.jsx(li.Provider,{value:{showTeamSelectionOptions:n,setShowTeamSelectionOptions:o,menuHeight:a,onSwitchTeam:s},children:e})};function Al({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsxs("g",{fill:n,children:[r.jsx("path",{d:"M17 6a3 3 0 013 3v1h1a1 1 0 011 1v2a1 1 0 01-1 1h-1v1a3 3 0 01-3 3H5a3 3 0 01-3-3V9a3 3 0 013-3h12zm-.002 1.5H5a1.5 1.5 0 00-1.493 1.356L3.5 9v6a1.5 1.5 0 001.355 1.493L5 16.5h11.998a1.5 1.5 0 001.493-1.355l.007-.145V9a1.5 1.5 0 00-1.355-1.493l-.145-.007z"}),r.jsx("path",{d:"M11.495 8.017a.473.473 0 00-.303.018.809.809 0 00-.345.293l-.948 1.287c-.155.21-.38.512-.577.775l-1.16 1.537a.728.728 0 00-.162.404.482.482 0 00.064.262c.034.06.097.137.207.2.111.062.264.107.475.107h1.49v2.496c0 .054 0 .173.038.29a.425.425 0 00.413.314c.143 0 .258-.07.34-.14.083-.072.142-.153.172-.194l.904-1.292.06-.083c.222-.302.54-.737.743-1.01l.932-1.263c.172-.232.215-.491.09-.707-.122-.212-.375-.324-.675-.324h-1.405V8.609c0-.19-.041-.326-.109-.422a.432.432 0 00-.244-.17z"})]})})}function Vi({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,fillRule:"evenodd",d:"M13.143 2.042a.996.996 0 00-.693.044c-.261.113-.528.34-.79.733L9.491 6.037c-.353.528-.867 1.28-1.318 1.94l-2.653 3.84v.002c-.26.38-.36.72-.37 1.008-.01.288.068.51.145.655.079.149.222.343.475.5.253.157.603.268 1.084.268h3.409v6.24c0 .136 0 .433.085.724.087.295.275.623.675.745a.926.926 0 00.271.041c.326 0 .59-.175.778-.352.188-.178.323-.38.391-.482l.002-.002 2.068-3.23.138-.206c.505-.755 1.233-1.844 1.698-2.526l2.13-3.156c.393-.58.492-1.23.207-1.768-.28-.53-.859-.81-1.543-.81H13.95V3.522c0-.475-.095-.816-.25-1.056a.992.992 0 00-.558-.425z",clipRule:"evenodd"})})}const b0=t=>{const{onClick:e,label:n,size:o="default",disabled:i,fullWidth:a,dropdownOptions:s,withIcon:c,shadow:d,customHeight:u}=t,[h,p]=l.useState(null),g=_a(),m=l.useMemo(()=>({"&:hover":{fill:f(i?"primaryButtonTextDisable":"InteractiveHover"),color:f(i?"primaryButtonTextDisable":"InteractiveHover"),backgroundColor:f(i?"primaryButtonDisable":"batchGenerationButtonBackground")},backgroundColor:f(i?"batchGenerationButtonBackgroundMaskDisabled":"batchGenerationButtonBackground"),color:f(i?"primaryButtonTextDisable":"secondary"),fill:f(i?"primaryButtonTextDisable":"secondary")}),[i,g]);return r.jsxs(r.Fragment,{children:[r.jsxs(PA,{sx:{width:a?"100%":void 0,height:u??(o==="small"?32:40),flex:a?1:void 0,justifyContent:s?"space-between":"center",borderRadius:"8px",boxShadow:d?"0px 1px 2px 0px rgba(9, 9, 11, 0.05)":void 0},disabled:i,disableRipple:!0,children:[s&&r.jsx("div",{}),r.jsx(jA,{onClick:e,sx:{...o==="small"?{padding:"0 12px",minHeight:32,fontSize:14}:{padding:"0 16px",minHeight:40,fontSize:16},paddingLeft:c?1:void 0,...m},"data-isdisabled":i?"true":"false",children:n}),s&&r.jsx(r.Fragment,{children:r.jsx(AA,{onClick:v=>{p(v.currentTarget)},sx:{minHeight:o==="small"?32:40,borderRightStyle:i?"none":"solid",paddingLeft:0,...m},children:r.jsx($n,{color:f(i?"batchGenerationButtonTextDisable":"batchGenerationButtonText"),width:16,height:16})})})]}),s&&r.jsx(MA,{anchorEl:h,open:!!h,onClose:()=>p(null),sx:{zIndex:v=>v.zIndex.drawer+140},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},disablePortal:!0,children:s.map((v,x)=>{const{menuButton:y}=v;return r.jsx(C,{onClick:()=>p(null),children:y},`option-${x}`)})})]})},AA=b(C)(()=>({borderRightWidth:1,borderRightColor:f("batchGenerationButtonBorder"),display:"flex",alignItems:"center",justifyContent:"center",width:24,transform:"rotate(180deg)","&:hover":{color:f("batchGenerationButtonDisable")},"&:hover::after":{content:'""',position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:f("neutral_100A"),pointerEvents:"none"},"&:disabled::after, &:active::after":{content:'""',position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:f("batchGenerationButtonBackgroundMaskDisabled"),pointerEvents:"none"},transition:"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"})),jA=b(C)(({"data-isdisabled":t})=>({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",flex:1,height:"100%","&:hover:not(:disabled)::after":{content:'""',position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:f(t==="true"?"batchGenerationButtonBackgroundMaskDisabled":"neutral_100A"),pointerEvents:"none"},letterSpacing:"-0.56px","&:active::after":{backgroundColor:f("batchGenerationButtonBackgroundMaskDisabled")}})),PA=b(gt)(()=>({"&.Mui-disabled":{opacity:1,color:f("InteractiveHover"),backgroundColor:f("primaryButtonDisable"),pointerEvents:"auto",cursor:"not-allowed"},"&:disabled::after":{content:'""',position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:f("batchGenerationButtonBackgroundMaskDisabled"),pointerEvents:"none"},fontWeight:500,textWrap:"nowrap",padding:0,overflow:"hidden",boxSizing:"border-box",borderRadius:"8px",border:`0.5px solid ${f("batchGenerationButtonBorder")}`,pointerEvents:"auto"})),MA=b(So)(()=>({"& .MuiPopover-paper":{backgroundColor:f("menuBackground"),padding:4,outlineStyle:"solid",outlineWidth:1,outlineColor:f("batchGenerationButtonBorder"),"& .MuiMenu-list":{paddingTop:0,paddingBottom:0},boxShadow:f("menuShadow"),marginTop:4,borderRadius:"10px"},pointerEvents:"auto"})),xp=t=>{const{text:e,textColor:n,backgroundColor:o}=t;return r.jsx(OA,{sx:{color:n,borderRadius:1,padding:"0 4px 1px 4px",backgroundColor:o},children:e})},OA=b(le)({fontSize:14,fontWeight:600,lineHeight:"20px",letterSpacing:"-0.24px"});function C0({width:t,height:e,color:n,borderProps:o}){let i={};const a=t??24,s=e??24;let c=a,d=s;return o!=null&&(i={display:"inline-block",border:"0.5px solid",borderRadius:"50%",borderColor:o.borderColor,padding:14},d=o.innerHeight,c=o.innerWidth),r.jsx("div",{style:i,children:r.jsx(BA,{width:a,height:s,children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:c,height:d,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M17.5 12C20.5376 12 23 14.4624 23 17.5C23 20.5376 20.5376 23 17.5 23C14.4624 23 12 20.5376 12 17.5C12 14.4624 14.4624 12 17.5 12ZM12.0223 13.9993C11.7256 14.4626 11.486 14.966 11.3136 15.4996L4.25354 15.4999C3.83933 15.4999 3.50354 15.8357 3.50354 16.2499V17.1573C3.50354 17.8129 3.78953 18.4359 4.28671 18.8634C5.54479 19.945 7.4408 20.5011 10 20.5011C10.5988 20.5011 11.1614 20.4706 11.6881 20.4101C11.9371 20.9103 12.2509 21.374 12.6171 21.7905C11.8149 21.9313 10.942 22.0011 10 22.0011C7.1105 22.0011 4.87168 21.3445 3.30882 20.0008C2.48019 19.2884 2.00354 18.25 2.00354 17.1573V16.2499C2.00354 15.0073 3.0109 13.9999 4.25354 13.9999L12.0223 13.9993ZM20.8092 15.2523L15.2523 20.8092C15.8929 21.2452 16.6667 21.5 17.5 21.5C19.7091 21.5 21.5 19.7092 21.5 17.5C21.5 16.6667 21.2452 15.8929 20.8092 15.2523ZM17.5 13.5C15.2909 13.5 13.5 15.2909 13.5 17.5C13.5 18.3333 13.7548 19.1071 14.1908 19.7477L19.7477 14.1908C19.1071 13.7548 18.3333 13.5 17.5 13.5ZM10 2.00464C12.7614 2.00464 15 4.24321 15 7.00464C15 9.76606 12.7614 12.0046 10 12.0046C7.23857 12.0046 5 9.76606 5 7.00464C5 4.24321 7.23857 2.00464 10 2.00464ZM10 3.50464C8.067 3.50464 6.5 5.07164 6.5 7.00464C6.5 8.93764 8.067 10.5046 10 10.5046C11.933 10.5046 13.5 8.93764 13.5 7.00464C13.5 5.07164 11.933 3.50464 10 3.50464Z"})})})})}const BA=b(C)({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),LA=t=>{const{blockedUser:e,action:n}=t,o=e.blockedTime==null?"N/A":xI(e.blockedTime);return r.jsxs(DA,{children:[r.jsx(C0,{width:40,height:40,color:f("menuAction"),borderProps:{borderColor:f("borderHighlight"),innerHeight:28,innerWidth:28}}),r.jsxs(FA,{children:[r.jsx(zA,{flex:2,children:e.userDisplayHandle}),r.jsxs(UA,{flex:2,children:["Muted on ",o]})]}),r.jsx(NA,{children:r.jsx(It,{label:"Unmute",onClick:n})})]})},NA=b(C)({display:"flex",alignItems:"center",justifyContent:"flex-end",flex:1}),DA=b(C)({display:"flex",flexDirection:"row",position:"relative",marginTop:12,marginBotton:12,alignItems:"center"}),FA=b(C)({display:"flex",flexDirection:"column",fontSize:16}),zA=b(le)(()=>({color:f("primary"),userSelect:"text",fontSize:16,fontWeight:600,marginLeft:8})),UA=b(le)(()=>({color:f("staticContent"),userSelect:"text",fontSize:14,fontWeight:400,marginLeft:8})),GA=t=>{const e=we(),n=xe(e.breakpoints.down(720)),{blockedUsersModalRef:o,handleClose:i}=t,{privacyApi:a}=l.useContext(ge),[s,c]=l.useState(null),d=l.useCallback(()=>{a==null||a.getBlockedUsers().then(h=>{if(h.blockedUsers!==void 0){const p=h.blockedUsers.sort((g,m)=>{if(g.blockedTime&&m.blockedTime){const v=m.blockedTime.getTime()-g.blockedTime.getTime();if(v!=0)return v}return g.userDisplayHandle.localeCompare(m.userDisplayHandle)});c(p)}})},[a,c]);l.useEffect(d,[d]);const u=l.useCallback(h=>{a==null||a.postUnblockUsers({postUnblockUserRequest:{blockedUserId:h}}).then(p=>{d()})},[d,a]);return r.jsxs(vp,{ref:o,children:[r.jsx($A,{children:r.jsx(Be,{onClick:i,icon:r.jsx(wt,{color:f("quietButtonText")})})}),r.jsx(C,{height:23}),r.jsx(qA,{children:r.jsx(HA,{fontSize:23,fontWeight:700,children:"Muted creators"})}),r.jsx(C,{height:16}),r.jsxs(WA,{sx:{flexDirection:"column"},children:[r.jsx(jl,{fontSize:16,maxWidth:n?void 0:"100%",flex:2,children:"Muted users don’t show up in your feed and notifications. They don’t know you muted them."}),r.jsx(C,{height:24}),s===null?r.jsx(jl,{fontSize:16,children:r.jsx(r.Fragment,{children:"Loading..."})}):s.length===0?r.jsxs(r.Fragment,{children:[r.jsx(C,{height:8}),r.jsx(jl,{children:r.jsx(r.Fragment,{children:"You are not muting any users."})}),r.jsx(C,{height:8})]}):r.jsx(vp,{children:s.map(h=>r.jsx(LA,{blockedUser:h,action:()=>{u(h.userId)}},h.userId))}),r.jsx(C,{height:24})]})]})},jl=b(le)(()=>({color:f("staticContent"),userSelect:"text"})),HA=b(le)(()=>({color:f("staticTitle"),userSelect:"text"})),vp=b(C)({display:"flex",flexDirection:"column",position:"relative",maxHeight:"96dvh"}),qA=b(C)({display:"flex",flexDirection:"column",marginLeft:23}),WA=b(C)({display:"flex",marginLeft:24,marginRight:24}),$A=b(C)({position:"absolute",top:8,right:8,zIndex:1}),VA=({handleClose:t,blockedUserModalRef:e})=>{const{userProfileState:n}=l.useContext(ge);return n?r.jsx(Rr,{open:!0,handleClose:t,content:r.jsx(GA,{handleClose:t,blockedUsersModalRef:e})}):null},KA=t=>{const e=_a(),{open:n,onClose:o,deleteAccountWarningRef:i}=t,{userProfileState:a,subscriptionStatus:s}=l.useContext(ge),[c,d]=l.useState(""),[u,h]=l.useState("warning"),p=l.useMemo(()=>u==="deleted"?r.jsx(r.Fragment,{children:r.jsx(Vs,{sx:{color:f("primary")},children:"Your account deletion is being processed, this usually takes 48 hours."})}):r.jsxs(r.Fragment,{children:[r.jsx(Vs,{sx:{color:f("primary"),fontSize:14,fontWeight:600},children:"Do you want to delete your account?"}),r.jsxs(Uc,{children:[r.jsxs(Gc,{sx:{color:f("primary"),fontSize:12},children:[r.jsx("b",{children:"All your generations and data will be permanently deleted. "}),r.jsx("br",{})," The process usually takes 48 hours, during which you cannot re-register with the same email. ",r.jsx("br",{}),r.jsx("br",{}),' Please type "',r.jsx("span",{className:"notranslate",children:"delete"}),'" in the text box below to confirm your action.',!(s!=null&&s.noActiveSubscription)&&r.jsxs(r.Fragment,{children:[r.jsx("br",{})," ",r.jsx("br",{})," Your subscription will be canceled at the end of your current subscription period."]})]}),r.jsx(sv,{variant:"outlined",fullWidth:!0,value:c,onChange:g=>d(g.target.value),placeholder:"Confirm your action here",autoComplete:"off",sx:{marginTop:2,color:f("primary"),"& .MuiOutlinedInput-notchedOutline":{borderColor:f("primary")},fontSize:14},InputProps:{sx:{caretColor:f("primary"),"&::placeholder":{color:f("informative")},color:f("primary")}}})]}),r.jsxs(av,{children:[r.jsx(gt,{onClick:()=>o(),sx:{color:f("primary")},children:"No"}),r.jsx(gt,{disabled:!(a!=null&&a.displayHandle)||c.toLocaleLowerCase()!=="delete",onClick:async()=>{h("deleted"),await pI(a==null?void 0:a.displayHandle),eI(),setTimeout(()=>{Lt()},3e3)},sx:{color:f("primary")},children:"Yes"})]})]}),[u,c,a==null?void 0:a.displayHandle,s,e]);return r.jsx(Wn,{ref:i,sx:{zIndex:g=>g.zIndex.drawer+145},open:n,onClose:()=>o(),PaperProps:{sx:{backgroundColor:f("solid"),color:f("primary"),zIndex:g=>g.zIndex.drawer+150,padding:2,borderRadius:8}},children:p})};function JA({width:t,height:e,color:n}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??16,height:e??16,fill:n??"inherit",viewBox:"0 0 16 16",children:[r.jsx("g",{clipPath:"url(#clip0_1458_37805)",children:r.jsx("path",{fill:n??"inherit",d:"M13.545 2.77a13.195 13.195 0 00-3.257-1.01.05.05 0 00-.052.025c-.141.25-.297.577-.406.833a12.18 12.18 0 00-3.658 0 8.426 8.426 0 00-.412-.833.051.051 0 00-.052-.025 13.158 13.158 0 00-3.257 1.01.047.047 0 00-.021.019C.356 5.888-.213 8.91.066 11.896c.001.014.01.028.02.037a13.27 13.27 0 003.996 2.02.052.052 0 00.056-.019 9.48 9.48 0 00.818-1.33.05.05 0 00-.028-.07 8.735 8.735 0 01-1.248-.595.051.051 0 01-.005-.085c.084-.062.168-.128.248-.194a.05.05 0 01.051-.007c2.619 1.196 5.454 1.196 8.041 0a.05.05 0 01.053.006c.08.067.164.133.248.195a.051.051 0 01-.004.086c-.399.232-.813.43-1.249.594a.051.051 0 00-.027.07c.24.466.514.91.817 1.33a.05.05 0 00.056.019 13.227 13.227 0 004.001-2.02.051.051 0 00.021-.037c.334-3.45-.559-6.449-2.365-9.107a.04.04 0 00-.021-.019zm-8.198 7.308c-.789 0-1.438-.724-1.438-1.613 0-.888.637-1.612 1.438-1.612.807 0 1.45.73 1.438 1.612 0 .89-.637 1.613-1.438 1.613zm5.316 0c-.788 0-1.438-.724-1.438-1.613 0-.888.637-1.612 1.438-1.612.807 0 1.45.73 1.438 1.612 0 .89-.63 1.613-1.438 1.613z"})}),r.jsx("defs",{children:r.jsx("clipPath",{id:"clip0_1458_37805",children:r.jsx("path",{fill:n??"inherit",d:"M0 0H16V16H0z"})})})]})}function XA({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??48,height:e??48,fill:"inherit",viewBox:"0 0 48 48",children:r.jsx("g",{children:r.jsx("path",{fill:n??"inherit",d:"M39.49 39.49h-6.52V29.28c0-2.435-.043-5.569-3.39-5.569-3.396 0-3.915 2.653-3.915 5.392v10.386h-6.52V18.494h6.259v2.869h.088a6.86 6.86 0 016.175-3.392c6.608 0 7.826 4.347 7.826 10.001L39.49 39.49zm-27.7-23.866a3.783 3.783 0 11-.003-7.566 3.783 3.783 0 01.002 7.566zm3.259 23.866H8.523V18.494h6.526V39.49zM42.74 2.003H5.247A3.21 3.21 0 002 5.174v37.65a3.213 3.213 0 003.247 3.174H42.74A3.22 3.22 0 0046 42.823V5.172A3.218 3.218 0 0042.74 2"})})})}function YA({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??16,height:e??17,fill:n??"inherit",viewBox:"0 0 16 17",children:r.jsx("g",{children:r.jsx("path",{fill:"inherit",d:"M10.034 2.271a1.666 1.666 0 10-.01-.72 2.69 2.69 0 00-2.399 2.67v.01c-1.465.061-2.802.478-3.864 1.136a2.334 2.334 0 10-2.417 3.96c.077 2.71 3.03 4.89 6.661 4.89 3.632 0 6.589-2.182 6.662-4.894a2.334 2.334 0 10-2.422-3.959C11.174 4.701 9.82 4.284 8.34 4.23v-.006c0-.992.737-1.815 1.693-1.95V2.27zM3.667 8.695C3.706 7.85 4.268 7.2 4.922 7.2c.653 0 1.153.687 1.114 1.533-.039.847-.527 1.154-1.181 1.154-.655 0-1.227-.344-1.188-1.19zM11.09 7.2c.654 0 1.216.65 1.255 1.496.039.847-.534 1.191-1.188 1.191-.653 0-1.142-.307-1.181-1.154-.04-.846.46-1.533 1.114-1.533zm-.778 3.455c.123.012.2.14.153.254a2.665 2.665 0 01-4.92 0 .185.185 0 01.154-.254 23.042 23.042 0 012.306-.113c.812 0 1.588.04 2.307.113z"})})})}function QA({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??16,height:e??14,fill:n??"inherit",viewBox:"0 0 16 14",children:r.jsx("g",{children:r.jsx("path",{fill:n??"inherit",d:"M12.163.5h2.205L9.55 6.007l5.668 7.493H10.78L7.304 8.955 3.327 13.5H1.12l5.153-5.89L.836.5h4.55L8.53 4.654 12.163.5zm-.774 11.68h1.222L4.723 1.75H3.41l7.978 10.43z"})})})}function ZA({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??20,height:e??20,fill:n??"inherit",viewBox:"0 0 20 20",children:r.jsx("g",{children:r.jsx("path",{fill:n??"inherit",d:"M19.8 6s-.195-1.379-.796-1.984c-.762-.797-1.613-.801-2.004-.848-2.797-.203-6.996-.203-6.996-.203h-.008s-4.2 0-6.996.203c-.39.047-1.242.05-2.004.848C.395 4.62.203 6 .203 6S0 7.621 0 9.238v1.516c0 1.617.2 3.238.2 3.238s.195 1.38.792 1.985c.762.796 1.762.77 2.207.855 1.602.152 6.801.2 6.801.2s4.203-.009 7-.208c.39-.047 1.242-.05 2.004-.847.601-.606.797-1.985.797-1.985S20 12.375 20 10.754V9.238C20 7.621 19.8 6 19.8 6zM7.935 12.594V6.973l5.402 2.82-5.402 2.8z"})})})}const e3=()=>r.jsxs(t3,{children:[r.jsx(Be,{onClick:()=>{var t;return(t=window.open(On.discord,"_blank"))==null?void 0:t.focus()},icon:r.jsx(JA,{color:f("secondary"),width:16,height:16})}),r.jsx(Be,{onClick:()=>{var t;return(t=window.open(On.x,"_blank"))==null?void 0:t.focus()},icon:r.jsx(QA,{color:f("secondary"),width:16,height:16})}),r.jsx(Be,{onClick:()=>{var t;return(t=window.open(On.youtube,"_blank"))==null?void 0:t.focus()},icon:r.jsx(ZA,{color:f("secondary"),width:16,height:16})}),r.jsx(Be,{onClick:()=>{var t;return(t=window.open(On.linkedIn,"_blank"))==null?void 0:t.focus()},icon:r.jsx(XA,{color:f("secondary"),width:16,height:16})}),r.jsx(Be,{onClick:()=>{var t;return(t=window.open(On.reddit,"_blank"))==null?void 0:t.focus()},icon:r.jsx(YA,{color:f("secondary"),width:16,height:16})})]}),t3=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:2}),n3=()=>{const{userProfileState:t}=l.useContext(ge);return t?r.jsxs(r3,{children:[r.jsxs(o3,{onClick:()=>{var e;return(e=window.open(On.tos,"_blank"))==null?void 0:e.focus()},children:[r.jsx(yp,{onClick:()=>{var e;return(e=window.open(On.tos,"_blank"))==null?void 0:e.focus()},children:"Terms"}),r.jsx(yp,{onClick:()=>{var e;return(e=window.open(On.privacy,"_blank"))==null?void 0:e.focus()},children:"Privacy"})]}),r.jsx(e3,{})]}):null},yp=b(le)(()=>({fontSize:14,lineHeight:"20px",padding:8,color:f("Interactive"),"&:hover":{color:f("InteractiveHover")},"&:active":{color:f("InteractiveActive")}})),o3=b(C)({cursor:"pointer",display:"flex"}),r3=b(C)({display:"flex",flexDirection:"column",alignItems:"flex-start"}),Dr=t=>{const{type:e}=t;return e==="free"?r.jsx(xi,{sx:{color:f("primary")},children:"Free"}):e==="basic"?r.jsx(xi,{sx:{color:f("primary"),borderRadius:1,padding:"0 4px 1px 4px",backgroundColor:f("infoCardBackground")},children:"Basic"}):e==="plus"?r.jsx(xi,{sx:{color:"#fff",borderRadius:1,padding:"0 4px 1px 4px",backgroundColor:f("IdeogramPink")},children:"Plus"}):e==="pro"?r.jsx(xi,{sx:{color:"#fff",borderRadius:1,padding:"0 4px 1px 4px",backgroundColor:f("IdeogramPink")},children:"Pro"}):e==="team"?r.jsx(xi,{sx:{color:f("primaryButtonText"),borderRadius:1,padding:"0 4px 1px 4px",backgroundColor:f("iconPrimary")},children:"Team"}):null},xi=b(le)({fontSize:14,fontWeight:700,lineHeight:"20px",letterSpacing:"-0.24px"}),qa=b(lv)(()=>({background:f("skeleton"),backgroundColor:f("skeleton"),borderColor:f("skeletonBorder"),borderStyle:"solid",borderWidth:.5})),ci=t=>{const{size:e,src:n,badge:o,blocked:i,subscriptionBadge:a,borderRadius:s,hasPadding:c=!0,customContainerSize:d}=t,u=l.useMemo(()=>{if(d)return d;switch(e){case"xs":return 22;case"sm":return 32;case"md":return 46;case"lg":return 120;default:return 40}},[d,e]),h=l.useMemo(()=>c?e==="lg"?"4px":"1px":"0px",[e,c]),p=l.useMemo(()=>e==="lg"?3:2,[e]),g=l.useMemo(()=>o?o==="GOLD"?{backgroundImage:"linear-gradient(119deg, rgba(140,66,29,1) 0%, rgba(251,230,123,1) 33%, rgba(247,209,78,1) 77%, rgba(212,160,65,1) 100%)"}:o==="SILVER"?{backgroundImage:"linear-gradient(331deg, rgba(168,168,166,1) 0%, rgba(105,105,105,1) 45%, rgba(249,248,246,1) 67%, rgba(212,212,212,1) 82%, rgba(127,127,127,1) 100%)"}:o==="BRONZE"?{backgroundImage:"linear-gradient(331deg, rgba(188,101,84,1) 0%, rgba(98,54,45,1) 20%, rgba(161,80,61,1) 40%, rgba(202,117,97,1) 49%, rgba(226,170,157,1) 67%, rgba(98,54,45,1) 83%, rgba(170,89,70,1) 95%)"}:{}:{},[o]);return r.jsxs(a3,{sx:{width:u,height:u,borderRadius:s??`${u/2}px`,padding:c?`${p}px`:"0px",...g},children:[r.jsx(s3,{sx:{borderRadius:s??`${u/2}px`,padding:h},children:n?r.jsx(i3,{src:n,sx:{outlineColor:i?f("borderHighlight"):"transparent",borderRadius:s??"50%"}}):r.jsx(qa,{sx:{width:"100%",height:"100%"},variant:"circular"})}),!!a&&a!=="free"&&r.jsx(l3,{children:r.jsx(Dr,{type:a})})]})},i3=b("img")({objectFit:"cover",objectPosition:"center",width:"100%",height:"100%",outlineStyle:"solid",outlineWidth:1,WebkitUserDrag:"none",zIndex:0}),s3=b("div")(()=>({display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",backgroundColor:f("background")})),a3=b(C)({display:"flex",alignItems:"center",justifyContent:"center",borderStyle:"solid",maxWidth:"100%",maxHeight:"100%",position:"relative"}),l3=b(C)({position:"absolute",bottom:0,right:0}),wp=()=>{const{userProfileState:t,profileLink:e,isTeamBillingEnabled:n}=l.useContext(ge),{navigate:o}=l.useContext($e),{externalPhotoUrl:i,badge:a,displayHandle:s,emailAddress:c}=t??{};return t?r.jsxs(u3,{onClick:()=>e&&o(e),children:[r.jsx(ci,{src:i,size:"md",badge:a,hasPadding:!n,customContainerSize:n?40:void 0}),r.jsxs(C,{marginLeft:1,children:[r.jsx(c3,{children:s}),r.jsx(d3,{children:c})]})]}):null},c3=b(le)(()=>({fontSize:16,fontWeight:600,lineHeight:"24px",letterSpacing:"-0.32px",color:f("primary")})),d3=b(le)(()=>({fontSize:14,fontWeight:400,marginTop:-2,color:f("secondary"),display:"flex",alignItems:"center",gap:3})),u3=b(C)(()=>({display:"flex",flexDirection:"row",borderRadius:"12px",alignItems:"center",cursor:"pointer",padding:"12px 8px","&:hover":{color:f("InteractiveHover"),backgroundColor:f("menuActionHover")}})),_0=t=>t>=1e9?(t/1e9).toFixed(1).replace(/\.0$/,"")+"b":t>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"m":t>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"k":t.toString(),Or=t=>t.toLocaleString("en-US"),bp=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{subscriptionStatus:n,isBasicSubscriber:o,isPlusSubscriber:i,isProSubscriber:a,chosenOrganization:s,isTeamBillingEnabled:c}=l.useContext(ge),{slowCredit:d,priorityCredit:u,isFetchingUserTaskQuotaStats:h}=l.useContext(ye),p=l.useMemo(()=>!(s!=null&&s.isPersonalOrganization)&&c?r.jsx(Dr,{type:"team"}):n!=null&&n.noActiveSubscription?r.jsx(Dr,{type:"free"}):o?r.jsx(Dr,{type:"basic"}):i?r.jsx(Dr,{type:"plus"}):a?r.jsx(Dr,{type:"pro"}):r.jsx("div",{}),[n==null?void 0:n.noActiveSubscription,o,i,a,t,s==null?void 0:s.isPersonalOrganization,c]),g=l.useMemo(()=>n!=null&&n.noActiveSubscription||o&&(!u||u.total<=0)?d:u,[n==null?void 0:n.noActiveSubscription,o,u,d]),m=l.useMemo(()=>!(n!=null&&n.noActiveSubscription||o&&(!u||u.balance<=0)),[o,u,n==null?void 0:n.noActiveSubscription]),v=l.useMemo(()=>g!=null&&g.total&&(g!=null&&g.max)?Math.min(100,g.total/g.max*100):0,[g]);return r.jsxs(m3,{children:[r.jsxs(x3,{children:[p,r.jsx(Rt,{content:r.jsxs(v3,{children:[!!(u!=null&&u.max)&&r.jsxs(ks,{children:[r.jsxs(As,{children:[Or(u.balance??0)," /"," ",Or((u==null?void 0:u.max)??0)," monthly"]})," ","priority credits"]}),!!(u!=null&&u.stickyBalance)&&r.jsxs(ks,{children:[r.jsxs(As,{children:[Or((u==null?void 0:u.stickyBalance)??0)," top-up"]})," ","priority credits"]}),d&&d.max>0?r.jsxs(ks,{children:[r.jsxs(As,{children:[Or((d==null?void 0:d.balance)??0)," /"," ",Or((d==null?void 0:d.max)??0)]})," ",o?`credits left until your daily limit resets in ${zi(d.refresh)}`:`credits left until your weekly limit resets in ${zi(d.refresh)}`]}):r.jsxs(ks,{children:[r.jsx(As,{children:"Unlimited slow"})," credits"]}),Og()&&!(n!=null&&n.noActiveSubscription)&&r.jsx(y3,{onClick:async()=>{n!=null&&n.noActiveSubscription||(await cI(lt.DevelopmentEnvironmentHardCancel),window.location.reload())},children:"Staging only hard cancel"})]}),placement:e?"top":"left",children:r.jsxs(p3,{children:[r.jsx(za,{color:f("iconPrimary"),width:16,height:16}),r.jsxs(g3,{children:[r.jsx(f3,{children:h?r.jsx(qa,{width:"30px",height:"15px"}):Or((g==null?void 0:g.total)??0)}),m?" priority ":" "," credits left"]})]})})]}),r.jsx(h3,{sx:{[`& .${ql.bar}`]:{backgroundColor:c&&!(s!=null&&s.isPersonalOrganization)?f("iconPrimary"):f(i||a?"IdeogramPink":"iconPrimary")}},variant:"determinate",value:v})]})},h3=b(cv)(()=>({height:4,borderRadius:2,width:"100%",[`&.${ql.colorPrimary}`]:{backgroundColor:f("toggleBackground")},[`& .${ql.bar}`]:{borderRadius:2,transition:"none"}})),ks=b(le)({fontSize:14,color:"#D4D4D8",lineHeight:"20px",position:"relative"}),p3=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:2,paddingLeft:8}),As=b("span")({color:"#FAFAFA",fontWeight:600,letterSpacing:"-0.28px"}),f3=b("span")(()=>({fontWeight:600,color:f("primary")})),g3=b(le)(()=>({fontSize:14,lineHeight:"20px",color:f("secondary"),display:"flex",alignItems:"center",gap:"3px"})),m3=b(C)({width:"100%",padding:"12px 8px 8px"}),x3=b(C)({width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:4}),v3=b(C)({display:"flex",flexDirection:"column",gap:8,position:"relative"}),y3=b("a")(()=>({width:"100%",cursor:"pointer",fontSize:10,display:"flex",justifyContent:"flex-end",position:"absolute",right:0,bottom:-32,color:f("secondary")}));function Wt({width:t,height:e,darkModeReverse:n}){const o=n?"#18181B":"#FAFAFA",i=n?"#FAFAFA":"#18181B";return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??12,height:e??12,fill:"none",viewBox:"0 0 12 12",children:os?r.jsxs(r.Fragment,{children:[r.jsx("path",{fill:"url(#paint0_linear_175_4288)",d:"M8 4V3a2 2 0 10-4 0v1h-.5A1.5 1.5 0 002 5.5v4A1.5 1.5 0 003.5 11h5A1.5 1.5 0 0010 9.5v-4A1.5 1.5 0 008.5 4H8zM6 2a1 1 0 011 1v1H5V3a1 1 0 011-1z"}),r.jsx("defs",{children:r.jsxs("linearGradient",{id:"paint0_linear_175_4288",x1:"1.429",x2:"11.617",y1:"0.63",y2:"10.563",gradientUnits:"userSpaceOnUse",children:[r.jsx("stop",{stopColor:o}),r.jsx("stop",{offset:"0.4",stopColor:o}),r.jsx("stop",{offset:"1",stopColor:o,stopOpacity:"0.1"})]})})]}):r.jsxs(r.Fragment,{children:[r.jsx("path",{fill:"url(#paint0_linear_54_3195)",d:"M8 4V3a2 2 0 10-4 0v1h-.5A1.5 1.5 0 002 5.5v4A1.5 1.5 0 003.5 11h5A1.5 1.5 0 0010 9.5v-4A1.5 1.5 0 008.5 4H8zM6 2a1 1 0 011 1v1H5V3a1 1 0 011-1z"}),r.jsx("defs",{children:r.jsxs("linearGradient",{id:"paint0_linear_54_3195",x1:"1.429",x2:"11.617",y1:"0.63",y2:"10.563",gradientUnits:"userSpaceOnUse",children:[r.jsx("stop",{stopColor:i}),r.jsx("stop",{offset:"0.4",stopColor:i}),r.jsx("stop",{offset:"1",stopColor:i,stopOpacity:"0.2"})]})})]})})}function I0({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherits",viewBox:"0 0 24 24",children:r.jsx("path",{fill:n??"inherits",d:"M7.75 12a1.75 1.75 0 11-3.5 0 1.75 1.75 0 013.5 0zm6 0a1.75 1.75 0 11-3.5 0 1.75 1.75 0 013.5 0zM18 13.75a1.75 1.75 0 100-3.5 1.75 1.75 0 000 3.5z"})})}function w3({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",children:r.jsx("path",{fill:n??"inherit",d:"M12 7.75a1.75 1.75 0 110-3.5 1.75 1.75 0 010 3.5zm0 6a1.75 1.75 0 110-3.5 1.75 1.75 0 010 3.5zM10.25 18a1.75 1.75 0 103.5 0 1.75 1.75 0 00-3.5 0z"})})}const S0=()=>r.jsx(b3,{children:r.jsx(C3,{children:"Beta"})}),b3=b(C)(()=>({display:"inline-flex",height:14,padding:"1px 4px 1px 4px",justifyContent:"center",alignItems:"center",gap:4,flexShrink:0,borderRadius:4,background:f("primaryButton"),color:f("primaryButtonText")})),C3=b(le)(()=>({color:f("primaryButtonText"),fontSize:12,fontWeight:700,lineHeight:"20px",letterSpacing:"-0.36px"})),R0=()=>r.jsx(_3,{children:r.jsx(I3,{children:"New"})}),_3=b(C)(()=>({display:"inline-flex",height:14,padding:"1px 4px 1px 4px",justifyContent:"center",alignItems:"center",gap:4,flexShrink:0,borderRadius:4,background:f("IdeogramPink")})),I3=b(le)(()=>({color:"#FFFFFF",fontSize:12,fontWeight:700,lineHeight:"20px",letterSpacing:"-0.36px"})),S3=tt.forwardRef(function(e,n){return r.jsx(rr,{direction:"up",ref:n,...e})}),R3=t=>t.some(e=>!e.hidden),di=t=>{const{size:e,onClose:n,forcePopup:o,options:i,minWidth:a,horizontal:s,direction:c,buttonComponent:d,disableScrollLock:u,onToggle:h}=t,p=we(),g=xe(p.breakpoints.down("md")),[m,v]=l.useState(!1),[x,y]=l.useState(null),[_,w]=l.useState(null),[I,R]=l.useState(null),[S,E]=l.useState(!1),{generationInputOpen:N}=l.useContext(ye),k=l.useRef(null),[A,D]=l.useState(c??"right");l.useEffect(()=>{if(k.current){const F=k.current.getBoundingClientRect();window.innerWidth-F.right<165?D("left"):F.left<165&&D("right")}},[x,k==null?void 0:k.current]);const O=l.useMemo(()=>i.flatMap(F=>F.filter(T=>!T.hidden)),[i]),L=l.useCallback(()=>{w(null),R(null),E(!1)},[R,w,E]),P=l.useCallback(()=>{v(!1),y(null),L(),n==null||n()},[v,y,n,L]);l.useEffect(()=>{N&&P()},[N,P]);const G=l.useMemo(()=>g&&!o,[g,o]),B=l.useMemo(()=>r.jsx(_p,{children:i.filter(R3).map((F,T)=>r.jsxs(C,{width:"100%",children:[r.jsx(Ip,{children:F.map((j,Z)=>{const{onClick:ee,icon:te,text:$,disabled:X,danger:W,hidden:Y,stale:q,nestedMenuOptions:V,paywallLock:Q,tooltipContent:K,tooltipPlacement:ae,beta:ce,new:ve}=j;return Y?null:r.jsx(Rt,{content:K,placement:ae,children:r.jsxs(Sp,{id:`menu-button-${$}`,onClick:se=>{V&&V.length?(G||w(se.currentTarget),R(V)):(q||P(),ee==null||ee())},onMouseOver:se=>{V&&V.length?(G||w(se.currentTarget),R(V)):L()},sx:{backgroundColor:(_==null?void 0:_.getAttribute("id"))===`menu-button-${$}`?f("menuActionHover"):void 0},disabled:X,disableRipple:!0,children:[!!te&&r.jsx(r.Fragment,{children:te}),!!$&&r.jsx(Rp,{color:f(X?"menuActionDisabled":"menuAction"),children:$}),(ce||ve||Q||V)&&r.jsx(C,{flex:1}),ce&&r.jsx(S0,{}),ve&&r.jsx(R0,{}),Q&&!X&&r.jsx(Wt,{}),!Q&&V&&V.length&&r.jsx(E3,{children:r.jsx("div",{style:{transform:"rotate(90deg)"},children:r.jsx($n,{color:f(X?"menuActionDisabled":"menuAction")})})})]})},`menu-button-${Z}`)})}),T!==i.length-1&&r.jsx(T3,{})]},`menu-group-${T}`))}),[i,_,G,P,L]),M=l.useMemo(()=>!I||!I.length?null:r.jsx(_p,{children:r.jsx(Ip,{children:I.map((F,T)=>{const{onClick:j,text:Z,stale:ee,paywallLock:te,icon:$}=F;return r.jsxs(Sp,{onClick:()=>{ee||(G?P():L()),j==null||j()},disableRipple:!0,children:[!!$&&r.jsx(C,{children:$}),typeof Z=="string"?r.jsx(Rp,{color:f("menuAction"),children:Z}):Z,te&&r.jsx(k3,{children:r.jsx(Wt,{})})]},`nested-menu-button-${T}`)})})}),[I,G,P,L]),z=l.useMemo(()=>i.flatMap(F=>F.filter(T=>T.confirmation)).map((F,T)=>r.jsx("div",{children:F.confirmation},T)),[i]);return l.useEffect(()=>h==null?void 0:h(!!x),[x,h]),O.length===0?null:r.jsxs(r.Fragment,{children:[d?r.jsx(C,{onClick:F=>{v(!0),G||y(F.currentTarget)},children:d}):r.jsx(Be,{size:e==="small"?{width:32,height:32}:{width:40,height:40},onClick:F=>{v(!0),G||y(F.currentTarget)},icon:s?r.jsx(I0,{color:f("quietButtonText")}):r.jsx(w3,{color:f("quietButtonText")}),pressed:m}),z,G?r.jsxs(Wn,{open:m,TransitionComponent:S3,keepMounted:!0,onClose:()=>P(),fullScreen:!0,hideBackdrop:!0,sx:{zIndex:F=>F.zIndex.drawer+140},PaperProps:{sx:{height:"fit-content",position:"fixed",bottom:0,borderTopRightRadius:24,borderTopLeftRadius:24,padding:2,backgroundColor:f("menuBackground")}},children:[M?r.jsx(Yo,{disableRipple:!0,sx:{alignSelf:"flex-start",backgroundColor:"transparent",zIndex:2,marginLeft:1,marginBottom:-1},onClick:()=>L(),children:r.jsx(Uo,{color:f("menuAction")})}):r.jsx(Yo,{disableRipple:!0,sx:{alignSelf:"flex-end",backgroundColor:"transparent",zIndex:2,marginBottom:-5},onClick:()=>P(),children:r.jsx(wt,{color:f("menuAction")})}),M??B]}):r.jsx(Cp,{anchorEl:x,open:m,onClose:()=>P(),sx:{zIndex:F=>F.zIndex.drawer+(S?140:141)},slotProps:{paper:{ref:k,sx:{marginTop:c==="right"?0:c==="up"?"-4px":"4px",marginLeft:c==="right"?"4px":0,marginRight:c==="left"?"4px":0,minWidth:a??160},onMouseLeave:()=>{M&&!G&&E(!0)}}},anchorOrigin:{vertical:c==="bottom"||!c?"bottom":"top",horizontal:c==="left"?c:"right"},transformOrigin:{vertical:c==="up"?"bottom":"top",horizontal:c==="right"?"left":"right"},disableScrollLock:u,children:B}),M&&!G&&r.jsx(Cp,{anchorEl:_,open:!!_&&!!M&&!!x,onClose:()=>{L()},sx:{zIndex:F=>F.zIndex.drawer+(S?141:140)},slotProps:{paper:{sx:{minWidth:128,marginTop:A==="right"?0:A==="up"?"8px":"-8px",marginLeft:A==="right"?"8px":"-8px"},onMouseLeave:()=>{L()}}},anchorOrigin:{vertical:A==="up"?"bottom":"top",horizontal:A==="left"?"left":"right"},transformOrigin:{vertical:A==="up"?"bottom":"top",horizontal:A==="left"?"right":"left"},children:M})]})},Cp=b(So)(()=>({"& .MuiPopover-paper":{backgroundColor:f("menuBackground"),padding:0,borderRadius:12,outlineStyle:"solid",outlineWidth:.5,outlineColor:f("border"),"& .MuiMenu-list":{paddingTop:0,paddingBottom:0},boxShadow:f("menuShadow")}})),_p=b(C)({display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%"}),Ip=b(C)({padding:4,display:"flex",flexDirection:"column",width:"100%"}),T3=b(Ra)(()=>({color:f("borderHighlight"),borderColor:f("borderHighlight"),width:"100%"})),Sp=b(gt)(()=>({display:"flex",alignItems:"center",justifyContent:"flex-start",borderRadius:8,height:40,"&:hover":{backgroundColor:f("menuActionHover")},width:"100%","&.Mui-disabled":{pointerEvents:"auto","&:hover":{backgroundColor:"transparent"},cursor:"not-allowed"},gap:10})),Rp=b(le)(()=>({fontSize:14,fontWeight:400,paddingRight:12})),E3=b(C)({flex:1,display:"flex",alignItems:"center",justifyContent:"flex-end"}),k3=b(C)({display:"flex",width:20,height:20,alignItems:"center",justifyContent:"center"}),kd=t=>{const{name:e,width:n=34,height:o=34,fontSize:i=24,borderRadius:a,hasBorder:s=!1,backgroundColor:c=f("iconPrimary"),letterColor:d=f("primaryButtonText")}=t;return r.jsx(A3,{sx:{...t.sx},children:r.jsx(j3,{sx:{width:n,height:o,fontSize:i,color:d,borderRadius:a??"50%",border:s?`1.5px solid ${f("border")}`:"none",backgroundColor:c},children:e.charAt(0).toUpperCase()})})},A3=b(C)(()=>({fontWeight:600,overflow:"hidden"})),j3=b(C)(()=>({display:"flex",justifyContent:"center",alignItems:"center",fontFamily:"Manrope, sans-serif"})),T0=t=>{const{org:e,externalPhotoUrl:n,badge:o}=t,{chosenOrganization:i}=l.useContext(ge);return r.jsxs(P3,{children:[r.jsxs(O3,{children:[e.type==="PRIVATE"?r.jsx(ci,{src:n,size:"xs",badge:o,hasPadding:!1}):r.jsx(kd,{width:18,height:18,fontSize:12,name:e.name||"",borderRadius:"4px"}),r.jsx(M3,{children:e.type==="PRIVATE"?"Personal":e.name})]}),(i==null?void 0:i.chosenOrganizationId)===e.organizationId&&r.jsx(or,{color:f("secondary"),width:18,height:18})]},e.organizationId)},P3=b(C)(()=>({width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"10px",borderRadius:8,padding:2})),M3=b(le)(()=>({fontSize:"14px",color:f("secondary"),fontWeight:400,letterSpacing:"-0.14px"})),O3=b(C)({display:"flex",alignItems:"center",gap:"10px",minWidth:137,textAlign:"left"}),Tp="HAS_SHOWN_TEAM_SELECTION_TOOLTIP",E0=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{chosenOrganization:n}=l.useContext(ge),{setShowTeamSelectionOptions:o}=l.useContext(li),[i,a]=l.useState("");l.useEffect(()=>{localStorage.getItem(Tp)||a("Switch between your personal and team spaces")},[]);const s=()=>{e&&o(!0),localStorage.setItem(Tp,"true"),a("")};return r.jsx(Rt,{content:i,placement:e?"top":"right",children:r.jsxs(B3,{sx:{"&:hover":{backgroundColor:f("menuActionHover"),cursor:"pointer"}},onClick:s,children:[r.jsxs(N3,{children:[!(n!=null&&n.isPersonalOrganization)&&r.jsx(kd,{width:24,height:24,fontSize:14,name:(n==null?void 0:n.name)||"",borderRadius:"4px"}),r.jsx(L3,{children:n!=null&&n.isPersonalOrganization?"Personal":n==null?void 0:n.name})]}),r.jsx(D3,{children:r.jsx("div",{style:{transform:"rotate(90deg)"},children:r.jsx($n,{color:f("menuAction")})})})]})})},B3=b(C)(()=>({display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"8px 10px 8px 8px",borderRadius:6})),L3=b(le)(()=>({fontSize:"14px",color:f("secondary"),fontWeight:400,letterSpacing:"-0.14px"})),N3=b(C)({display:"flex",alignItems:"center",gap:"10px",minWidth:137,textAlign:"left"}),D3=b(C)({flex:1,display:"flex",alignItems:"center",justifyContent:"flex-end"}),F3=()=>{const{userProfileState:t,userOrganizations:e}=l.useContext(ge),{externalPhotoUrl:n,badge:o}=t??{},{onSwitchTeam:i}=l.useContext(li),a=we(),s=xe(a.breakpoints.down("md")),c=l.useMemo(()=>s?[]:[(e==null?void 0:e.map(d=>({icon:r.jsx(T0,{org:d,externalPhotoUrl:n,badge:o}),onClick:()=>i(d)})))??[]],[o,n,s,i,e]);return r.jsx(di,{horizontal:!0,direction:"right",options:c,buttonComponent:r.jsx(E0,{})})};function z3({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??21,height:e??20,fill:n,viewBox:"0 0 21 20",children:r.jsx("g",{children:r.jsx("path",{fill:n,d:"M10.184 5.015a5 5 0 11-4.586 7.712c1.403-.38 3.316-1.302 4.16-3.551.552-1.474.584-2.938.426-4.16zM15.79 10a6 6 0 00-6.211-5.996.5.5 0 00-.474.592c.229 1.214.279 2.728-.284 4.228-.8 2.134-2.802 2.84-4.077 3.071a.5.5 0 00-.361.71A6 6 0 0015.79 10z"})})})}function U3({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??21,height:e??20,fill:n,viewBox:"0 0 21 20",children:r.jsx("g",{children:r.jsx("path",{fill:n,d:"M7.167 6a1.5 1.5 0 00-1.5 1.5v4a1.5 1.5 0 001.5 1.5h7a1.5 1.5 0 001.5-1.5v-4a1.5 1.5 0 00-1.5-1.5h-7zm-.5 1.5a.5.5 0 01.5-.5h7a.5.5 0 01.5.5v4a.5.5 0 01-.5.5h-7a.5.5 0 01-.5-.5v-4zm-1.5 6.5a.5.5 0 000 1h11a.5.5 0 000-1h-11z"})})})}function G3({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??21,height:e??20,fill:n,viewBox:"0 0 21 20",children:r.jsx("g",{children:r.jsx("path",{fill:n,d:"M10.5 3a.5.5 0 01.5.5v1a.5.5 0 01-1 0v-1a.5.5 0 01.5-.5zm0 10a3 3 0 100-6 3 3 0 000 6zm0-1a2 2 0 110-4 2 2 0 010 4zm6.5-1.5a.5.5 0 000-1h-1a.5.5 0 000 1h1zM10.5 15a.5.5 0 01.5.5v1a.5.5 0 01-1 0v-1a.5.5 0 01.5-.5zM5 10.5a.5.5 0 000-1H4a.5.5 0 000 1h1zm.646-5.354a.5.5 0 01.708 0l1 1a.5.5 0 11-.708.708l-1-1a.5.5 0 010-.708zm.708 9.708a.5.5 0 11-.708-.707l1-1a.5.5 0 01.708.707l-1 1zm9-9.708a.5.5 0 00-.708 0l-1 1a.5.5 0 00.708.708l1-1a.5.5 0 000-.708zm-.708 9.708a.5.5 0 00.708-.707l-1-1a.5.5 0 00-.708.707l1 1z"})})})}const H3=()=>{const t=Ee(),[e,n]=l.useState(localStorage.getItem($r)?localStorage.getItem($r):Xo.auto),{refreshTheme:o}=l.useContext($e),i=l.useCallback(a=>{t({eventKey:"TOGGLE_THEME_MODE",metaData:{themeMode:a}}),localStorage.setItem($r,a),HI(a),n(a),o(),document.documentElement.style.setProperty("scrollbar-color",`#5a5a5f ${f("background")}`)},[t,n,o]);return r.jsx(is,{width:"100%",options:[{optionName:"Light",optionId:"light",optionIcon:r.jsx(Pl,{children:r.jsx(G3,{color:f("toggleTextRest")})}),onSelect:()=>i(Xo.light)},{optionName:"Dark",optionId:"dark",optionIcon:r.jsx(Pl,{children:r.jsx(z3,{color:f("toggleTextRest")})}),onSelect:()=>i(Xo.dark)},{optionName:"Auto",optionId:"auto",optionIcon:r.jsx(Pl,{children:r.jsx(U3,{color:f("toggleTextRest")})}),onSelect:()=>i(Xo.auto)}],currentSelection:e})},Pl=b("div")({marginLeft:-6}),k0=t=>{var P;const e=we(),n=xe(e.breakpoints.down("md")),{t:o}=Kc(),{closeMenu:i}=t,a=Ee(),s=Nt(),{subscriptionStatus:c,isFeatureEnabled:d,profileLink:u,isBatchGenerationEnabled:h,isTeamBillingEnabled:p,chosenOrganization:g,userOrganizations:m}=l.useContext(ge),{navigate:v}=l.useContext($e),[x,y]=l.useState(!1),{menuHeight:_}=l.useContext(li),{setModalContent:w}=l.useContext(Tt),I=l.useCallback(()=>{w(null)},[w]),R=l.useCallback(()=>{w(r.jsx(VA,{handleClose:I}))},[w,I]),S=l.useCallback(()=>{a({eventKey:"OPEN_SUBSCRIPTION_FROM_DORPDOWN_MENU"}),i==null||i(),s({conversionReason:lt.FoundSubscriptionInAppMenu})},[a,i,s]),E=l.useCallback(()=>{a({eventKey:"OPEN_TEAM_BILLING_FROM_DROPDOWN_MENU"}),i==null||i(),u&&v(oe.TEAM_BILLING)},[a,i,u,v]),N=l.useCallback(()=>{a({eventKey:"APP_MENU_V2_UPGRADE_PLAN_CLICK"}),s({conversionReason:lt.AppMenuUpgradePlan})},[s,a]),k=l.useCallback(()=>{var G;(G=window.open(oe.API_MANAGEMENT,"_blank"))==null||G.focus()},[]),A=l.useCallback(()=>{i==null||i(),u&&v(u)},[v,u,i]),D=l.useCallback(()=>{i==null||i(),v(oe.BATCH_GENERATION)},[v,i]),O=l.useCallback(()=>{a({eventKey:"APP_MENU_V2_TOP_UP_CLICK"}),w(r.jsx(yr,{open:!0,onClose:()=>w(null),topUpReason:vr.AppMenuDirectTopUp})),i==null||i()},[i,w,a]),L=l.useRef(null);return l.useEffect(()=>{L.current&&(_.current=L.current.offsetHeight)},[_,(P=L==null?void 0:L.current)==null?void 0:P.offsetHeight]),r.jsxs(C,{ref:L,children:[p?r.jsxs(C,{children:[r.jsx(wp,{}),m.length>1?n?r.jsx(E0,{}):r.jsx(F3,{}):null,r.jsx(bp,{}),c!=null&&c.noActiveSubscription?r.jsx(js,{sx:{margin:"2px 7px 8px 7px"},children:r.jsx(ht,{fullWidth:!0,label:r.jsxs(r.Fragment,{children:[r.jsx(Vi,{color:f("primaryButtonText"),width:20,height:20}),r.jsx(C,{width:4}),"Upgrade plan"]}),onClick:N})}):g!=null&&g.isPersonalOrganization&&(c!=null&&c.noActiveSubscription)?r.jsx(js,{sx:{margin:"2px 7px 8px 7px"},children:r.jsx(b0,{fullWidth:!0,label:r.jsxs(r.Fragment,{children:[r.jsx(Al,{color:f("iconPrimary"),width:20,height:20}),r.jsx(C,{width:8}),"Top up credits"]}),onClick:O})}):(g==null?void 0:g.role)===Wr.Owner?r.jsx(js,{sx:{margin:"2px 7px 8px 7px"},children:r.jsx(It,{fullWidth:!0,label:r.jsxs(r.Fragment,{children:[r.jsx(Al,{color:f("iconPrimary"),width:20,height:20}),r.jsx(C,{width:8}),"Top up credits"]}),onClick:E})}):null]}):r.jsxs(C,{children:[r.jsx(wp,{}),r.jsx(bp,{}),r.jsx(C,{height:4}),r.jsx(js,{marginX:"8px",children:c!=null&&c.noActiveSubscription?r.jsx(ht,{fullWidth:!0,label:r.jsxs(r.Fragment,{children:[r.jsx(Vi,{color:f("primaryButtonText"),width:20,height:20}),r.jsx(C,{width:4}),"Upgrade plan"]}),onClick:N}):r.jsx(It,{fullWidth:!0,label:r.jsxs(r.Fragment,{children:[r.jsx(Al,{color:f("iconPrimary"),width:20,height:20}),r.jsx(C,{width:8}),"Top up credits"]}),onClick:O})})]}),(p||n)&&r.jsx(go,{onClick:A,children:"View profile"}),(p?(g==null?void 0:g.isPersonalOrganization)&&!(c!=null&&c.noActiveSubscription):!(c!=null&&c.noActiveSubscription))&&r.jsx(go,{onClick:S,children:"Manage subscription"}),p&&g&&!(g!=null&&g.isPersonalOrganization)&&r.jsx(go,{onClick:E,children:(g==null?void 0:g.role)===Wr.Owner?"Manage team subscription":"View team"}),r.jsx(go,{onClick:()=>window.open(On.doc,"_blank"),children:"Help & documentation"}),r.jsx(go,{onClick:R,children:"Manage muted users"}),r.jsx(go,{onClick:()=>{y(!0)},children:"Delete account"}),h&&n&&r.jsxs(r.Fragment,{children:[r.jsx(q3,{}),r.jsxs(go,{onClick:()=>{D()},gap:"10px",children:["Batch Generation",r.jsx(xp,{text:"New",textColor:f("surface"),backgroundColor:f("IdeogramPink")})]})]}),d(Bt.can_access_affiliate_program)&&r.jsx(go,{onClick:()=>{a({eventKey:"AFFILIATE_PROGRAM_BUTTON_CLICK"}),i==null||i(),iI()},children:"Affiliate program"}),d(Bt.api_management_access)&&!rn()&&r.jsxs(go,{onClick:k,children:[r.jsx(Qo,{i18nKey:"app.menu.ideogram_api"}),r.jsx(C,{width:10})," ",r.jsx(xp,{text:o("generic.beta_tag"),textColor:f("primary"),backgroundColor:f("primaryBackground")})]}),r.jsx(go,{onClick:()=>{a({eventKey:"LOGOUT_USER_CILCK_SIGNOUT"}),Lt()},children:"Log out"}),r.jsx(C,{padding:"16px 4px 12px 4px",children:r.jsx(H3,{})}),r.jsx(KA,{open:x,onClose:()=>y(!1)}),r.jsx(n3,{})]})},js=b(C)(()=>({borderRadius:8,boxShadow:"0px 1px 2px 0px rgba(9, 9, 11, 0.05);",marginBottom:16})),go=b(C)(()=>({display:"flex",alignItems:"center",justifyContent:"flex-start",borderRadius:8,height:40,color:f("Interactive"),"&:hover":{color:f("InteractiveHover"),backgroundColor:f("menuActionHover")},"&:active":{color:f("InteractiveActive"),backgroundColor:f("menuActionHover")},width:"100%",fontSize:14,fontWeight:400,padding:8,cursor:"pointer",fontFamily:"Manrope, sans-serif"})),q3=b(Ra)(()=>({color:f("borderHighlight"),borderColor:f("borderHighlight"),width:"100%",padding:"4px 8px",marginBottom:"8px"})),A0=t=>{const e=we(),n=xe(e.breakpoints.down("md")),{open:o,close:i}=t;return l.useEffect(()=>{if(n)return;const a=()=>i();return window.addEventListener("resize",a),window.addEventListener("scroll",a),()=>{window.removeEventListener("resize",a),window.removeEventListener("scroll",a)}},[i,n]),l.useEffect(()=>{const a=s=>{s.code==="Escape"&&(i(),Tg())};return document.addEventListener("keydown",a,!1),()=>{document.removeEventListener("keydown",a)}},[i]),r.jsx(Ia,{children:r.jsx(ri,{open:o,"aria-hidden":"false",sx:{zIndex:a=>a.zIndex.drawer+136,backgroundColor:"transparent"},children:r.jsx(Hc,{onClickAway:a=>{i(),a.preventDefault(),a.stopPropagation()},children:r.jsx(W3,{sx:{marginTop:n?"-4px":1,opacity:o?1:0,transform:o?"translateY(0)":"translateY(-10px)"},children:r.jsx(k0,{closeMenu:()=>i()})})})})})},W3=b(Ir)(({theme:t})=>({maxHeight:"calc(100vh - 16px)",position:"fixed",bottom:"8px",left:"89px",overscrollBehavior:"contain",overflow:"auto",background:f("menuBackground"),backgroundColor:f("menuBackground"),padding:4,minWidth:272,borderRadius:"12px",boxShadow:"0px 4px 6px -1px rgba(9, 9, 11, 0.10), 0px 2px 4px -2px rgba(9, 9, 11, 0.10)",outlineColor:f("borderHighlight"),outlineStyle:"solid",outlineWidth:.5,transition:"opacity 379ms cubic-bezier(0.4, 0, 0.2, 1), transform 300ms cubic-bezier(0.4, 0, 0.2, 1)",[t.breakpoints.down("md")]:{bottom:"72px",left:"unset",right:"8px",maxHeight:"calc(100vh - 80px)"}})),$3=()=>{const{userOrganizations:t,userProfileState:e}=l.useContext(ge),{externalPhotoUrl:n,badge:o}=e??{},i=we(),a=xe(i.breakpoints.down("md")),{onSwitchTeam:s,menuHeight:c,setShowTeamSelectionOptions:d}=l.useContext(li);return r.jsxs(V3,{height:a?c.current:"auto",children:[a&&r.jsxs(J3,{children:[r.jsx(Be,{icon:r.jsx(Uo,{color:f("iconPrimary"),width:20,height:20}),onClick:()=>d(!1)}),"Switch teams"]}),t==null?void 0:t.map(u=>r.jsx(K3,{onClick:()=>s(u),children:r.jsx(T0,{org:u,externalPhotoUrl:n,badge:o})},u.organizationId))]})},V3=b(C)(()=>({padding:4})),K3=b(C)(({theme:t})=>({[t.breakpoints.down("md")]:{display:"flex",alignItems:"center",justifyContent:"flex-start",borderRadius:6,padding:"8px 10px","&:hover":{backgroundColor:f("menuActionHover"),cursor:"pointer"},width:"100%","&.Mui-disabled":{pointerEvents:"auto","&:hover":{backgroundColor:"transparent"},cursor:"not-allowed"},gap:10}})),J3=b(C)(()=>({display:"flex",alignItems:"center",marginBottom:8,fontSize:14,fontWeight:500,color:f("secondary"),fontFamily:"Manrope, sans-serif"})),j0=t=>{const e=we(),n=xe(e.breakpoints.down("md")),{open:o,close:i}=t,{showTeamSelectionOptions:a}=l.useContext(li);return l.useEffect(()=>{if(n)return;const s=()=>i();return window.addEventListener("resize",s),window.addEventListener("scroll",s),()=>{window.removeEventListener("resize",s),window.removeEventListener("scroll",s)}},[i,n]),l.useEffect(()=>{const s=c=>{c.code==="Escape"&&(i(),Tg())};return document.addEventListener("keydown",s,!1),()=>{document.removeEventListener("keydown",s)}},[i]),r.jsx(Ia,{children:r.jsx(ri,{open:o,sx:{zIndex:s=>s.zIndex.drawer+136,backgroundColor:"transparent"},children:r.jsx(Hc,{onClickAway:s=>{i(),s.preventDefault(),s.stopPropagation()},children:r.jsx(X3,{sx:{marginTop:n?"-4px":1,opacity:o?1:0,transform:o?"translateY(0)":"translateY(-10px)"},children:n&&a?r.jsx($3,{}):r.jsx(k0,{closeMenu:()=>i()})})})})})},X3=b(Ir)(({theme:t})=>({maxHeight:"calc(100vh - 16px)",position:"fixed",bottom:"8px",left:"89px",overscrollBehavior:"contain",overflow:"auto",background:f("menuBackground"),backgroundColor:f("menuBackground"),padding:4,minWidth:272,borderRadius:"12px",boxShadow:"0px 4px 6px -1px rgba(9, 9, 11, 0.10), 0px 2px 4px -2px rgba(9, 9, 11, 0.10)",outlineColor:f("borderHighlight"),outlineStyle:"solid",outlineWidth:.5,transition:"opacity 379ms cubic-bezier(0.4, 0, 0.2, 1), transform 300ms cubic-bezier(0.4, 0, 0.2, 1)",[t.breakpoints.down("md")]:{bottom:"72px",left:"unset",right:"8px",maxHeight:"calc(100vh - 80px)"}})),Y3=(t,e,n)=>{const[o,i]=l.useState(!1),a=l.useMemo(()=>new IntersectionObserver(([s])=>i(s.isIntersecting),e),[e]);return l.useEffect(()=>(t.current&&a.observe(t.current),()=>a.disconnect()),[a,t]),o};var Ad={},Q3=pn;Object.defineProperty(Ad,"__esModule",{value:!0});var P0=Ad.default=void 0,Z3=Q3(fn()),ej=r;P0=Ad.default=(0,Z3.default)((0,ej.jsx)("path",{d:"M19 7v2.99s-1.99.01-2 0V7h-3s.01-1.99 0-2h3V2h2v3h3v2zm-3 4V8h-3V5H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-8zM5 19l3-4 2 3 3-4 4 5z"}),"AddPhotoAlternate");var jd={},tj=pn;Object.defineProperty(jd,"__esModule",{value:!0});var M0=jd.default=void 0,nj=tj(fn()),oj=r;M0=jd.default=(0,nj.default)((0,oj.jsx)("path",{d:"M18 11v2h4v-2zm-2 6.61c.96.71 2.21 1.65 3.2 2.39.4-.53.8-1.07 1.2-1.6-.99-.74-2.24-1.68-3.2-2.4-.4.54-.8 1.08-1.2 1.61M20.4 5.6c-.4-.53-.8-1.07-1.2-1.6-.99.74-2.24 1.68-3.2 2.4.4.53.8 1.07 1.2 1.6.96-.72 2.21-1.65 3.2-2.4M4 9c-1.1 0-2 .9-2 2v2c0 1.1.9 2 2 2h1v4h2v-4h1l5 3V6L8 9zm11.5 3c0-1.33-.58-2.53-1.5-3.35v6.69c.92-.81 1.5-2.01 1.5-3.34"}),"Campaign");var Pd={},rj=pn;Object.defineProperty(Pd,"__esModule",{value:!0});var O0=Pd.default=void 0,ij=rj(fn()),sj=r;O0=Pd.default=(0,ij.default)((0,sj.jsx)("path",{d:"m2 22 14-5-9-9zm12.53-9.47 5.59-5.59c.49-.49 1.28-.49 1.77 0l.59.59 1.06-1.06-.59-.59c-1.07-1.07-2.82-1.07-3.89 0l-5.59 5.59zm-4.47-5.65-.59.59 1.06 1.06.59-.59c1.07-1.07 1.07-2.82 0-3.89l-.59-.59-1.06 1.07.59.59c.48.48.48 1.28 0 1.76m7 5-1.59 1.59 1.06 1.06 1.59-1.59c.49-.49 1.28-.49 1.77 0l1.61 1.61 1.06-1.06-1.61-1.61c-1.08-1.07-2.82-1.07-3.89 0m-2-6-3.59 3.59 1.06 1.06 3.59-3.59c1.07-1.07 1.07-2.82 0-3.89l-1.59-1.59-1.06 1.06 1.59 1.59c.48.49.48 1.29 0 1.77"}),"Celebration");var Md={},aj=pn;Object.defineProperty(Md,"__esModule",{value:!0});var B0=Md.default=void 0,lj=aj(fn()),cj=r;B0=Md.default=(0,lj.default)((0,cj.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2"}),"Circle");var Od={},dj=pn;Object.defineProperty(Od,"__esModule",{value:!0});var Bd=Od.default=void 0,uj=dj(fn()),hj=r;Bd=Od.default=(0,uj.default)((0,hj.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit");var Ld={},pj=pn;Object.defineProperty(Ld,"__esModule",{value:!0});var L0=Ld.default=void 0,fj=pj(fn()),gj=r;L0=Ld.default=(0,fj.default)((0,gj.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info");var Nd={},mj=pn;Object.defineProperty(Nd,"__esModule",{value:!0});var N0=Nd.default=void 0,xj=mj(fn()),vj=r;N0=Nd.default=(0,xj.default)((0,vj.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person");const D0=({width:t,height:e,color:n})=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 20 20",children:r.jsx("g",{id:"Icon / Batch",children:r.jsxs("g",{id:"Vector",fill:n??"inherit",children:[r.jsx("path",{fillRule:"evenodd",d:"M10 12.5a2.5 2.5 0 0 1 2.5-2.5h4.167a2.5 2.5 0 0 1 2.5 2.5v4.167c0 .54-.172 1.04-.463 1.448l-2.942-2.942a1.667 1.667 0 0 0-2.357 0l-2.943 2.942A2.5 2.5 0 0 1 10 16.667zm7.5 0a.833.833 0 1 1-1.667 0 .833.833 0 0 1 1.667 0",clipRule:"evenodd"}),r.jsx("path",{d:"M11.051 18.705a2.5 2.5 0 0 0 1.449.462h4.167c.54 0 1.04-.172 1.448-.463l-2.942-2.942a.833.833 0 0 0-1.179 0z"}),r.jsx("path",{fillRule:"evenodd",d:"M2.5 5.208A2.71 2.71 0 0 1 5.208 2.5h9.584A2.71 2.71 0 0 1 17.5 5.208v4.064a3.3 3.3 0 0 0-.833-.105h-.417v-.834h-3.333v.834H12.5a3.3 3.3 0 0 0-.833.105v-.939H8.333v3.334h.939a3.3 3.3 0 0 0-.105.833v.417h-.834v3.333h.834v.417q0 .432.105.833H5.208A2.71 2.71 0 0 1 2.5 14.792zM5.208 3.75c-.805 0-1.458.653-1.458 1.458v1.875h3.333V3.75zM3.75 8.333v3.334h3.333V8.333zm9.167-1.25h3.333V5.208c0-.805-.653-1.458-1.458-1.458h-1.875zm-1.25-3.333H8.333v3.333h3.334zM3.75 12.917v1.875c0 .805.653 1.458 1.458 1.458h1.875v-3.333z",clipRule:"evenodd"})]})})});function Dd({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M12.82 5.58l-.82.822-.824-.823a5.375 5.375 0 00-7.601 7.601l7.895 7.896a.75.75 0 001.06 0l7.902-7.897a5.38 5.38 0 00-7.612-7.6z"})})}const F0="https://storage.googleapis.com/ideogram-static/welcome-modal.webp",z0=()=>r.jsx(yj,{sx:{background:`url(${F0})`,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}),yj=b(C)({width:"100%",minWidth:"50%",minHeight:"40dvh",flex:1,maxHeight:"100%"});function wj({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("g",{children:r.jsx("path",{fill:n,d:"M7.912 6.412a2.837 2.837 0 011.347-.955l1.378-.448a.544.544 0 000-1.025l-1.378-.448A2.838 2.838 0 017.5 1.774l-.011-.034L7.04.363a.544.544 0 00-1.027 0L5.567 1.74a2.836 2.836 0 01-1.798 1.796l-1.378.448-.028.007a.544.544 0 000 1.025l1.378.448A2.839 2.839 0 015.539 7.26l.448 1.377A.547.547 0 006.5 9a.544.544 0 00.513-.363l.448-1.377c.101-.307.254-.593.45-.848zM.217 10.213l.766-.248a1.577 1.577 0 00.998-.999l.25-.764a.302.302 0 01.57 0l.248.764a1.575 1.575 0 00.984.999l.765.248a.302.302 0 010 .57l-.765.249a1.577 1.577 0 00-1 1.002l-.248.764a.302.302 0 01-.57 0l-.249-.764a1.576 1.576 0 00-.999-.999l-.765-.248a.302.302 0 010-.57l.015-.004zM12 4.47V4.5h5.75c.966 0 1.75.784 1.75 1.75v11.5c0 .209-.037.409-.104.595l-5.822-5.702-.128-.116a2.25 2.25 0 00-3.02.116l-5.823 5.7a1.747 1.747 0 01-.103-.593v-5.759l-.12.038a.741.741 0 00-.22.14.59.59 0 00-.14.23l-.24.76a1.35 1.35 0 01-.78.806v3.785A3.25 3.25 0 006.25 21h11.5A3.25 3.25 0 0021 17.75V6.25A3.25 3.25 0 0017.75 3h-6.797c.306.11.573.308.767.569a1.6 1.6 0 01.28.9zm.525 9.246L18.33 19.4a1.746 1.746 0 01-.581.099H6.25c-.204 0-.4-.035-.582-.099l5.807-5.686.084-.071a.75.75 0 01.966.07zm4.98-4.963a2.252 2.252 0 10-4.505 0 2.252 2.252 0 004.504 0zm-3.005 0a.752.752 0 111.504 0 .752.752 0 01-1.504 0z"})})})}function us({width:t,height:e,color:n}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,viewBox:"0 0 24 24",children:[r.jsx("path",{fill:n??"inherit",fillRule:"evenodd",d:"M16 11.75a4 4 0 10-8 0 4 4 0 008 0zm-6.5 0a2.5 2.5 0 115 0 2.5 2.5 0 01-5 0z",clipRule:"evenodd"}),r.jsx("path",{fill:n??"inherit",fillRule:"evenodd",d:"M12 4c4.613 0 8.596 3.15 9.701 7.564a.757.757 0 010 .37 10.003 10.003 0 01-19.403.006.758.758 0 010-.37A10.003 10.003 0 0112 4zm0 1.5c3.859 0 7.2 2.593 8.2 6.25a8.504 8.504 0 01-16.4.005A8.504 8.504 0 0112 5.5z",clipRule:"evenodd"})]})}const U0=()=>{const t=Nt(),e=l.useCallback(o=>{o.preventDefault(),t({conversionReason:"WELCOME_MODAL_LINK",newTab:!0})},[t]),n=l.useMemo(()=>[{title:"Enjoy 10 weekly credits in the slow queue",description:r.jsxs(r.Fragment,{children:["That’s up to 40 images per week! Skip the wait and generate even more with an"," ",r.jsx(Ps,{onClick:e,href:oe.PRICING,children:"Ideogram plan"}),"."]}),icon:r.jsx(wj,{color:f("secondary")})},{title:"Generations are public by default",description:r.jsxs(r.Fragment,{children:["You can generate in private or delete individual images with"," ",r.jsx(Ps,{onClick:e,href:oe.PRICING,children:"Ideogram Plus"}),"."]}),icon:r.jsx(us,{color:f("secondary")})},{title:"Get premium features with a subscription",description:r.jsxs(r.Fragment,{children:["Learn about our advanced features like Upscale and Image Upload in our"," ",r.jsx(Ps,{href:On.doc,target:"_blank",children:"Docs"})," ","or"," ",r.jsx(Ps,{onClick:e,href:oe.PRICING,children:"Pricing page"}),"."]}),icon:r.jsx(za,{color:f("secondary")})}],[e]);return r.jsxs(Sj,{children:[r.jsx(Ij,{children:"Welcome to Ideogram!"}),r.jsx(_j,{children:"Get to know your free plan:"}),r.jsx(Rj,{container:!0,spacing:"28px",children:n.map((o,i)=>r.jsxs(Cj,{item:!0,xs:12,children:[r.jsx(C,{children:o.icon}),r.jsxs(bj,{children:[r.jsx(Tj,{children:o.title}),r.jsx(Ej,{children:o.description})]})]},`benefit-${i}`))})]})},bj=b(C)({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",paddingLeft:"12px",gap:4}),Cj=b(Co)({display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start",width:"100%"}),_j=b(le)({fontSize:16,marginTop:8,lineHeight:"24px"}),Ij=b(le)({fontSize:26,fontWeight:700,lineHeight:"125%",letterSpacing:"-0.78px",color:f("primary")}),Sj=b(C)(()=>({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",width:"100%",color:f("secondary"),userSelect:"text"})),Rj=b(Co)({marginTop:4}),Tj=b(le)(()=>({fontSize:16,fontWeight:600,lineHeight:"24px",letterSpacing:"-0.32px",color:f("primary"),whiteSpace:"nowrap"})),Ej=b(le)(()=>({fontSize:14,fontWeight:400,lineHeight:"20px",color:f("secondary")})),Ps=b("a")(()=>({fontSize:14,fontWeight:600,lineHeight:"20px",letterSpacing:"-0.28px",textDecorationLine:"underline",cursor:"pointer",color:f("Interactive"),"&:hover":{color:f("InteractiveHover")},"&:active":{color:f("InteractiveActive")}})),G0=()=>{const t=we(),e=xe(t.breakpoints.down("lg")),n=Nt(),{setModalContent:o}=l.useContext(Tt);return r.jsx(Aj,{children:r.jsxs(kj,{flexDirection:e?"row-reverse":"column",children:[r.jsx(ht,{fullWidth:!0,label:"Start creating",onClick:()=>o(null)}),r.jsx(C,{width:8,height:8}),r.jsx(It,{fullWidth:!0,label:"See our plans",onClick:()=>n({conversionReason:"WELCOME_MODAL_BUTTON"})})]})})},kj=b(C)({display:"flex",marginTop:24}),Aj=b(C)({display:"flex",flexDirection:"column"}),jj=()=>{const t=we(),e=xe(t.breakpoints.down("lg")),{setModalContent:n}=l.useContext(Tt),o=l.useRef(null),[i,a]=l.useState(!0),s=l.useCallback(()=>{const c=o.current;if(c){const d=c.scrollHeight-c.scrollTop<=c.clientHeight+4;a(d)}},[a]);return l.useEffect(()=>{const c=o.current;if(s(),c)return c.addEventListener("scroll",s),()=>{c.removeEventListener("scroll",s)}},[s]),r.jsxs(Bj,{flexDirection:e?"column":"row",children:[r.jsx(Mj,{sx:e?{backgroundColor:f("glassBackground"),"&:hover":{backgroundColor:f("glassBackgroundHover")},"&:active":{backgroundColor:f("glassBackgroundPressed")}}:{},children:r.jsx(Be,{icon:r.jsx(wt,{color:e?"#fff":f("secondary")}),onClick:()=>n(null)})}),r.jsx(z0,{}),r.jsxs(Oj,{ref:o,children:[r.jsx(C,{paddingX:4,display:"flex",children:r.jsx(U0,{})}),r.jsx(Pj,{sx:i?{}:{borderTopStyle:"solid",borderTopColor:f("border"),borderTopWidth:.5,boxShadow:"0px 25px 50px -12px rgba(9, 9, 11, 0.25)"},children:r.jsx(G0,{})})]})]})},Pj=b(C)(()=>({position:"sticky",width:"100%",bottom:0,left:0,backgroundColor:f("menuBackground"),padding:"16px 32px 24px 32px"})),Mj=b(C)({position:"absolute",top:8,right:8,zIndex:1,borderRadius:8}),Oj=b(C)(()=>({padding:"48px 0 0 0",backgroundColor:f("menuBackground"),maxHeight:"100%",overflow:"auto",position:"relative",display:"flex",flexDirection:"column"})),Bj=b(C)({display:"flex",maxHeight:"100%",overflow:"auto",position:"relative"}),Lj=()=>{const{setModalContent:t}=l.useContext(Tt);return r.jsxs(r.Fragment,{children:[r.jsx(Fj,{children:r.jsx(Be,{icon:r.jsx(wt,{color:"#fff"}),onClick:()=>t(null)})}),r.jsxs(Dj,{children:[r.jsx(z0,{}),r.jsx(Nj,{children:r.jsx(U0,{})}),r.jsx(zj,{children:r.jsx(G0,{})})]})]})},Nj=b(C)({padding:"32px 16px 16px 16px",width:"100%"}),Dj=b(C)(()=>({display:"flex",flexDirection:"column",backgroundColor:f("menuBackground"),position:"relative",height:"101dvh",overflow:"auto"})),Fj=b(C)(()=>({position:"absolute",top:8,right:8,zIndex:1,borderRadius:8,backgroundColor:f("glassBackground"),"&:hover":{backgroundColor:f("glassBackgroundHover")},"&:active":{backgroundColor:f("glassBackgroundPressed")}})),zj=b(C)(()=>({position:"sticky",width:"100%",bottom:0,left:0,backgroundColor:f("menuBackground"),padding:"0 16px 16px 16px",borderTopStyle:"solid",borderTopColor:f("border"),borderTopWidth:.5,boxShadow:"0px 25px 50px -12px rgba(9, 9, 11, 0.25)"})),Uj=()=>{const t=we();return xe(t.breakpoints.down("md"))?r.jsx(Lj,{}):r.jsx(jj,{})},Gj=()=>{const{setModalContent:t}=l.useContext(Tt);return r.jsx(Rr,{open:!0,content:r.jsx(Uj,{}),handleClose:()=>{t(null)},mobileFullScreen:!0})},Hj=()=>{const{setModalContent:t}=l.useContext(Tt),e=l.useCallback(()=>{t(r.jsx(Gj,{}))},[t]);return l.useEffect(()=>{No(F0)},[]),e},H0=t=>{const{type:e}=t,{setModalContent:n}=l.useContext(Tt),o=Nt();return r.jsx(Wj,{children:r.jsxs(qj,{children:[(e==="FREE_TIER_LIMIT_10"||e==="FREE_TIER_LIMIT_10_WEEKLY")&&r.jsx(It,{fullWidth:!0,label:"See plans",onClick:()=>o({newTab:!0,conversionReason:e})}),r.jsx(ht,{fullWidth:!0,label:"Got it",onClick:()=>n(null)})]})})},qj=b(C)({display:"flex",marginTop:16,flexDirection:"row",gap:8}),Wj=b(C)({display:"flex",flexDirection:"column"}),da=new Map([["FREE_TIER_LIMIT_10_WEEKLY","https://storage.googleapis.com/ideogram-static/notification_modal/free_tier_modal_weekly.jpg"],["FREE_TIER_LIMIT_10","https://storage.googleapis.com/ideogram-static/free_tier_modal_10.webp"],["FREE_TIER_LIMIT_20","https://storage.googleapis.com/ideogram-static/free_tier_modal.png"]]),q0=t=>{const{type:e}=t;return r.jsx($j,{sx:{background:da.get(e)?`url(${da.get(e)}) 0% 0% / cover;`:"url(https://storage.googleapis.com/ideogram-static/free_tier_modal.png) 0% 0% / cover;"}})},$j=b(C)({width:"100%",minWidth:"50%",minHeight:240,objectFit:"cover",objectPosition:"center",flex:1,maxHeight:"100%",backgroundSize:"cover"}),Kr=b("li")({display:"list-item",listStyle:"disc",paddingTop:12}),Ki=b(le)({fontSize:16}),Vj=b(le)(()=>({fontSize:18,color:f("primary"),fontWeight:700,width:"100%"})),Fd=b(le)({fontSize:26,lineHeight:1.25}),zd=b(C)(()=>({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",width:"100%",color:f("secondary"),userSelect:"text"})),Xn=b("span")(()=>({fontWeight:700,color:f("primary")})),W0=b("a")(()=>({cursor:"pointer",textDecoration:"underline",textDecorationStyle:"dotted",textUnderlineOffset:2,letterSpacing:"-0.24px",fontWeight:600,color:f("Interactive"),"&:hover":{color:f("InteractiveHover")},"&:active":{color:f("InteractiveActive")}})),Kj=()=>{const{userProfileState:t}=l.useContext(ge),e=Nt();return r.jsxs(zd,{children:[r.jsx(Fd,{children:r.jsx(Xn,{children:"Our free plan is changing"})}),r.jsx(C,{height:32}),r.jsxs(Ki,{children:["Hi ",t==null?void 0:t.displayHandle,",",r.jsx("br",{}),r.jsx("br",{})," We're focused on advancing Ideogram as the leading platform for creative design. This has attracted a considerable number of free users, dramatically increasing wait times.",r.jsx("br",{}),r.jsx("br",{}),"To ensure fair access and service quality for everyone, starting"," ",r.jsx(Xn,{children:"July 14, 2024, 8pm ET"})," (midnight UTC), our free plan is changing to 10 prompts per day. You’ll still have all the free features you had before:",r.jsxs("ul",{style:{paddingLeft:22},children:[r.jsxs(Kr,{children:[r.jsx(Xn,{children:"Ideogram 1.0 "})," for state-of-the-art prompt adherence and text quality"]}),r.jsxs(Kr,{children:[r.jsx(Xn,{children:"Magic Prompt"})," for enhancing and translating your initial prompt"]}),r.jsxs(Kr,{children:[r.jsx(Xn,{children:"Describe"})," for turning images into detailed descriptions"]})]})]}),r.jsx(C,{height:16}),r.jsxs(Ki,{children:["We’re continuing to offer extremely competitive"," ",r.jsx(W0,{onClick:()=>e({newTab:!0,conversionReason:"FREE_10_LIMIT_NOTIFICATION"}),children:"paid plans"})," ","for more prompts and premium features like private generation and image upload.",r.jsx("br",{}),r.jsx("br",{}),"Thank you for being part of our community, ",r.jsx("br",{})," The Ideogram Team"]})]})},Jj=()=>{const{userProfileState:t}=l.useContext(ge),e=Nt();return r.jsxs(zd,{children:[r.jsx(Fd,{children:r.jsx(Xn,{children:"Changes to our Free plan and Model 0.2"})}),r.jsx(C,{height:32}),r.jsxs(Ki,{children:["Hi ",t==null?void 0:t.displayHandle,",",r.jsx("br",{}),r.jsx("br",{})," We remain committed to making Ideogram the best platform for creative design. As our community grows, we’ve seen an increase in generation times, and the slow queue is frequently at capacity. To improve quality and usability for everyone, we’re making a few adjustments.",r.jsx("br",{}),r.jsx("br",{}),r.jsx(Xn,{children:"Starting today,"})," our Free plan is changing to 10 credits per week. Your weekly credits will refresh"," ",r.jsx(Xn,{children:"every Friday at midnight UTC."})," You’ll still have access to all the features you currently enjoy.",r.jsx("br",{}),r.jsx("br",{}),"We're also retiring our oldest model, Ideogram 0.2, on January 6. Your previously generated images won’t be affected.",r.jsx("br",{}),r.jsx("br",{}),"If you need more credits or premium features like private generation, image upload, or Magic Fill & Extend on your own images, take a look at our"," ",r.jsx(W0,{onClick:()=>e({newTab:!0,conversionReason:"FREE_TIER_LIMIT_10_WEEKLY"}),children:"paid plans."}),r.jsx("br",{}),r.jsx("br",{}),"Thank you for being part of our community, ",r.jsx("br",{})," The Ideogram Team"]})]})},Xj=()=>{const{userProfileState:t}=l.useContext(ge);return r.jsxs(zd,{children:[r.jsx(Fd,{children:r.jsx(Xn,{children:"Our free plan is changing"})}),r.jsx(C,{height:32}),r.jsxs(Ki,{children:["Hi ",t==null?void 0:t.displayHandle,",",r.jsx("br",{}),r.jsx("br",{})," Since our initial launch in September, we’ve introduced several key features to make it even easier for you to create high-quality visual content, all for free:",r.jsxs("ul",{style:{paddingLeft:22},children:[r.jsxs(Kr,{children:[r.jsx(Xn,{children:"Ideogram 1.0 "})," lets you generate detailed images with industry-leading prompt adherence and text accuracy"]}),r.jsxs(Kr,{children:[r.jsx(Xn,{children:"Magic Prompt"})," enhances, extends, and translates your initial prompt for more creative images"]}),r.jsxs(Kr,{children:[r.jsx(Xn,{children:"Describe"})," turns reference images into detailed descriptions"]})]})]}),r.jsx(C,{height:32}),r.jsx(Vj,{children:"What’s changing?"}),r.jsx(C,{height:16}),r.jsxs(Ki,{children:["Our free plan is changing from 25 to 20 prompts per day. This update helps us ensure fair access and service quality to everyone by letting us serve more users with shorter wait times. You’ll still have access to all the great features you had before.",r.jsx("br",{})," ",r.jsx("br",{})," Thanks for being part of our community, ",r.jsx("br",{}),"The Ideogram Team"]})]})},$0=t=>{const{type:e}=t;return e==="FREE_TIER_LIMIT_10_WEEKLY"?r.jsx(Jj,{}):e==="FREE_TIER_LIMIT_10"?r.jsx(Kj,{}):r.jsx(Xj,{})},Yj=t=>{const e=we(),n=xe(e.breakpoints.down("lg")),{setModalContent:o}=l.useContext(Tt),i=l.useRef(null),[a,s]=l.useState(!0),c=l.useCallback(()=>{const d=i.current;if(d){const u=d.scrollHeight-d.scrollTop<=d.clientHeight+4;s(u)}},[s]);return l.useEffect(()=>{const d=i.current;if(c(),d)return d.addEventListener("scroll",c),()=>{d.removeEventListener("scroll",c)}},[c]),r.jsxs(tP,{flexDirection:n?"column":"row",children:[r.jsx(Zj,{sx:n?{backgroundColor:f("glassBackground"),"&:hover":{backgroundColor:f("glassBackgroundHover")},"&:active":{backgroundColor:f("glassBackgroundPressed")}}:{},children:r.jsx(Be,{icon:r.jsx(wt,{color:n?"#fff":f("secondary")}),onClick:()=>o(null)})}),r.jsx(q0,{...t}),r.jsxs(eP,{ref:i,children:[r.jsx(C,{paddingX:4,children:r.jsx($0,{...t})}),r.jsx(Qj,{sx:a?{}:{borderTopStyle:"solid",borderTopColor:f("border"),borderTopWidth:.5,boxShadow:"0px 25px 50px -12px rgba(9, 9, 11, 0.25)"},children:r.jsx(H0,{...t})})]})]})},Qj=b(C)(()=>({position:"sticky",width:"100%",bottom:0,left:0,backgroundColor:f("menuBackground"),padding:"16px 32px 24px 32px"})),Zj=b(C)({position:"absolute",top:8,right:8,zIndex:1,borderRadius:8}),eP=b(C)(()=>({padding:"48px 0 0 0",backgroundColor:f("menuBackground"),maxHeight:"100%",overflow:"auto",position:"relative"})),tP=b(C)({display:"flex",maxHeight:"100%",overflow:"auto",position:"relative"}),nP=t=>{const{setModalContent:e}=l.useContext(Tt);return r.jsxs(r.Fragment,{children:[r.jsx(iP,{children:r.jsx(Be,{icon:r.jsx(wt,{color:"#fff"}),onClick:()=>e(null)})}),r.jsxs(rP,{children:[r.jsx(q0,{...t}),r.jsx(oP,{children:r.jsx($0,{...t})}),r.jsx(sP,{children:r.jsx(H0,{...t})})]})]})},oP=b(C)({padding:"32px 16px 16px 16px",width:"100%"}),rP=b(C)(()=>({display:"flex",flexDirection:"column",backgroundColor:f("menuBackground"),position:"relative",height:"101dvh",overflow:"auto"})),iP=b(C)(()=>({position:"absolute",top:8,right:8,zIndex:1,borderRadius:8,backgroundColor:f("glassBackground"),"&:hover":{backgroundColor:f("glassBackgroundHover")},"&:active":{backgroundColor:f("glassBackgroundPressed")}})),sP=b(C)(()=>({position:"sticky",width:"100%",bottom:0,left:0,backgroundColor:f("menuBackground"),padding:"0 16px 16px 16px",borderTopStyle:"solid",borderTopColor:f("border"),borderTopWidth:.5,boxShadow:"0px 25px 50px -12px rgba(9, 9, 11, 0.25)"})),aP=t=>{const e=we();return xe(e.breakpoints.down("md"))?r.jsx(nP,{...t}):r.jsx(Yj,{...t})},lP=t=>{const{setModalContent:e}=l.useContext(Tt);return r.jsx(Rr,{open:!0,content:r.jsx(aP,{...t}),handleClose:()=>{e(null)},mobileFullScreen:!0})},Ep=async t=>Le(`/api/n/${t?`?page=${t}`:""}`,{method:"GET",headers:{"Content-Type":"application/json",...Ne}}).then(e=>{if(e.status!==200)throw e;return e.json()}),cP=async t=>Le("/api/n/",{method:"PATCH",headers:{"Content-Type":"application/json",...Ne},body:JSON.stringify({latest_notification_id_seen:t})}).then(e=>{if(e.status!==200)throw e}),dP=async t=>Le(`/api/n/${t}/dismiss`,{method:"POST",headers:{"Content-Type":"application/json",...Ne}}).then(e=>{if(e.status!==200)throw e}),uP=t=>{const{notificationData:e,notificationId:n,closeNotificationPopUp:o}=t,i=l.useCallback(async d=>{await dP(d),o==null||o()},[o]),{acceptInvitation:a,isLoading:s}=Rm({navigateHomeOnError:!1,ignoreNotification:()=>i(n)}),c=l.useCallback(async d=>{d.preventDefault(),d.stopPropagation(),await a((e==null?void 0:e.invite_id)||""),i(n),o==null||o()},[a,e==null?void 0:e.invite_id,i,n,o]);return r.jsxs(Gn,{sx:{flexDirection:"column",gap:"8px",alignItems:"flex-start"},children:[r.jsxs(wn,{maxWidth:360,children:[r.jsx(Ji,{children:e==null?void 0:e.inviter_display_handle})," has invited you to join"," ",r.jsxs(Ji,{children:[e==null?void 0:e.organization_name,"."]})]}),r.jsxs(hP,{children:[r.jsx(C,{flex:1,children:r.jsx(b0,{fullWidth:!0,size:"small",label:"Ignore",onClick:()=>i(n)})}),r.jsx(C,{flex:1,children:r.jsx(ht,{fullWidth:!0,size:"small",label:"Accept",onClick:c,loading:s})})]})]})},hP=dv(C)({display:"flex",flexDirection:"row",gap:"16px",width:"100%",marginBottom:"8px"}),pP=t=>{const{notificationData:e}=t;return r.jsx(Gn,{children:r.jsxs(wn,{maxWidth:360,children:["You have been removed from"," ",r.jsxs(Ji,{children:[e==null?void 0:e.organization_name,"."]})]})})},fP=["FREE_TIER_LIMIT_10","FREE_TIER_LIMIT_20","FREE_TIER_LIMIT_10_WEEKLY"],gP=["ANNOUNCEMENT","SUBSCRIPTION_ENROLL_SUCCESS","STRIPE_PAYMENT_FAILED","TOPOFF_PURCHASE_SUCCESS","GENERAL"],mP=t=>{const e=Ee(),{notification:n,last:o,paperRef:i,notifications:a,closeNotificationPopUp:s}=t,{notificationId:c,isNewNotification:d,notificationType:u,users:h,badgeNotificationText:p,announcementText:g,announcementLink:m,announcementLinkLabel:v,targetGeneration:x,targetResponseId:y,remixes:_,updateTime:w,notificationData:I,targetUpload:R,edit:S}=n,{navigate:E,setNotificationScrollPosition:N,replace:k}=l.useContext($e),{profileLink:A}=l.useContext(ge),D=Hj(),O=l.useCallback(()=>i.current?i.current.firstChild.getBoundingClientRect().top:0,[i]),L=l.useCallback(()=>{i.current&&N(O())},[O,i,N]),P=l.useMemo(()=>["VARIATION","EDIT_VARIATION","UPLOAD_VARIATION"],[]),G=l.useMemo(()=>P.includes(u),[u,P]),B=l.useCallback($=>JSON.parse(localStorage.getItem("ignoredNotifications")||"[]").includes($),[]),M=l.useMemo(()=>u==="BADGE"||u==="SUBSCRIPTION_ENROLL_SUCCESS"||u==="TOPOFF_PURCHASE_SUCCESS"?r.jsx(O0,{sx:{fontSize:24},htmlColor:f("primary")}):u==="FOLLOW"?r.jsx(N0,{sx:{fontSize:24},htmlColor:f("primary")}):G?r.jsx(P0,{sx:{fontSize:24},htmlColor:f("iconPrimary")}):u==="EDIT"?r.jsx(Bd,{sx:{fontSize:24},htmlColor:f("iconPrimary")}):u==="REACTION"?r.jsx(Dd,{color:f("IdeogramPink")}):u==="ANNOUNCEMENT"||u==="GENERAL"?r.jsx(M0,{sx:{fontSize:24},htmlColor:f("primary")}):u==="SUBSCRIPTION_TERMINATED"||u==="STRIPE_PAYMENT_FAILED"?r.jsx(L0,{sx:{fontSize:24},htmlColor:f("primary")}):u==="BATCH_GENERATION"?r.jsx(D0,{width:24,height:24,color:f("primary")}):u==="ORGANIZATION_INVITE"||u==="ORGANIZATION_MEMBER_REMOVED"?r.jsx(Im,{width:24,height:24,color:f("primary")}):null,[u,G]),z=l.useMemo(()=>x!=null&&x.aspect_ratio?parseInt(x.aspect_ratio.split(":")[1])/parseInt(x.aspect_ratio.split(":")[0]):R!=null&&R.aspect_ratio?parseInt(R.aspect_ratio.split(":")[1])/parseInt(R.aspect_ratio.split(":")[0]):1,[x,R]),F=l.useCallback($=>{$!=null&&$.includes("Team")&&(s==null||s(),E(oe.TEAM_BILLING))},[E,s]),T=l.useMemo(()=>{var W;let $,X;if(x&&y){const Y=(W=x.responses)==null?void 0:W.findIndex(q=>q.response_id===y);$=oe.GENERATION.replace(":request_id",x.request_id).replace(":image_index",(Y!==void 0&&Y!==-1?Y:0).toString()),X="NOTIFICATION_TARGET_GENERATION_CLICK"}else if(R)$=oe.IMAGE.replace(":image_id",R.image_id),X="NOTIFICATION_TARGET_UPLOAD_CLICK";else return null;return r.jsx("a",{href:$,onClick:Y=>{Y.preventDefault(),Y.stopPropagation(),e({eventKey:X,metaData:{notificationType:u}}),L(),E({...mt($),generation:x,notificationState:{notifications:a,scrollPosition:O()}})},children:r.jsx(IP,{src:y?Pt(y,"balanced","response"):R&&Pt(R.image_id,"balanced","response"),sx:{aspectRatio:1/z}})})},[x,y,R,z,e,u,L,E,a,O]),j=l.useMemo(()=>!h||h.length<=1?" ":` and ${h.length-1} more user${h.length>2?"s ":" "}`,[h]),{setModalContent:Z}=l.useContext(Tt),ee=l.useMemo(()=>{if(u==="BADGE"&&p)return r.jsx(Gn,{children:r.jsxs(wn,{children:[p," ",r.jsx("a",{style:{textDecoration:"underline"},href:"https://docs.ideogram.ai/usage/creator-titles",target:"_blank",rel:"noopener noreferrer",onClick:$=>$.stopPropagation(),children:"Read more here."})]})});if(u==="EDIT"&&(x||R)&&h&&h.length>0&&S&&S.image_id){const $=h[0],X=parseInt(S.aspect_ratio.split(":")[1])/parseInt(S.aspect_ratio.split(":")[0]);return r.jsxs(r.Fragment,{children:[r.jsxs(kp,{children:[r.jsx("a",{href:oe.IMAGE.replace(":image_id",S.image_id),onClick:W=>{W.preventDefault(),W.stopPropagation(),e({eventKey:"NOTIFICATION_USER_PROFILE_CLICK"}),L(),E({...mt(oe.PROFILE.replace(":uhandle",$.display_handle)),notificationState:{notifications:a,scrollPosition:O()}})},children:r.jsx(Ml,{src:$.photo_url})}),r.jsxs(wn,{paddingLeft:1,flex:1,children:[r.jsx("b",{onClick:W=>{W.stopPropagation(),E({...mt(oe.PROFILE.replace(":uhandle",$.display_handle)),notificationState:{notifications:a,scrollPosition:O()}})},children:$.display_handle}),j,"edited"]}),T]}),r.jsx(SP,{container:!0,spacing:.5,children:r.jsx("a",{href:oe.IMAGE.replace(":image_id",S.image_id),onClick:W=>{W.preventDefault(),W.stopPropagation(),e({eventKey:"NOTIFICATION_EDIT_CLICK"}),L(),E({...mt(oe.IMAGE.replace(":image_id",S.image_id)),generation:S,notificationState:{notifications:a,scrollPosition:O()}})},style:{width:"100%"},children:r.jsx(Ap,{src:Zr(S.image_id,"balanced"),sx:{borderRadius:2,aspectRatio:1/X}})})})]})}else if(G&&x&&h&&h.length>0&&_&&_.length>0&&_[0].request_id&&_[0].responses){const $=h[0],X=_[0],W=oe.GENERATION.replace(":request_id",X.request_id),Y=parseInt(X.aspect_ratio.split(":")[1])/parseInt(X.aspect_ratio.split(":")[0]);return r.jsxs(r.Fragment,{children:[r.jsxs(kp,{children:[r.jsx("a",{href:oe.PROFILE.replace(":uhandle",$.display_handle),onClick:q=>{q.preventDefault(),q.stopPropagation(),e({eventKey:"NOTIFICATION_USER_PROFILE_CLICK"}),L(),E({...mt(oe.PROFILE.replace(":uhandle",$.display_handle)),notificationState:{notifications:a,scrollPosition:O()}})},children:r.jsx(Ml,{src:$.photo_url})}),r.jsxs(wn,{paddingLeft:1,flex:1,children:[r.jsx("b",{children:$.display_handle}),j,"remixed"]}),T]}),r.jsx(V0,{container:!0,spacing:.5,children:X.responses.map((q,V)=>r.jsx(Co,{item:!0,xs:6,children:r.jsx("a",{href:W.replace(":image_index",V.toString()),onClick:Q=>{Q.preventDefault(),Q.stopPropagation(),e({eventKey:"NOTIFICATION_REMIX_CLICK"}),L(),X.request_id&&window.location.pathname.startsWith(`/g/${X.request_id}`)?k(oe.GENERATION.replace(":request_id",X.request_id).replace(":image_index",V.toString())):E({...mt(W.replace(":image_index",V.toString())),generation:X,notificationState:{notifications:a,scrollPosition:O()}})},style:{width:"100%"},children:r.jsx(Ap,{src:cd(q.response_id,"balanced"),sx:{borderTopLeftRadius:V===0?8:2,borderTopRightRadius:V===1?8:2,borderBottomLeftRadius:V===2?8:2,borderBottomRightRadius:V===3?8:2,aspectRatio:1/Y}})})},`remix-${V}`))})]})}else{if(u==="REACTION"&&x&&h&&h.length>0)return r.jsx(Gn,{children:r.jsxs(wn,{children:[r.jsx("b",{onClick:$=>{$.stopPropagation(),E({...mt(oe.PROFILE.replace(":uhandle",h[0].display_handle)),notificationState:{notifications:a,scrollPosition:O()}})},children:h[0].display_handle}),j,"liked"]})});if(u==="FOLLOW"&&h&&h.length>0)return r.jsx(Gn,{children:r.jsxs(wn,{children:[r.jsx("b",{children:h[0].display_handle}),j,"followed you"]})});if(I!=null&&I.modal_type){const $=fP.includes(I.modal_type);return $&&da.get(I==null?void 0:I.modal_type)&&No(da.get(I==null?void 0:I.modal_type)),r.jsx(Gn,{onClick:()=>{$?Z(r.jsx(lP,{type:I.modal_type})):I.modal_type==="FREE_PLAN_WELCOME"&&D()},children:r.jsxs(wn,{maxWidth:360,children:[I!=null&&I.general_text?I.general_text:"",!!(I!=null&&I.modal_label)&&r.jsxs(r.Fragment,{children:[" ",r.jsx("span",{style:{textDecoration:"underline",cursor:"pointer"},children:I.modal_label||"Learn more"})]})]})})}else{if(u==="ANNOUNCEMENT"&&g)return r.jsx(Gn,{children:r.jsxs(wn,{maxWidth:360,children:[g,!!m&&!!v&&r.jsxs(r.Fragment,{children:[" ",r.jsx("a",{style:{textDecoration:"underline"},href:m,target:"_blank",rel:"noopener noreferrer",children:v||"Read more here."})]})]})});if(u==="SUBSCRIPTION_ENROLL_SUCCESS")return r.jsx(Gn,{children:r.jsx(wn,{maxWidth:400,children:I!=null&&I.is_upgrade?r.jsxs("a",{onClick:()=>F(I==null?void 0:I.plan_name),children:["Success! Your subscription is upgraded."," ",I!=null&&I.plan_name?r.jsxs(r.Fragment,{children:["Welcome to ",I.plan_name,"!"," ",r.jsx(C,{component:"span",sx:{textDecoration:"underline",cursor:"pointer"},children:I!=null&&I.plan_name.includes("Team")?"Invite members":""})]}):""]}):r.jsxs("a",{onClick:()=>F(I==null?void 0:I.plan_name),children:["Success! You're subscribed."," ",I!=null&&I.plan_name?`Welcome to ${I.plan_name}!`:""," ",r.jsx(C,{component:"span",sx:{textDecoration:"underline",cursor:"pointer"},children:I!=null&&I.plan_name.includes("Team")?" Invite members":""})]})})});if(u==="SUBSCRIPTION_TERMINATED")return r.jsx(Gn,{children:r.jsx(wn,{maxWidth:360,children:r.jsxs("a",{href:"https://ideogram.ai/pricing",children:[" ","Your subscription plan has ended. We hope you enjoyed your experience! If you wish to renew or explore other subscription plans, please click here."]})})});if(u==="STRIPE_PAYMENT_FAILED")return r.jsx(Gn,{children:r.jsx(wn,{maxWidth:360,children:"Alert: There was an issue processing your payment. Please check your email for more information from Stripe."})});if(u==="TOPOFF_PURCHASE_SUCCESS")return r.jsx(Gn,{children:r.jsx(wn,{maxWidth:360,children:"Success! Priority credits have been increased. Top-up credit will be used after your monthly priority queue credits are used. Any unused top-up credit will be transferred to the next subscription period."})});if(u==="GENERAL")return r.jsx(Gn,{children:r.jsxs(wn,{maxWidth:360,children:[I!=null&&I.general_text?I.general_text:"",!!(I!=null&&I.general_link)&&!!I.general_link_label&&r.jsxs(r.Fragment,{children:[" ",r.jsx("a",{style:{textDecoration:"underline"},href:I.general_link,target:"_blank",rel:"noopener noreferrer",children:I.general_link_label||"Read more here."})]})]})});if(u==="BATCH_GENERATION")return r.jsx(Gn,{onClick:()=>E(oe.BATCH_GENERATION,{searchParams:new URLSearchParams({jobId:I==null?void 0:I.jobId})}),children:r.jsxs(wn,{maxWidth:360,children:["Batch"," ",(I==null?void 0:I.status)==="COMPLETED"?"completed":"paused",":"," ",r.jsxs(Ji,{children:[I==null?void 0:I.filename,"."]})," ",r.jsx(Ji,{sx:{textDecoration:"underline"},rel:"noopener noreferrer",children:"Go to batch"})]})});if(u==="ORGANIZATION_INVITE")return r.jsx(uP,{notificationData:I,notificationId:c,closeNotificationPopUp:s});if(u==="ORGANIZATION_MEMBER_REMOVED")return r.jsx(pP,{notificationData:I})}}return null},[u,p,x,R,h,S,G,_,I,g,j,T,e,L,E,a,O,k,Z,D,m,v,F,c,s]),te=l.useCallback(()=>{var $,X,W;if(e({eventKey:"NOTIFICATION_CLICK",metaData:{notificationType:u}}),L(),u==="VARIATION"&&x&&_&&_.length){const Y=_[0],q=Math.max(...(($=Y.responses)==null?void 0:$.map(K=>K.num_likes))??[0]);let V=q>0?Y.responses.findIndex(K=>K.num_likes===q):Y.responses.findIndex(K=>K.highest_fidelity);V=Math.max(0,V);const Q=oe.GENERATION.replace(":request_id",Y.request_id).replace(":image_index",V.toString());E({...mt(Q),generation:Y,notificationState:{notifications:a,scrollPosition:O()}})}else if(u==="BADGE"&&A)E({...mt(A),notificationState:{notifications:a,scrollPosition:O()}});else if(u==="FOLLOW"&&h&&h.length&&A)h.length>1?E({...mt(A),notificationState:{notifications:a,scrollPosition:O()}}):E({...mt(oe.PROFILE.replace(":uhandle",h[0].display_handle)),notificationState:{notifications:a,scrollPosition:O()}});else if(u==="REACTION"&&x&&y){const Y=(X=x.responses)==null?void 0:X.findIndex(V=>V.response_id===y),q=oe.GENERATION.replace(":request_id",x.request_id).replace(":image_index",(Y!==void 0&&Y!==-1?Y:0).toString());E({...mt(q),generation:x,notificationState:{notifications:a,scrollPosition:O()}})}else u==="ANNOUNCEMENT"&&m&&((W=window.open(m,"_blank"))==null||W.focus())},[e,u,L,x,_,A,h,y,m,E,a,O]);return!ee||!M||B(c)?null:r.jsxs(bP,{sx:o?{}:{borderBottomStyle:"solid",borderBottomWidth:.5,borderBottomColor:f("borderHighlight"),backgroundColor:u==="ORGANIZATION_INVITE"?f("primaryBackground"):"unset"},onClick:()=>te(),children:[r.jsx(vP,{children:M}),r.jsxs(yP,{sx:{cursor:gP.includes(u)&&!m?void 0:"pointer"},children:[r.jsxs(C,{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",children:[r.jsxs(C,{display:"flex",flexDirection:"column",width:"100%",children:[h&&h.length>0&&(u==="REACTION"||u==="FOLLOW")&&r.jsx(_P,{children:h.slice(0,24).map($=>r.jsx(CP,{children:r.jsx(Ca,{title:$.display_handle,slotProps:{tooltip:{sx:{backgroundColor:f("revertBackdrop"),color:f("background")}}},PopperProps:{modifiers:[{name:"offset",options:{offset:[0,-8]}}]},children:r.jsx("a",{href:oe.PROFILE.replace(":uhandle",$.display_handle),onClick:X=>{X.preventDefault(),X.stopPropagation(),e({eventKey:"NOTIFICATION_USER_PROFILE_CLICK",metaData:{notificationType:u}}),L(),E({...mt(oe.PROFILE.replace(":uhandle",$.display_handle)),notificationState:{notifications:a,scrollPosition:O()}})},children:r.jsx(Ml,{src:$.photo_url})})})},`user_${$.display_handle}`))}),ee]}),u==="REACTION"&&T]}),r.jsx(xP,{children:td(w)})]}),r.jsx(wP,{children:d&&r.jsx(B0,{sx:{fontSize:8},htmlColor:f("active")})})]})},xP=b(le)(()=>({fontSize:10,color:f("informative"),textAlign:"end",marginTop:2})),vP=b(C)({display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:8,paddingRight:8,height:32}),yP=b(C)({flex:1,display:"flex",flexDirection:"column",paddingLeft:8,paddingRight:8}),wP=b(C)({width:8,height:8,alignSelf:"center",display:"flex",alignItems:"center",justifyContent:"center"}),bP=b(C)({width:"100%",paddingBottom:8,paddingTop:20,display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between",paddingLeft:8,paddingRight:8}),Ji=b("span")(()=>({fontWeight:600})),Ml=b("img")(()=>({width:40,height:40,borderRadius:20,backgroundColor:f("secondary"),objectFit:"cover"})),CP=b(C)({paddingRight:8,width:"fit-content",paddingBottom:8}),_P=b(C)({display:"flex",flexDirection:"row",flexWrap:"wrap",maxWidth:400}),wn=b(le)(()=>({fontSize:14,color:f("primary")})),Gn=b(C)({display:"flex",flexDirection:"row",alignItems:"center"}),kp=b(C)({height:48,display:"flex",flexDirection:"row",alignItems:"center"}),IP=b("img")(()=>({maxWidth:64,maxHeight:64,borderRadius:4,marginLeft:12,backgroundColor:f("secondary")})),Ap=b("img")(()=>({width:"100%",cursor:"pointer",background:"transparent",borderColor:"transparent",borderRadius:2,backgroundColor:f("secondary")})),V0=b(Co)({display:"flex",flexDirection:"row",width:"100%",maxWidth:400,alignItems:"center",marginTop:24,marginBottom:8}),SP=b(V0)({maxWidth:320}),RP=t=>{const{notifications:e,paperRef:n,loadingNextPageNotification:o,loadNotificationNextPage:i,notificationPageEndReached:a,isFetchingNotifications:s,closeNotificationPopUp:c}=t,d=we(),u=xe(d.breakpoints.down("md")),h=l.useRef(null),p=Y3(h,{rootMargin:"0px",threshold:0});return l.useEffect(()=>{p&&e!==void 0&&!o&&!a&&i()},[p,e,i,o,a]),u&&s?r.jsx(C,{minHeight:u?"100.1dvh":void 0,children:r.jsx(C,{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",paddingY:3,children:r.jsx(co,{size:20,color:"primary"})})}):r.jsxs(C,{minHeight:u?"100.1dvh":void 0,children:[!pt(oe.NOTIFICATIONS,window.location.pathname)&&r.jsx(EP,{children:r.jsx(TP,{children:"Notifications"})}),(!e||e.length===0)&&r.jsx(kP,{children:"No notifications yet."}),e==null?void 0:e.map((g,m)=>r.jsx(mP,{notification:g,last:e.length===m+1,paperRef:n,notifications:e,closeNotificationPopUp:c},`notification-${m}`)),o&&r.jsx(C,{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",paddingY:3,children:r.jsx(co,{size:20,color:"primary"})}),r.jsx(C,{height:8,ref:h})]})},TP=b(le)(()=>({fontSize:14,fontWeight:700,color:f("primary")})),EP=b(C)({width:"100%",display:"flex",justifyContent:"space-between",padding:16,paddingBottom:8,paddingRight:4}),kP=b(le)(()=>({textAlign:"center",marginTop:32,fontSize:12,color:f("informative")})),K0=t=>{const{open:e,close:n,notificationBellButtonRef:o,notifications:i,loadingNextPageNotification:a,loadNotificationNextPage:s,notificationPageEndReached:c,isFetchingNotifications:d}=t,u=l.useRef(null),{getBrowsingData:h}=l.useContext($e),{bannerHeight:p}=l.useContext(zo);return l.useEffect(()=>{const g=m=>{m.stopPropagation(),(!u.current||!u.current.contains(m.target))&&(!(o!=null&&o.current)||!(o!=null&&o.current.contains(m.target)))&&n()};return document.addEventListener("mousedown",g),()=>{document.removeEventListener("mousedown",g)}},[n,o]),l.useEffect(()=>{var g,m;(m=(g=h())==null?void 0:g.notificationState)!=null&&m.scrollPosition&&u.current&&u.current.scrollBy(0,-1*h().notificationState.scrollPosition+u.current.offsetTop)},[h]),e?r.jsx(Ia,{children:r.jsx(ri,{open:e,sx:{zIndex:g=>g.zIndex.drawer+136,backgroundColor:"transparent"},onClick:n,children:r.jsx(AP,{ref:u,sx:{top:8+p},children:r.jsx(RP,{notifications:i,paperRef:u,loadingNextPageNotification:a,loadNotificationNextPage:s,notificationPageEndReached:c,isFetchingNotifications:d,closeNotificationPopUp:n})})})}):null},AP=b(Ir)(()=>({position:"fixed",overscrollBehavior:"contain",overflow:"auto",backgroundColor:f("menuBackground"),minWidth:480,maxWidth:480,borderRadius:"12px",boxShadow:"0px 4px 6px -1px rgba(9, 9, 11, 0.10), 0px 2px 4px -2px rgba(9, 9, 11, 0.10)",outlineColor:f("borderHighlight"),outlineStyle:"solid",outlineWidth:.5,left:88,bottom:8})),J0=t=>{var A,D;const e=we(),n=xe(e.breakpoints.down("md")),{openNotification:o}=t,{userProfileState:i}=l.useContext(ge),{getBrowsingData:a,setNotifications:s,getNotificationPage:c,setNotificationPage:d}=l.useContext($e),{data:u,refetch:h,isFetching:p}=Ve(["fetchNotifications"],()=>Ep(),{enabled:!!i,staleTime:6e4,refetchInterval:6e4,retry:3}),[g,m]=l.useState((D=(A=a())==null?void 0:A.notificationState)==null?void 0:D.notifications),v=l.useRef(c()),[x,y]=l.useState(!1),[_,w]=l.useState(!1),I=l.useCallback(async()=>{y(!0);const O=await Ep(v.current);O.length===0?w(!0):(m([...g??[],...O]),d(v.current+1),v.current=v.current+1),y(!1)},[g,d]),R=l.useCallback(()=>{u&&u.length>0&&cP(u[0].notificationId)},[u]);l.useEffect(()=>{(!o||g===void 0)&&m(u)},[g,u,o]),l.useEffect(()=>{o&&(s(g),R())},[o,g,s,R]);const S=l.useCallback(()=>{v.current=1,w(!1),d(1),s(void 0),m(void 0),h()},[w,d,s,m,h]),E=l.useMemo(()=>(u==null?void 0:u.filter(O=>O.isNewNotification).length)??0,[u]);l.useEffect(()=>()=>{n&&E&&S()},[n,E,S]);const N=l.useRef(!0);l.useEffect(()=>{!o&&!N.current&&S(),N.current=!1},[o,S]);const k=l.useMemo(()=>{const[O,L]=es.partition(g,P=>P.notificationType==="ORGANIZATION_INVITE");return[...O,...L]},[g]);return{notificationCount:E,notificationState:k,loadingNextPageNotification:x,loadNotificationNextPage:I,notificationPageEndReached:_,resetNotificationState:S,isFetchingNotifications:p}};function X0({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??20,height:e??20,fill:"none",viewBox:"0 0 20 20",children:r.jsx("g",{children:r.jsx("path",{fill:n??"inherit",d:"M10 2a8 8 0 110 16 8 8 0 010-16zm3.358 5.646a.5.5 0 00-.637-.057l-.07.057L9 11.298 7.354 9.651l-.07-.058a.5.5 0 00-.695.696l.057.07 2 2 .07.057a.5.5 0 00.568 0l.07-.058 4.004-4.004.058-.07a.5.5 0 00-.058-.638z"})})})}const jP=t=>{const{percentage:e}=t,n=2,o=4,i=20,a=600,[s,c]=l.useState(e);l.useEffect(()=>{const m=s>e?0:s,v=e-m,x=performance.now(),y=_=>{const w=_-x,I=Math.min(w/a,1),R=m+v*I;c(R),I<1&&requestAnimationFrame(y)};requestAnimationFrame(y)},[e,a]);const d=i/2-n/2,u=2*Math.PI*d,h=2*o,p=s/100*u-o,g=u-p-h;return s<8?r.jsx("svg",{width:i,height:i,viewBox:`0 0 ${i} ${i}`,children:r.jsx("circle",{cx:i/2,cy:i/2,r:d,fill:"transparent",stroke:f("progressBase"),strokeWidth:n,strokeDasharray:`${u} 0`,strokeLinecap:"round",transform:`rotate(-90 ${i/2} ${i/2})`})}):s>92?r.jsx("svg",{width:i,height:i,viewBox:`0 0 ${i} ${i}`,children:r.jsx("circle",{cx:i/2,cy:i/2,r:d,fill:"transparent",stroke:f("primary"),strokeWidth:n,strokeDasharray:`${u} 0`,strokeLinecap:"round",transform:`rotate(-90 ${i/2} ${i/2})`})}):r.jsxs("svg",{width:i,height:i,viewBox:`0 0 ${i} ${i}`,children:[r.jsx("circle",{cx:i/2,cy:i/2,r:d,fill:"transparent",stroke:f("primary"),strokeWidth:n,strokeDasharray:`${p} ${u-p}`,strokeDashoffset:-o/2,strokeLinecap:"round",transform:`rotate(-90 ${i/2} ${i/2})`}),r.jsx("circle",{cx:i/2,cy:i/2,r:d,fill:"transparent",stroke:f("progressBase"),strokeWidth:n,strokeDasharray:`${g} ${u-g}`,strokeDashoffset:-(p+o+o/2),strokeLinecap:"round",transform:`rotate(-90 ${i/2} ${i/2})`})]})},Y0=()=>{const{inSessionGenerations:t}=l.useContext(ye),e=l.useMemo(()=>t.filter(a=>!a.data.generation.job_id||a.data.generation.has_started),[t]),n=l.useCallback(()=>{let a=0;if(e.every(s=>s.stage===Ft.DONE||s.data.generation.is_completed))a=100;else{const s=e.filter(c=>c.stage===Ft.INTERMEDIATE&&c.data.generation.has_started&&!c.data.generation.is_completed);s.length&&(a=Math.max(...s.map(c=>c.data.generation.completion_percentage??0)))}return{percentage:a,total:e.length,unfinishedCount:e.filter(s=>s.stage!==Ft.DONE).length}},[e]),[o,i]=l.useState(n());return l.useEffect(()=>{i(n())},[n]),o.total<=0?null:r.jsx(PP,{children:o.percentage>=100?r.jsx(X0,{color:f("toggleSuccess"),width:26,height:26}):r.jsxs(r.Fragment,{children:[r.jsx(jP,{percentage:o.percentage}),r.jsx(MP,{children:o.unfinishedCount})]})})},PP=b(C)({width:22,height:22,display:"flex",alignItems:"center",justifyContent:"center",position:"relative"}),MP=b(le)(()=>({color:f("primary"),textAlign:"center",fontSize:"10px",fontStyle:"normal",fontWeight:800,lineHeight:"16px",letterSpacing:"-0.4px",position:"absolute",width:22,height:22,padding:"3px",top:0,left:0}));function Ud({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",children:r.jsx("path",{fill:n??"inherit",d:"M19.79 13.267a.75.75 0 00-1.085-1.034l-5.955 6.251V3.75a.75.75 0 00-1.5 0v14.734l-5.955-6.251a.75.75 0 00-1.086 1.034l7.067 7.42c.16.168.366.268.58.3a.754.754 0 00.29-.001.995.995 0 00.578-.3l7.067-7.419z"})})}function Gd({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",children:r.jsx("path",{fill:n??"inherit",d:"M4.21 10.733a.75.75 0 001.086 1.034l5.954-6.251V20.25a.75.75 0 001.5 0V5.516l5.955 6.251a.75.75 0 001.086-1.034l-7.067-7.42a.995.995 0 00-.58-.3.754.754 0 00-.29.001.995.995 0 00-.578.3L4.21 10.733z"})})}const Tc=t=>r.jsxs(C,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:[r.jsx(le,{fontSize:14,children:t.description}),t.shortcutProps&&r.jsxs(r.Fragment,{children:[r.jsx(C,{width:8})," ",r.jsx(OP,{...t.shortcutProps})]})]}),OP=t=>{const{keyName:e,keyString:n,keyStringArray:o}=t,i=l.useMemo(()=>e==="up"?r.jsx(Gd,{color:f("shortcutIcon"),width:10,height:10}):e==="down"?r.jsx(Ud,{color:f("shortcutIcon"),width:10,height:10}):e==="space"?"Space":null,[e]),a=o??(n?n.split(""):void 0);return a?r.jsx(r.Fragment,{children:a.map((s,c)=>r.jsx(jp,{marginLeft:c===0?0:.5,width:s.length===1?16:void 0,children:s},s))}):r.jsx(jp,{width:e==="space"?void 0:16,children:i})},jp=b(C)(()=>({height:16,display:"flex",alignItems:"center",justifyContent:"center",borderWidth:1,borderStyle:"solid",color:f("shortcutIcon"),borderColor:f("shortcutBorder"),backgroundColor:f("shortcutBackground"),borderRadius:4,boxShadow:"box-shadow: 0px 2px 0px 0px #09090B08",padding:"2px 4px",fontSize:12})),Oo=l.forwardRef((t,e)=>{const{label:n,icon:o,onClick:i,selected:a,shortcut:s,beta:c,paywallLock:d,hideTooltip:u,disabled:h,newLabel:p,showGenerationProgressBadge:g}=t;return r.jsx(Rt,{content:!h&&!u&&n&&!d?r.jsx(Tc,{description:n,shortcutProps:s}):null,placement:"right",size:"small",children:r.jsx(C,{ref:e,position:"relative",children:r.jsxs(LP,{disableRipple:!0,onClick:i,sx:{backgroundColor:a?`${f("quietButtonPressed")} !important`:void 0,width:n?64:44,height:n?64:44},disabled:h,children:[r.jsxs("div",{style:{position:"relative"},children:[o,d&&r.jsx(NP,{children:r.jsx(Wt,{})})]}),!!n&&r.jsx(BP,{children:n}),!!g&&r.jsx(Ol,{sx:{top:2,right:2},children:r.jsx(Y0,{})}),c&&r.jsx(Ol,{sx:{top:0,right:-4},children:r.jsx(S0,{})}),p&&r.jsx(Ol,{sx:{top:0,right:-4},children:r.jsx(R0,{})})]})})})});Oo.displayName="ToolButton";const BP=b(le)({color:"inherit",fontSize:"11px",fontWeight:600,lineHeight:"20px",letterSpacing:"-0.55px"}),LP=b(gt)(()=>({color:f("Interactive"),fill:f("Interactive"),"&:hover":{color:f("InteractiveHover"),fill:f("InteractiveHover"),backgroundColor:f("quietButtonHover")},"&:active":{fill:f("InteractiveActive"),color:f("InteractiveActive"),backgroundColor:f("quietButtonPressed")},"&.Mui-disabled":{opacity:1,fill:f("quietButtonTextDisabled"),color:f("quietButtonTextDisabled")},minWidth:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:0,marginTop:4,gap:4,position:"relative"})),NP=b("div")({position:"absolute",bottom:0,right:-12}),Ol=b("div")({position:"absolute"}),Ec=t=>{const{chosenOrganization:e,externalPhotoUrl:n,badge:o}=t,{isTeamBillingEnabled:i}=l.useContext(ge);return e===null?r.jsx(qa,{sx:{width:24,height:24},variant:"circular"}):r.jsxs(DP,{children:[r.jsx(ci,{size:"sm",src:n,badge:o}),i&&!e.isPersonalOrganization&&r.jsx(FP,{children:r.jsx(kd,{width:17.5,height:17.5,fontSize:10,name:e.name,hasBorder:!0,borderRadius:"4px"})})]})},DP=b(C)({display:"flex",alignItems:"center",justifyContent:"center",position:"relative"}),FP=b(C)({position:"absolute",right:-5,bottom:-5}),zP=()=>{var k;const t=Ee(),{userProfileState:e,profileLink:n,chosenOrganization:o,isTeamBillingEnabled:i}=l.useContext(ge),{getBrowsingData:a,navigate:s}=l.useContext($e),{externalPhotoUrl:c,badge:d}=e??{},u=Rn(),{uhandle:h}=an(),[p,g]=l.useState(!!((k=a())!=null&&k.notificationState)),[m,v]=l.useState(!1),{notificationState:x,loadingNextPageNotification:y,loadNotificationNextPage:_,notificationPageEndReached:w,isFetchingNotifications:I,notificationCount:R}=J0({openNotification:p}),S=l.useRef(null),E=l.useMemo(()=>Ba(u.pathname)&&h===(e==null?void 0:e.displayHandle),[u.pathname,h,e==null?void 0:e.displayHandle]),N=l.useMemo(()=>o!=null&&o.isPersonalOrganization?E:AI(u.pathname),[o==null?void 0:o.isPersonalOrganization,E,u.pathname]);return r.jsxs(UP,{children:[r.jsx(GP,{badgeContent:R>99?"99+":R,overlap:"circular",children:r.jsx(Oo,{icon:r.jsx(x0,{width:22,height:22}),selected:p,onClick:()=>g(!p),ref:S})}),i?r.jsx(Oo,{icon:r.jsx(Ec,{chosenOrganization:o,externalPhotoUrl:c,badge:d}),selected:!!m,onClick:()=>{t({eventKey:"SETTING_NAV_CLICK"}),v(!m)}}):r.jsxs(r.Fragment,{children:[r.jsx(Oo,{icon:r.jsx(Ec,{chosenOrganization:o,externalPhotoUrl:c,badge:d}),selected:N,onClick:()=>{t({eventKey:"PROFILE_NAV_CLICK"}),o!=null&&o.isPersonalOrganization?n&&s(n):s(oe.TEAM_BILLING)}}),r.jsx(Oo,{icon:m?r.jsx(v0,{}):r.jsx(y0,{}),selected:!!m,onClick:()=>{t({eventKey:"SETTING_NAV_CLICK"}),v(!m)}})]}),p&&r.jsx(K0,{open:p,close:()=>{p&&t({eventKey:"NOTIFICATION_CLOSE"}),g(!1)},notificationBellButtonRef:S,notifications:x,loadingNextPageNotification:y,loadNotificationNextPage:_,notificationPageEndReached:w,isFetchingNotifications:I}),!!m&&(i?r.jsx(w0,{children:r.jsx(j0,{open:m,close:()=>{v(!1)}})}):r.jsx(A0,{open:m,close:()=>{v(!1)}}))]})},UP=b(C)({width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingBottom:8}),GP=b(qc)(()=>({"& .MuiBadge-badge":{color:"#fff",backgroundColor:f("IdeogramPink"),width:20,height:20,borderRadius:12,fontFamily:"Manrope, sans-serif",fontWeight:600,lineHeight:"20px",letterSpacing:"-0.36px",fontSize:12,top:12,right:12,minWidth:0,pointerEvents:"none"}}));function hs({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??22,height:e??22,fill:n??"inherit",viewBox:"0 0 22 22",children:r.jsx("g",{children:r.jsxs("g",{fill:n??"inherit",children:[r.jsx("path",{d:"M13.616 15.717a2.59 2.59 0 01.628 1.022l.41 1.262a.498.498 0 00.941 0l.41-1.262a2.6 2.6 0 011.649-1.647l1.263-.41a.5.5 0 000-.94l-.025-.007-1.263-.41a2.601 2.601 0 01-1.648-1.647l-.41-1.262a.498.498 0 00-.942 0l-.41 1.262-.01.031a2.6 2.6 0 01-1.613 1.616l-1.263.41a.499.499 0 000 .94l1.263.41c.384.128.734.345 1.02.632zm6.567 3.5l.701.228.014.004a.278.278 0 010 .522l-.701.228a1.447 1.447 0 00-.916.915l-.228.701a.277.277 0 01-.523 0l-.228-.701a1.445 1.445 0 00-.915-.919l-.702-.227a.278.278 0 01-.134-.421.278.278 0 01.134-.102l.702-.227a1.446 1.446 0 00.901-.916l.228-.7a.277.277 0 01.523 0l.228.7a1.444 1.444 0 00.916.916z"}),r.jsx("path",{d:"M4.812 1.833c.38 0 .688.308.688.688v1.604h11V2.52a.688.688 0 011.375 0v1.604h1.604a.687.687 0 110 1.375h-1.604v4.583a.688.688 0 01-1.375 0V5.5h-11v11h6.875a.687.687 0 110 1.375H5.5v1.604a.688.688 0 01-1.375 0v-1.604H2.52a.688.688 0 010-1.375h1.604v-11H2.52a.688.688 0 010-1.375h1.604V2.52c0-.38.308-.688.687-.688z"})]})})})}function Q0({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherits",viewBox:"0 0 24 24",children:r.jsx("path",{fill:n??"inherits",d:"M13.45 2.533a2.25 2.25 0 00-2.9 0L3.8 8.228a2.25 2.25 0 00-.8 1.72v9.305c0 .966.784 1.75 1.75 1.75h3a1.75 1.75 0 001.75-1.75V15.25c0-.68.542-1.232 1.217-1.25h2.566a1.25 1.25 0 011.217 1.25v4.003c0 .966.784 1.75 1.75 1.75h3a1.75 1.75 0 001.75-1.75V9.947a2.25 2.25 0 00-.8-1.72l-6.75-5.694z"})})}function Z0({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherits",viewBox:"0 0 24 24",children:r.jsx("path",{fill:n??"inherits",d:"M10.55 2.532a2.25 2.25 0 012.9 0l6.75 5.692c.507.428.8 1.057.8 1.72v9.31a1.75 1.75 0 01-1.75 1.75h-3.5a1.75 1.75 0 01-1.75-1.75v-5.007a.25.25 0 00-.25-.25h-3.5a.25.25 0 00-.25.25v5.007a1.75 1.75 0 01-1.75 1.75h-3.5A1.75 1.75 0 013 19.254v-9.31c0-.663.293-1.292.8-1.72l6.75-5.692zm1.933 1.147a.75.75 0 00-.966 0L4.767 9.37a.75.75 0 00-.267.573v9.31c0 .138.112.25.25.25h3.5a.25.25 0 00.25-.25v-5.007c0-.967.784-1.75 1.75-1.75h3.5c.966 0 1.75.783 1.75 1.75v5.007c0 .138.112.25.25.25h3.5a.25.25 0 00.25-.25v-9.31a.75.75 0 00-.267-.573l-6.75-5.692z"})})}function e1({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",children:r.jsx("g",{children:r.jsx("path",{fill:n??"inherit",d:"M13.748 8.996a1.248 1.248 0 100-2.496 1.248 1.248 0 000 2.496zM6.25 3A3.25 3.25 0 003 6.25v9a3.25 3.25 0 003.25 3.25h9a3.25 3.25 0 003.25-3.25v-9A3.25 3.25 0 0015.25 3h-9zM4.5 6.25c0-.966.784-1.75 1.75-1.75h9c.966 0 1.75.784 1.75 1.75v9c0 .231-.045.452-.126.654l-4.587-4.291a2.25 2.25 0 00-3.074 0l-4.587 4.29a1.745 1.745 0 01-.126-.653v-9zm6.762 6.458l4.505 4.214c-.163.05-.337.078-.517.078h-9c-.18 0-.354-.027-.517-.078l4.504-4.214a.75.75 0 011.025 0zM8.75 21a3.247 3.247 0 01-2.74-1.5h9.74a3.75 3.75 0 003.75-3.75V6.011a3.248 3.248 0 011.5 2.74v7C21 18.65 18.65 21 15.75 21h-7z"})})})}function t1({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,viewBox:"0 0 24 24",children:r.jsx("g",{children:r.jsx("path",{fill:n??"inherit",d:"M3 6.25A3.25 3.25 0 016.25 3h9a3.25 3.25 0 013.25 3.25v9c0 .646-.189 1.248-.514 1.755l-5.692-5.376a2.25 2.25 0 00-3.09 0l-5.69 5.375A3.235 3.235 0 013 15.25v-9zm10.747 2.746a1.248 1.248 0 100-2.496 1.248 1.248 0 000 2.496zm-2.483 3.724l5.642 5.327a3.235 3.235 0 01-1.656.453h-9a3.235 3.235 0 01-1.656-.453l5.64-5.327a.75.75 0 011.03 0zM8.75 21a3.247 3.247 0 01-2.74-1.5h9.74a3.75 3.75 0 003.75-3.75V6.011a3.247 3.247 0 011.5 2.74v7c0 2.899-2.35 5.25-5.25 5.25h-7z"})})})}const HP=()=>{const t=Rn(),e=Ee(),{tab:n}=an(),{navigate:o,setHomePageTab:i}=l.useContext($e),{openCanvas:a}=l.useContext(ye),{isBatchGenerationEnabled:s}=l.useContext(ge),c=l.useMemo(()=>Bn(t.pathname)&&(n===Ae.explore||n===Ae.labelling),[t.pathname,n]),d=l.useCallback(()=>{c||(Bn(window.location.pathname)?i(Ae.explore):o(oe.HOME_TAB.replace(":tab",Ae.explore)))},[c,o,i]),u=l.useMemo(()=>Bn(t.pathname)&&n===Ae.my_images,[t.pathname,n]),h=l.useCallback(()=>{u||(Bn(window.location.pathname)?i(Ae.my_images):o(oe.HOME_TAB.replace(":tab",Ae.my_images)))},[u,o,i]),p=l.useMemo(()=>kI(t.pathname),[t.pathname]),g=l.useCallback(()=>{p||o(oe.BATCH_GENERATION)},[p,o]);return r.jsxs(qP,{children:[r.jsx(Oo,{icon:c?r.jsx(Q0,{width:22,height:22}):r.jsx(Z0,{width:22,height:22}),label:"Home",selected:c,onClick:d,hideTooltip:!0}),r.jsx(Oo,{icon:u?r.jsx(t1,{width:22,height:22}):r.jsx(e1,{width:22,height:22}),label:"Creations",selected:u,onClick:h,hideTooltip:!0,showGenerationProgressBadge:!0}),r.jsx(Oo,{icon:r.jsx(hs,{width:22,height:22}),label:"Canvas",selected:!1,onClick:()=>{e({eventKey:"CANVAS_NAV_BAR_CLICK"}),a({})},hideTooltip:!0,beta:!0}),s&&r.jsx(Oo,{icon:r.jsx(D0,{width:22,height:22}),label:"Batch",selected:p,onClick:()=>{e({eventKey:"BATCH_GENERATION_NAV_BAR_CLICK"}),g()},hideTooltip:!0,newLabel:!0})]})},qP=b(C)({width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),WP=()=>r.jsxs(TA,{onMouseDown:t=>t.stopPropagation(),children:[r.jsx(EA,{onClick:()=>window.location.pathname=oe.HOME}),r.jsx(HP,{}),r.jsx(C,{flex:1}),r.jsx(zP,{})]}),$P=t=>{const e=we(),n=xe(e.breakpoints.down("lg")),{truncate:o,responsive:i,disableLink:a}=t,{userProfileState:s}=l.useContext(ge);return r.jsxs(VP,{fontSize:24,onClick:a?void 0:()=>window.location.href=s||rn()?oe.HOME:oe.LOGIN,sx:{cursor:a?void 0:"pointer",zIndex:c=>c.zIndex.drawer+130},children:[r.jsx(C,{marginRight:0,children:r.jsx(m0,{width:28,color:f("primary")})}),!(n&&i)&&r.jsx(Ni,{orientation:"horizontal",in:!o,timeout:0,children:r.jsx(KP,{style:o?{opacity:0,visibility:"hidden"}:{opacity:1,visibility:"visible"},children:"ideogram"})})]})},VP=b(C)(()=>({fontWeight:700,color:f("primary"),whiteSpace:"nowrap",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",paddingRight:8,fontFamily:"Manrope, sans-serif",letterSpacing:-1.5,pointerEvents:"auto"})),KP=b("span")({paddingLeft:8,transition:"opacity 0.05s, visibility 0.05s"}),Un=()=>r.jsx(C,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100dvh",sx:{backgroundColor:f("background")},children:r.jsx($P,{})});function Wa(){return(Wa=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function n1(t,e){if(t==null)return{};var n,o,i={},a=Object.keys(t);for(o=0;o<a.length;o++)e.indexOf(n=a[o])>=0||(i[n]=t[n]);return i}function kc(t){var e=l.useRef(t),n=l.useRef(function(o){e.current&&e.current(o)});return e.current=t,n.current}var Xi=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=1),t>n?n:t<e?e:t},Li=function(t){return"touches"in t},Ac=function(t){return t&&t.ownerDocument.defaultView||self},Pp=function(t,e,n){var o=t.getBoundingClientRect(),i=Li(e)?function(a,s){for(var c=0;c<a.length;c++)if(a[c].identifier===s)return a[c];return a[0]}(e.touches,n):e;return{left:Xi((i.pageX-(o.left+Ac(t).pageXOffset))/o.width),top:Xi((i.pageY-(o.top+Ac(t).pageYOffset))/o.height)}},Mp=function(t){!Li(t)&&t.preventDefault()},o1=tt.memo(function(t){var e=t.onMove,n=t.onKey,o=n1(t,["onMove","onKey"]),i=l.useRef(null),a=kc(e),s=kc(n),c=l.useRef(null),d=l.useRef(!1),u=l.useMemo(function(){var m=function(y){Mp(y),(Li(y)?y.touches.length>0:y.buttons>0)&&i.current?a(Pp(i.current,y,c.current)):x(!1)},v=function(){return x(!1)};function x(y){var _=d.current,w=Ac(i.current),I=y?w.addEventListener:w.removeEventListener;I(_?"touchmove":"mousemove",m),I(_?"touchend":"mouseup",v)}return[function(y){var _=y.nativeEvent,w=i.current;if(w&&(Mp(_),!function(R,S){return S&&!Li(R)}(_,d.current)&&w)){if(Li(_)){d.current=!0;var I=_.changedTouches||[];I.length&&(c.current=I[0].identifier)}w.focus(),a(Pp(w,_,c.current)),x(!0)}},function(y){var _=y.which||y.keyCode;_<37||_>40||(y.preventDefault(),s({left:_===39?.05:_===37?-.05:0,top:_===40?.05:_===38?-.05:0}))},x]},[s,a]),h=u[0],p=u[1],g=u[2];return l.useEffect(function(){return g},[g]),tt.createElement("div",Wa({},o,{onTouchStart:h,onMouseDown:h,className:"react-colorful__interactive",ref:i,onKeyDown:p,tabIndex:0,role:"slider"}))}),Hd=function(t){return t.filter(Boolean).join(" ")},r1=function(t){var e=t.color,n=t.left,o=t.top,i=o===void 0?.5:o,a=Hd(["react-colorful__pointer",t.className]);return tt.createElement("div",{className:a,style:{top:100*i+"%",left:100*n+"%"}},tt.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:e}}))},sn=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=Math.pow(10,e)),Math.round(n*t)/n},JP=function(t){return eM(jc(t))},jc=function(t){return t[0]==="#"&&(t=t.substring(1)),t.length<6?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?sn(parseInt(t[3]+t[3],16)/255,2):1}:{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16),a:t.length===8?sn(parseInt(t.substring(6,8),16)/255,2):1}},XP=function(t){return ZP(QP(t))},YP=function(t){var e=t.s,n=t.v,o=t.a,i=(200-e)*n/100;return{h:sn(t.h),s:sn(i>0&&i<200?e*n/100/(i<=100?i:200-i)*100:0),l:sn(i/2),a:sn(o,2)}},Pc=function(t){var e=YP(t);return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},QP=function(t){var e=t.h,n=t.s,o=t.v,i=t.a;e=e/360*6,n/=100,o/=100;var a=Math.floor(e),s=o*(1-n),c=o*(1-(e-a)*n),d=o*(1-(1-e+a)*n),u=a%6;return{r:sn(255*[o,c,s,s,d,o][u]),g:sn(255*[d,o,o,c,s,s][u]),b:sn(255*[s,s,d,o,o,c][u]),a:sn(i,2)}},Ms=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},ZP=function(t){var e=t.r,n=t.g,o=t.b,i=t.a,a=i<1?Ms(sn(255*i)):"";return"#"+Ms(e)+Ms(n)+Ms(o)+a},eM=function(t){var e=t.r,n=t.g,o=t.b,i=t.a,a=Math.max(e,n,o),s=a-Math.min(e,n,o),c=s?a===e?(n-o)/s:a===n?2+(o-e)/s:4+(e-n)/s:0;return{h:sn(60*(c<0?c+6:c)),s:sn(a?s/a*100:0),v:sn(a/255*100),a:i}},tM=tt.memo(function(t){var e=t.hue,n=t.onChange,o=Hd(["react-colorful__hue",t.className]);return tt.createElement("div",{className:o},tt.createElement(o1,{onMove:function(i){n({h:360*i.left})},onKey:function(i){n({h:Xi(e+360*i.left,0,360)})},"aria-label":"Hue","aria-valuenow":sn(e),"aria-valuemax":"360","aria-valuemin":"0"},tt.createElement(r1,{className:"react-colorful__hue-pointer",left:e/360,color:Pc({h:e,s:100,v:100,a:1})})))}),nM=tt.memo(function(t){var e=t.hsva,n=t.onChange,o={backgroundColor:Pc({h:e.h,s:100,v:100,a:1})};return tt.createElement("div",{className:"react-colorful__saturation",style:o},tt.createElement(o1,{onMove:function(i){n({s:100*i.left,v:100-100*i.top})},onKey:function(i){n({s:Xi(e.s+100*i.left,0,100),v:Xi(e.v-100*i.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+sn(e.s)+"%, Brightness "+sn(e.v)+"%"},tt.createElement(r1,{className:"react-colorful__saturation-pointer",top:1-e.v/100,left:e.s/100,color:Pc(e)})))}),i1=function(t,e){if(t===e)return!0;for(var n in t)if(t[n]!==e[n])return!1;return!0},oM=function(t,e){return t.toLowerCase()===e.toLowerCase()||i1(jc(t),jc(e))};function rM(t,e,n){var o=kc(n),i=l.useState(function(){return t.toHsva(e)}),a=i[0],s=i[1],c=l.useRef({color:e,hsva:a});l.useEffect(function(){if(!t.equal(e,c.current.color)){var u=t.toHsva(e);c.current={hsva:u,color:e},s(u)}},[e,t]),l.useEffect(function(){var u;i1(a,c.current.hsva)||t.equal(u=t.fromHsva(a),c.current.color)||(c.current={hsva:a,color:u},o(u))},[a,t,o]);var d=l.useCallback(function(u){s(function(h){return Object.assign({},h,u)})},[]);return[a,d]}var iM=typeof window<"u"?l.useLayoutEffect:l.useEffect,sM=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},Op=new Map,aM=function(t){iM(function(){var e=t.current?t.current.ownerDocument:document;if(e!==void 0&&!Op.has(e)){var n=e.createElement("style");n.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,Op.set(e,n);var o=sM();o&&n.setAttribute("nonce",o),e.head.appendChild(n)}},[])},lM=function(t){var e=t.className,n=t.colorModel,o=t.color,i=o===void 0?n.defaultColor:o,a=t.onChange,s=n1(t,["className","colorModel","color","onChange"]),c=l.useRef(null);aM(c);var d=rM(n,i,a),u=d[0],h=d[1],p=Hd(["react-colorful",e]);return tt.createElement("div",Wa({},s,{ref:c,className:p}),tt.createElement(nM,{hsva:u,onChange:h}),tt.createElement(tM,{hue:u.h,onChange:h,className:"react-colorful__last-control"}))},cM={defaultColor:"000",toHsva:JP,fromHsva:function(t){return XP({h:t.h,s:t.s,v:t.v,a:1})},equal:oM},s1=function(t){return tt.createElement(lM,Wa({},t,{colorModel:cM}))},qd={},dM=pn;Object.defineProperty(qd,"__esModule",{value:!0});var Mc=qd.default=void 0,uM=dM(fn()),hM=r;Mc=qd.default=(0,uM.default)((0,hM.jsx)("path",{d:"m20.71 5.63-2.34-2.34a.9959.9959 0 0 0-1.41 0l-3.12 3.12-1.93-1.91-1.41 1.41 1.42 1.42L3 16.25V21h4.75l8.92-8.92 1.42 1.42 1.41-1.41-1.92-1.92 3.12-3.12c.4-.4.4-1.03.01-1.42M6.92 19 5 17.08l8.06-8.06 1.92 1.92z"}),"Colorize");var Wd={},pM=pn;Object.defineProperty(Wd,"__esModule",{value:!0});var a1=Wd.default=void 0,fM=pM(fn()),gM=r;a1=Wd.default=(0,fM.default)((0,gM.jsx)("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8"}),"Undo");var $d={},mM=pn;Object.defineProperty($d,"__esModule",{value:!0});var l1=$d.default=void 0,xM=mM(fn()),vM=r;l1=$d.default=(0,xM.default)((0,vM.jsx)("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7z"}),"Redo");var Vd={},yM=pn;Object.defineProperty(Vd,"__esModule",{value:!0});var c1=Vd.default=void 0,wM=yM(fn()),bM=r;c1=Vd.default=(0,wM.default)((0,bM.jsx)("path",{d:"M6 2.5V1h5v5H9.5V3.56L3.56 9.5H6V11H1V6h1.5v2.44L8.44 2.5zm15.89 11.27-3.8-1.67c-.13-.06-.28-.1-.44-.1H17V7.5C17 6.12 15.88 5 14.5 5S12 6.12 12 7.5v8.15l-1.87-.4c-.19-.03-1.02-.15-1.73.56L7 17.22l5.12 5.19c.37.38.88.59 1.41.59h6.55c.98 0 1.81-.7 1.97-1.67l.92-5.44c.15-.86-.29-1.72-1.08-2.12M20.08 21h-6.55l-3.7-3.78 4.17.89V7.5c0-.28.22-.5.5-.5s.5.22.5.5v6.18h1.76L21 15.56z"}),"PinchOutlined");var Kd={},CM=pn;Object.defineProperty(Kd,"__esModule",{value:!0});var d1=Kd.default=void 0,_M=CM(fn()),IM=r;d1=Kd.default=(0,_M.default)((0,IM.jsx)("path",{d:"M17 15h2V7c0-1.1-.9-2-2-2H9v2h8zM7 17V1H5v4H1v2h4v10c0 1.1.9 2 2 2h10v4h2v-4h4v-2z"}),"Crop");var Jd={},SM=pn;Object.defineProperty(Jd,"__esModule",{value:!0});var Xd=Jd.default=void 0,RM=SM(fn()),TM=r;Xd=Jd.default=(0,RM.default)((0,TM.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var Yd={},EM=pn;Object.defineProperty(Yd,"__esModule",{value:!0});var u1=Yd.default=void 0,kM=EM(fn()),AM=r;u1=Yd.default=(0,kM.default)((0,AM.jsx)("path",{d:"M19 13H5v-2h14z"}),"Remove");const h1=()=>{const[t,e]=l.useState(!0),n=l.useCallback(()=>{e(document.visibilityState==="visible")},[]);return l.useEffect(()=>(document.addEventListener("visibilitychange",n),()=>{document.removeEventListener("visibilitychange",n)}),[n]),t},jM=t=>{var en,Kn,ao,de,Pe;const e=we(),n=xe(e.breakpoints.down("md")),o=Ee(),{openDrawBoard:i,closeDrawBoard:a,imageUrl:s,isUpload:c,defaultPrivate:d}=t,{generationInput:u,setGenerationInput:h,imageEditState:p,handleDescribeImage:g,setShowRemixAspectRatioWarning:m}=l.useContext(ye),{hasAccessToEditor:v,subscriptionStatus:x}=l.useContext(ge),[y,_]=l.useState(!1),w=l.useRef(null),I=l.useRef(!1),[R,S]=l.useState("view"),[E,N]=l.useState(12),[k,A]=l.useState(!1),D=l.useRef(!1),O=l.useRef(!1),L=l.useRef(null),[P,G]=l.useState(null),[B,M]=l.useState("#000000"),[z,F]=l.useState(null),T=l.useRef([]),[j,Z]=l.useState(!0),ee=l.useRef([]),[te,$]=l.useState(-1),X=!!P,W=l.useRef(null),Y=l.useRef(!1),[q,V]=l.useState({x:0,y:0}),[Q,K]=l.useState(3),[ae,ce]=l.useState(null),[ve,se]=l.useState(((en=p.parentInfo)==null?void 0:en.aspect_ratio)??u.aspectRatio??"1:1"),[H,me]=l.useState(!!d),[ne,ue]=l.useState(!1);l.useEffect(()=>{var J,U;(J=p.parentInfo)!=null&&J.aspect_ratio&&h({...u,aspectRatio:(U=p.parentInfo)==null?void 0:U.aspect_ratio})},[(Kn=p.parentInfo)==null?void 0:Kn.aspect_ratio]);const fe=l.useCallback((J,U)=>{U&&ce(U)},[ce]),Se=l.useRef(""),je=l.useCallback(()=>{const J=te<0?0:te;if(!ee.current[J])return;const U=document.createElement("canvas");U.width=ee.current[J].fullImageData.width,U.height=ee.current[J].fullImageData.height;const pe=U.getContext("2d");pe&&(pe.putImageData(ee.current[J].fullImageData,0,0),Se.current=U.toDataURL())},[te]),qe=l.useCallback(()=>{var J,U,pe,Te,Ie;return((J=ee.current[te])==null?void 0:J.cropInfo)??{area:{x:0,y:0,width:(U=p.parentInfo)!=null&&U.aspect_ratio&&((pe=Hn[p.parentInfo.aspect_ratio])!=null&&pe.width)?Hn[p.parentInfo.aspect_ratio].width:Hn["1:1"].width,height:(Te=p.parentInfo)!=null&&Te.aspect_ratio&&((Ie=Hn[p.parentInfo.aspect_ratio])!=null&&Ie.height)?Hn[p.parentInfo.aspect_ratio].height:Hn["1:1"].height},aspectRatio:ve}},[te,ve,u.aspectRatio]),De=l.useCallback(J=>{var Ie,Ke,dt;const U=document.createElement("canvas"),pe=(Ie=ee.current[te])==null?void 0:Ie.fullImageData,Te=qe();if(pe){U.width=pe.width,U.height=pe.height;const ot=U.getContext("2d");return ot?(ot.putImageData(pe,0,0),ot.putImageData(J,Te.area.x,Te.area.y),{fullImageData:ot.getImageData(0,0,U.width,U.height),cropInfo:Te}):void 0}else{U.width=J.width*3,U.height=J.height*3;const ot=U.getContext("2d");return ot?(ot.fillStyle="#FFFFFF",ot.fillRect(0,0,U.width,U.height),ot.putImageData(J,J.width,J.height),{fullImageData:ot.getImageData(0,0,U.width,U.height),cropInfo:(Ke=ee.current[te])!=null&&Ke.cropInfo?Te:{area:{x:J.width,y:J.height,width:J.width,height:J.height},aspectRatio:((dt=p.parentInfo)==null?void 0:dt.aspect_ratio)??u.aspectRatio??"1:1"}}):void 0}},[qe,te,(ao=p.parentInfo)==null?void 0:ao.aspect_ratio]),Ye=l.useCallback(J=>{const U=document.createElement("canvas");U.width=J.fullImageData.width,U.height=J.fullImageData.height;const pe=U.getContext("2d");if(pe)return pe.putImageData(J.fullImageData,0,0),pe.getImageData(J.cropInfo.area.x,J.cropInfo.area.y,J.cropInfo.area.width,J.cropInfo.area.height)},[]),nt=l.useCallback(()=>{if(!W.current||!w.current)return;const J=W.current.getImageData(0,0,w.current.width,w.current.height),U=De(J);if(!U)return;const pe=ee.current.slice(Math.max(0,te-20),te+1);pe.push(U),ee.current=pe,$(pe.length-1)},[te,$,De]),ct=l.useCallback(()=>{if(W.current&&w.current&&te>0){const J=Ye(ee.current[te-1]);if(!J)return;w.current.width=ee.current[te-1].cropInfo.area.width,w.current.height=ee.current[te-1].cropInfo.area.height,W.current.putImageData(J,0,0),$(te-1),je()}},[te,$,Ye,je]),he=l.useCallback(()=>{if(W.current&&w.current&&te<ee.current.length-1){const J=Ye(ee.current[te+1]);if(!J)return;w.current.width=ee.current[te+1].cropInfo.area.width,w.current.height=ee.current[te+1].cropInfo.area.height,W.current.putImageData(J,0,0),$(te+1),je()}},[te,$,Ye,je]);l.useEffect(()=>{const J=U=>{U.code==="KeyZ"&&(U.ctrlKey||U.metaKey)&&U.shiftKey?(o({eventKey:"EDITOR_KEYBOARD_REDO"}),he()):U.code=="KeyZ"&&(U.ctrlKey||U.metaKey)&&(o({eventKey:"EDITOR_KEYBOARD_UNDO"}),ct())};return document.addEventListener("keydown",J),()=>{document.removeEventListener("keydown",J)}},[ct,he]);const Fe=l.useRef(1),Ge=l.useRef(!1),st=l.useCallback(async()=>{if(!w.current||I.current)return;const J=w.current;if(!(!W.current||W.current==null))if(ee.current.length===0){if(s)await(pe=>new Promise(Te=>{const Ie=new Image;Ie.src=pe,Ie.crossOrigin="Anonymous",Ie.onload=()=>{if(Ie.width>1280||Ie.height>1280){const Ke=1280/Math.max(Ie.width,Ie.height);J.width=Math.floor(Ie.width*Ke),J.height=Math.floor(Ie.height*Ke)}else J.width=Ie.width,J.height=Ie.height;Fe.current=Ie.height/Ie.width,W.current.drawImage(Ie,0,0,J.width,J.height),Te()}}))(s);else{const U=Hn[u.aspectRatio??"1:1"];J.width=U.width,J.height=U.height,W.current.fillStyle="#FFFFFF",W.current.fillRect(0,0,U.width,U.height)}if(nt(),!s)ee.current[0].cropInfo.aspectRatio=u.aspectRatio??"1:1",se(u.aspectRatio??"1:1");else{const U=(J.width/J.height).toFixed(3);if(dr[U])ee.current[0].cropInfo.aspectRatio=dr[U],se(dr[U]);else{Ge.current=!0;const pe=Ug(U);je(),se(dr[pe]),S("crop")}}I.current=!0,Z(!1)}else{const U=Ye(ee.current[te]);U&&(J.width=U.width,J.height=U.height,W.current.putImageData(U,0,0)),I.current=!0}},[s,nt,Ye,u.aspectRatio]);l.useEffect(()=>{u.aspectRatio!==ve&&R==="crop"&&h({...u,aspectRatio:ve})},[ve,u,h,R]);const bt=l.useCallback((J,U)=>{if(!W.current)return;const pe=W.current.getImageData(J,U,1,1).data,Te=`#${cl(pe[0].toString(16))}${cl(pe[1].toString(16))}${cl(pe[2].toString(16))}`;F(Te)},[F,z]),En=l.useCallback(()=>{o({eventKey:"EDITOR_COLOR_PICK_COMMIT"}),z!==null&&(M(z),F(null),S("draw"))},[z]),We=l.useCallback((J,U)=>{W.current&&(W.current.fillStyle=B,T.current.includes(B)||T.current.push(B),W.current.beginPath(),W.current.arc(J,U,E/2,0,Math.PI*2,!0),W.current.closePath(),W.current.fill(),O.current=!0,Y.current=!0)},[E,B]),vt=l.useCallback((J,U)=>{!D.current||!W.current||R!=="draw"||(L.current!==null&&(n&&We(L.current.x,L.current.y),W.current.beginPath(),W.current.lineWidth=E,W.current.strokeStyle=B,W.current.moveTo(L.current.x,L.current.y),W.current.lineTo(J,U),W.current.stroke()),We(J,U),L.current={x:J,y:U})},[n,We,R,E,B]),Qt=l.useCallback((J,U)=>{if(U&&(D.current=!0),!w.current||X)return;const pe=w.current.getBoundingClientRect(),Te=pe.right-pe.left,Ie=pe.bottom-pe.top,Ke=J.clientX-pe.left,dt=J.clientY-pe.top,ot=Ke*(w.current.width/Te),jt=dt*(w.current.height/Ie);z!==null&&!U?bt(ot,jt):R==="draw"&&(U?(L.current={x:ot,y:jt},We(ot,jt)):vt(ot,jt))},[bt,We,vt,z,X]),kt=l.useCallback((J,U)=>{if(J.preventDefault(),U&&(D.current=!0),!w.current||J.touches.length>1)return;const pe=w.current.getBoundingClientRect(),Te=pe.right-pe.left,Ie=pe.bottom-pe.top,Ke=J.touches[0].clientX-pe.left,dt=J.touches[0].clientY-pe.top,ot=Ke*(w.current.width/Te),jt=dt*(w.current.height/Ie);z!==null?bt(ot,jt):R==="draw"&&(U?L.current={x:ot,y:jt}:vt(ot,jt))},[bt,vt,R,z]),Ct=l.useCallback(()=>{D.current&&(o(R==="draw"?{eventKey:"EDITOR_DRAW_STROKE"}:{eventKey:"EDITOR_PAN_CANVAS"}),D.current=!1,L.current=null,O.current&&nt()),O.current=!1,je()},[nt,je,R]);l.useEffect(()=>(document.body.style.overflow="hidden",document.body.style.height="100dvh",()=>{document.body.style.overflow="unset",document.body.style.height="unset"}),[]);const so=l.useCallback(()=>{L.current=null},[]);l.useEffect(()=>{var pe;if(!w.current||!i||(W.current=(pe=w.current)==null?void 0:pe.getContext("2d",{willReadFrequently:!0}),!W.current))return;st();const J=Te=>{z!==null?En():Te.buttons===1&&Qt(Te,!0)},U=Te=>kt(Te,!0);return w.current.addEventListener("mousedown",J),w.current.addEventListener("mousemove",Qt),w.current.addEventListener("mouseleave",so),w.current.addEventListener("touchstart",U),w.current.addEventListener("touchmove",kt),()=>{var Te,Ie,Ke,dt,ot;(Te=w.current)==null||Te.removeEventListener("mousedown",J),(Ie=w.current)==null||Ie.removeEventListener("mousemove",Qt),(Ke=w.current)==null||Ke.removeEventListener("mouseleave",so),(dt=w.current)==null||dt.removeEventListener("touchstart",U),(ot=w.current)==null||ot.removeEventListener("touchmove",kt)}},[st,i,Qt,kt,En]);const gn=l.useRef(R);l.useEffect(()=>{gn.current==="crop"&&R!=="crop"?st():R==="crop"&&(I.current=!1),gn.current=R},[R,st]),l.useEffect(()=>{const J=()=>{z?En():Ct()},U=pe=>{if(pe.preventDefault(),o({eventKey:"EDITOR_RIGHT_CLICK_COLOR_PICK"}),!w.current||X)return;const Te=w.current.getBoundingClientRect(),Ie=Te.right-Te.left,Ke=Te.bottom-Te.top,dt=pe.clientX-Te.left,ot=pe.clientY-Te.top,jt=dt*(w.current.width/Ie),To=ot*(w.current.height/Ke);bt(jt,To),S("draw"),Ct()};return document.addEventListener("mouseup",Ct),document.addEventListener("contextmenu",U),document.addEventListener("touchend",J),()=>{document.removeEventListener("mouseup",Ct),document.removeEventListener("contextmenu",U),document.removeEventListener("touchend",J)}},[Ct,z,En,F,S,bt]);const Dn=l.useCallback(async J=>{const{id:U}=J;if(U){const pe=qe();h({...u,aspectRatio:pe.aspectRatio,variation_input:{image_id:U,private:H},timestamp:Date.now(),imageParent:await Da(U)}),m(!1),p.parentInfo||g({image_id:U}),await No(Zr(U,"balanced")),a()}},[p.parentInfo,qe,h,u,No,Zr,a,H,g,m]),{mutateAsync:kn}=wo({mutationFn:Hg,onSuccess:Dn,onError:async J=>{J.status===403&&Lt(),Z(!1)},retryDelay:200,retry:(J,U)=>U.status===403&&J<5}),An=wo({mutationFn:vS,onSuccess:Dn,onError:async J=>{J.status===403&&Lt(),Z(!1)},retryDelay:200,retry:(J,U)=>U.status===403&&J<5}),Vn=l.useCallback(()=>{var J;(J=w.current)==null||J.toBlob(async U=>{if(U){const pe=new File([U],"name");Y.current||!c?An.mutateAsync({file:pe,metadata:{...p.parentInfo,private:H,aspect_ratio:qe().aspectRatio}}):kn({file:pe,aspect_ratio:qe().aspectRatio})}},"image/png")},[qe,H,p.parentInfo]),mn=l.useMemo(()=>{var J;return(J=p.parentInfo)!=null&&J.aspect_ratio?parseInt(p.parentInfo.aspect_ratio.split(":")[0])/parseInt(p.parentInfo.aspect_ratio.split(":")[1]):1},[(de=p.parentInfo)==null?void 0:de.aspect_ratio]),ln=l.useMemo(()=>{const J=qe();return J.area.width/J.area.height},[qe]),cn=l.useMemo(()=>parseInt(ve.split(":")[0])/parseInt(ve.split(":")[1]),[ve]),Fn=l.useMemo(()=>ln??mn,[ln,mn]),Zt=l.useRef(null),St=l.useMemo(()=>{var Te,Ie;if(!Zt.current)return;const J=(Te=Zt.current)==null?void 0:Te.offsetWidth,U=(Ie=Zt.current)==null?void 0:Ie.offsetHeight,pe=J/ln;return pe<U?{width:J,height:pe}:{width:U*ln,height:U}},[ln,j]),dn=l.useMemo(()=>{if(!St)return;const J=St==null?void 0:St.width,U=St==null?void 0:St.height,pe=J/cn;return pe<U?{width:J,height:pe}:{width:U*cn,height:U}},[cn,j,St]),[Dt,At]=l.useState({min:1,max:6});l.useEffect(()=>{if(R==="crop"&&dn&&St){const J=St.width,U=St.width*Fe.current,pe=J/dn.width;if(U/dn.height<pe){const Ie=dn.height/U;At({min:1*Ie,max:6*Ie})}else{const Ie=dn.width/J;At({min:1*Ie,max:6*Ie})}}},[R,Q,dn,Fn]),l.useEffect(()=>{Q<Dt.min&&K(Dt.min)},[Q,Dt.min]);const xn=l.useCallback(()=>{if(!ae)return;const J={fullImageData:ee.current[te].fullImageData,cropInfo:{area:ae,aspectRatio:ve}};if(W.current){const pe=Ye(J);if(!pe)return;W.current.putImageData(pe,0,0)}const U=ee.current.slice(Math.max(0,te-20),te+1);U.push(J),$(U.length-1),ee.current=U,Ge.current=!1},[ae,ve,Ye,te,$,S]),jn=l.useCallback(()=>{o({eventKey:"EDITOR_SAVE_CLICK"}),Z(!0),Vn()},[Z,Vn]);l.useEffect(()=>{const J=U=>{U.code==="Escape"&&(o({eventKey:"EDITOR_KEYBOARD_ESC"}),U.stopPropagation(),U.preventDefault(),a())};return document.addEventListener("keydown",J,!1),()=>{document.removeEventListener("keydown",J)}},[a]);const vn=h1(),Gt=l.useRef(!1);return l.useEffect(()=>{if(!vn&&!Gt.current)Gt.current=!0;else if(vn&&Gt.current){if(Gt.current=!1,!ee.current[te])return;const J=Ye(ee.current[te]);if(!J||!w.current||!W.current)return;w.current.width=ee.current[te].cropInfo.area.width,w.current.height=ee.current[te].cropInfo.area.height,W.current.putImageData(J,0,0)}},[vn,te]),{openDrawBoard:i,hasAccessToEditor:v,mode:R,loading:j,canvasSize:St,setPickingColor:F,setMode:S,handleCrop:xn,prevModeRef:gn,strokeSize:E,setStrokeSize:N,color:B,setAnchorEl:G,anchorEl:P,openColorSelect:X,usedColorsRef:T,setColor:M,growBoundRef:Zt,aspectRatioNumber:Fn,fullImageUrlRef:Se,crop:q,zoom:Q,croppingAspectRatio:ve,croppedAreaPixels:ae,setCrop:V,onCropComplete:fe,setZoom:K,zoomConfig:Dt,croppingSize:dn,pickingColor:z,canvasRef:w,generationInput:u,setCroppingAspectRatio:se,handleUndo:ct,redoUndoIndex:te,handleRedo:he,editStackRef:ee,handleDoneClick:jn,closeDrawBoard:a,savePrivate:H,setSavePrivate:me,privateAccess:(Pe=x==null?void 0:x.subscriptionQuota)==null?void 0:Pe.privateGeneration,showPrivateEditAd:y,setShowPrivateEditAd:_,fakePrivateSelection:ne,setFakePrivateSelection:ue,typedStrokeEmpty:k,setTypedStrokeEmpty:A,forceCropRef:Ge}},PM=t=>{var ne,ue;const e=we(),n=xe(e.breakpoints.down("md")),o=xe(e.breakpoints.down("sm")),i=Ee(),a=Nt(),{openDrawBoard:s,hasAccessToEditor:c,mode:d,loading:u,canvasSize:h,setPickingColor:p,setMode:g,handleCrop:m,prevModeRef:v,strokeSize:x,setStrokeSize:y,color:_,setAnchorEl:w,anchorEl:I,openColorSelect:R,setColor:S,growBoundRef:E,aspectRatioNumber:N,fullImageUrlRef:k,crop:A,zoom:D,croppingAspectRatio:O,croppedAreaPixels:L,setCrop:P,onCropComplete:G,setZoom:B,canvasRef:M,generationInput:z,setCroppingAspectRatio:F,handleUndo:T,redoUndoIndex:j,handleRedo:Z,editStackRef:ee,handleDoneClick:te,zoomConfig:$,pickingColor:X,croppingSize:W,closeDrawBoard:Y,savePrivate:q,setSavePrivate:V,privateAccess:Q,showPrivateEditAd:K,setShowPrivateEditAd:ae,fakePrivateSelection:ce,setFakePrivateSelection:ve,typedStrokeEmpty:se,setTypedStrokeEmpty:H,forceCropRef:me}=jM(t);return!s||!c?null:r.jsxs(BM,{sx:{backgroundColor:d==="crop"?"#fff":f("background"),zIndex:fe=>fe.zIndex.drawer+145,opacity:u||!h?0:1},children:[r.jsx(Np,{sx:n?{position:"fixed",top:0,padding:2,left:0,right:0}:{position:"relative",marginTop:1,marginBottom:1,padding:1,width:h==null?void 0:h.width,minWidth:520,borderRadius:1},onClick:()=>p(null),children:r.jsxs(Bl,{children:[r.jsxs(Zo,{width:128,value:d,exclusive:!0,size:"small",color:"primary",children:[r.jsx(on,{value:"crop",onClick:()=>{i({eventKey:"EDITOR_CROP_MODE_CLICK"}),g("crop")},disableRipple:!0,children:r.jsx(d1,{sx:{fontSize:18,marginX:.5}})}),r.jsx(on,{value:"view",onClick:()=>{i({eventKey:"EDITOR_VIEW_MODE_CLICK"}),v.current==="crop"&&m(),g("view")},disableRipple:!0,children:r.jsx(c1,{sx:{fontSize:18,marginX:.5}})}),r.jsx(on,{value:"draw",onClick:()=>{i({eventKey:"EDITOR_DRAW_MODE_CLICK"}),v.current==="crop"&&m(),g("draw")},disableRipple:!0,children:r.jsx(Bd,{sx:{fontSize:18,marginX:.5}})})]}),r.jsxs(Br,{onClick:()=>{d==="crop"&&m(),g("draw")},children:[!o&&r.jsxs(r.Fragment,{children:[r.jsx(Wc,{sx:{color:f("primary"),width:24,fontSize:13},inputProps:{style:{textAlign:"center",padding:0}},value:se?"":x.toString(),onChange:fe=>{const Se=fe.target.value,je=parseInt(Se.slice(Se.length-2,Se.length));Se===""&&H(!0),typeof je=="number"&&je>=1&&je<=99&&(i({eventKey:"EDITOR_STROKE_INPUT_COMMIT",metaData:{strokeSize:je}}),y(je),H(!1))}}),r.jsx(C,{width:8}),r.jsx(Wf,{min:1,max:100,value:x,onChangeCommitted:(fe,Se)=>{i({eventKey:"EDITOR_STROKE_SLIDER_COMMIT",metaData:{strokeSize:Se}}),y(Se)},onChange:(fe,Se)=>y(Se),sx:{width:100,height:16,marginY:-1,"& .MuiSlider-thumb":{"&:hover, &.Mui-focusVisible, &.Mui-active":{boxShadow:"none"}}}}),r.jsx(C,{width:8})]}),r.jsxs(Zo,{width:164,value:x,exclusive:!0,size:"small",color:"primary",onChange:(fe,Se)=>{i({eventKey:"EDITOR_STROKE_BUTTON_CLICK",metaData:{strokeSize:Se}})},children:[r.jsx(on,{value:2,onClick:()=>y(2),disableRipple:!0,children:r.jsx(Os,{sx:{background:f(x===2?"primary":"informative"),height:"1px"}})}),r.jsx(on,{value:6,onClick:()=>y(6),disableRipple:!0,children:r.jsx(Os,{sx:{background:f(x===6?"primary":"informative"),height:3}})}),r.jsx(on,{value:12,onClick:()=>y(12),disableRipple:!0,children:r.jsx(Os,{sx:{background:f(x===12?"primary":"informative"),height:5}})}),r.jsx(on,{value:36,onClick:()=>y(36),disableRipple:!0,children:r.jsx(Os,{sx:{background:f(x===36?"primary":"informative"),height:8}})})]}),r.jsx(C,{width:8}),r.jsx(Yo,{sx:{padding:.5},onClick:fe=>{fe.stopPropagation(),i({eventKey:"EDITOR_COLOR_PICK_BUTTON_CLICK"}),d==="crop"&&m(),g("draw"),p(_)},children:r.jsx(Mc,{htmlColor:f("primary"),sx:{fontSize:18}})}),r.jsx(C,{width:6}),r.jsx(Hc,{onClickAway:()=>setTimeout(()=>w(null),50),touchEvent:"onTouchStart",mouseEvent:"onMouseDown",children:r.jsxs(NM,{onClick:fe=>{i({eventKey:"EDITOR_COLOR_SELECT_BUTTON_CLICK"}),w(I?null:fe.currentTarget),p(null)},children:[r.jsx(LM,{sx:{backgroundColor:_}}),R&&r.jsx(uv,{open:R,anchorEl:I,placement:"bottom-end",modifiers:[{name:"offset",options:{offset:[0,8]}}],sx:{zIndex:fe=>fe.zIndex.drawer+200},disablePortal:!0,children:r.jsx(DM,{onClick:fe=>fe.stopPropagation(),onTouchStart:fe=>fe.stopPropagation(),children:r.jsx(s1,{color:_,onChange:S,style:{width:472,height:472,maxWidth:"92dvw",maxHeight:"92dvw"}})})})]})})]})]})}),r.jsx(OM,{sx:{width:n?"96dvw":"80dvw",height:n?"76dvh":"80dvh"},ref:E,children:r.jsx(zM,{height:(h==null?void 0:h.height)??"100%",width:(h==null?void 0:h.width)??`${100*N}%`,children:r.jsx(FM,{children:d==="crop"?r.jsx(Hv,{image:k.current,crop:A,zoom:D,aspect:parseInt(O.split(":")[0])/parseInt(O.split(":")[1]),objectFit:"horizontal-cover",initialCroppedAreaPixels:L??void 0,onCropChange:P,onCropComplete:G,onZoomChange:B,maxZoom:$.max,minZoom:$.min,cropSize:W,style:{containerStyle:{borderRadius:0,overflow:"visible",minWidth:"100%",minHeight:"100%"},cropAreaStyle:{borderRadius:0},mediaStyle:{outlineColor:f("border"),outlineStyle:"solid",outlineWidth:.5,borderRadius:0,height:"unset"}},restrictPosition:!0}):r.jsx(Uv,{panning:{disabled:d!=="view"||X!==null},children:r.jsx(Gv,{wrapperStyle:{overflow:"visible",display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},contentStyle:{position:"relative",zIndex:0,display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},children:r.jsx(MM,{style:{cursor:d==="draw"||X?"crosshair":"all-scroll"},ref:M,width:((ne=Hn[z.aspectRatio])==null?void 0:ne.width)??1024,height:((ue=Hn[z.aspectRatio])==null?void 0:ue.height)??1024,id:"canvas"})})})})})}),r.jsx(Np,{sx:n?{position:"fixed",bottom:0,padding:2,left:0,right:0}:{position:"relative",marginTop:1,marginBottom:1,padding:1,width:h==null?void 0:h.width,minWidth:520,borderRadius:1},onClick:()=>p(null),children:d==="crop"?r.jsxs(Bl,{children:[r.jsxs(Br,{children:[r.jsx(Ng,{editorMode:!0,onChange:fe=>F(fe)}),!o&&r.jsxs(r.Fragment,{children:[r.jsx(C,{width:16}),r.jsx(Fp,{disableRipple:!0,disabled:D<=$.min,onClick:()=>{i({eventKey:"EDITOR_CROP_ZOOM_OUT_CLICK"}),B(Math.max(D-.05,$.min))},children:r.jsx(u1,{htmlColor:f(D<=$.min?"secondary":"primary"),sx:{fontSize:18}})}),r.jsxs(UM,{children:[Math.floor(D/3*100),"%"]}),r.jsx(Fp,{disableRipple:!0,disabled:D>=$.max,onClick:()=>{i({eventKey:"EDITOR_CROP_ZOOM_IN_CLICK"}),B(Math.min(D+.05,$.max))},children:r.jsx(Xd,{htmlColor:f(D>=$.max?"secondary":"primary"),sx:{fontSize:18}})})]})]}),r.jsxs(Br,{children:[r.jsx(Bp,{onClick:()=>{i({eventKey:"EDITOR_CROP_CANCEL_CLICK"}),me.current?Y():g("view")},children:"Cancel"}),r.jsx(C,{width:4}),r.jsx(Lp,{onClick:()=>{i({eventKey:D>=3?"EDITOR_CROP_IN_COMMIT":"EDITOR_CROP_ZOOM_OUT_CLICK"}),g("view"),m()},children:"Crop"})]})]}):r.jsxs(Bl,{children:[r.jsxs(Br,{children:[r.jsx(Yo,{onClick:()=>{i({eventKey:"EDITOR_UNDO_CLICK"}),T()},children:r.jsx(a1,{sx:{fontSize:18},htmlColor:f(j>0?"primary":"secondary")})}),r.jsx(C,{width:8}),r.jsx(Yo,{onClick:()=>{i({eventKey:"EDITOR_REDO_CLICK"}),Z()},children:r.jsx(l1,{sx:{fontSize:18},htmlColor:f(ee.current.length>j+1?"primary":"secondary")})})]}),r.jsxs(Br,{children:[r.jsx(Bp,{onClick:()=>{i({eventKey:"EDITOR_CANCEL_CLICK"}),Y()},children:"Cancel"}),r.jsx(C,{width:4}),r.jsxs(Zo,{width:160,value:q||ce,exclusive:!0,size:"small",color:"primary",children:[r.jsx(on,{value:!0,onClick:()=>{i({eventKey:"EDITOR_PRIVATE_CLICK"}),Q?V(!0):(ve(!0),setTimeout(()=>{ve(!1),ae(!0)},500))},disableRipple:!0,children:r.jsx(Dp,{children:"Private"})}),r.jsx(on,{value:!1,onClick:()=>{i({eventKey:"EDITOR_PUBLIC_CLICK"}),V(!1)},disableRipple:!0,children:r.jsx(Dp,{children:"Public"})})]}),r.jsx(C,{width:8}),r.jsx(Lp,{onClick:te,children:"Save"})]})]})}),r.jsx(as,{open:u}),r.jsx(Jr,{anchorOrigin:{vertical:n?"bottom":"top",horizontal:"center"},open:!!X,sx:{"& .MuiSnackbarContent-root":{backgroundColor:X},"& .MuiSnackbarContent-message":{width:"100%"}},message:X&&r.jsxs(Br,{children:[r.jsx(Mc,{htmlColor:ih(X),sx:{fontSize:18,marginRight:1}}),r.jsx(le,{color:ih(X),fontSize:12,fontWeight:500,children:n?"Hold to check color, release to select":"Click to select color"})]})}),r.jsx(Jr,{anchorOrigin:{vertical:"top",horizontal:"center"},open:K,autoHideDuration:1e4,onClose:()=>ae(!1),message:r.jsxs(le,{fontSize:13,textAlign:"center",width:"100%",children:["Get"," ",r.jsx("span",{onClick:()=>{i({eventKey:"OPEN_SUBSCRIPTION_FROM_PRIVATE_EDIT_SNACK"}),a({newTab:!0,conversionReason:lt.EditorVisibilitySnackBar}),ae(!1)},style:{cursor:"pointer",textDecoration:"underline"},children:"Ideogram Plus or Pro"})," ","to unlock private edit."]})})]})},Os=b(C)({width:16,borderRadius:2,margin:4}),MM=b("canvas")(()=>({borderRadius:4,width:"100%",height:"100%",userSelect:"none",...os?{outlineColor:f("border"),outlineStyle:"solid",outlineWidth:.5}:{boxShadow:"0px 2px 4px -1px rgba(0,0,0,0.2), 0px 4px 5px 0px rgba(0,0,0,0.14), 0px 1px 10px 0px rgba(0,0,0,0.12)"}})),OM=b(C)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}),Bp=b(gt)(()=>({backgroundColor:"transparent",color:f("primary"),textDecoration:"underline","&:hover":{backgroundColor:"transparent",color:f("primary"),textDecoration:"underline"},fontSize:13,minWidth:0})),Br=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"}),Lp=b(gt)(()=>({backgroundColor:f("primary"),color:f("background"),"&:hover":{backgroundColor:f("primary"),color:f("background")},borderRadius:4,fontSize:13})),Np=b(C)(()=>({display:"flex",flexDirection:"column",alignItems:"center",zIndex:2,backgroundColor:f("transparentSolid"),userSelect:"none"})),BM=b(C)({position:"fixed",top:0,left:0,height:"100dvh",width:"100dvw",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:8,overscrollBehavior:"contain",userSelect:"none"}),LM=b(C)({width:20,height:20,borderRadius:10,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"}),NM=b(C)({width:24,height:24,borderRadius:12,cursor:"pointer",background:"linear-gradient(to bottom right, #b827fc 0%, #2c90fc 25%, #b8fd33 50%, #fec837 75%, #fd1892 100%)",display:"flex",alignItems:"center",justifyContent:"center"}),Bl=b(C)({display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"}),DM=b(Ir)(()=>({borderRadius:8,backgroundColor:f("background"),outlineColor:f("border"),outlineWidth:.5,outlineStyle:"solid"})),Dp=b(le)(()=>({fontSize:12,fontWeight:500,minWidth:48})),FM=b(C)({position:"relative",width:"100%",height:"100%"}),zM=b(C)({maxWidth:"100dvw",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"}),Fp=b(gt)(()=>({background:"tranparent",color:f("primary"),borderRadius:4,"&:hover":{background:"tranparent",color:f("primary")},padding:4,minWidth:0})),UM=b(le)(()=>({fontWeight:400,fontSize:12,color:f("primary"),width:32,textAlign:"center"})),p1=()=>{const{hasAccessToEditor:t}=l.useContext(ge),{imageEditState:e,closeEditor:n}=l.useContext(ye),o=Nt();return e.url===!1?null:t?r.jsx(PM,{openDrawBoard:!0,closeDrawBoard:()=>{n()},imageUrl:typeof e.url=="string"?e.url:void 0,defaultPrivate:e.defaultPrivate,isUpload:e.url!==!0&&typeof e.url=="string"&&!e.url.includes("/api/images/direct")&&!e.url.includes("/api/uploads/retrieve")}):r.jsx(Jr,{anchorOrigin:{vertical:"top",horizontal:"center"},open:!!e,autoHideDuration:1e4,onClose:()=>n(),message:r.jsxs(le,{fontSize:13,textAlign:"center",width:"100%",children:["Get"," ",r.jsx("span",{onClick:()=>{Xe({eventKey:"OPEN_SUBSCRIPTION_MODEL_FROM_EDITOR_SNACK"}),o({conversionReason:lt.EditorSnackBar}),n()},style:{cursor:"pointer",textDecoration:"underline"},children:"Ideogram Basic or above"})," ","to unlock ideogram Editor."]})})},GM=()=>{const t=we(),e=Nt(),n=xe(t.breakpoints.down("md")),{describeError:o,setDescribeError:i}=l.useContext(ye),{slowCredit:a}=l.useContext(ye);return o!=="quota"?null:r.jsx(Jr,{open:o==="quota",onClose:()=>i(!1),anchorOrigin:{vertical:"top",horizontal:"center"},sx:{width:n?void 0:"max-content"},children:r.jsxs(WM,{children:[r.jsxs(qM,{alignItems:n?"flex-start":"center",children:[r.jsxs(HM,{children:[r.jsxs(zp,{children:["You reached your ",(a==null?void 0:a.max)??10," credit limit."]})," ",r.jsx("br",{})," Get more credits with"," ",r.jsx(zp,{children:"Ideogram Basic or above"}),"."]}),!n&&r.jsxs(r.Fragment,{children:[r.jsx(C,{width:8}),r.jsx(ht,{size:"small",label:"Compare plans",onClick:()=>{e({newTab:!0,conversionReason:lt.DescribeQuotaError})}})]}),r.jsx(C,{width:12}),r.jsx(Be,{icon:r.jsx(wt,{color:f("quietButtonText")}),onClick:()=>i(!1),size:{width:32,height:32}})]}),n&&r.jsxs(r.Fragment,{children:[r.jsx(C,{height:8}),r.jsx(ht,{size:"small",label:"Compare plans",onClick:()=>{e({newTab:!0,conversionReason:lt.DescribeQuotaError})}})]})]})})},HM=b(le)(()=>({fontSize:16,color:f("secondary")})),zp=b("span")(()=>({fontWeight:500,color:f("primary")})),qM=b(C)({display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%"}),WM=b(C)(()=>({display:"flex",flexDirection:"column",alignItems:"flex-start",outlineStyle:"solid",outlineWidth:.5,outlineColor:f("infoCardBorder"),backgroundColor:f("infoCardBackground"),borderRadius:8,padding:"8px 8px 8px 12px",color:f("primary"),fontSize:16,width:"100%",wordBreak:"break-word",marginBottom:16})),$M=t=>{const{autoCloseTimerRef:e,backgroundColor:n,showClose:o}=t,i=o!==void 0?o:!0,a=we(),s=xe(a.breakpoints.down("md")),{alertContent:c,setAlertContent:d}=l.useContext(Tn),u=l.useMemo(()=>c!==null,[c]),h=l.useMemo(()=>{const g=window.location.pathname===oe.PRICING;return!s&&!g},[s]);return u?r.jsx(Jr,{open:u,onClose:()=>{e.current===null&&d(null)},anchorOrigin:{vertical:"top",horizontal:"center"},sx:{width:s?void 0:"max-content",maxWidth:"100%",zIndex:p=>p.zIndex.drawer+151,marginLeft:h?"32px":0},children:r.jsxs(JM,{sx:{backgroundColor:n??f("infoCardBackground")},children:[r.jsxs(KM,{alignItems:s?"flex-start":"center",gap:s?"12px":"20px",children:[r.jsx(VM,{children:c}),i&&r.jsx(Be,{icon:r.jsx(wt,{color:n?qI(n):f("quietButtonText")}),onClick:()=>d(null),size:{width:32,height:32}})]}),s&&r.jsx(r.Fragment,{children:r.jsx(C,{height:8})})]})}):null},VM=b(C)(()=>({fontSize:16,color:f("secondary"),fontFamily:"Manrope, sans-serif"})),KM=b(C)({display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%"}),JM=b(C)(()=>({display:"flex",flexDirection:"column",alignItems:"flex-start",outlineStyle:"solid",outlineWidth:1,outlineColor:f("infoCardBorder"),borderRadius:8,padding:"12px",color:f("primary"),fontSize:16,width:"100%",wordBreak:"break-word",marginBottom:16})),f1=l.createContext({shouldPlayAnimationRef:{current:!0}}),XM=({children:t})=>{const e=l.useRef(!0);return r.jsx(f1.Provider,{value:{shouldPlayAnimationRef:e},children:t})},YM=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{navigate:n,decorateGeneration:o}=l.useContext($e),i=Ee(),{inSessionGenerations:a}=l.useContext(ye),s=l.useMemo(()=>{var x;return(x=a.find(y=>!o(y.data.generation).deleted))==null?void 0:x.data.generation},[o,a]),c=l.useMemo(()=>{var w;const x=(w=s==null?void 0:s.aspect_ratio)==null?void 0:w.split(":"),y=(s==null?void 0:s.width)??parseInt((x==null?void 0:x[0])??"1"),_=(s==null?void 0:s.height)??parseInt((x==null?void 0:x[1])??"1");return e?y/_>=3?1:y/_<=1.3?4:2:y>_*1.2?2:4},[e,s==null?void 0:s.aspect_ratio,s==null?void 0:s.height,s==null?void 0:s.width]),d=l.useMemo(()=>(s==null?void 0:s.request_type)==="SUPER_RES"?1:4,[s==null?void 0:s.request_type]),u=l.useMemo(()=>d===1?12:12/c,[d,c]),h=l.useMemo(()=>{if(s!=null&&s.height&&(s!=null&&s.width))return s.width/s.height;if(s!=null&&s.aspect_ratio){const x=s==null?void 0:s.aspect_ratio.split(":");if(x[0]&&x[1])return parseFloat(x[0])/parseFloat(x[1])}return 1},[s==null?void 0:s.aspect_ratio,s==null?void 0:s.height,s==null?void 0:s.width]),p=l.useMemo(()=>{if(!(!s||d>1))return window.innerWidth*h},[s,d,h]),g=l.useMemo(()=>{const x=s==null?void 0:s.aspect_ratio.split(":");return`${x==null?void 0:x[0]} / ${x==null?void 0:x[1]}`},[s]),m=l.useMemo(()=>[...Array(d).keys()].map(x=>{var y,_,w,I;return s!=null&&s.latest_intermediate_image_seconds&&!s.is_completed&&s.request_id?{src:Na(s.request_id,s.latest_intermediate_image_seconds,x??0)}:{link:s!=null&&s.request_id?oe.GENERATION.replace(":request_id",s.request_id).replace(":image_index",x.toString()):void 0,src:(_=(y=s==null?void 0:s.responses)==null?void 0:y[x])!=null&&_.response_id?Pt((I=(w=s==null?void 0:s.responses)==null?void 0:w[x])==null?void 0:I.response_id,"balanced","response"):void 0}})??[],[s==null?void 0:s.is_completed,s==null?void 0:s.latest_intermediate_image_seconds,s==null?void 0:s.request_id,s==null?void 0:s.responses,d]),v=l.useCallback(x=>{var _;i({eventKey:"GENERATION_GRID_CLICK"});const y=(_=m[x])==null?void 0:_.link;y&&n({...mt(y),generation:s??void 0})},[s,n,m,i]);return s?r.jsx(Co,{container:!0,spacing:1,padding:"4px 8px 8px 8px",width:e?"100%":d===1?Math.max(280,280*h):660,sx:{display:"flex",justifyContent:"center"},children:[...Array(d).keys()].map(x=>{var y,_,w;return r.jsx(Co,{item:!0,xs:u,maxWidth:p,onClick:()=>{i({eventKey:"FLOATING_PROGRESS_IMAGE_CLICK"}),v(x)},children:(y=m[x])!=null&&y.src?r.jsx("a",{href:(_=m[x])==null?void 0:_.link,onClick:I=>I.preventDefault(),children:r.jsx(Up,{iscompleted:(s.is_completed||"").toString(),children:r.jsx(ZM,{sx:{aspectRatio:g,cursor:s.is_completed?"pointer":"progress"},src:(w=m[x])==null?void 0:w.src})})}):r.jsx(Up,{children:r.jsx(QM,{sx:{aspectRatio:g}})})},`${s.request_id}_${x}_preview`)})}):null},QM=b("div")(()=>({userSelect:"none",width:"100%",display:"block",flex:1,backgroundColor:f("bulkSelectBackground"),borderRadius:4,cursor:"progress",animation:"pulse 2s infinite ease-out"})),Up=b(C)(()=>({display:"block",position:"relative",width:"100%",flex:1})),ZM=b("img")(()=>({objectFit:"cover",userSelect:"none",width:"100%",display:"block",backgroundColor:f("bulkSelectBackground")})),Gp=()=>{const t=we(),e=xe(t.breakpoints.down("md")),n=Ee(),{inSessionGenerations:o,dismissedGenerationProgressAt:i,setDismissedGenerationProgressAt:a,generationPreviewOpen:s,setGenerationSetting:c,showGenerationPreview:d,priorityCredit:u}=l.useContext(ye),{shouldPlayAnimationRef:h}=l.useContext(f1),{subscriptionStatus:p,userPublicProfileData:g,isFeatureEnabled:m}=l.useContext(ge),{navigate:v,decorateGeneration:x}=l.useContext($e),{setTabFilter:y}=l.useContext(_m),_=Nt(),{tab:w,filter:I,request_id:R}=an(),S=Rn(),[E,N]=l.useState(!1),k=l.useMemo(()=>u&&(u==null?void 0:u.total)>0,[u]),A=l.useMemo(()=>o.find(T=>!x(T.data.generation).deleted),[x,o]),D=l.useMemo(()=>!!A&&i>(A==null?void 0:A.data.timestamp),[i,A]),O=l.useMemo(()=>{if(!A)return null;if(A.data.generation.has_started){if(A.data.generation.has_started&&!A.data.generation.is_completed)return"IN_PROGRESS";if(A.data.generation.is_completed)return"COMPLETED"}else return k?"WAITING_IN_FAST_QUEUE":"WAITING_IN_SLOW_QUEUE";return null},[k,A]),L=l.useCallback(()=>{n({eventKey:"FLOATING_PROGRESS_STATUS_CLICK"});const T=A!=null&&A.data.generation.private?"private":"public",j=oe.HOME_TAB_FILTER.replace(":tab",Ae.my_images).replace(":filter",T);Bn(window.location.pathname)?((window.location.search||window.location.pathname!==j)&&y(Ae.my_images,T),window.scrollTo({top:0,behavior:"smooth"})):v(j)},[A==null?void 0:A.data.generation.private,v,y,n]),P=l.useMemo(()=>{if(O==="WAITING_IN_FAST_QUEUE")return r.jsx(Be,{freeWidth:!0,onClick:L,icon:r.jsx(vi,{children:"Waiting in the priority queue..."})});if(O==="WAITING_IN_SLOW_QUEUE")return r.jsxs(Ll,{children:[r.jsx(Be,{freeWidth:!0,onClick:L,icon:r.jsx(vi,{children:"Waiting in the slow queue..."})}),!s&&r.jsx(Be,{onClick:()=>{p!=null&&p.activeSubscription?N(!0):_({conversionReason:"SLOW_QUEUE_WAIT"})},freeWidth:!0,icon:r.jsxs(vi,{children:[r.jsx(Vi,{color:f("IdeogramPink"),width:18,height:18}),r.jsx(t7,{children:"Skip the wait"})]})})]});if(O==="IN_PROGRESS")return r.jsx(Be,{freeWidth:!0,onClick:L,icon:r.jsxs(vi,{children:[A==null?void 0:A.data.generation.completion_percentage,"% complete"]})});if(O==="COMPLETED")return r.jsx(Be,{onClick:()=>{a(Date.now()),L()},freeWidth:!0,icon:r.jsxs(Ll,{children:[r.jsx(X0,{color:f("primary")}),r.jsx(C,{width:8}),r.jsx(vi,{children:"Generation complete"})]})})},[L,A==null?void 0:A.data.generation.completion_percentage,O,_,p==null?void 0:p.activeSubscription,t,s]),G=l.useMemo(()=>!!pt(oe.GENERATION,S.pathname)&&R===(A==null?void 0:A.data.generation.request_id),[A==null?void 0:A.data.generation.request_id,S.pathname,R]),B=l.useMemo(()=>Bn(S.pathname)&&w===Ae.my_images,[S.pathname,w]),M=l.useCallback(T=>B&&T<96&&(!I||(A==null?void 0:A.data.generation.private)&&I==="private"||!(A!=null&&A.data.generation.private)&&I==="public"),[A==null?void 0:A.data.generation.private,B,I]),z=l.useCallback(()=>{B&&M(window.scrollY)&&a(Date.now())},[a,M,B]);l.useEffect(()=>(A!=null&&A.data.timestamp&&z(),window.addEventListener("scroll",z),()=>{window.removeEventListener("scroll",z)}),[z,A==null?void 0:A.data.timestamp]);const F=l.useMemo(()=>d&&A&&O&&P&&!D&&!(e&&(m(Bt.mobile_jump_to_creations)||Mg(g==null?void 0:g.join_time_float))),[D,P,m,e,A,O,d,g==null?void 0:g.join_time_float]);return l.useEffect(()=>{F?setTimeout(()=>h.current=!1,300):h.current=!0},[h,F]),!F||M(window.scrollY)||G?null:r.jsxs(r.Fragment,{children:[r.jsxs(n7,{sx:{borderBottomStyle:s?"none":"solid",...e?{width:"100%",borderRadius:"16px",borderBottomLeftRadius:0,borderBottomRightRadius:0,bottom:Bn(S.pathname)||Ba(S.pathname)||pt(oe.NOTIFICATIONS,S.pathname)?64:0,...s?{left:0,right:0}:{right:0}}:{width:"fit-content",right:16,borderRadius:"12px",borderBottomLeftRadius:0,borderBottomRightRadius:0,bottom:0}},children:[r.jsxs(o7,{children:[P,r.jsxs(Ll,{children:[r.jsx(Be,{icon:r.jsx(C,{sx:{transform:s?"rotate(180deg)":void 0},children:r.jsx($n,{color:f("iconPrimary"),width:20,height:20})}),onClick:()=>{n({eventKey:s?"FLOATING_PROGRESS_COLLAPSE":"FLOATING_PROGRESS_EXPEND"}),c({default_generation_preview_expanded:!s})}}),r.jsx(Be,{icon:r.jsx(wt,{color:f("iconPrimary"),width:20,height:20}),onClick:()=>{n({eventKey:"FLOATING_PROGRESS_DISMISS"}),a(Date.now())}})]})]}),r.jsx(e7,{in:s,appear:h.current,children:r.jsx(YM,{})})]}),E&&r.jsx(yr,{open:E,onClose:()=>N(!1),topUpReason:vr.GenerationPreviewTopUp})]})},e7=b(Ni)({width:"100%","& .MuiCollapse-wrapperInner":{display:"flex",alignItems:"center",justifyContent:"center"}}),Ll=b(C)(()=>({display:"flex",alignItems:"center",justifyContent:"center"})),t7=b("span")(()=>({fontWeight:600,fontSize:"14px",color:f("IdeogramPink")})),vi=b(le)(()=>({whiteSpace:"nowrap",color:f("primary"),"&:hover":{color:f("InteractiveHover")},"&:active":{color:f("InteractiveActive")},fontSize:14,fontWeight:600,lineHeight:"20px",display:"flex",gap:"4px",alignItems:"center"})),n7=b(C)(()=>({position:"fixed",backgroundColor:f("previewPanelBackground"),boxShadow:f("previewPanelBoxShadow"),padding:4,paddingTop:0,display:"flex",flexDirection:"column",alignItems:"center",zIndex:1,border:`1px solid ${f("batchGenerationButtonBorder")}`,borderBottomLeftRadius:0,borderBottomRightRadius:0,maxHeight:"90dvh",overflow:"auto"})),o7=b(C)(()=>({display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",position:"sticky",top:0,zIndex:1,backgroundColor:f("previewPanelBackground"),paddingTop:4}));function r7({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M9.042 19.003h5.916a3 3 0 01-5.916 0zm2.958-17a7.5 7.5 0 017.5 7.5v4l1.418 3.16A.95.95 0 0120.052 18h-16.1a.95.95 0 01-.867-1.338l1.415-3.16V9.49l.005-.25A7.5 7.5 0 0112 2.004z"})})}function g1({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M18.25 3.509a.75.75 0 100-1.5l-13-.004a.75.75 0 100 1.5l13 .004zm-6.602 18.488l.102.007a.75.75 0 00.743-.649l.007-.101-.001-13.685 3.722 3.72a.75.75 0 00.976.073l.085-.073a.75.75 0 00.072-.977l-.073-.084-4.997-4.996a.75.75 0 00-.976-.073l-.085.072-5.003 4.997a.75.75 0 00.976 1.134l.084-.073 3.719-3.713L11 21.254c0 .38.282.693.648.743z"})})}const i7=t=>{const{teasingDrop:e,handleDragOver:n,dropType:o,fileTypes:i,fileProcessingFn:a,setTeasingDrop:s,handleDropFn:c}=t,d=l.useCallback(h=>{h.preventDefault(),h.stopPropagation(),s(!1),Array.from(h.dataTransfer.files).forEach(g=>{a&&a(g)})},[a,s]),u=c??d;return r.jsx(s7,{open:e,onDragOver:n,onDrop:u,children:r.jsx(a7,{children:r.jsxs(l7,{children:[r.jsx(g1,{width:24,height:24,color:f("secondary")}),r.jsxs(c7,{children:[" Drop your ",o," to upload"]}),r.jsx(d7,{children:i})]})})})},s7=b(ri)(()=>({backgroundColor:"rgba(63, 63, 70, 0.20)",zIndex:1336})),a7=b(C)(()=>({padding:16,borderRadius:16,background:f("promptBoxColor"),boxShadow:"0px 10px 15px -3px rgba(9, 9, 11, 0.10), 0px 4px 6px -4px rgba(9, 9, 11, 0.10)",width:576,height:196})),l7=b(C)(()=>({width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:12,borderRadius:8,border:`1px dashed ${f("borderHighlight")}`})),c7=b(le)(()=>({color:f("primary"),fontSize:16,fontWeight:600,lineHeight:"24px",letterSpacing:"-0.16px"})),d7=b(le)(()=>({color:f("secondary"),textAlign:"center",fontSize:"14px",fontWeight:400,lineHeight:"20px",letterSpacing:"-0.14px"})),Qd=t=>{const{setTeasingDrop:e,teasingDrop:n}=t,{handleUploadImage:o}=l.useContext(ye),{hasAccessToImageUpload:i}=l.useContext(ge),{showPayWallModel:a}=$t(),s=l.useCallback(u=>{u.preventDefault()},[]),c=l.useCallback(()=>{a("UPLOAD")},[a]),d=l.useCallback(u=>{u.preventDefault(),u.stopPropagation(),e(!1);const h=Array.from(u.dataTransfer.files),g=h.find(m=>m.type.startsWith("image/"))||h[0];g&&o(g)},[o,e]);return r.jsx(i7,{teasingDrop:n,handleDragOver:s,setTeasingDrop:e,handleDropFn:i?d:c,dropType:"image",fileTypes:""})},Et=l.createContext({prompt:"",setPrompt:()=>[],handleClose:()=>[],handleGenerate:()=>[],renderInputOnly:!0,handleOpen:()=>[],wrapSetting:!1,setWrapSetting:()=>[],setPreviousPrompt:()=>[],setNextPrompt:()=>[],handleClearClick:()=>[],showPayWallModel:()=>[],handleDismissImagePrompt:()=>[]}),u7=t=>{const e=Ee(),{children:n,handleClose:o,prompt:i,setPrompt:a,renderInputOnly:s,handleOpen:c,autoFocus:d}=t,{hasAccessToImageUpload:u}=l.useContext(ge),{setGenerationInput:h,generationInput:p,handleSubmitGeneration:g,setShowAdvancedFeatures:m,descriptionMap:v,prevPromptClick:x,nextPromptClick:y,getAndClearGenerationInput:_,setSuggestions:w,setImageUploadLocalSrc:I,setUploadError:R,setGenerationSetting:S,setShowGenerationPreview:E}=l.useContext(ye),[N,k]=l.useState(!1),A=l.useRef(),D=l.useRef();l.useEffect(()=>{var F;d&&((F=A.current)==null||F.focus())},[d]);const O=l.useMemo(()=>{var F;return(F=Array.from(v.values()).find(T=>T.caption===i))==null?void 0:F.descriptionId},[v,i]);l.useEffect(()=>{s&&(A!=null&&A.current)&&(A.current.scrollTop=0)},[s]),l.useEffect(()=>{s||(p.seed||p.negative_prompt||(p.generation_speed??0)!==0)&&m(!0)},[p.generation_speed,p.negative_prompt,p.seed,s,m]),l.useEffect(()=>{const F=T=>{T.code==="Escape"&&(T.stopPropagation(),T.preventDefault(),o())};return document.addEventListener("keydown",F,!1),()=>{document.removeEventListener("keydown",F)}},[o]);const L=l.useCallback(()=>{e({eventKey:"V2_GENERATION"}),h({...p,prompt:i}),E(!0),g({prompt:i,callback:()=>o()})},[e,h,p,i,E,g,o]),P=l.useCallback(()=>{e({eventKey:"GO_TO_PREVIOUS_PROMPT"});const F=x(i);F!==void 0&&a(F)},[x,i,a,e]),G=l.useCallback(()=>{e({eventKey:"GO_TO_NEXT_PROMPT"});const F=y(i);F!==void 0&&a(F)},[y,i,a,e]),B=l.useCallback(()=>{e({eventKey:"CLEAR_PROMPT_BUTTON_CLICK"}),w([]),a(""),_()},[e,w,a,_]);l.useEffect(()=>{if(!u)return;const F=T=>{var te;const j=(te=T.clipboardData)==null?void 0:te.items;if(!j)return;let Z=null,ee=null;for(let $=0;$<j.length;$++){const X=j[$].getAsFile();if(X&&j[$].type.indexOf("image")===0)if(!X.type.startsWith("image")||X.type.endsWith("svg+xml")||X.type.endsWith("avif")||X.type.endsWith("heic"))Z="FILE_TYPE";else if(X.size/1024/1024>Gi)Z="FILE_SIZE";else{ee=X;break}else X&&(Z="FILE_TYPE")}ee?I(URL.createObjectURL(ee)):Z&&R(Z)};return s?document.removeEventListener("paste",F):document.addEventListener("paste",F),()=>{document.removeEventListener("paste",F)}},[s,u,I,R]),l.useEffect(()=>{s&&R(null)},[s,R]),l.useEffect(()=>()=>{R(null)},[R]);const{showPayWallModel:M}=$t(),z=l.useCallback(()=>{let F=p.aspectRatio??"1:1";F=zg(F,p.model_version),S({aspectRatio:F}),h({...p,variation_input:void 0,retry_inpaint_data:void 0})},[p,h,S]);return r.jsx(Et.Provider,{value:{prompt:i,setPrompt:a,handleClose:o,handleGenerate:L,renderInputOnly:s,handleOpen:c,inputRef:A,inputBottomRef:D,wrapSetting:N,setWrapSetting:k,currentDescriptionId:O,setPreviousPrompt:P,setNextPrompt:G,handleClearClick:B,showPayWallModel:M,handleDismissImagePrompt:z},children:n})},m1=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{handleClose:n,inputRef:o}=l.useContext(Et),{setImageUploadLocalSrc:i,imageUploadLocalSrc:a}=l.useContext(ye);return r.jsx(Be,{onClick:s=>{var c;s.stopPropagation(),a?i(null):((c=o==null?void 0:o.current)==null||c.blur(),setTimeout(()=>{n()},100))},icon:e?r.jsx(Uo,{color:f("quietButtonText")}):r.jsx(wt,{color:f("quietButtonText")}),tooltip:"Close"})},h7=()=>{const{generationsApi:t}=l.useContext(ge),{generationInput:e,generationInputMode:n}=l.useContext(ye);return{parentNeedCenterCrop:l.useCallback(async i=>{const{width:a,height:s}=i;if(t)return(await t.validateResolution({validateResolutionRequest:{width:a,height:s,modelVersion:n==="upscale"?"V_1_5":e.model_version}})).modified;const c=(a/s).toFixed(3);return!dr[c]},[e.model_version,n,t])}};var Zd={},p7=pn;Object.defineProperty(Zd,"__esModule",{value:!0});var eu=Zd.default=void 0,f7=p7(fn()),g7=r;eu=Zd.default=(0,f7.default)((0,g7.jsx)("path",{d:"M9 16.17 5.53 12.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0z"}),"CheckRounded");function Ko({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 22 22",children:r.jsx("g",{children:r.jsx("path",{fill:n??"inherit",d:"M10.77 2.75c.349 0 .636.259.682.594l.006.093.002 6.646h6.648a.687.687 0 01.093 1.37l-.093.005H11.46l.002 6.645a.688.688 0 01-1.368.094l-.007-.093-.002-6.646H3.44a.687.687 0 01-.094-1.368l.094-.007h6.645l-.002-6.645c0-.38.308-.688.688-.688z"})})})}function qr({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",children:r.jsx("path",{fill:n??"inherit",d:"M5.503 4.627L5.5 6.75v10.504a3.25 3.25 0 003.25 3.25h8.616a2.251 2.251 0 01-2.122 1.5H8.75A4.75 4.75 0 014 17.254V6.75c0-.98.627-1.815 1.503-2.123zM17.75 2A2.25 2.25 0 0120 4.25v13a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-13A2.25 2.25 0 018.75 2h9zm0 1.5h-9a.75.75 0 00-.75.75v13c0 .414.336.75.75.75h9a.75.75 0 00.75-.75v-13a.75.75 0 00-.75-.75z"})})}function x1({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,fillRule:"evenodd",d:"M15.053 4.05c.69 0 1.25.56 1.25 1.25v13.4c0 .69-.56 1.25-1.25 1.25H8.947c-.69 0-1.25-.56-1.25-1.25V5.3c0-.69.56-1.25 1.25-1.25h6.106zm-.25 1.5H9.197v5.7h5.606v-5.7zm0 7.2H9.197v5.7h5.606v-5.7z",clipRule:"evenodd"})})}function v1({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,fillRule:"evenodd",d:"M4.05 5.395c0-.69.56-1.25 1.25-1.25h13.4c.69 0 1.25.56 1.25 1.25v13.21c0 .69-.56 1.25-1.25 1.25H5.3c-.69 0-1.25-.56-1.25-1.25V5.395zm1.5.25v5.605h5.7V5.645h-5.7zm7.2 0v5.605h5.7V5.645h-5.7zm5.7 7.105h-5.7v5.605h5.7V12.75zm-7.2 5.605V12.75h-5.7v5.605h5.7z",clipRule:"evenodd"})})}function y1({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,fillRule:"evenodd",d:"M2.25 5.395c0-.69.56-1.25 1.25-1.25h13.4c.69 0 1.25.56 1.25 1.25v5.855h2.35c.69 0 1.25.56 1.25 1.25v6.105c0 .69-.56 1.25-1.25 1.25H7.1c-.69 0-1.25-.56-1.25-1.25V12.75H3.5c-.69 0-1.25-.56-1.25-1.25V5.395zm5.1 7.355v5.605h5.7V12.75h-5.7zm7.2 0v5.605h5.7V12.75h-5.7zm2.1-1.5V5.645h-5.7v5.605h5.7zm-7.2 0V5.645h-5.7v5.605h5.7z",clipRule:"evenodd"})})}function w1({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,fillRule:"evenodd",d:"M4.05 8.947c0-.69.56-1.25 1.25-1.25h13.4c.69 0 1.25.56 1.25 1.25v6.106c0 .69-.56 1.25-1.25 1.25H5.3c-.69 0-1.25-.56-1.25-1.25V8.947zm1.5.25v5.606h5.7V9.197h-5.7zm7.2 0v5.606h5.7V9.197h-5.7z",clipRule:"evenodd"})})}function b1({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,fillRule:"evenodd",d:"M18.605 21.75c.69 0 1.25-.56 1.25-1.25V7.1c0-.69-.56-1.25-1.25-1.25H12.75V3.5c0-.69-.56-1.25-1.25-1.25H5.395c-.69 0-1.25.56-1.25 1.25v13.4c0 .69.56 1.25 1.25 1.25h5.855v2.35c0 .69.56 1.25 1.25 1.25h6.105zm-7.355-5.1H5.645v-5.7h5.605v5.7zm0-7.2H5.645v-5.7h5.605v5.7zm1.5-2.1h5.605v5.7H12.75v-5.7zm0 7.2h5.605v5.7H12.75v-5.7z",clipRule:"evenodd"})})}const m7=tt.forwardRef(({width:t,height:e,color:n},o)=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??12,height:e??12,fill:n,viewBox:"0 0 12 12",children:r.jsx("path",{fill:n,d:"M4 4V3a2 2 0 114 0v1h.5A1.5 1.5 0 0110 5.5v4A1.5 1.5 0 018.5 11h-5A1.5 1.5 0 012 9.5v-4A1.5 1.5 0 013.5 4H4zm1-1v1h2V3a1 1 0 00-2 0zM3.5 5a.5.5 0 00-.5.5v4a.5.5 0 00.5.5h5a.5.5 0 00.5-.5v-4a.5.5 0 00-.5-.5h-5z"})})),ro=t=>{const e=we(),n=xe(e.breakpoints.down("md")),{label:o,disabled:i,tooltip:a,freeWidth:s,showGradientLockIcon:c}=t,[d,u]=l.useState(!1);return r.jsxs(x7,{sx:{minWidth:s?void 0:n?120:124,marginRight:n?0:1,cursor:c?"pointer":void 0},onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),onTouchStart:()=>u(!0),onTouchEnd:()=>u(!1),onTouchCancel:()=>u(!1),onTouchEndCapture:()=>u(!1),onTouchCancelCapture:()=>u(!1),onClick:()=>u(!d),children:[r.jsx(v7,{sx:{color:f(i?"disabledLabel":"label"),fontSize:n?13:14},children:o}),c&&!i&&r.jsxs(r.Fragment,{children:[r.jsx(C,{width:"2px"}),r.jsx(Wt,{})]}),!c&&(a==null?void 0:a.content)&&r.jsxs(r.Fragment,{children:[r.jsx(C,{width:"2px"}),r.jsx(Rt,{content:a.content,open:d,children:r.jsx("div",{children:a.type==="lock"?r.jsx(m7,{color:f("disabledLabel")}):r.jsx(ai,{color:f("label")})})})]})]})},x7=b(C)({display:"flex",alignItems:"center",position:"relative",height:38}),v7=b(le)({fontWeight:400,textWrap:"nowrap"}),tr=b(le)(()=>({fontSize:14,fontWeight:400,color:f("tooltipText")})),Ws=new Map([[-2,"Quality"],[-1,"0.5x"],[0,"Default"],[1,"1.5x"],[2,"Turbo"]]),y7=()=>{const t=Ee(),{hasAccessToAdvancedFeatures:e}=l.useContext(ge),{generationInput:n,setGenerationSetting:o,setGenerationInput:i}=l.useContext(ye),{showPayWallModel:a}=l.useContext(Et),s=l.useCallback(g=>{t({eventKey:"SLIDE_GENERATION_SPEED",metaData:{value:g}}),Yn(n.model_version)&&e&&o({generation_speed:g})},[t,n,e,o]),c=l.useMemo(()=>[{optionId:"2",optionName:Ws.get(2),onSelect:()=>s(2)},{optionId:"0",optionName:Ws.get(0),onSelect:()=>s(0)},{optionId:"-2",optionName:Ws.get(-2),onSelect:()=>s(-2)}],[s]);l.useEffect(()=>{!Yn(n.model_version)&&n.generation_speed!==0&&n.generation_speed!==void 0&&i({...n,generation_speed:0})},[n,i]);const d=l.useMemo(()=>n.generation_speed?n.generation_speed.toString():"0",[n.generation_speed]),u=l.useMemo(()=>!Yn(n.model_version),[n.model_version]),h=l.useMemo(()=>u?r.jsx(tr,{children:"Only model 2.0 and 1.0 supports rendering setting."}):null,[u]),p=l.useMemo(()=>!e&&!u,[u,e]);return r.jsxs(to,{onClick:()=>{p&&a("RENDER")},children:[r.jsx(ro,{label:"Rendering",disabled:u,tooltip:{content:h,type:"info"},showGradientLockIcon:p}),r.jsx(is,{disabled:u,options:c,currentSelection:d})]})};function w7({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??19,height:e??18,fill:n??"inherit",viewBox:"0 0 19 18",children:r.jsx("g",{id:"Icon / My Images",children:r.jsx("path",{id:"Shape",fill:n??"inherit",d:"M10.811 6.747a.936.936 0 1 0 0-1.872.936.936 0 0 0 0 1.872M5.188 2.25A2.44 2.44 0 0 0 2.75 4.688v6.75a2.437 2.437 0 0 0 2.438 2.437h6.75a2.437 2.437 0 0 0 2.437-2.437v-6.75a2.437 2.437 0 0 0-2.437-2.438zM3.875 4.688c0-.725.588-1.313 1.313-1.313h6.75c.724 0 1.312.588 1.312 1.313v6.75q-.002.26-.095.49L9.715 8.71a1.687 1.687 0 0 0-2.306 0l-3.44 3.217a1.3 1.3 0 0 1-.094-.49zM8.946 9.53l3.38 3.16a1.3 1.3 0 0 1-.389.059h-6.75q-.203 0-.388-.058l3.379-3.16a.56.56 0 0 1 .768 0m-1.884 6.22a2.44 2.44 0 0 1-2.054-1.126h7.305a2.813 2.813 0 0 0 2.812-2.812V4.508a2.44 2.44 0 0 1 1.125 2.055v5.25a3.94 3.94 0 0 1-3.937 3.937z"})})})}function tu({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??21,height:e??20,fill:"none",viewBox:"0 0 21 20",children:r.jsx("path",{fill:n??"inherit",d:"M3.333 3.5a.5.5 0 01.5-.5h10a.5.5 0 01.5.5v2a.5.5 0 01-1 0V4h-4v12h.207c.099.349.231.683.393 1h-3.1a.5.5 0 010-1h1.5V4h-4v1.5a.5.5 0 01-1 0v-2zm16 11a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zm-4-2a.5.5 0 00-1 0V14h-1.5a.5.5 0 100 1h1.5v1.5a.5.5 0 101 0V15h1.5a.5.5 0 000-1h-1.5v-1.5z"})})}function nu({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M12 4.5a7.5 7.5 0 11-7.419 6.392c.067-.454-.265-.892-.724-.892a.749.749 0 00-.752.623A9 9 0 106 5.292V4.25a.75.75 0 00-1.5 0v3c0 .414.336.75.75.75h3a.75.75 0 000-1.5H6.9a7.473 7.473 0 015.1-2z"})})}const C1=()=>{const{generationsApi:t}=l.useContext(ge),{data:e}=Ve(["retrieveColorPalettes"],()=>t==null?void 0:t.retrieveColorPalettes(),{staleTime:1/0,retry:3}),n=l.useMemo(()=>e?e.colorPalettes.presetColorPalettes:[],[e]),o=l.useCallback(i=>{for(const a of n){const{members:s}=a;if(s.length===i.length&&s.map(c=>c.colorHex).join(",")===i.map(c=>c.color_hex).join(","))return!0}return!1},[n]);return{colorPalettePresets:n,isColorPaletteInPreset:o}},_1=t=>{const{forceModal:e}=t,{generationsApi:n}=l.useContext(ge),{generationInput:o}=l.useContext(ye),i=l.useMemo(()=>e??o.model_version,[e,o.model_version]),{data:a}=Ve(["getAvailableResolutions",i],()=>n==null?void 0:n.getAvailableResolutions({modelVersion:i}),{staleTime:1/0,retry:3}),s=l.useMemo(()=>{const h={};if(a){const{availableResolutions:p}=a,{basicResolutions:g,advancedResolutions:m,restrictedResolutions:v}=p,x=new Set(v?v.map(y=>y.aspectRatio):[]);if(g)for(const y of g)h[y.aspectRatio]={isBasic:!0,isRestricted:x.has(y.aspectRatio),resolutionObject:y};if(m)for(const y of m)h[y.aspectRatio]={isBasic:!1,isRestricted:x.has(y.aspectRatio),resolutionObject:y}}return h},[a]),c=l.useCallback(h=>h.width/h.height,[]),d=l.useMemo(()=>Object.values(s).sort((h,p)=>c(h.resolutionObject)-c(p.resolutionObject)),[s,c]),u=l.useMemo(()=>d.filter(h=>!h.isRestricted),[d]);return{allAspectRatios:d,getAspectRatioNumber:c,nonRestrictedResolution:u,aspectRatioDict:s}},ou=t=>{const{generationData:e}=t,{hasAccessToCustomColorPalette:n,hasAccessToAdvancedFeatures:o,subscriptionStatus:i,hasAccessToTiling:a,hasAccessToSuperRes:s,userProfileState:c,hasAccessToModel21:d}=l.useContext(ge),{generationInput:u,setGenerationInput:h,setSuggestions:p,setGenerationInputMode:g}=l.useContext(ye),{pathname:m}=Rn(),{isColorPaletteInPreset:v}=C1(),{nonRestrictedResolution:x}=_1({forceModal:e==null?void 0:e.model_version}),y=l.useMemo(()=>["model_2.0","model_1.0"],[]),_=l.useMemo(()=>Zl(m),[m]),w=l.useMemo(()=>{const L=new Set(["model_0.2","model_0.1"]);return _&&(L.add("negative_prompt"),L.add("tile")),L},[_]),I=l.useMemo(()=>{const L=new Set(y);return d&&L.add("model_2.1"),n&&L.add("custom_color_palette"),o&&(L.add("rendering"),L.add("negative_prompt")),i!=null&&i.activeSubscription&&L.add("magic_fill_extend"),a&&L.add("tile"),s&&L.add("upscale"),L},[y,o,n,d,s,a,i==null?void 0:i.activeSubscription]),R=l.useCallback(()=>{var P,G,B;const L=new Set;return e&&(e.model_version==="V_2_1"?L.add("model_2.1"):e.model_version==="V_1_5"?L.add("model_2.0"):e.model_version==="V_0_3"?L.add("model_1.0"):e.model_version==="V_0_2"?L.add("model_0.2"):e.model_version==="V_0_1"&&L.add("model_0.1"),e.color_palette&&!v(e.color_palette)&&L.add("custom_color_palette"),e.sampling_speed&&L.add("rendering"),e.user_negative_prompt&&L.add("negative_prompt"),e.request_type==="INPAINTING"&&L.add("magic_fill_extend"),e.request_type==="SUPER_RES"&&L.add("upscale"),e.request_type==="TILING"&&L.add("tile"),e.request_type!=="INPAINTING"&&((P=e==null?void 0:e.parent)!=null&&P.should_hide||(G=e==null?void 0:e.variation_parent)!=null&&G.should_hide||(B=e==null?void 0:e.upload_parent)!=null&&B.private&&(e==null?void 0:e.upload_parent.user.user_id)!==(c==null?void 0:c.userId))&&L.add("inaccessible_parent"),x.map(M=>M.resolutionObject.aspectRatio).includes(e.aspect_ratio)||L.add("inaccessible_aspect_ratio")),L},[e,v,x,c==null?void 0:c.userId]),S=l.useCallback(L=>Ut.difference([...L],[...I]),[I]),E=l.useCallback(L=>Ut.intersection([...w],[...L]),[w]),N=l.useCallback(()=>{const L=R(),P=E(L);if(P.length)return{reasons:P,blockedBy:"ui"};const G=S(L);if(G.length)return{reasons:G,blockedBy:"account"}},[S,E,R]),k=l.useCallback(L=>{var j,Z;if(!(e!=null&&e.model_version))return;let P=e.model_version;_&&(P="V_1_5");let G=e.user_prompt;if(rs(P)){const ee=La(G);G=ee.prompt,p(ee.styles)}const B=e.request_type!=="INPAINTING"?e.parent??e.variation_parent??e.upload_parent:void 0;let M="OFF";const z=(j=e.responses)==null?void 0:j.filter(ee=>ee.is_autoprompt===!0);(z==null?void 0:z.length)===4?M="ON":z!=null&&z.length&&(M="AUTO");const F=(Z=e.color_palette)==null?void 0:Z.map(ee=>({colorHex:ee.color_hex,colorWeight:ee.color_weight})),T=e.request_type==="INPAINTING"&&e.request_id?{request_id:e.request_id,response_id:L}:void 0;h({...u,prompt:G,variation_input:B,timestamp:Date.now(),aspectRatio:e.aspect_ratio,model_version:P,use_autoprompt:M,seed:void 0,negative_prompt:e.user_negative_prompt,generation_speed:e.sampling_speed,tiling_preset:e.tiling_preset,upscale_details_weight:e.upscale_details_weight,style_expert:e.style_expert,selected_aspect_ratio_v2:{aspectRatio:e.aspect_ratio,height:e.height,width:e.width},color_palette:F?{members:F}:void 0,retry_inpaint_data:T}),g(B?e.request_type==="SUPER_RES"?"upscale":"remix":"generate")},[e,u,_,h,g,p]),{showPayWallModel:A}=$t(),D=l.useCallback((L,P)=>{const G=N();if(G)return G.blockedBy==="account"&&A("RETRY"),G;k(P)},[N,k,A]);return{isRetryBlockForNonSubscriptionReason:l.useCallback(L=>L?L.blockedBy==="ui"||L.blockedBy==="account"&&L.reasons.includes("inaccessible_parent")?!0:!!(L.blockedBy==="account"&&L.reasons.includes("model_2.1")):!1,[]),getRetryBlockedReason:N,handleRetryGeneration:D}};function $a({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??17,height:e??16,fill:n??"inherit",viewBox:"0 0 17 16",children:r.jsx("path",{fill:n??"inherit",d:"M3.167 4.5a1.5 1.5 0 011.5-1.5h2.23a.5.5 0 100-1h-2.23a2.5 2.5 0 00-2.5 2.5v7a2.5 2.5 0 002.5 2.5h7a2.5 2.5 0 002.5-2.5V9.27a.5.5 0 00-1 0v2.23a1.5 1.5 0 01-1.5 1.5h-3.5V9.77A1.77 1.77 0 006.396 8h-3.23V4.5zm0 4.5h3.23a.77.77 0 01.77.77V13h-2.5a1.5 1.5 0 01-1.5-1.5V9zm5.769-6.5a.5.5 0 01.5-.5h4.23a.5.5 0 01.5.5v4.23a.5.5 0 01-1 0V3.708L9.79 7.084a.5.5 0 01-.708-.707L12.46 3H9.436a.5.5 0 01-.5-.5z"})})}const b7="Image is already at maximum resolution available. Higher resolutions coming soon.",C7=t=>{const{handleUpscale:e,isSuperResDisabled:n}=t,o=Ee(),{hasAccessToSuperRes:i}=l.useContext(ge),{showPayWallModel:a}=$t(),s=l.useCallback(()=>{o({eventKey:"UPSCALE_CLICK_FROM_ZOOM_IN_PAGE"}),i?e==null||e():a("SUPER_RES")},[o,i,a,e]);return e?r.jsx(Rt,{content:n?b7:void 0,children:r.jsx(C,{flex:1,children:r.jsx(It,{withIcon:!0,fullWidth:!0,size:"small",disabled:n,label:r.jsxs(C,{sx:{display:"flex",alignItems:"center"},children:[r.jsx($a,{width:18,height:18}),r.jsx(C,{width:4}),"Upscale",!i&&r.jsx(I1,{children:r.jsx(Wt,{})})]}),onClick:s,customHeight:36})})}):r.jsx(C,{style:{flex:1}})},I1=ii(C)({marginLeft:"2px",minHeight:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),Hp=new Map([["model_2.0","Model Ideogram 2.0"],["model_1.0","Model Ideogram 1.0"],["model_0.2","Model Ideogram 0.2"],["model_0.1","Model Ideogram 0.2"],["custom_color_palette","Custom color palette"],["rendering","Rendering"],["negative_prompt","Negative prompt"],["magic_fill_extend","Magic Fill or Extend"],["tile","Tile"],["upscale","Upscale"],["inaccessible_aspect_ratio","Custom aspect ratio"]]),_7=t=>{const{generationData:e,onRetryGeneration:n,targetResponseId:o}=t,{handleRetryGeneration:i,getRetryBlockedReason:a}=ou({generationData:e}),s=l.useMemo(()=>{if(e)return a()},[e,a]),c=l.useMemo(()=>{if(s){if(s.blockedBy==="ui")return s.reasons.includes("model_0.1")?"Model 0.1 is no longer supported":s.reasons.includes("model_0.2")?"Model 0.2 is no longer supported":r.jsxs(r.Fragment,{children:["Canvas doesn't support these settings yet:"," ",r.jsx(qp,{children:s.reasons.map(h=>{const p=Hp.get(h);return p?r.jsx("li",{children:p},p):null})})]});if(s.blockedBy==="account"&&s.reasons.includes("inaccessible_parent"))return"Can't retry because the parent image is not accessible anymore";if(s.blockedBy==="account"&&s.reasons.includes("model_2.1"))return"Ideogram 2a is not accessible at the moment"}},[s]),d=l.useMemo(()=>{if(!(c||!s)&&s.blockedBy==="account")return r.jsxs(r.Fragment,{children:["This creation uses paid settings:"," ",r.jsx(qp,{children:s.reasons.map(h=>{const p=Hp.get(h);return p?r.jsx("li",{children:p},h):null})})]})},[s,c]),u=l.useCallback(()=>{!e||o===void 0||(i(e,o),n==null||n())},[e,i,n,o]);return e?r.jsx(Rt,{content:c??d,children:r.jsx(I7,{children:r.jsx(It,{customHeight:36,withIcon:!0,fullWidth:!0,size:"small",label:r.jsxs(r.Fragment,{children:[r.jsx(nu,{color:f(c?"outlinedButtonTextDisabled":"outlinedButtonText"),width:18,height:18}),r.jsx(C,{width:4}),"Retry",!!d&&r.jsx(I1,{children:r.jsx(Wt,{})})]}),onClick:u,disabled:!!c})})}):null},I7=b(C)({minWidth:"calc((100% - 16px) / 3)"}),qp=b("ul")(()=>({listStyle:"disc",padding:"0 0 0 20px",marginTop:"4px"})),S7=t=>{var u;const{isPrivate:e,isCreator:n,toggleVisibility:o}=t,{subscriptionStatus:i}=l.useContext(ge),[a,s]=l.useState(!1),{showPayWallModel:c}=$t(),d=l.useMemo(()=>[{optionName:"Public",onSelect:()=>{o==null||o(!1)}},{optionName:"Private",onSelect:()=>{var h;a||e||((h=i==null?void 0:i.subscriptionQuota)!=null&&h.privateGeneration?o==null||o(!0):(s(!0),setTimeout(()=>{s(!1),c("ZOOM_IN_PRIVATE_TOGGLE")},500)))}}],[o,a,e,(u=i==null?void 0:i.subscriptionQuota)==null?void 0:u.privateGeneration,c]);return n?r.jsx(r.Fragment,{children:r.jsx(is,{options:d,currentSelection:a||e?"Private":"Public",width:160,height:36,round:!0})}):r.jsx("div",{})},R7=t=>{const{isPrivate:e,isCreator:n,toggleVisibility:o,isGeneration:i,generationData:a,onRetryGeneration:s,targetResponseId:c}=t;return r.jsxs(T7,{children:[r.jsx(S7,{isPrivate:e,isCreator:n,toggleVisibility:o}),i&&a&&r.jsx(_7,{generationData:a,onRetryGeneration:s,targetResponseId:c})]})},T7=ii(C)({width:"100%",display:"flex",flexDirection:"row",alignItems:"stretch",justifyContent:"space-between"});function ti({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsxs("g",{fill:n,clipPath:"url(#clip0_452_440)",children:[r.jsx("path",{fillRule:"evenodd",d:"M8 7H4.333A3.333 3.333 0 001 10.333v9.334A3.333 3.333 0 004.333 23h9.334A3.333 3.333 0 0017 19.667V16c-.453 0-.898-.034-1.333-.098v3.765c0 .308-.07.6-.195.862l-4.87-4.869a2.267 2.267 0 00-3.205 0l-4.869 4.869a1.992 1.992 0 01-.195-.862v-9.334a2 2 0 012-2h3.765A9.073 9.073 0 018 7zm-2.33 6.005a1.336 1.336 0 110-2.672 1.336 1.336 0 010 2.672zm2.67 3.598l-4.869 4.869c.261.125.554.195.862.195h9.334c.308 0 .6-.07.862-.195l-4.87-4.87a.933.933 0 00-1.319 0z",clipRule:"evenodd"}),r.jsx("path",{d:"M14.2 6.3a.7.7 0 01.7-.7h4.2a.7.7 0 110 1.4h-4.2a.7.7 0 01-.7-.7zm.7 2.1a.7.7 0 100 1.4h2.8a.7.7 0 100-1.4h-2.8zM10 7a7 7 0 113.627 6.135l-2.723.829a.7.7 0 01-.874-.874l.83-2.726A6.972 6.972 0 0110 7zm7-5.6a5.6 5.6 0 00-4.784 8.512.7.7 0 01.072.569l-.536 1.761 1.759-.535a.7.7 0 01.57.073A5.6 5.6 0 1017 1.4z"})]})})}const E7=t=>{const{handleDescribe:e}=t,{loadingDescription:n}=l.useContext(ye);return n?r.jsx(C,{style:{flex:1},children:r.jsx(ht,{label:r.jsxs(r.Fragment,{children:[r.jsx(ti,{color:f("primaryButtonTextDisable"),width:18,height:18}),r.jsx(C,{width:4}),"Describe"]}),disabled:!0,fullWidth:!0,size:"small",customHeight:36})}):r.jsx(It,{customHeight:36,withIcon:!0,fullWidth:!0,size:"small",label:r.jsxs(r.Fragment,{children:[r.jsx(ti,{color:f("outlinedButtonText"),width:18,height:18}),r.jsx(C,{width:4}),"Describe"]}),onClick:e})};function k7({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??22,height:e??22,fill:n??"inherit",viewBox:"0 0 22 22",children:r.jsx("g",{children:r.jsx("path",{fill:n??"inherit",d:"M8.02 16.959h3.32a1.415 1.415 0 01-.265-1.375H8.021l-.132-.006a1.604 1.604 0 01-1.472-1.599V2.521l-.007-.093a.688.688 0 00-1.368.093l-.001 2.52H2.52l-.094.007a.688.688 0 00.094 1.369h2.52v7.562l.005.17a2.98 2.98 0 002.975 2.81zm8.814-5.7c.043.032.085.065.124.1V8.02l-.005-.17a2.98 2.98 0 00-2.974-2.81H7.333v1.376h6.646l.132.005a1.604 1.604 0 011.472 1.599v3.047a1.416 1.416 0 011.25.192zm4.445.265l.562.183.011.002a.221.221 0 010 .418l-.561.182a1.155 1.155 0 00-.733.732l-.182.561a.222.222 0 01-.419 0l-.182-.56a1.156 1.156 0 00-.732-.735l-.562-.183a.222.222 0 010-.418l.561-.182a1.157 1.157 0 00.722-.732l.182-.56a.221.221 0 01.337-.108.222.222 0 01.081.107l.183.561a1.156 1.156 0 00.732.732zm-6.746 6.026a2.591 2.591 0 01.628 1.022l.41 1.262a.5.5 0 00.941 0l.41-1.262a2.6 2.6 0 011.649-1.647l1.263-.41a.499.499 0 000-.94l-.026-.006-1.263-.41a2.603 2.603 0 01-1.648-1.648l-.41-1.261a.499.499 0 00-.941 0l-.41 1.261-.011.032a2.6 2.6 0 01-1.613 1.615l-1.263.41a.5.5 0 000 .94l1.263.41c.385.13.734.345 1.02.632z"})})})}function A7({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??22,height:e??22,fill:n??"inherit",viewBox:"0 0 22 22",children:r.jsx("g",{children:r.jsx("path",{fill:n??"inherit",d:"M14.748 5.878a2.6 2.6 0 00-1.235-.876l-1.263-.41a.499.499 0 010-.94l1.263-.41a2.603 2.603 0 001.612-1.616l.01-.031.41-1.262a.5.5 0 01.942 0l.41 1.262a2.6 2.6 0 001.649 1.647l1.262.41.026.006a.499.499 0 010 .94l-1.263.41a2.602 2.602 0 00-1.648 1.647l-.41 1.262a.499.499 0 01-.94 0l-.412-1.262a2.6 2.6 0 00-.413-.777zM21.8 9.362l-.702-.228a1.445 1.445 0 01-.915-.915l-.228-.7a.277.277 0 00-.523 0l-.228.7a1.443 1.443 0 01-.902.915l-.701.228a.277.277 0 000 .522l.701.228a1.445 1.445 0 01.916.919l.228.7a.277.277 0 00.523 0l.228-.7a1.443 1.443 0 01.915-.915l.702-.228a.277.277 0 000-.522l-.014-.004zm-10.544-6.09c.178-.24.422-.421.703-.522H9.854a.687.687 0 100 1.375H11v-.028c0-.295.09-.582.257-.825zm-7.82 5.895c.38 0 .688.307.688.687v2.292a.687.687 0 11-1.375 0V9.854c0-.38.308-.687.688-.687zm9.396 9.396c0 .38-.308.687-.687.687H9.854a.687.687 0 110-1.375h2.292c.38 0 .687.308.687.688zM5.73 2.75a.688.688 0 010 1.375h-.458c-.633 0-1.146.513-1.146 1.146v.458a.688.688 0 01-1.375 0v-.458A2.52 2.52 0 015.27 2.75h.46zm0 16.5a.688.688 0 000-1.375h-.458a1.146 1.146 0 01-1.146-1.146v-.458a.687.687 0 10-1.375 0v.458a2.52 2.52 0 002.52 2.521h.46zm9.854-.688c0 .38.308.688.688.688h.458a2.52 2.52 0 002.521-2.52v-.46a.687.687 0 10-1.375 0v.46c0 .632-.513 1.145-1.146 1.145h-.458a.687.687 0 00-.688.688z"})})})}const j7=t=>{const{handleOpenInCanvas:e,handleMagicFill:n,handleExtend:o}=t,i=Ee(),{showPayWallModel:a}=$t(),{subscriptionStatus:s}=l.useContext(ge),{createCanvasLocked:c}=l.useContext(ye),d=l.useMemo(()=>!!(s!=null&&s.activeSubscription),[s==null?void 0:s.activeSubscription]);return r.jsx(It,{customHeight:36,withIcon:!0,fullWidth:!0,size:"small",label:r.jsxs(r.Fragment,{children:[r.jsx(hs,{color:f("outlinedButtonText"),width:18,height:18}),r.jsx(C,{width:4}),"Open in Canvas",c&&r.jsxs(r.Fragment,{children:[r.jsx(C,{width:4}),r.jsx(Wt,{})]})]}),dropdownOptions:[{label:r.jsxs($p,{children:[r.jsxs(Wp,{children:[r.jsx(A7,{width:18,height:18}),r.jsx(Vp,{children:"Magic Fill"})]}),d&&!c?r.jsx("div",{}):r.jsx(Wt,{})]}),onClick:()=>{if(i({eventKey:"MAGIC_FILL_FROM_ZOOM_IN_PAGE"}),!d){a("CANVAS_MAGIC_FILL");return}n==null||n()}},{label:r.jsxs($p,{children:[r.jsxs(Wp,{children:[r.jsx(k7,{width:18,height:18}),r.jsx(Vp,{children:"Extend"})]}),d&&!c?r.jsx("div",{}):r.jsx(Wt,{})]}),onClick:()=>{if(i({eventKey:"EXTEND_FROM_ZOOM_IN_PAGE"}),!d){a("CANVAS_EXTEND");return}o==null||o()}}],onClick:()=>{i({eventKey:"OPEN_CANVAS_FROM_ZOOM_IN_PAGE"}),e==null||e()}})},Wp=b(C)({display:"flex",alignItems:"center",justifyContent:"center",gap:10}),$p=b(C)({display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",gap:10}),Vp=b(le)(()=>({fontSize:14,fontWeight:400,lineHeight:"20px",letterSpacing:"-0.14px"}));function Va({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??20,height:e??20,fill:n??"inherit",viewBox:"0 0 20 20",children:r.jsx("path",{fill:n??"inherit",d:"M10 5.5a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zm-4-2a.5.5 0 00-1 0V5H3.5a.5.5 0 000 1H5v1.5a.5.5 0 001 0V6h1.5a.5.5 0 000-1H6V3.5zm8 .5h-3.207a5.466 5.466 0 00-.393-1H14a3 3 0 013 3v8a3 3 0 01-3 3H6a3 3 0 01-3-3v-3.6c.317.162.651.294 1 .393V14c0 .373.102.722.28 1.02l4.669-4.588a1.5 1.5 0 012.102 0l4.67 4.588A1.99 1.99 0 0016 14V6a2 2 0 00-2-2zm0 3.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm-1 0a.5.5 0 10-1 0 .5.5 0 001 0zm-8.012 8.226A1.99 1.99 0 006 16h8c.37 0 .715-.1 1.012-.274l-4.662-4.58a.5.5 0 00-.7 0l-4.662 4.58z"})})}const P7=t=>{const{handleRemix:e}=t;return e?r.jsx(It,{customHeight:36,withIcon:!0,fullWidth:!0,size:"small",label:r.jsxs(r.Fragment,{children:[r.jsx(Va,{color:f("outlinedButtonText"),width:18,height:18}),r.jsx(C,{width:4}),"Remix"]}),onClick:e}):r.jsx(C,{flex:1})};function ni({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??18,height:e??18,fill:n??"inherit",viewBox:"0 0 18 18",children:r.jsx("g",{id:"Icon / Remove background",children:r.jsx("g",{id:"Vector",fill:n??"inherit",children:r.jsx("path",{d:"M6.563 12.178h4.87c.69 0 1.254.53 1.309 1.205l.004.107v2.261h-1.125v-2.26a.19.19 0 0 0-.144-.183l-.043-.005H6.563a.19.19 0 0 0-.183.144l-.005.043v2.261H5.25v-2.26c0-.69.53-1.254 1.205-1.309zM9 6.75a2.25 2.25 0 1 1 0 4.5 2.25 2.25 0 0 1 0-4.5m0 1.125a1.125 1.125 0 1 0 0 2.25 1.125 1.125 0 0 0 0-2.25M9.938 2.25h1.59L2.25 11.532V9.94zM6.566 2.25h1.59L2.25 8.158v-1.59zM2.25 4.782v-.095A2.44 2.44 0 0 1 4.688 2.25h.093zM2.595 14.563a2.4 2.4 0 0 1-.345-1.247l3.79-3.79c.068.417.222.805.444 1.146zM4.5 15.743a2.4 2.4 0 0 1-1.001-.302L4.5 14.44zM15.75 13.313a2.44 2.44 0 0 1-2.25 2.43v-.18zM15.75 9.94v1.59l-2.25 2.25v-.266c0-.38-.103-.736-.283-1.041zM15.75 6.563v1.592l-3.475 3.475a2.1 2.1 0 0 0-.838-.177h-.575zM15.44 3.496c.197.352.31.759.31 1.192v.088l-3.787 3.789a3 3 0 0 0-.44-1.151zM14.56 2.593l-3.927 3.928a3 3 0 0 0-1.146-.444l3.825-3.827c.456 0 .883.125 1.248.343"})})})})}const M7="The parent image before remove background is not accessible anymore.",O7=t=>{const{handleRemoveBg:e,handleEditBg:n,isBackgroundRemovedImage:o,isEditBackgroundDisabled:i}=t,{showPayWallModel:a}=$t(),{hasAccessToRemoveBg:s}=l.useContext(ge),{createCanvasLocked:c}=l.useContext(ye),d=l.useMemo(()=>!s||c,[c,s]),u=l.useCallback(()=>{if(Xe({eventKey:"EDIT_BG_CLICK",metaData:{from:Zl(window.location.pathname)?"CANVAS_IMAGE_PANEL":"ZOOM_IN_PAGE"}}),d){a("REMOVE_BACKGROUND");return}n==null||n()},[n,d,a]),h=l.useCallback(()=>{if(Xe({eventKey:"REMOVE_BG_CLICK",metaData:{from:Zl(window.location.pathname)?"CANVAS_IMAGE_PANEL":"ZOOM_IN_PAGE"}}),!s){a("REMOVE_BACKGROUND");return}e==null||e()},[e,s,a]);return o&&n?r.jsx(Rt,{content:i?M7:void 0,children:r.jsx(C,{flex:1,children:r.jsx(It,{customHeight:36,withIcon:!0,fullWidth:!0,size:"small",label:r.jsxs(r.Fragment,{children:[r.jsx(ni,{width:18,height:18}),r.jsx(C,{width:4}),"Edit background",d&&r.jsx(Kp,{children:r.jsx(Wt,{})})]}),onClick:u,disabled:i})})}):e?r.jsx(It,{customHeight:36,withIcon:!0,fullWidth:!0,size:"small",label:r.jsxs(r.Fragment,{children:[r.jsx(ni,{width:18,height:18}),r.jsx(C,{width:4}),"Remove bg",!s&&r.jsx(Kp,{children:r.jsx(Wt,{})})]}),onClick:h}):null},Kp=b(C)({marginLeft:"2px",minHeight:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),ua=t=>{const{isGeneration:e,handleUpscale:n,isSuperResDisabled:o,handleUsePrompt:i,handleRemix:a,isPrivate:s,isCreator:c,toggleVisibility:d,handleOpenInCanvas:u,handleMagicFill:h,handleExtend:p,handleDescribe:g,handleOpenImagePage:m,isBackgroundRemovedImage:v,isEditBackgroundDisabled:x,handleEditBg:y,handleRemoveBg:_,generationData:w,onRetryGeneration:I,targetResponseId:R}=t,S=we(),E=xe(S.breakpoints.down("md")),N=Ee(),k=l.useMemo(()=>!E&&u&&h&&p,[p,h,u,E]),A=l.useMemo(()=>!!m,[m]),D=l.useMemo(()=>!(v&&E),[v,E]),O=l.useMemo(()=>{let L=0;return L+=k?1:0,L+=A?1:0,L+=D?1:0,L},[A,k,D]);return r.jsxs(L7,{children:[c&&r.jsx(R7,{isPrivate:s,isCreator:c,isGeneration:!0,toggleVisibility:d,generationData:w,onRetryGeneration:I,targetResponseId:R}),r.jsxs(Jp,{children:[e||i?r.jsx(It,{customHeight:36,withIcon:!0,fullWidth:!0,size:"small",label:r.jsxs(r.Fragment,{children:[r.jsx(tu,{color:f("outlinedButtonText"),width:18,height:18}),r.jsx(C,{width:4}),"Prompt"]}),onClick:i}):r.jsx(E7,{handleDescribe:g}),r.jsx(P7,{handleRemix:a}),r.jsx(C7,{handleUpscale:n,isSuperResDisabled:o})]}),O>0&&r.jsxs(Jp,{children:[E&&O===1&&r.jsx(C,{flex:1}),k&&r.jsx(j7,{handleOpenInCanvas:u,handleMagicFill:h,handleExtend:p}),A&&r.jsx(It,{customHeight:36,withIcon:!0,fullWidth:!0,size:"small",label:r.jsxs(r.Fragment,{children:[r.jsx(w7,{color:f("outlinedButtonText"),width:18,height:18}),r.jsx(C,{width:4}),"Open image page"]}),onClick:()=>{N({eventKey:"OPEN_IMAGE_PAGE_CLICK_FROM_CANVAS"}),m==null||m()}}),D&&r.jsx(B7,{children:r.jsx(O7,{isEditBackgroundDisabled:x,isBackgroundRemovedImage:v,handleEditBg:y,handleRemoveBg:_})}),!E&&O===1&&r.jsx(C,{flex:1})]})]})},B7=b(C)(({theme:t})=>({flex:1,[t.breakpoints.down("md")]:{maxWidth:"calc((100% - 16px) / 3)"}})),L7=b(C)({width:"100%",display:"flex",flexDirection:"column",alignItems:"stretch",gap:6}),Jp=b(C)({width:"100%",display:"flex",flexDirection:"row",alignItems:"stretch",gap:6});var S1={exports:{}};(function(t,e){(function(n,o){o()})(vo,function(){function n(u,h){return typeof h>"u"?h={autoBom:!1}:typeof h!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),h={autoBom:!h}),h.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function o(u,h,p){var g=new XMLHttpRequest;g.open("GET",u),g.responseType="blob",g.onload=function(){d(g.response,h,p)},g.onerror=function(){console.error("could not download file")},g.send()}function i(u){var h=new XMLHttpRequest;h.open("HEAD",u,!1);try{h.send()}catch{}return 200<=h.status&&299>=h.status}function a(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(h)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof vo=="object"&&vo.global===vo?vo:void 0,c=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(u,h,p){var g=s.URL||s.webkitURL,m=document.createElement("a");h=h||u.name||"download",m.download=h,m.rel="noopener",typeof u=="string"?(m.href=u,m.origin===location.origin?a(m):i(m.href)?o(u,h,p):a(m,m.target="_blank")):(m.href=g.createObjectURL(u),setTimeout(function(){g.revokeObjectURL(m.href)},4e4),setTimeout(function(){a(m)},0))}:"msSaveOrOpenBlob"in navigator?function(u,h,p){if(h=h||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(n(u,p),h);else if(i(u))o(u,h,p);else{var g=document.createElement("a");g.href=u,g.target="_blank",setTimeout(function(){a(g)})}}:function(u,h,p,g){if(g=g||open("","_blank"),g&&(g.document.title=g.document.body.innerText="downloading..."),typeof u=="string")return o(u,h,p);var m=u.type==="application/octet-stream",v=/constructor/i.test(s.HTMLElement)||s.safari,x=/CriOS\/[\d]+/.test(navigator.userAgent);if((x||m&&v||c)&&typeof FileReader<"u"){var y=new FileReader;y.onloadend=function(){var I=y.result;I=x?I:I.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=I:location=I,g=null},y.readAsDataURL(u)}else{var _=s.URL||s.webkitURL,w=_.createObjectURL(u);g?g.location=w:location.href=w,g=null,setTimeout(function(){_.revokeObjectURL(w)},4e4)}});s.saveAs=d.saveAs=d,t.exports=d})})(S1);var Oc=S1.exports;const ru=Jf(Oc),iu=async(t,e)=>{var g,m,v;if(rn()){Sg(t);return}const{request_ids:n,cover_only:o,image_ids:i}=t,a=await Le("/api/d/images",{headers:{"Content-Type":"application/json",...Ne},method:"POST",body:JSON.stringify(t)}),s=parseInt(((g=a.headers)==null?void 0:g.get("Content-Length-Estimation"))??"0"),c=(m=a.headers.get("content-disposition"))==null?void 0:m.split("filename=")[1].split(";")[0],d=(v=a==null?void 0:a.body)==null?void 0:v.getReader();let u=0;const h=[],p=async()=>{await(d==null?void 0:d.read().then(async({done:x,value:y})=>{if(x){const _=((n==null?void 0:n.length)??0)*(o?1:4)+((i==null?void 0:i.length)??0)>1?`ideogram_download_${Ta().format("YYYY-MM-DD")}.zip`:c,w=new Uint8Array(u);let I=0;for(const S of h)w.set(S,I),I+=S.length;const R=new Blob([w]);ru(R,_??"image.png");return}if(h.push(y),u+=y.length,s&&e){const _=Math.min(99,Math.floor(u/s*100));e==null||e(_)}await p()}))};await p()},N7=async t=>{var a;if(rn()){Sg(t);return}const{response_ids:e}=t,n=await Le("/api/d/images",{headers:{"Content-Type":"application/json",...Ne},method:"POST",body:JSON.stringify(t)}),o=e.length>1?`ideogram_download_${Ta().format("YYYY-MM-DD")}.zip`:(a=n.headers.get("content-disposition"))==null?void 0:a.split("filename=")[1].split(";")[0],i=await n.blob();ru(i,o??"image.png")},D7=async t=>{const{request_id:e,response_id:n,undo:o}=t;return Le("/api/r/submit",{headers:{"Content-Type":"application/json",...Ne},method:"POST",body:JSON.stringify({reaction:"♥",request_id:e,response_id:n,undo:o})}).then(i=>i.json())},F7=async t=>{const{request_id:e,response_id:n,reaction:o}=t;return Le("/api/r/submit",{headers:{"Content-Type":"application/json",...Ne},method:"POST",body:JSON.stringify({reaction:o,request_id:e,response_id:n,undo:!1})}).then(i=>i.json())},R1=t=>{const{generationData:e,targetResponseId:n,onLikeCompleted:o,eventKey:i}=t,{setGenerationDecoration:a}=l.useContext($e),s=wo({mutationFn:D7}),c=l.useMemo(()=>{if(e!=null&&e.responses)return e.responses.find(u=>u.response_id===n)},[e==null?void 0:e.responses,n]);return{handleLikeGeneration:l.useCallback(u=>{var g;if(!c||!e)return;const h=Ut.cloneDeep(e),p=(g=h==null?void 0:h.responses)==null?void 0:g.find(m=>m.response_id===c.response_id);if(u&&(p!=null&&p.self_like)){o==null||o({generationData:h,liked:!0});return}if(p){const m=p.num_likes+(c.self_like?-1:1),v=!p.self_like;p.num_likes=m,p.self_like=v,a(h),e.request_id&&s.mutateAsync({request_id:e.request_id,response_id:c.response_id,undo:c.self_like}),o==null||o({generationData:h,liked:p==null?void 0:p.self_like}),Xe({eventKey:i,metaData:{modelVariant:p.model_variant??"",experiment:h.experiment??"",like:p.self_like}})}},[c,e,o,a,i,s])}},Ln=l.createContext({showDoubleTapIndicator:!1,aspectRatioStyle:"1 / 1",isTileImage:!1,isSuperRes:!1,isBgRemovedImage:!1,isEditedImage:!1,isUploadedImage:!1,isMagicFillResultImage:!1,isSuperResDisabled:!0,feedType:"generation",imageAspectRatioNumber:1,switchResponseIndex:()=>{},handlePinGeneration:()=>{},handleRemixGeneration:()=>{},handleUseGenerationPrompt:()=>{},handleLikeGeneration:()=>{},handleAutoLikeGeneration:()=>{},handleReportImage:()=>{},handleEditGeneration:()=>{},handleCanvasGeneration:()=>{},handleCanvasImageFile:()=>{},handleGenerationRemoveBg:()=>{},handleImageFileRemoveBg:()=>{},handleShareGeneration:()=>{},handleDownloadGeneration:()=>{},handleSetProfilePhoto:()=>{},handleGenerationPrivateToggle:()=>{},handleDeleteGeneration:()=>{},handleApplySeed:()=>{},handleDescribeGeneration:()=>{},isCreator:!1,handleRemixImageFile:()=>{},handleEditImageFile:()=>{},handleShareImageFile:()=>{},handleDownloadImageFile:()=>{},handleDeleteImageFile:()=>{},handleImageFilePrivateToggle:()=>{},handleDescribeImageFile:()=>{},useDescriptionAsPrompt:()=>{}}),z7=t=>{var xn,jn,vn,Gt,en,Kn,ao,de,Pe,J;const{children:e}=t,{request_id:n,image_index:o,image_id:i}=an(),{showBoundary:a}=Yf(),s=Ee(),{setBackdropLoading:c}=l.useContext(Do),{userProfileState:d,visionApi:u}=l.useContext(ge),{getBrowsingData:h,navigate:p,replace:g,setGenerationDecoration:m,back:v}=l.useContext($e),{addImagePrompt:x,openEditor:y,openCanvas:_,setGenerationInput:w,generationInput:I,setSuggestions:R,handleDescribeImage:S,handleSubmitGeneration:E,descriptionMap:N}=l.useContext(ye),{setAlertText:k,setAlertContent:A}=l.useContext(Tn),[D,O]=l.useState((xn=h())==null?void 0:xn.generation),[L,P]=l.useState(!1);l.useEffect(()=>{P(!1)},[o,P]),l.useEffect(()=>{var U;return O((U=h())==null?void 0:U.generation)},[h,n]);const{data:G}=Ve(["generationMetadata",n],()=>ud(n,{throwError:!0}),{staleTime:1e3,enabled:!!n&&(!D||!D.is_completed),refetchInterval:U=>U&&U.is_completed?!1:3e3,onError:U=>{U.status===404&&(k("Image is not available"),p(oe.HOME)),a(new Error("Generation not found."))},retryDelay:100,retry:3}),{data:B}=Ve(["fetchImageMetadata",i],()=>Da(i),{staleTime:1e3,enabled:!!i,onError:U=>{U.status===404&&(k("Image is not available"),p(oe.HOME)),a(new Error("Image not found."))},retryDelay:100,retry:3,onSuccess:U=>{m(U),O(U)}}),M=l.useMemo(()=>{if(i)return D??B;const U=D??G;return U!=null&&U.is_completed?U:G??D},[G,D,B,i]),z=l.useMemo(()=>M==null?void 0:M.user,[M]),F=l.useMemo(()=>i?"image":"generation",[i]),T=l.useMemo(()=>{if(F==="generation"&&M&&M.request_id)return M},[F,M]),j=l.useMemo(()=>{if(F==="image"&&M&&M.image_id)return M},[F,M]),Z=l.useMemo(()=>(T==null?void 0:T.request_type)==="SUPER_RES",[T==null?void 0:T.request_type]),ee=l.useMemo(()=>(j==null?void 0:j.upload_type)==="background_removed_image",[j==null?void 0:j.upload_type]),te=l.useMemo(()=>(j==null?void 0:j.upload_type)==="edit",[j==null?void 0:j.upload_type]),$=l.useMemo(()=>(j==null?void 0:j.upload_type)==="upload",[j==null?void 0:j.upload_type]),X=l.useMemo(()=>(T==null?void 0:T.request_type)==="INPAINTING",[T==null?void 0:T.request_type]),W=l.useMemo(()=>(T==null?void 0:T.can_upscale)===!1||(j==null?void 0:j.can_upscale)===!1,[T==null?void 0:T.can_upscale,j==null?void 0:j.can_upscale]),Y=l.useMemo(()=>{if(F==="image"&&i&&j)return Pt(i,"balanced","edit");if(F==="generation"&&n&&o!==void 0&&(T!=null&&T.responses)&&(T!=null&&T.responses[parseInt(o)])){const U=T==null?void 0:T.responses[parseInt(o)].response_id;return Pt(U,"balanced","response")}},[F,i,j,n,o,T==null?void 0:T.responses]),q=l.useMemo(()=>{if(F==="image"&&i&&j)return Qs(i,"lossless","edit");if(F==="generation"&&n&&o!==void 0&&(T!=null&&T.responses)&&(T!=null&&T.responses[parseInt(o)])){const U=T==null?void 0:T.responses[parseInt(o)].response_id;return Qs(U,"lossless","response")}},[T,j,F,i,n,o]),[V,Q]=l.useState(!1);l.useEffect(()=>{q&&(Q(!1),No(q).then(()=>Q(!0)))},[q,Q]);const K=l.useMemo(()=>V?q:Y,[V,q,Y]),ae=l.useMemo(()=>T?parseInt(T.aspect_ratio.split(":")[0])/parseInt(T.aspect_ratio.split(":")[1]):j?j.width/j.height:1,[T,j]),ce=l.useCallback(U=>{T!=null&&T.request_id&&o&&U!==parseInt(o)&&g(oe.GENERATION.replace(":request_id",T.request_id).replace(":image_index",U.toString()))},[T==null?void 0:T.request_id,o,g]),ve=l.useRef(!1);l.useEffect(()=>{ve.current=!1},[n]),l.useEffect(()=>{var Te,Ie,Ke;if(ve.current)return;const U=(Ie=(Te=h())==null?void 0:Te.loadingGenerationState)==null?void 0:Ie.initialResponseId,pe=(Ke=T==null?void 0:T.responses)==null?void 0:Ke.findIndex(dt=>dt.response_id===U);pe!==void 0&&pe!==-1&&pe<4&&o&&(pe!==parseInt(o)&&ce(pe),ve.current=!0)},[T==null?void 0:T.responses,h,o,ce]);const{mutateAsync:se}=wo({mutationFn:Gg}),H=l.useMemo(()=>{if(!(!o||!(T!=null&&T.responses)))return T==null?void 0:T.responses[parseInt(o)]},[T==null?void 0:T.responses,o]),me=l.useMemo(()=>{var U;return(d==null?void 0:d.userId)!==void 0&&((d==null?void 0:d.userId)===((U=T==null?void 0:T.user)==null?void 0:U.user_id)||(d==null?void 0:d.userId)===(j==null?void 0:j.user.user_id))},[d==null?void 0:d.userId,(jn=T==null?void 0:T.user)==null?void 0:jn.user_id,j==null?void 0:j.user.user_id]),ne=l.useCallback(()=>{var U,pe;if(n&&o&&((U=T==null?void 0:T.responses)!=null&&U[parseInt(o)])){const Te=Ut.cloneDeep(T),Ie=(pe=Te.responses)==null?void 0:pe.find(Ke=>{var dt;return Ke.response_id===((dt=T==null?void 0:T.responses)==null?void 0:dt[parseInt(o)].response_id)});if(Ie){Ie.pin_on_profile=!Ie.pin_on_profile,s({eventKey:Ie.pin_on_profile?"PIN_CLICK":"UNPIN_CLICK",metaData:{modelVariant:Ie.model_variant??"",experiment:Te.experiment??""}});const Ke={...Te,private:Ie.pin_on_profile?!1:Te.private};m(Ke),O(Ke),se({request_id:n,response_id:Ie.response_id,pin:Ie.pin_on_profile}),Ie.pin_on_profile&&Te.private&&k(`${T.responses&&T.responses.length>1?"Image set":"Image"} is now pinned`,{autoDismissMs:2e3})}}},[T,o,se,n,k,m,s]),{handleLikeGeneration:ue}=R1({generationData:T,targetResponseId:H==null?void 0:H.response_id,onLikeCompleted:({generationData:U,liked:pe})=>{pe&&(P(!0),setTimeout(()=>P(!1),1500)),O(U)},eventKey:"LIKE_CLICK_FROM_ZOOMIN_VIEW"}),fe=l.useCallback(()=>{me||ue(!0)},[ue,me]),Se=l.useMemo(()=>{var U,pe,Te;return j&&yS(j)||!!((U=T==null?void 0:T.parent)!=null&&U.should_hide)||!!((pe=T==null?void 0:T.variation_parent)!=null&&pe.should_hide)||((Te=T==null?void 0:T.upload_parent)==null?void 0:Te.private)&&(T==null?void 0:T.upload_parent.user.user_id)!==(d==null?void 0:d.userId)},[j,(vn=T==null?void 0:T.parent)==null?void 0:vn.should_hide,(Gt=T==null?void 0:T.variation_parent)==null?void 0:Gt.should_hide,(en=T==null?void 0:T.upload_parent)==null?void 0:en.private,(Kn=T==null?void 0:T.upload_parent)==null?void 0:Kn.user.user_id,d==null?void 0:d.userId]),je=l.useCallback(()=>{!T||!(H!=null&&H.response_id)||(s({eventKey:"REMIX_TEXT_BUTTON_CLICK_FROM_ZOOMIN_VIEW",metaData:{response_id:H.response_id}}),x({response_id:H.response_id,parent:T}),fe())},[T,H==null?void 0:H.response_id,s,x,fe]),qe=l.useCallback(()=>{if(!T||!H)return;fe();const U=H.prompt??T.user_prompt;if(rs(I.model_version)){const pe=La(U);R(pe.styles),w({...I,prompt:pe.prompt,timestamp:Date.now()})}else w({...I,prompt:U,timestamp:Date.now()})},[T,H,fe,I,R,w]),De=l.useCallback(()=>{(T==null?void 0:T.seed)!==void 0&&w({...I,timestamp:Date.now(),seed:T==null?void 0:T.seed})},[T==null?void 0:T.seed,I,w]),Ye=l.useCallback(async()=>{H&&(fe(),S({response_id:H.response_id}))},[H,fe,S]),nt=l.useCallback(U=>{var dt,ot,jt,To;if(!j)return;const{submitGenerationAs:pe}=U??{},{image_id:Te,aspect_ratio:Ie,private:Ke}=j;if(Te){const at=(jt=(ot=(dt=j.descriptions)==null?void 0:dt[0])==null?void 0:ot.caption)!=null&&jt[0]?(To=j.descriptions)==null?void 0:To[0].caption[0]:void 0,yn={...I,variation_input:{image_id:Te,private:!!Ke},aspectRatio:Ie,timestamp:Date.now(),imageParent:j,prompt:at};w(yn),pe==="upscale"&&E({generationDataOverride:{...yn,prompt:at},generationInputModeOverride:pe})}},[j,I,w,E]),ct=wo({mutationFn:F7}),he=l.useCallback(async U=>{H!=null&&H.response_id&&(T!=null&&T.request_id)&&await ct.mutateAsync({request_id:T.request_id,response_id:H==null?void 0:H.response_id,reaction:U})},[H==null?void 0:H.response_id,T==null?void 0:T.request_id,ct]),Fe=l.useCallback(()=>{H!=null&&H.response_id&&T&&(fe(),y({responseId:H==null?void 0:H.response_id,defaultPrivate:!!T.private,parentInfo:{parent_request_id:T.request_id,parent_response_id:H.response_id,aspect_ratio:T.aspect_ratio}}))},[H==null?void 0:H.response_id,T,fe,y]),Ge=l.useCallback(U=>{H!=null&&H.response_id&&T&&(fe(),_({requestId:n,responseId:H==null?void 0:H.response_id,title:T.user_prompt},U))},[H==null?void 0:H.response_id,T,fe,_,n]),st=l.useCallback(async()=>{if(H!=null&&H.response_id){fe(),c(!0);try{const U=await(u==null?void 0:u.removeImageBackground({postRemoveImageBackgroundRequest:{assetType:Qr.Response,assetId:H.response_id}}));if(U!=null&&U.backgroundRemovedImageId){const pe=oe.IMAGE.replace(":image_id",U.backgroundRemovedImageId);p({...mt(pe)})}else throw new Error("remove bg failed")}catch{s({eventKey:"BG_REMOVAL_FAILURE"})}c(!1)}},[fe,p,c,H==null?void 0:H.response_id,s,u]),bt=l.useCallback(()=>{j!=null&&j.image_id&&y({imageId:j.image_id,defaultPrivate:!!j.private,parentInfo:{parent_image_id:j.image_id,aspect_ratio:j.aspect_ratio}})},[j==null?void 0:j.aspect_ratio,j==null?void 0:j.image_id,j==null?void 0:j.private,y]),En=l.useCallback(U=>{var pe,Te,Ie;j!=null&&j.image_id&&_({imageId:j==null?void 0:j.image_id,title:((Ie=(Te=(pe=j==null?void 0:j.descriptions)==null?void 0:pe[0])==null?void 0:Te.caption)==null?void 0:Ie[0])??""},U)},[j==null?void 0:j.descriptions,j==null?void 0:j.image_id,_]),We=l.useCallback(async()=>{if(j!=null&&j.image_id){c(!0);try{const U=await(u==null?void 0:u.removeImageBackground({postRemoveImageBackgroundRequest:{assetType:Qr.Upload,assetId:j.image_id}}));if(U!=null&&U.backgroundRemovedImageId){const pe=oe.IMAGE.replace(":image_id",U.backgroundRemovedImageId);p({...mt(pe)})}else throw new Error("remove bg failed")}catch{s({eventKey:"BG_REMOVAL_FAILURE"})}c(!1)}},[j==null?void 0:j.image_id,p,c,s,u]),vt=l.useCallback(()=>{if(!T)return;s({eventKey:"SHARE_LINK_CLICK",metaData:{response_id:(H==null?void 0:H.response_id)??"",modelVariant:(H==null?void 0:H.model_variant)??"",experiment:(T==null?void 0:T.experiment)??""}});const U=`${window.location.origin}/g/${T.request_id}/${o}`;navigator.share?navigator.share({url:U,title:"ideogram.ai"}):(navigator.clipboard.writeText(U),A("Share link copied!"))},[T,s,H==null?void 0:H.response_id,H==null?void 0:H.model_variant,o,A]),Qt=l.useCallback(()=>{if(!j)return;s({eventKey:"SHARE_LINK_CLICK"});const U=`${window.location.origin}/i/${j.image_id}`;navigator.share?navigator.share({url:U,title:"ideogram.ai"}):(navigator.clipboard.writeText(U),A("Share link copied!"))},[j,A,s]),kt=l.useCallback(()=>{s({eventKey:"DOWNLOAD_IMAGE_CLICK",metaData:{response_id:(H==null?void 0:H.response_id)??"",modelVariant:(H==null?void 0:H.model_variant)??"",experiment:(T==null?void 0:T.experiment)??""}}),H!=null&&H.response_id&&N7({response_ids:[H.response_id]})},[H==null?void 0:H.model_variant,H==null?void 0:H.response_id,T==null?void 0:T.experiment,s]),Ct=l.useCallback(()=>{s({eventKey:"DOWNLOAD_IMAGE_CLICK"}),j!=null&&j.image_id&&(s({eventKey:"DOWNLOAD_IMAGE_CLICK"}),iu({image_ids:[j==null?void 0:j.image_id],cover_only:!0,request_ids:[]}))},[j==null?void 0:j.image_id,s]),so=l.useCallback(async()=>{!(T!=null&&T.request_id)||!(H!=null&&H.response_id)||(s({eventKey:"SET_PROFILE_PHOTO_CLICK",metaData:{response_id:(H==null?void 0:H.response_id)??"",modelVariant:(H==null?void 0:H.model_variant)??"",experiment:(T==null?void 0:T.experiment)??""}}),await mI({request_id:T.request_id,response_id:H.response_id}),A("Profile photo updating"))},[T==null?void 0:T.request_id,T==null?void 0:T.experiment,H==null?void 0:H.response_id,H==null?void 0:H.model_variant,s,A]),{mutateAsync:gn}=wo({mutationFn:pd}),Dn=l.useCallback(U=>{var pe;if(n&&H&&T){const Te=Ut.cloneDeep(T),Ie=U===void 0?!T.private:U,Ke={...Te,private:Ie,responses:(pe=Te.responses)==null?void 0:pe.map(dt=>({...dt,pin_on_profile:Ie?!1:void 0}))};m(Ke),O(Ke),gn({make_public:!Ie,request_ids:[n]}),k(`${T.responses&&T.responses.length>1?"Image set":"Image"} is now ${Ie?"private":"public"}.`,{autoDismissMs:2e3})}},[n,H,T,m,gn,k]),{mutateAsync:kn}=wo({mutationFn:gd}),An=l.useCallback(U=>{if(j){const pe=Ut.cloneDeep(j),Te=U===void 0?!j.private:U,Ie={...pe,private:Te};m(Ie),O(Ie),kn({make_public:!Te,image_ids:[j.image_id]}),k(`Image is now ${Te?"private":"public"}.`,{autoDismissMs:2e3})}},[j,k,m,kn]),Vn=l.useCallback(async()=>{T!=null&&T.request_id&&(fd({request_ids:[T.request_id]}).then(()=>{k(`${T.responses&&T.responses.length>1?"Image set":"Image"} is now deleted.`,{autoDismissMs:2e3})}),m({...T,deleted:!0}),v())},[v,T,k,m]),mn=l.useCallback(async()=>{j!=null&&j.image_id&&md({image_ids:[j.image_id]}).then(()=>{k("Image is now deleted.",{autoDismissMs:2e3}),m({...j,deleted:!0}),v()})},[v,j,k,m]),ln=l.useCallback(async()=>{j!=null&&j.image_id&&S({image_id:j.image_id})},[j,S]),cn=l.useMemo(()=>{var pe,Te,Ie,Ke,dt,ot,jt,To,at,yn;if(j)return(pe=j.edit_parent)!=null&&pe.upload_parent?Zr((Te=j.edit_parent)==null?void 0:Te.upload_parent.image_id,"balanced"):(Ie=j.edit_parent)!=null&&Ie.variation_parent?Pt((Ke=j.edit_parent)==null?void 0:Ke.variation_parent.response_id,"balanced","response"):void 0;if(T!=null&&T.inpainting_init_image&&(T!=null&&T.inpainting_mask_image)&&T.request_id)return Fg(T.request_id);if((dt=T==null?void 0:T.upload_parent)!=null&&dt.image_id||(ot=T==null?void 0:T.parent)!=null&&ot.image_id){const tn=((jt=T==null?void 0:T.upload_parent)==null?void 0:jt.image_id)??((To=T==null?void 0:T.parent)==null?void 0:To.image_id);return Pt(tn,"balanced","edit")}const U=((at=T==null?void 0:T.variation_parent)==null?void 0:at.response_id)??((yn=T==null?void 0:T.parent)==null?void 0:yn.response_id);return U?Pt(U,"balanced","response"):void 0},[j,T==null?void 0:T.inpainting_init_image,T==null?void 0:T.inpainting_mask_image,T==null?void 0:T.request_id,(ao=T==null?void 0:T.upload_parent)==null?void 0:ao.image_id,(de=T==null?void 0:T.parent)==null?void 0:de.image_id,(Pe=T==null?void 0:T.parent)==null?void 0:Pe.response_id,(J=T==null?void 0:T.variation_parent)==null?void 0:J.response_id]),Fn=l.useMemo(()=>!!(T!=null&&T.tiling_preset),[T==null?void 0:T.tiling_preset]),Zt=l.useMemo(()=>H!=null&&H.response_id&&Fn?Pt(H.response_id,"balanced","tile"):void 0,[H==null?void 0:H.response_id,Fn]),St=l.useMemo(()=>Zt,[Zt]),dn=l.useMemo(()=>M!=null&&M.aspect_ratio?`${parseInt(M.aspect_ratio.split(":")[0])} / ${parseInt(M.aspect_ratio.split(":")[1])}`:`${M==null?void 0:M.width} / ${M==null?void 0:M.height}`,[M==null?void 0:M.aspect_ratio,M==null?void 0:M.width,M==null?void 0:M.height]),Dt=l.useMemo(()=>{var U,pe,Te,Ie,Ke,dt,ot,jt;if(H)return((U=N.get(H.response_id))==null?void 0:U.caption)??((Ie=(Te=(pe=H.descriptions)==null?void 0:pe[0])==null?void 0:Te.caption)==null?void 0:Ie[0]);if(j)return((Ke=N.get(j.image_id))==null?void 0:Ke.caption)??((jt=(ot=(dt=j.descriptions)==null?void 0:dt[0])==null?void 0:ot.caption)==null?void 0:jt[0])},[H,j,N]),At=l.useCallback(()=>{Dt&&w({...I,prompt:Dt,timestamp:Date.now()})},[Dt,w,I]);return r.jsx(Ln.Provider,{value:{feedType:F,displayImageSrc:K,imageAspectRatioNumber:ae,generationData:T,imageFileData:j,switchResponseIndex:ce,targetResponseImage:H,handlePinGeneration:ne,handleRemixGeneration:je,handleUseGenerationPrompt:qe,handleLikeGeneration:ue,handleAutoLikeGeneration:fe,handleReportImage:he,handleCanvasGeneration:Ge,handleEditGeneration:Fe,handleShareGeneration:vt,handleDownloadGeneration:kt,handleSetProfilePhoto:so,handleGenerationPrivateToggle:Dn,handleDeleteGeneration:Vn,handleApplySeed:De,handleDescribeGeneration:Ye,isCreator:me,handleRemixImageFile:nt,handleEditImageFile:bt,handleShareImageFile:Qt,handleDownloadImageFile:Ct,handleDeleteImageFile:mn,handleImageFilePrivateToggle:An,handleDescribeImageFile:ln,creator:z,feedData:M,parentSrc:cn,shouldHideParent:Se,isTileImage:Fn,displayTiledImageSrc:St,isSuperRes:Z,isBgRemovedImage:ee,isEditedImage:te,isUploadedImage:$,isMagicFillResultImage:X,isSuperResDisabled:W,aspectRatioStyle:dn,showDoubleTapIndicator:L,handleCanvasImageFile:En,handleGenerationRemoveBg:st,handleImageFileRemoveBg:We,description:Dt,useDescriptionAsPrompt:At},children:e})},Xt=b(le)(()=>({fontSize:16,fontWeight:700,userSelect:"text",cursor:"text",color:f("primary")})),Mn=b(le)(()=>({fontSize:16,userSelect:"text",cursor:"text",color:f("staticContent"),maxWidth:"100%",wordWrap:"break-word",wordBreak:"break-word",overflowWrap:"break-word",whiteSpace:"normal"})),T1=b("span")(()=>({userSelect:"text",cursor:"text",color:f("tertiary")})),Ri=b(C)({display:"flex",alignItems:"center",justifyContent:"space-between",height:48,minHeight:48}),U7=t=>{const{colorPalette:e}=t,{setGenerationInput:n,generationInput:o}=l.useContext(ye),[i,a]=l.useState(!1),s=l.useCallback(()=>{navigator.clipboard.writeText(e.map(c=>c.color_hex).join(" ")),a(!0),setTimeout(()=>a(!1),2e3)},[e]);return r.jsxs(H7,{children:[r.jsx(W7,{children:e.map(c=>r.jsx(q7,{sx:{background:c.color_hex}},c.color_hex))}),r.jsxs(G7,{children:[r.jsx(Yt,{size:32,onClick:()=>{n({...o,model_version:"V_1_5",color_palette:{members:e.map(c=>({colorHex:c.color_hex,colorWeight:c.color_weight}))},timestamp:Date.now()})},icon:r.jsx(Ko,{color:f("outlinedButtonText"),width:16,height:16}),tooltip:"Use"}),r.jsx(Yt,{size:32,onClick:()=>s(),icon:i?r.jsx(Ei,{}):r.jsx(qr,{color:f("outlinedButtonText"),width:16,height:16}),tooltip:i?"Copied":"Copy"})]})]})},G7=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",alignSelf:"center",gap:8}),H7=b(C)({width:"100",display:"flex",alignItems:"center",justifyContent:"flex-end",marginTop:8,gap:8}),q7=b(C)({width:24,height:24,borderRadius:2}),W7=b(C)({display:"flex",alignItems:"center",gap:2}),lr=()=>r.jsx(C,{sx:{maxWidth:"100%"},children:r.jsx($7,{})}),$7=b(Ra)(()=>({marginTop:16,marginBottom:12,color:f("border"),borderColor:f("border"),marginLeft:-16,width:"calc(100% + 32px);",borderBottomWidth:.5}));function su(t,e=300,n={}){const o=l.useRef(null),i=l.useCallback(a=>{o.current?(clearTimeout(o.current),o.current=null,t&&t(a)):o.current=setTimeout(()=>{n.onSingleTap&&n.onSingleTap(a),o.current=null},e)},[t,e,n.onSingleTap]);return t?{onClick:i}:{}}function V7({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M16.5 17.985c0 2.442-1.14 4.199-3.007 4.199-.975 0-1.341-.543-1.69-1.796l-.207-.772c-.101-.359-.277-.97-.527-1.83a.249.249 0 00-.03-.066l-2.866-4.485a5.884 5.884 0 00-2.855-2.327l-.473-.181A2.75 2.75 0 013.13 7.635l.404-2.086A3.25 3.25 0 015.95 3.011l7.628-1.87a4.75 4.75 0 015.733 3.44l1.415 5.55a3.25 3.25 0 01-3.15 4.053h-1.822c.496 1.632.746 2.892.746 3.801zM4.6 7.921a1.25 1.25 0 00.78 1.405l.474.181a7.385 7.385 0 013.582 2.92l2.867 4.486c.09.14.159.293.205.454l.552 1.92.212.792c.14.488.21.605.22.605.868 0 1.507-.984 1.507-2.699 0-.884-.326-2.335-.984-4.315a.75.75 0 01.711-.986h2.85a1.751 1.751 0 001.696-2.183l-1.415-5.549a3.25 3.25 0 00-3.923-2.354l-7.628 1.87a1.75 1.75 0 00-1.301 1.367L4.6 7.92z"})})}function K7({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M16.5 5.203c0-2.442-1.14-4.2-3.007-4.2-1.026 0-1.378.602-1.746 2-.075.29-.112.43-.151.569-.101.358-.277.97-.527 1.83a.25.25 0 01-.03.065L8.174 9.953a5.885 5.885 0 01-2.855 2.327l-.473.181a2.75 2.75 0 00-1.716 3.092l.404 2.086a3.25 3.25 0 002.417 2.538l7.628 1.87a4.75 4.75 0 005.733-3.44l1.415-5.55a3.25 3.25 0 00-3.15-4.053h-1.822c.496-1.633.746-2.892.746-3.801zM4.6 15.267a1.25 1.25 0 01.78-1.405l.474-.181a7.384 7.384 0 003.582-2.92l2.867-4.486c.09-.14.159-.294.205-.454.252-.865.428-1.48.53-1.843.044-.153.085-.309.159-.593.19-.722.283-.881.295-.881.868 0 1.507.984 1.507 2.699 0 .884-.326 2.335-.984 4.315a.75.75 0 00.711.986h2.85a1.75 1.75 0 011.696 2.182l-1.415 5.55a3.25 3.25 0 01-3.923 2.353l-7.628-1.87a1.75 1.75 0 01-1.301-1.366L4.6 15.267z"})})}function J7({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M15.056 9.004c.46-1.427.693-2.677.693-3.754 0-2.398-.939-4.247-2.5-4.247-.847 0-1.109.504-1.437 1.747.018-.065-.163.634-.215.821-.101.359-.277.97-.527 1.831a.247.247 0 01-.03.065L8.174 9.953a5.885 5.885 0 01-2.855 2.326l-1.257.482a1.75 1.75 0 00-1.092 1.967l.686 3.539a2.25 2.25 0 001.673 1.757l8.25 2.022a4.75 4.75 0 005.733-3.44l1.574-6.173a2.75 2.75 0 00-2.665-3.43h-3.165z"})})}function X7({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M15.056 14.183c.46 1.427.693 2.676.693 3.753 0 2.398-.939 4.247-2.5 4.247-.8 0-1.078-.45-1.383-1.546l-.27-1.022c-.1-.358-.276-.97-.526-1.83a.247.247 0 00-.03-.066l-2.866-4.485a5.885 5.885 0 00-2.855-2.327l-1.257-.481A1.75 1.75 0 012.97 8.458l.686-3.538a2.25 2.25 0 011.673-1.758l8.25-2.021a4.75 4.75 0 015.733 3.44l1.574 6.172a2.75 2.75 0 01-2.665 3.43h-3.165z"})})}const E1=t=>{var _,w;const{descriptionId:e}=t,{visionApi:n}=l.useContext(ge),{descriptionMap:o,generationInput:i,setDescriptionMap:a}=l.useContext(ye),{targetResponseImage:s,imageFileData:c}=l.useContext(Ln),{prompt:d}=l.useContext(Et),[u,h]=l.useState(!1),p=l.useMemo(()=>{var I,R;if(s)return s.response_id;if(c)return c.image_id;if((I=i.variation_input)!=null&&I.response_id)return i.variation_input.response_id;if((R=i.variation_input)!=null&&R.image_id)return i.variation_input.image_id},[s,c,(_=i.variation_input)==null?void 0:_.response_id,(w=i.variation_input)==null?void 0:w.image_id]),[g,m]=l.useState();l.useEffect(()=>{var I,R,S,E,N,k,A,D,O,L,P,G,B,M,z;m(e?(I=Array.from(o.values()).find(F=>F.descriptionId===e&&F.rating!==void 0))==null?void 0:I.rating:p&&((R=o.get(p))!=null&&R.rating)?(S=o.get(p))==null?void 0:S.rating:((k=(N=(E=s==null?void 0:s.descriptions)==null?void 0:E[0])==null?void 0:N.description_reaction)==null?void 0:k.reaction)==="POSITIVE"||((O=(D=(A=c==null?void 0:c.descriptions)==null?void 0:A[0])==null?void 0:D.description_reaction)==null?void 0:O.reaction)==="POSITIVE"?"like":((G=(P=(L=s==null?void 0:s.descriptions)==null?void 0:L[0])==null?void 0:P.description_reaction)==null?void 0:G.reaction)==="NEGATIVE"||((z=(M=(B=c==null?void 0:c.descriptions)==null?void 0:B[0])==null?void 0:M.description_reaction)==null?void 0:z.reaction)==="NEGATIVE"?"dislike":void 0)},[e,o,p,s,c]);const v=l.useMemo(()=>{var I,R,S,E,N,k;if(e)return e;if(s)return((I=o.get(s.response_id))==null?void 0:I.descriptionId)??((S=(R=s.descriptions)==null?void 0:R[0])==null?void 0:S.description_id);if(c)return((E=o.get(c.image_id))==null?void 0:E.descriptionId)??((k=(N=c.descriptions)==null?void 0:N[0])==null?void 0:k.description_id)},[s,c,o,e]);l.useEffect(()=>{h(!1)},[v]);const x=l.useMemo(()=>{var I,R,S,E,N,k,A,D;if(s)return((I=o.get(s.response_id))==null?void 0:I.caption)??((E=(S=(R=s.descriptions)==null?void 0:R[0])==null?void 0:S.caption)==null?void 0:E[0]);if(c)return((N=o.get(c.image_id))==null?void 0:N.caption)??((D=(A=(k=c.descriptions)==null?void 0:k[0])==null?void 0:A.caption)==null?void 0:D[0]);if(d&&d.length>0)return d},[s,c,o,d]),y=l.useCallback(I=>{if(m(I),I!=="neutral"&&h(!0),v&&(n==null||n.addDescriptionReaction({addDescriptionReactionRequest:{reaction:I==="like"?sl.Positive:I==="dislike"?sl.Negative:sl.Neutral,descriptionId:v}})),p&&x&&v)o.set(p,{caption:x,descriptionId:v,rating:I}),a(new Map(o));else if(v){const R=Array.from(o.values()).find(S=>S.descriptionId===v);R&&(R.rating=I),a(new Map(o))}setTimeout(()=>h(!1),2e3)},[v,p,x,n,o,a]);return r.jsxs(Q7,{children:[r.jsx(Be,{size:{width:32,height:32},icon:g==="like"?r.jsx(J7,{color:f("quietButtonText")}):r.jsx(K7,{color:f("quietButtonText")}),onClick:()=>y(g==="like"?"neutral":"like"),tooltip:"Good description"}),r.jsx(C,{width:4}),r.jsx(Be,{size:{width:32,height:32},icon:g==="dislike"?r.jsx(X7,{color:f("quietButtonText")}):r.jsx(V7,{color:f("quietButtonText")}),onClick:()=>y(g==="dislike"?"neutral":"dislike"),tooltip:"Needs improvement"}),r.jsx(xr,{in:u,appear:!1,timeout:{enter:0,exit:1e3},children:r.jsx(Y7,{children:"Thanks for the feedback!"})})]})},Y7=b(le)(()=>({paddingLeft:8,color:f("secondary"),fontSize:14})),Q7=b(C)({display:"flex",flexDirection:"row",alignItems:"center",paddingTop:8,width:"100%"}),Ti=t=>{const e=Ee(),{content:n,defaultExpanded:o,showRatingActions:i}=t,[a,s]=l.useState(!!o),[c,d]=l.useState(!1),u=l.useRef(null),[h,p]=l.useState("");l.useEffect(()=>{u.current&&(u.current.style.display="-webkit-box"),d(!1),p(""),s(!1)},[n,d,p,s]);const g=l.useCallback(()=>{if(!a&&n){const x=u.current;if(x){x.textContent=n,x.style.display="-webkit-box",x.style.webkitLineClamp="4";const y=x.scrollHeight>x.clientHeight||x.scrollWidth>x.clientWidth;if(d(y),y){x.style.webkitLineClamp="3",x.textContent="";let _=0;for(let w=0;w<n.length;w++)if(x.textContent+=n[w],n[w]===" "&&(_=w+1),x.scrollHeight>x.clientHeight||x.scrollWidth>x.scrollWidth){x.textContent=n.slice(0,_),p(n.slice(_)),x.style.display="block";break}}}}},[d,a,n,p]);l.useEffect(()=>(g(),window.addEventListener("resize",g),()=>{window.removeEventListener("resize",g)}),[g]);const{onClick:m}=su(x=>{x.preventDefault(),x.stopPropagation();const y=document.createRange();y.selectNodeContents(x.currentTarget);const _=window.getSelection();_==null||_.removeAllRanges(),_==null||_.addRange(y)},300),v=l.useCallback(x=>{x.detail>1&&x.preventDefault()},[]);return r.jsxs(e6,{paddingBottom:c?0:"12px",onClick:m,onCopy:x=>{var _;const y=(_=window.getSelection())==null?void 0:_.toString();if(y){x.preventDefault();const w=y.replace(/\n\n/g," ");x.clipboardData.setData("text/plain",w)}},children:[r.jsx(Mn,{ref:u,onMouseDown:v,sx:{textOverflow:"ellipsis",width:"100%",display:"-webkit-box",WebkitLineClamp:c?"3":"4",lineClamp:c?"3":"4",WebkitBoxOrient:"vertical",overflow:"hidden"},children:n}),!!h.length&&r.jsxs(t6,{children:[r.jsx(Mn,{onMouseDown:v,sx:{flex:1,...a?{overflow:"visible"}:{WebkitLineClamp:"1",lineClamp:"1",WebkitBoxOrient:"vertical",overflow:"hidden",display:"-webkit-box"}},children:h}),c&&!a&&r.jsx(Xp,{onClick:()=>{e({eventKey:"EXPEND_MORE_CLICK"}),s(!0)},children:"More"})]}),(a||!c)&&r.jsxs(Z7,{children:[i?r.jsx(E1,{}):r.jsx(C,{}),a&&r.jsx(Xp,{onClick:()=>{e({eventKey:"EXPEND_LESS_CLICK"}),s(!1)},children:"Less"})]})]})},Z7=b(C)({display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"}),Xp=b("a")(()=>({cursor:"pointer",textDecoration:"underline",textDecorationStyle:"dotted",textUnderlineOffset:"4px",fontWeight:600,marginLeft:4,color:f("secondary"),"&:hover":{color:f("primary")},fontSize:16})),e6=b(C)({display:"flex",flexDirection:"column",alignItems:"center",marginTop:8,width:"100%"}),t6=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",maxWidth:"100%"}),n6=()=>r.jsx(Rt,{content:r.jsxs(le,{fontSize:12,children:["This image will be shown as the cover image for the generation."," "]}),children:r.jsx(o6,{children:"Cover"})}),o6=b(le)(()=>({position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",margin:"auto",backgroundColor:f("transparentSolid"),color:f("primary"),padding:2,paddingLeft:8,paddingRight:8,width:"fit-content",borderRadius:4,fontSize:12,fontWeight:500,bottom:2,left:2,right:2})),r6=t=>{if(!t)return 0;let e=Array.from(t.keys()),n=e.find(s=>t[s].self_like)??-1;const o=e.find(s=>t[s].pin_on_profile===!0)??-1,i=e.find(s=>t[s].self_like===!0)??-1,a=Math.max(...e.map(s=>t[s].num_likes));if(o>=0)n=o;else if(i>=0)n=i;else if(a!==0)n=e.find(s=>t[s].num_likes===a)??-1;else if(n<0){const s=e.find(c=>t[c].highest_fidelity===!0)??-1;s>=0&&(n=s)}return n<0&&(n=e.length>0?e[0]:0),n},i6=2048*2048*.9,k1=()=>{var c,d;const t=we(),e=xe(t.breakpoints.down("md")),{generationData:n,switchResponseIndex:o,isTileImage:i}=l.useContext(Ln),{image_index:a}=an(),s=l.useMemo(()=>r6(n==null?void 0:n.responses),[n==null?void 0:n.responses]);return r.jsx(a6,{sx:{padding:e?"0 6px":0},children:(d=(c=n==null?void 0:n.responses)==null?void 0:c.slice(0,4))==null?void 0:d.map((u,h)=>r.jsxs(C,{position:"relative",flex:"1",children:[r.jsx(s6,{onClick:()=>o(h),src:Pt(u.response_id,"balanced",i?"tile":"response"),sx:{opacity:a&&parseInt(a)===h?1:.4}}),h===s&&r.jsx(n6,{})]},u.response_id))})},s6=b("img")(()=>({aspectRatio:1,borderRadius:4,cursor:"pointer",objectFit:"cover",backgroundColor:f("foggyBackground2"),outlineStyle:"solid",outlineWidth:.5,outlineColor:f("border"),width:"100%"})),a6=b(C)({display:"flex",flexDirection:"row",alignItems:"center",width:"100%",background:"transparent",gap:6,justifyContent:"space-between"});function ps({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M10 5h4a2 2 0 10-4 0zM8.5 5a3.5 3.5 0 117 0h5.75a.75.75 0 010 1.5h-1.32L18.76 18.611A3.75 3.75 0 0115.026 22H8.974a3.75 3.75 0 01-3.733-3.389L4.07 6.5H2.75a.75.75 0 010-1.5H8.5zm2 4.75a.75.75 0 00-1.5 0v7.5a.75.75 0 001.5 0v-7.5zM14.25 9a.75.75 0 01.75.75v7.5a.75.75 0 01-1.5 0v-7.5a.75.75 0 01.75-.75zm-7.516 9.467a2.25 2.25 0 002.24 2.033h6.052a2.25 2.25 0 002.24-2.033L18.424 6.5H5.576l1.158 11.967z"})})}function fs({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M20.952 3.048a3.579 3.579 0 00-5.061 0L3.941 15a3.106 3.106 0 00-.825 1.476L2.02 21.078a.75.75 0 00.904.903l4.601-1.096a3.106 3.106 0 001.477-.825L20.952 8.11a3.578 3.578 0 000-5.06zm-4 1.06a2.078 2.078 0 112.94 2.94L19 7.939 16.06 5l.892-.891zM15 6.062L17.94 9 7.94 19c-.21.21-.474.357-.763.426l-3.416.814.813-3.416c.069-.29.217-.554.427-.764L15 6.06z"})})}function l6({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M3 3.748a.75.75 0 01.75-.75h16.504a.75.75 0 01.6 1.2L16.69 9.75l4.164 5.551a.75.75 0 01-.6 1.2H4.5v4.75a.75.75 0 01-.648.743L3.75 22a.75.75 0 01-.743-.648L3 21.25V3.748zm15.754.75H4.5V15h14.254l-3.602-4.8a.75.75 0 010-.9l3.602-4.802z"})})}function A1({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M12.82 5.58l-.82.822-.824-.823a5.375 5.375 0 00-7.601 7.601l7.895 7.896a.75.75 0 001.06 0l7.902-7.897a5.38 5.38 0 00-7.612-7.6zm6.548 6.541L12 19.485 4.635 12.12a3.875 3.875 0 015.48-5.48l1.358 1.357a.75.75 0 001.073-.013L13.88 6.64a3.88 3.88 0 015.489 0 3.876 3.876 0 01-.002 5.481z"})})}function j1({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,fillRule:"evenodd",d:"M13.57 2.847a5.362 5.362 0 017.583 7.583l-1.794 1.794a.766.766 0 01-1.084-1.083l1.795-1.795a3.83 3.83 0 00-5.416-5.416l-4.596 4.596a3.83 3.83 0 001.057 6.165.766.766 0 11-.66 1.383 5.362 5.362 0 01-1.48-8.631l4.595-4.596zm-1.046 5.44a.766.766 0 011.021-.36 5.362 5.362 0 011.48 8.63l-4.595 4.596a5.362 5.362 0 01-7.583-7.583l1.794-1.794a.766.766 0 011.084 1.083L3.93 14.654a3.83 3.83 0 005.416 5.416l4.596-4.596a3.831 3.831 0 00-1.057-6.165.766.766 0 01-.36-1.021z",clipRule:"evenodd"})})}function Ka({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n??"inherit",fillRule:"evenodd",d:"M2.22 2.22a.75.75 0 00-.073.976l.073.084 3.194 3.194a9.973 9.973 0 00-3.116 5.096.758.758 0 000 .37 10.003 10.003 0 0014.768 6.187l3.654 3.653a.75.75 0 001.133-.976l-.073-.084-6.113-6.114.001-.002-1.2-1.198-2.87-2.87h.002L8.719 7.658l.001-.002-1.133-1.13L3.28 2.22a.75.75 0 00-1.06 0zm13.744 14.804L14.8 15.861l-.703-.704a4 4 0 01-5.504-5.504L7.334 8.395l-.857-.857A8.478 8.478 0 003.8 11.754a8.504 8.504 0 0012.164 5.27zm-6.262-6.261a2.5 2.5 0 003.285 3.285l-3.285-3.285zm1.248-2.874l1.385 1.383a2.502 2.502 0 012.143 2.145l1.383 1.382a4 4 0 00-4.91-4.91zm9.25 3.861a8.463 8.463 0 01-1.913 3.476l1.062 1.061a9.96 9.96 0 002.352-4.352.754.754 0 000-.37 10.004 10.004 0 00-13.774-6.7l1.151 1.152A8.504 8.504 0 0120.2 11.75z",clipRule:"evenodd"})})}function P1({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",children:r.jsx("path",{fill:n??"inherit",d:"M16.242 2.932l4.826 4.826a2.75 2.75 0 01-.715 4.404l-4.87 2.435a.75.75 0 00-.374.426l-1.44 4.166a1.25 1.25 0 01-2.065.476L8.5 16.561 4.06 21H3v-1.062L7.44 15.5l-3.105-3.104a1.25 1.25 0 01.476-2.066l4.166-1.439a.75.75 0 00.426-.374l2.435-4.87a2.75 2.75 0 014.405-.715zm3.766 5.886l-4.826-4.825a1.25 1.25 0 00-2.002.324l-2.435 4.871a2.25 2.25 0 01-1.278 1.12l-3.789 1.31 6.705 6.704 1.308-3.788a2.25 2.25 0 011.12-1.278l4.872-2.436a1.25 1.25 0 00.325-2.002z"})})}function M1({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",children:r.jsx("path",{fill:n??"inherit",d:"M21.068 7.758l-4.826-4.826a2.75 2.75 0 00-4.404.715l-2.435 4.87a.75.75 0 01-.426.374l-4.166 1.44a1.25 1.25 0 00-.476 2.065L7.439 15.5 3 19.94V21h1.06l4.44-4.44 3.104 3.105a1.25 1.25 0 002.066-.476l1.44-4.166a.75.75 0 01.373-.426l4.87-2.435a2.75 2.75 0 00.715-4.404z"})})}function c6({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M10.25 10a1.25 1.25 0 10-2.499 0 1.25 1.25 0 002.499 0zm6 0a1.25 1.25 0 10-2.499 0 1.25 1.25 0 002.499 0zm-6.114 5.107a.75.75 0 10-.772 1.286c.767.46 1.72.67 2.636.67.916 0 1.87-.21 2.636-.67a.75.75 0 10-.772-1.286c-.483.29-1.155.456-1.864.456-.71 0-1.38-.166-1.864-.456zm11.866-3.106c0-5.524-4.478-10.002-10.002-10.002-5.524 0-10.002 4.478-10.002 10.002 0 5.523 4.478 10.001 10.002 10.001 5.524 0 10.002-4.478 10.002-10.001zM3.497 12a8.502 8.502 0 1117.004 0 8.502 8.502 0 01-17.004 0z"})})}function O1({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,viewBox:"0 0 24 24",fill:n??"inherit",children:r.jsx("path",{fill:n??"inherit",d:"M18.25 20.5a.75.75 0 110 1.5l-13 .004a.75.75 0 110-1.5l13-.004zM11.648 2.012l.102-.007a.75.75 0 01.743.648l.007.102-.001 13.685 3.722-3.72a.75.75 0 01.976-.073l.085.073a.75.75 0 01.072.976l-.073.084-4.997 4.997a.75.75 0 01-.976.073l-.085-.073-5.003-4.996a.75.75 0 01.976-1.134l.084.072 3.719 3.714L11 2.755a.75.75 0 01.648-.743l.102-.007-.102.007z"})})}const au=t=>{const{getTileFileDownloadName:e,assetType:n,assetId:o,modelVariant:i,modelVariantExperiment:a,loadingCallback:s,handleAutoLikeGeneration:c}=t,{downloadsApi:d,subscriptionStatus:u}=l.useContext(ge),h=l.useCallback(y=>{if(Xe({eventKey:"DOWNLOAD_IMAGE_CLICK",metaData:{asset_id:o??"",modelVariant:i,experiment:a}}),c==null||c(),o){const _={responseId:o,quality:y};if(rn()){tI(_);return}d==null||d.downloadResponseImageRaw(_).then(w=>{var R;const I=(R=w.raw.headers.get("content-disposition"))==null?void 0:R.split("filename=")[1].split(";")[0];w.value().then(S=>{s&&s(!1),Oc.saveAs(S,I)})})}},[o,i,a,c,d,s]),p=l.useCallback(()=>{o&&(Xe({eventKey:"DOWNLOAD_IMAGE_CLICK",metaData:{asset_id:o??""}}),iu({image_ids:[o],cover_only:!0,request_ids:[]}))},[o]),g=l.useCallback(y=>{!o||!e||(Xe({eventKey:"DOWNLOAD_IMAGE_CLICK",metaData:{asset_id:o??""}}),c==null||c(),s&&s(!0),d==null||d.downloadTiledImageRaw({responseId:o,fileType:y}).then(_=>{var I;const w=(I=_.raw.headers.get("content-disposition"))==null?void 0:I.split("filename=")[1].split(";")[0];_.value().then(R=>{s&&s(!1),Oc.saveAs(R,`${e(y).replaceAll(" ","")}_${w}`)})}))},[o,e,c,s,d]),m=l.useMemo(()=>{if(n==="image")return p},[n,p]),{showPayWallModel:v}=$t(),x=l.useMemo(()=>{if(n==="tile"&&e)return[{onClick:()=>g(hn.X1),text:`${e(hn.X1)} tile`},{onClick:()=>g(hn.X2),text:`${e(hn.X2)} tile`},{onClick:()=>g(hn.X4),text:`${e(hn.X4)} tile`},{onClick:()=>g(hn.X8),text:`${e(hn.X8)} tile`}];if(n==="generation")return[{onClick:()=>{u!=null&&u.noActiveSubscription?v("DOWNLOAD_PNG"):h(Qu.Png)},text:r.jsxs(Yp,{children:[r.jsx(Qp,{children:"PNG"}),r.jsx(Zp,{children:"(100% quality)"})]}),paywallLock:u==null?void 0:u.noActiveSubscription},{onClick:()=>h(Qu.Jpeg),text:r.jsxs(Yp,{children:[r.jsx(Qp,{children:"JPEG"}),r.jsx(Zp,{children:"(70% quality)"})]})}]},[n,e,g,u==null?void 0:u.noActiveSubscription,v,h]);return{menuOption:{icon:r.jsx(O1,{color:f("menuAction"),width:18,height:18}),text:"Download",onClick:m,nestedMenuOptions:x}}},Yp=b(C)(()=>({display:"flex",alignItems:"center",color:f("Interactive"),"&:hover":{color:f("InteractiveHover")},paddingRight:12})),Qp=b(le)({fontSize:16,fontWeight:400,lineHeight:"24px"}),Zp=b(le)(()=>({fontSize:14,fontWeight:400,lineHeight:"20px",color:f("informative"),marginLeft:4})),d6=t=>{const{blockedUserHandle:e}=t;return r.jsxs(r.Fragment,{children:[r.jsx(u6,{children:e})," has been muted."," "]})},u6=b(le)(()=>({color:f("primary"),fontWeight:700,userSelect:"text",marginLeft:0,display:"inline"})),lu=t=>{const{privacyApi:e,userProfileState:n}=l.useContext(ge),[o,i]=l.useState(!1),{user_id:a,user_handle:s,trackEvent:c}=t,d=Ee(),{setAlertContent:u}=l.useContext(Tn),h=l.useCallback(()=>{c(),i(!0)},[c]),p=l.useCallback(()=>{i(!1),d({eventKey:"BLOCK_USER_CANCELLED_FROM_MODAL",metaData:{}})},[d]),g=d6({blockedUserHandle:s}),{navigate:m}=l.useContext($e),v=l.useCallback(()=>{s!=null&&u(g),m(oe.HOME)},[s,m,u,g]),x=l.useCallback(()=>{i(!1),a!=null&&(d({eventKey:"BLOCK_USER_CONFIRMED_FROM_MODAL",metaData:{}}),e==null||e.postBlockedUsers({postBlockUserRequest:{blockUserId:a}}).then(()=>{v()}))},[e,v,d,a]),y=l.useMemo(()=>n==null||n.userId===a,[n,a]),_=l.useMemo(()=>`BlockUserModal_${a}`,[a]);return{menuOption:{hidden:y,icon:r.jsx(C0,{color:f("menuAction")}),text:"Mute creator",onClick:h,confirmation:o?r.jsx(qg,{handleClose:p,handleAction:x,titleText:"Mute this creator?",confirmText:"Mute creator",message:r.jsxs(r.Fragment,{children:["You won't see images or notifications from"," ",r.jsx(h6,{children:s})," anymore. They won't know you muted them."]})},_):null}}},h6=b(le)(()=>({color:f("primary"),fontWeight:700,userSelect:"text",marginLeft:0,display:"inline"})),p6=t=>{const{userProfileState:e}=l.useContext(ge),{creatorUserId:n}=t,[o,i]=l.useState(),a=l.useMemo(()=>n===(e==null?void 0:e.userId),[n,e==null?void 0:e.userId]),{data:s,refetch:c}=Ve(["fetchUserFollowState",n],()=>uI(n),{enabled:!!(e!=null&&e.userId)&&!!n&&!a,staleTime:1/0});l.useEffect(()=>{i(s)},[s]);const d=l.useCallback(()=>{o===void 0||!n||(hI(n).then(()=>c()),i(!o))},[o,n,c]);return a||o===void 0?null:r.jsx(xr,{in:!o,children:r.jsx(f6,{onClick:u=>{u.stopPropagation(),Xe({eventKey:"FOLLOW_CLICK_FROM_ZOOMIN_VIEW"}),d()},disableRipple:!0,children:"Follow"})})},f6=b(gt)(()=>({backgroundColor:f("IdeogramPink"),"&:hover":{backgroundColor:f("IdeogramPinkHover")},fontSize:12,borderRadius:10,height:20,color:"#fff",textAlign:"center",fontFamily:"Manrope",fontWeight:700,lineHeight:"20px",letterSpacing:"-0.48px",minWidth:0,padding:"0 8px 1px 8px",boxShadow:"0px 1px 3px 0px rgba(9, 9, 11, 0.10), 0px 1px 2px -1px rgba(9, 9, 11, 0.10)"})),B1=t=>{const e=we(),n=xe(e.breakpoints.down("md")),{creator:o,creationTimeFloat:i,isEditedImage:a,isUploadedImage:s,isSuperRes:c,isBgRemovedImage:d,isMagicFillResultImage:u}=t,{navigate:h}=l.useContext($e),p=l.useMemo(()=>o!=null&&o.display_handle?oe.PROFILE.replace(":uhandle",o.display_handle):void 0,[o==null?void 0:o.display_handle]),g=l.useMemo(()=>td(i),[i]),m=l.useMemo(()=>nd(i),[i]),v=l.useMemo(()=>{if(d)return r.jsx(Bs,{children:"Background Removal"});if(c)return r.jsx(Bs,{children:"Upscale"});if(a)return r.jsx(Bs,{children:"Editor"});if(u)return r.jsx(Bs,{children:"Magic Fill"});if(s)return"Uploaded"},[d,a,u,c,s]);return o?r.jsxs(r.Fragment,{children:[r.jsx(ef,{href:p,onClick:x=>{x.preventDefault(),Xe({eventKey:"USER_PROFILE_CLICK_FROM_ZOOMIN_VIEW"}),p&&h(p)},draggable:!1,children:r.jsx(ci,{src:o.photo_url,size:"md",badge:o.badge??void 0})}),r.jsxs(g6,{children:[r.jsxs(v6,{children:[r.jsx(ef,{href:p,onClick:x=>{x.preventDefault(),Xe({eventKey:"USER_PROFILE_CLICK_FROM_ZOOMIN_VIEW"}),p&&h(p)},draggable:!1,children:r.jsx(x6,{children:o.display_handle})}),r.jsx(p6,{creatorUserId:o.user_id})]}),r.jsx(Rt,{content:m,placement:"right",size:"small",children:r.jsxs(m6,{sx:{fontSize:n?12:14},children:[g," ",v&&r.jsxs(r.Fragment,{children:[" • ",v]})]})})]})]}):null},Bs=b("span")({fontWeight:600}),ef=b("a")({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",alignSelf:"center",cursor:"pointer",fontSize:16,fontWeight:500}),g6=b(C)({display:"flex",flexDirection:"column",paddingLeft:8}),m6=b(le)(()=>({lineHeight:"20px",marginTop:-2,letterSpacing:"-0.28px",color:f("secondary"),width:"fit-content"})),x6=b(le)(()=>({fontSize:16,fontWeight:600,maxWidth:108,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",color:f("primary")})),v6=b(C)({display:"flex",flexDirection:"row",alignItems:"center",gap:6}),gs="Image is already at maximum resolution available. Higher resolutions coming soon.";b(C)({marginLeft:"2px",minHeight:"100%",display:"flex",alignItems:"center",justifyContent:"center"});const y6=tt.forwardRef(function(e,n){return r.jsx(rr,{direction:"up",ref:n,...e})}),Ja=t=>{const{open:e,onCancel:n,onConfirm:o}=t,i=we(),a=xe(i.breakpoints.down("md"));return r.jsxs(Wn,{open:e,TransitionComponent:y6,onClose:()=>n(),fullScreen:!0,hideBackdrop:!0,sx:{zIndex:s=>s.zIndex.drawer+140},PaperProps:{sx:{height:"fit-content",position:"fixed",bottom:0,borderTopRightRadius:24,borderTopLeftRadius:24,paddingY:4,backgroundColor:f("solid")}},children:[r.jsx(Vs,{fontSize:14,color:f("primary"),children:"Please confirm"}),r.jsx(Uc,{sx:{paddingBottom:0},children:r.jsx(Gc,{fontSize:13,color:f("informative"),children:"Are you sure about deleting your creation? This action cannot be undone."})}),r.jsx(C,{display:"flex",flexDirection:a?"column":"row",alignItems:a?"flex-end":"center",justifyContent:"flex-end",padding:2,children:r.jsxs(C,{children:[r.jsx(gt,{onClick:()=>n(),variant:"text",disableRipple:!0,sx:{marginRight:1,textDecoration:"underline","&:hover":{backgroundColor:"transparent",textDecoration:"underline"}},children:"Cancel"}),r.jsx(gt,{onClick:()=>{o()},variant:"contained",autoFocus:!0,disableRipple:!0,sx:{borderRadius:12},children:"Confirm"})]})})]})},w6=tt.forwardRef(function(e,n){return r.jsx(rr,{direction:"up",ref:n,...e})}),cu="disable-pin-private-confirmation",L1=t=>{const{open:e,onCancel:n,onConfirm:o}=t,i=we(),a=xe(i.breakpoints.down("md")),[s,c]=l.useState(!1);return r.jsxs(Wn,{open:e,TransitionComponent:w6,onClose:()=>n(),fullScreen:!0,hideBackdrop:!0,sx:{zIndex:d=>d.zIndex.drawer+140},PaperProps:{sx:{height:"fit-content",position:"fixed",bottom:0,borderTopRightRadius:24,borderTopLeftRadius:24,paddingY:4,backgroundColor:f("solid")}},children:[r.jsx(Vs,{fontSize:14,color:f("primary"),children:"Please confirm"}),r.jsx(Uc,{sx:{paddingBottom:0},children:r.jsx(Gc,{fontSize:13,color:f("informative"),children:"This is a private generation. Pinning a private generation will make it public and viewable by other users."})}),r.jsxs(C,{display:"flex",flexDirection:a?"column":"row",alignItems:a?"flex-end":"center",justifyContent:"space-between",padding:2,children:[r.jsxs(C,{display:"flex",flexDirection:"row",alignItems:"center",children:[r.jsx(hv,{value:s,onChange:d=>{c(d.target.checked)},size:"small",sx:{color:f("informative")}}),r.jsx(le,{color:f("informative"),fontSize:12,children:"Do not show this anymore."})]}),r.jsxs(C,{children:[r.jsx(gt,{onClick:()=>n(),variant:"text",disableRipple:!0,sx:{marginRight:1,textDecoration:"underline","&:hover":{backgroundColor:"transparent",textDecoration:"underline"}},children:"Cancel"}),r.jsx(gt,{onClick:()=>{s&&localStorage.setItem(cu,"true"),o()},variant:"contained",autoFocus:!0,disableRipple:!0,sx:{borderRadius:12},children:"Confirm"})]})]})]})},Nl="Thank you for your feedback!",N1=()=>{var De,Ye;const{targetResponseImage:t,handleLikeGeneration:e,creator:n,generationData:o,handlePinGeneration:i,handleReportImage:a,handleEditGeneration:s,handleCanvasGeneration:c,handleShareGeneration:d,handleSetProfilePhoto:u,handleGenerationPrivateToggle:h,isCreator:p,handleDeleteGeneration:g,handleRemixGeneration:m,handleUseGenerationPrompt:v,handleDescribeGeneration:x,isTileImage:y,isSuperResDisabled:_,feedData:w,isSuperRes:I,isBgRemovedImage:R,isEditedImage:S,isUploadedImage:E,isMagicFillResultImage:N,handleGenerationRemoveBg:k,handleAutoLikeGeneration:A}=l.useContext(Ln),{loadingDescription:D,setGenerationInputMode:O,createCanvasLocked:L}=l.useContext(ye),{subscriptionStatus:P,userProfileState:G,hasAccessToSuperRes:B,hasAccessToEditor:M,hasAccessToRemoveBg:z}=l.useContext(ge),{setAlertText:F}=l.useContext(Tn),[T,j]=l.useState(!1),[Z,ee]=l.useState(!1),[te,$]=l.useState(!1),X=l.useMemo(()=>t!=null&&t.num_likes?t==null?void 0:t.num_likes:void 0,[t==null?void 0:t.num_likes]),W=l.useMemo(()=>!!(t!=null&&t.self_like),[t==null?void 0:t.self_like]),Y=l.useMemo(()=>!!(t!=null&&t.pin_on_profile),[t==null?void 0:t.pin_on_profile]),q=()=>{Xe({eventKey:"BLOCK_USER_CLICK_FROM_COLUMN_VIEW",metaData:{}})},{menuOption:V}=lu({user_id:o==null?void 0:o.user.user_id,user_handle:o==null?void 0:o.user.display_handle,trackEvent:q}),Q=l.useMemo(()=>(o==null?void 0:o.tiling_preset)==="COLUMN"||(o==null?void 0:o.tiling_preset)==="ROW",[o==null?void 0:o.tiling_preset]),K=l.useCallback(nt=>{if(nt===hn.X1)return"1 x 1";if(nt===hn.X2)return`2 x ${Q?1:2}`;if(nt===hn.X4)return`4 x ${Q?1:4}`;if(nt===hn.X8)return`8 x ${Q?1:8}`},[Q]),ae=t==null?void 0:t.response_id,ce=(De=o==null?void 0:o.responses)==null?void 0:De.find(nt=>nt.response_id===ae),ve=(ce==null?void 0:ce.model_variant)??"",se=(o==null?void 0:o.experiment)??"",{menuOption:H}=au({getTileFileDownloadName:K,assetId:t==null?void 0:t.response_id,assetType:y?"tile":"generation",modelVariant:ve,modelVariantExperiment:se,loadingCallback:$,handleAutoLikeGeneration:A}),{showPayWallModel:me}=$t(),{handleRetryGeneration:ne,isRetryBlockForNonSubscriptionReason:ue,getRetryBlockedReason:fe}=ou({generationData:o}),Se=l.useCallback(()=>{!o||!(t!=null&&t.response_id)||ne(o,t==null?void 0:t.response_id)},[o,ne,t==null?void 0:t.response_id]),je=l.useMemo(()=>o?fe():void 0,[o,fe]),qe=l.useMemo(()=>{var nt,ct;return[[{icon:r.jsx(nu,{color:f("menuAction"),width:18,height:18}),text:"Retry",onClick:Se,hidden:!p||!!je&&ue(je),paywallLock:!!je},{icon:r.jsx(tu,{color:f("menuAction"),width:18,height:18}),text:"Prompt",onClick:()=>{Xe({eventKey:"USE_TEXT_CLICK_FROM_ZOOM_IN_PAGE"}),v()}},{icon:r.jsx(Va,{color:f("menuAction"),width:18,height:18}),text:"Remix",onClick:()=>{Xe({eventKey:"REMIX_CLICK_FROM_ZOOMIN_VIEW_MENU",metaData:{selfGeneration:p}}),O("remix"),m()}},{hidden:!!D,icon:D?r.jsx(co,{size:18,sx:{color:f("menuActionDisabled")}}):r.jsx(ti,{color:f("menuAction"),width:18,height:18}),text:D?"Describing...":"Describe",onClick:()=>{Xe({eventKey:"DESCRIBE_FROM_ZOOM_IN_PAGE"}),x()}},{icon:r.jsx($a,{color:f(_?"menuActionDisabled":"menuAction"),width:18,height:18}),text:"Upscale",onClick:()=>{Xe({eventKey:"UPSCALE_CLICK_FROM_ZOOM_IN_PAGE"}),B?(O("upscale"),m()):me("SUPER_RES")},paywallLock:!B,disabled:_,tooltipContent:_?gs:void 0},{icon:r.jsx(ni,{color:f("menuAction"),width:18,height:18}),text:"Remove background",onClick:()=>{Xe({eventKey:"REMOVE_BG_CLICK",metaData:{from:"ZOOM_IN_PAGE"}}),z?k():me("REMOVE_BACKGROUND")},paywallLock:!z,new:!0},{icon:r.jsx(hs,{color:f("menuAction"),width:18,height:18}),text:"Open in Canvas",onClick:()=>{Xe({eventKey:"CANVAS_CLICK_FROM_ZOOM_IN"}),c()},beta:!0,paywallLock:L},{icon:r.jsx(fs,{color:f("menuAction"),width:18,height:18}),text:"Edit in Editor",onClick:()=>{if(Xe({eventKey:"GENERATION_EDIT_CLICK_FROM_ZOOM_IN",metaData:{selfGeneration:(G==null?void 0:G.userId)===(o==null?void 0:o.user.user_id)}}),!M){me("EDITOR");return}s()},paywallLock:!M}],...p?[[{icon:r.jsx(c6,{color:f("menuAction"),width:18,height:18}),text:"Set as profile photo",onClick:()=>{u()}},{hidden:!((nt=P==null?void 0:P.subscriptionQuota)!=null&&nt.privateGeneration),icon:o!=null&&o.private?r.jsx(us,{color:f("menuAction"),width:18,height:18}):r.jsx(Ka,{color:f("menuAction"),width:18,height:18}),text:o!=null&&o.private?"Make public":"Make private",onClick:()=>{h()}}]]:[],[H,{icon:r.jsx(j1,{color:f("menuAction"),width:18,height:18}),text:"Share",onClick:()=>{d()}}],[{icon:r.jsx(l6,{color:f("menuAction"),width:18,height:18}),text:"Report...",danger:!0,stale:!0,nestedMenuOptions:[{text:"Poor image quality",onClick:()=>{a("Poor image quality"),F(Nl)}},{text:"Inappropriate image",onClick:()=>{a("Inappropriate image"),F(Nl)}},{text:"Inappropriate prompt",onClick:()=>{a("Inappropriate prompt"),F(Nl)}}]},V,{hidden:!((ct=P==null?void 0:P.subscriptionQuota)!=null&&ct.privateGeneration&&p),icon:r.jsx(ps,{color:f("menuAction"),width:18,height:18}),text:"Delete",onClick:()=>{ee(!0)},danger:!0}]]},[Se,p,je,ue,_,B,z,L,M,D,(Ye=P==null?void 0:P.subscriptionQuota)==null?void 0:Ye.privateGeneration,o==null?void 0:o.private,o==null?void 0:o.user.user_id,H,V,O,m,me,k,v,c,G==null?void 0:G.userId,s,x,u,h,d,a,F]);return n?r.jsxs(r.Fragment,{children:[r.jsxs(C6,{children:[r.jsx(tf,{children:!!(w!=null&&w.creation_time_float)&&!!n&&r.jsx(B1,{creator:n,creationTimeFloat:w.creation_time_float,isEditedImage:S,isUploadedImage:E,isSuperRes:I,isBgRemovedImage:R,isMagicFillResultImage:N})}),r.jsxs(tf,{children:[r.jsx(di,{horizontal:!0,options:qe,minWidth:212}),r.jsx(C,{width:4}),p&&r.jsxs(r.Fragment,{children:[r.jsx(Be,{onClick:()=>{!localStorage.getItem(cu)&&!(t!=null&&t.pin_on_profile)&&(o!=null&&o.private)?j(!0):i()},icon:Y?r.jsx(M1,{color:f("quietButtonText")}):r.jsx(P1,{color:f("quietButtonText")}),tooltip:Y?"Unpin":"Pin to profile"}),r.jsx(C,{width:4})]}),r.jsx(Be,{freeWidth:!!X,onClick:()=>e(),icon:r.jsxs(r.Fragment,{children:[!!X&&r.jsx(b6,{children:_0(X)}),W?r.jsx(Dd,{color:f("IdeogramPink")}):r.jsx(A1,{color:f("quietButtonText")})]}),tooltip:W?"Unlike":"Like"})]})]}),r.jsx(Ja,{open:Z,onCancel:()=>ee(!1),onConfirm:()=>{ee(!1),g()}}),r.jsx(L1,{open:T,onCancel:()=>j(!1),onConfirm:()=>{i(),j(!1)}}),r.jsx(as,{open:te})]}):null},b6=b(le)(()=>({fontSize:14,color:f("primary"),marginRight:4,minWidth:10,zIndex:1})),C6=b(C)({width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",minHeight:40}),tf=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"}),D1=new Map([["V_0_1","Ideogram 0.1"],["V_0_2","Ideogram 0.2"],["V_0_3","Ideogram 1.0"],["V_1_5","Ideogram 2.0"],["V_2_1","Ideogram 2a"]]),nf=new Map([["GRID",{name:"Grid",icon:r.jsx(v1,{color:f("staticContent")})}],["HORIZONTAL_BRICK",{name:"Horizontal brick",icon:r.jsx(y1,{color:f("staticContent")})}],["VERTICAL_BRICK",{name:"Vertical brick",icon:r.jsx(b1,{color:f("staticContent")})}],["COLUMN",{name:"Column",icon:r.jsx(x1,{color:f("staticContent")})}],["ROW",{name:"Row",icon:r.jsx(w1,{color:f("staticContent")})}]]),F1=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{generationData:n,imageAspectRatioNumber:o,targetResponseImage:i,isCreator:a,parentSrc:s,shouldHideParent:c,handleApplySeed:d,isSuperRes:u,handleUseGenerationPrompt:h,handleDescribeGeneration:p,handleRemixGeneration:g,isSuperResDisabled:m,handleGenerationPrivateToggle:v,handleCanvasGeneration:x,handleGenerationRemoveBg:y,description:_,handleAutoLikeGeneration:w}=l.useContext(Ln),{setGenerationInput:I,generationInput:R,setGenerationInputMode:S}=l.useContext(ye),{navigate:E,getBrowsingData:N}=l.useContext($e),{hasAccessToAdvancedFeatures:k}=l.useContext(ge),{image_index:A}=an(),D=Ee(),{showPayWallModel:O}=$t(),{user_prompt:L,use_autoprompt:P,variation_parent:G,upload_parent:B,model_version:M,aspect_ratio:z,request_id:F,seed:T,user_negative_prompt:j,sampling_speed:Z,image_weight:ee,tiling_preset:te,parent:$,style_expert:X,color_palette:W}=n??{},Y=l.useMemo(()=>{if(i&&(i.is_autoprompt||P))return i.prompt},[i,P]),q=l.useMemo(()=>{const Ge=(B==null?void 0:B.image_id)??($==null?void 0:$.image_id);if(Ge)return oe.IMAGE.replace(":image_id",Ge);const st=(G==null?void 0:G.request_id)??($==null?void 0:$.request_id);return st?oe.GENERATION.replace(":request_id",st).replace(":image_index","0"):void 0},[G==null?void 0:G.request_id,B==null?void 0:B.image_id,$==null?void 0:$.request_id,$==null?void 0:$.image_id]),V=l.useMemo(()=>ee||($==null?void 0:$.weight),[ee,$==null?void 0:$.weight]),Q=l.useMemo(()=>V?`${ee??($==null?void 0:$.weight)} / 100`:"",[ee,$==null?void 0:$.weight,V]),K=l.useMemo(()=>u?`${(n==null?void 0:n.upscale_details_weight)??50} / 100`:void 0,[u,n==null?void 0:n.upscale_details_weight]),ae=l.useMemo(()=>u?"Ideogram Upscale 1.0":M?D1.get(M)??"Ideogram 2.0":void 0,[M,u]),ce=l.useMemo(()=>{const Ge=(i==null?void 0:i.style_expert)??X;if(Ge)return yT.get(Ge)},[X,i==null?void 0:i.style_expert]),ve=l.useMemo(()=>z??"1:1",[z]),se=l.useMemo(()=>{if(n!=null&&n.width&&(n!=null&&n.height))return`(${n==null?void 0:n.width} x ${n==null?void 0:n.height})`},[n==null?void 0:n.width,n==null?void 0:n.height]),H=l.useMemo(()=>Ws.get(Z??0),[Z]),me=l.useRef(null);l.useEffect(()=>{var Ge,st,bt;e||(Ge=N())!=null&&Ge.yPosition||((bt=(st=me.current)==null?void 0:st.firstElementChild)==null||bt.scrollIntoView({block:"start"}),window.scrollTo(0,0))},[F,A,e,N]);const[ne,ue]=l.useState(!1),[fe,Se]=l.useState(!1),[je,qe]=l.useState(!1),[De,Ye]=l.useState(!1),nt=l.useCallback(()=>{n&&(D({eventKey:"COPY_PROMPT_FROM_ZOOMIN_VIEW",metaData:{selfGeneration:a}}),navigator.clipboard.writeText(n.user_prompt),ue(!0),setTimeout(()=>ue(!1),2e3))},[n,a,D]),ct=l.useCallback(()=>{i!=null&&i.prompt&&(D({eventKey:"COPY_PROMPT_MAGIC_FROM_ZOOMIN_VIEW",metaData:{selfGeneration:a}}),navigator.clipboard.writeText(i.prompt),Se(!0),setTimeout(()=>Se(!1),2e3))},[a,i==null?void 0:i.prompt,D]),he=l.useCallback(()=>{j&&(D({eventKey:"COPY_NEGATIVE_PROMPT_FROM_ZOOMIN_VIEW",metaData:{selfGeneration:a}}),navigator.clipboard.writeText(j),qe(!0),setTimeout(()=>qe(!1),2e3))},[a,D,j]),Fe=l.useCallback(()=>{_&&(D({eventKey:"COPY_DESCRIPTION_FROM_ZOOMIN_VIEW",metaData:{selfGeneration:a}}),navigator.clipboard.writeText(_),Ye(!0),setTimeout(()=>Ye(!1),2e3))},[_,a,D]);return n?r.jsxs(T6,{ref:me,children:[!e&&r.jsxs(r.Fragment,{children:[r.jsx(C,{minHeight:16}),r.jsx(N1,{}),r.jsx(C,{minHeight:16}),r.jsx(ua,{isPrivate:!!n.private,isCreator:a,isGeneration:!0,generationData:n,isSuperResDisabled:m,handleUsePrompt:h,handleDescribe:p,handleRemix:()=>{S("remix"),g()},handleUpscale:()=>{S("upscale"),g()},toggleVisibility:v,handleOpenInCanvas:()=>x(),handleMagicFill:()=>x("magic_fill"),handleExtend:()=>x("extend"),handleRemoveBg:y,isBackgroundRemovedImage:!1,targetResponseId:i==null?void 0:i.response_id}),!u&&r.jsxs(r.Fragment,{children:[r.jsx(C,{minHeight:16}),r.jsx(k1,{})]})]}),r.jsx(lr,{}),r.jsxs(Ri,{children:[r.jsx(qo,{children:r.jsx(Xt,{children:"Prompt"})}),r.jsxs(qo,{children:[r.jsx(Yt,{size:32,onClick:()=>{D({eventKey:"RETRY_PROMPT_CLICK_FROM_ZOOMIN_VIEW",metaData:{response_id:(i==null?void 0:i.response_id)??""}}),w(),I({...R,prompt:n.user_prompt,timestamp:Date.now()})},icon:r.jsx(Ko,{color:f("outlinedButtonText"),width:16,height:16}),tooltip:"Use"}),r.jsx(C,{width:8}),r.jsx(Yt,{size:32,onClick:()=>nt(),icon:ne?r.jsx(Ei,{}):r.jsx(qr,{color:f("outlinedButtonText"),width:16,height:16}),tooltip:ne?"Copied":"Copy"})]})]}),r.jsx(Ti,{content:L}),W&&r.jsx(U7,{colorPalette:W}),r.jsx(lr,{}),Y&&r.jsxs(r.Fragment,{children:[r.jsxs(Ri,{children:[r.jsx(qo,{children:r.jsx(Xt,{children:"Magic Prompt"})}),r.jsxs(qo,{children:[r.jsx(Yt,{size:32,onClick:()=>{D({eventKey:"RETRY_MAGIC_PROMPT_CLICK_FROM_ZOOMIN_VIEW",metaData:{response_id:(i==null?void 0:i.response_id)??""}}),w(),I({...R,prompt:Y,timestamp:Date.now()})},icon:r.jsx(Ko,{color:f("outlinedButtonText"),width:16,height:16}),tooltip:"Use"}),r.jsx(C,{width:8}),r.jsx(Yt,{size:32,onClick:()=>ct(),icon:fe?r.jsx(Ei,{}):r.jsx(qr,{color:f("outlinedButtonText"),width:16,height:16}),tooltip:fe?"Copied":"Copy"})]})]}),r.jsx(Ti,{content:Y}),r.jsx(lr,{})]}),j&&r.jsxs(r.Fragment,{children:[r.jsxs(Ri,{children:[r.jsx(qo,{children:r.jsx(Xt,{children:"Negative prompt"})}),r.jsxs(qo,{children:[r.jsx(Yt,{size:32,onClick:()=>{if(D({eventKey:"RETRY_NEGATIVE_PROMPT_CLICK_FROM_ZOOMIN_VIEW",metaData:{response_id:(i==null?void 0:i.response_id)??""}}),!k){O("NEGATIVE_PROMPT");return}w(),I({...R,negative_prompt:j,timestamp:Date.now()})},icon:r.jsxs(C,{position:"relative",children:[r.jsx(Ko,{color:f("outlinedButtonText"),width:16,height:16}),!k&&r.jsx(k6,{children:r.jsx(Wt,{})})]}),tooltip:"Use"}),r.jsx(C,{width:8}),r.jsx(Yt,{size:32,onClick:()=>he(),icon:je?r.jsx(Ei,{}):r.jsx(qr,{color:f("outlinedButtonText"),width:16,height:16}),tooltip:je?"Copied":"Copy"})]})]}),r.jsx(Ti,{content:j}),r.jsx(lr,{})]}),_&&r.jsxs(r.Fragment,{children:[r.jsxs(Ri,{children:[r.jsx(qo,{children:r.jsx(Xt,{children:"Description"})}),r.jsxs(qo,{children:[r.jsx(Yt,{size:32,onClick:()=>{D({eventKey:"RETRY_DESCRIPTION_CLICK_FROM_ZOOMIN_VIEW",metaData:{response_id:(i==null?void 0:i.response_id)??""}}),w(),I({...R,prompt:_,timestamp:Date.now()})},icon:r.jsx(Ko,{color:f("outlinedButtonText"),width:16,height:16}),tooltip:"Use"}),r.jsx(C,{width:8}),r.jsx(Yt,{size:32,onClick:()=>Fe(),icon:De?r.jsx(Ei,{width:16,height:16}):r.jsx(qr,{color:f("outlinedButtonText"),width:16,height:16}),tooltip:De?"Copied":"Copy"})]})]}),r.jsx(Ti,{showRatingActions:!0,content:_}),r.jsx(lr,{})]}),s&&q&&r.jsxs(r.Fragment,{children:[r.jsx(Xt,{marginTop:1,children:u?"Original image":"Parent"}),r.jsxs(E6,{children:[r.jsx(S6,{href:q,onClick:Ge=>{Ge.preventDefault(),Ge.stopPropagation(),!c&&(D({eventKey:"PARENT_CLICK"}),E({...mt(q),loadingGenerationState:{aspectRatioNumber:o,initialResponseId:(G==null?void 0:G.response_id)??($==null?void 0:$.response_id)}}))},children:r.jsx(R6,{src:s,sx:{cursor:c?"not-allowed":"pointer"}})}),!u&&V&&r.jsxs(Mn,{children:[r.jsx(_6,{children:"Image weight"}),r.jsx("br",{}),Q]})]}),r.jsx(lr,{})]}),r.jsxs(I6,{container:!0,children:[ae&&r.jsxs(Ao,{item:!0,xs:6,children:[r.jsx(Xt,{children:"Model"}),r.jsx(jo,{children:r.jsx(Mn,{children:ae})})]}),ce&&r.jsxs(Ao,{item:!0,xs:6,children:[r.jsx(Xt,{children:"Style"}),r.jsx(jo,{children:r.jsx(Mn,{children:ce})})]}),r.jsxs(Ao,{item:!0,xs:6,children:[r.jsx(Xt,{children:"Resolution"}),r.jsx(jo,{children:r.jsxs(Mn,{children:[ve," ",r.jsx(T1,{children:se})]})})]}),H&&!u&&r.jsxs(Ao,{item:!0,xs:6,children:[r.jsx(Xt,{children:"Rendering"}),r.jsx(jo,{children:r.jsx(Mn,{children:H})})]}),u&&r.jsxs(Ao,{item:!0,xs:6,children:[r.jsx(Xt,{children:"Resemblance"}),r.jsx(jo,{children:r.jsx(Mn,{children:Q})})]}),u&&K&&r.jsxs(Ao,{item:!0,xs:6,children:[r.jsx(Xt,{children:"Detail"}),r.jsx(jo,{children:r.jsx(Mn,{children:K})})]}),T!==void 0&&r.jsxs(Ao,{item:!0,xs:6,children:[r.jsx(Xt,{children:"Seed"}),r.jsxs(jo,{children:[r.jsx(Mn,{children:T}),k&&r.jsxs(r.Fragment,{children:[r.jsx(C,{width:8}),r.jsx(Yt,{size:32,onClick:()=>d(),icon:r.jsx(Ko,{color:f("outlinedButtonText"),width:16,height:16}),tooltip:"Use"})]})]})]}),te&&r.jsxs(Ao,{item:!0,xs:6,children:[r.jsx(Xt,{children:"Tile"}),r.jsxs(jo,{children:[nf.get(te).icon,r.jsx(C,{width:4}),r.jsx(Mn,{children:nf.get(te).name})]})]}),!!n.creation_time_float&&r.jsxs(Ao,{item:!0,xs:6,children:[r.jsx(Xt,{children:"Date created"}),r.jsx(jo,{children:r.jsx(Mn,{children:nd(n.creation_time_float)})})]})]}),r.jsx(C,{minHeight:48})]}):null},_6=b("span")(()=>({fontSize:14,fontWeight:600,color:f("primary")})),Ei=b(eu)(()=>({fontSize:16,color:f("primary")})),I6=b(Co)({width:"100%"}),Ao=b(Co)({display:"flex",flexDirection:"column",marginTop:24}),jo=b(C)({minHeight:40,display:"flex",alignItems:"center"}),S6=b("a")({position:"relative",width:"fit-content"}),R6=b("img")(()=>({width:64,height:64,borderRadius:4,backgroundColor:f("border"),objectFit:"cover"})),T6=b(C)({width:"100%",flex:1,display:"flex",flexDirection:"column",padding:16,paddingTop:0,maxHeight:"100%",minHeight:"100%",overflow:"auto",scrollbarGutter:"stable"}),qo=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",alignSelf:"center"}),E6=b(C)({display:"flex",alignItems:"center",gap:16,marginTop:12}),k6=b(C)({position:"absolute",right:"-14px",top:"50%",transform:"translateY(-50%)",marginTop:"auto",marginBottom:"auto",zIndex:1,cursor:"pointer"}),A6=()=>{const{hasImagePrompt:t,openEditor:e,generationInput:n,showRemixAspectRatioWarning:o,setShowRemixAspectRatioWarning:i,generationInputMode:a}=l.useContext(ye),{renderInputOnly:s}=l.useContext(Et),c=l.useMemo(()=>{var h,p;return(h=n==null?void 0:n.variation_input)!=null&&h.image_id?Zr(n==null?void 0:n.variation_input.image_id,"balanced"):(p=n==null?void 0:n.variation_input)!=null&&p.response_id?cd(n==null?void 0:n.variation_input.response_id,"balanced"):void 0},[n==null?void 0:n.variation_input]),{parentNeedCenterCrop:d}=h7();l.useEffect(()=>{i(!1),n.imageParent&&n.imageParent.width&&n.imageParent.height&&d({width:n.imageParent.width,height:n.imageParent.height}).then(h=>i(h))},[n.imageParent,d,i]);const u=l.useMemo(()=>a==="upscale"?"Upscale":D1.get(n.model_version),[n.model_version,a]);return!c||!o||!t||s?null:r.jsxs(j6,{children:[r.jsxs(le,{children:["We'll crop your image to the nearest supported aspect ratio by"," ",u,". You can adjust this in the"," ",r.jsx(P6,{onClick:()=>{var h,p,g,m,v,x;e({responseId:(h=n==null?void 0:n.variation_input)==null?void 0:h.request_id,imageId:(p=n==null?void 0:n.variation_input)==null?void 0:p.image_id,defaultPrivate:!0,parentInfo:(g=n==null?void 0:n.variation_input)!=null&&g.image_id?{parent_image_id:(m=n==null?void 0:n.variation_input)==null?void 0:m.image_id,aspect_ratio:n.aspectRatio??"1:1"}:{parent_request_id:(v=n==null?void 0:n.variation_input)==null?void 0:v.request_id,parent_response_id:(x=n==null?void 0:n.variation_input)==null?void 0:x.response_id,aspect_ratio:n.aspectRatio??"1:1"}})},children:"Editor"}),"."]}),r.jsx(C,{width:8}),r.jsx(Be,{icon:r.jsx(wt,{color:f("quietButtonText")}),onClick:()=>i(!1),size:{width:32,height:32}})]})},j6=b(C)(()=>({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",outlineStyle:"solid",outlineWidth:.5,outlineColor:f("infoCardBorder"),backgroundColor:f("infoCardBackground"),borderRadius:8,padding:"8px 8px 8px 12px",color:f("primary"),fontSize:16,width:"100%",wordBreak:"break-word",marginBottom:16})),P6=b("span")(()=>({color:f("primary"),textDecoration:"underline",textDecorationStyle:"dashed",cursor:"pointer"})),M6=()=>{const{describeError:t,setDescribeError:e}=l.useContext(ye);return t!==!0?null:r.jsxs(O6,{children:[r.jsx(le,{children:"Sorry, something went wrong. Please try again."}),r.jsx(Be,{icon:r.jsx(wt,{color:f("quietButtonText")}),onClick:()=>e(!1),size:{width:32,height:32}})]})},O6=b(C)(()=>({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",outlineStyle:"solid",outlineWidth:.5,outlineColor:f("infoCardBorder"),backgroundColor:f("infoCardBackground"),borderRadius:8,padding:"8px 8px 8px 12px",color:f("primary"),fontSize:16,width:"100%",wordBreak:"break-word",marginBottom:16})),of="DISMISSED_DESCRIBE_QUOTA_WARNING",B6=()=>{const{subscriptionStatus:t}=l.useContext(ge),e=Nt(),n=!localStorage.getItem(of),{currentDescriptionId:o}=l.useContext(Et),[i,a]=l.useState(n),s=l.useMemo(()=>(t==null?void 0:t.noActiveSubscription)&&i,[t==null?void 0:t.noActiveSubscription,i]),c=l.useCallback(()=>{localStorage.setItem(of,"true"),a(!1)},[a]);return!s||!o?null:r.jsxs(L6,{children:[r.jsxs(le,{children:["As a free user, each use of Describe counts toward your weekly credit limit. ",r.jsx("br",{})," Get"," ",r.jsx(N6,{href:oe.PRICING,target:"_blank",onClick:d=>{d.preventDefault(),e({newTab:!0,conversionReason:lt.DescribeQuotaWarning})},children:"Ideogram Basic or above"})," ","for unlimited use."]}),r.jsx(Be,{icon:r.jsx(wt,{color:f("quietButtonText")}),onClick:()=>c()})]})},L6=b(C)(()=>({display:"flex",flexDirection:"row",justifyContent:"space-between",outlineStyle:"solid",outlineWidth:.5,outlineColor:f("infoCardBorder"),backgroundColor:f("infoCardBackground"),borderRadius:8,padding:12,color:f("primary"),fontSize:16,width:"100%",wordBreak:"break-word",marginBottom:16})),N6=b("a")(()=>({color:f("primary"),textDecoration:"underline",textDecorationStyle:"dashed"})),Io=t=>{const{style:e,logic:n}=t,{value:o,onChange:i,number:a,numeric:s,disabled:c,onBlur:d,onFocus:u,autoSelect:h,onSelect:p,ref:g,parentRef:m,autoFocus:v}=n,{fullWidth:x,inputWidth:y,multiline:_,endButton:w,placeholder:I,center:R,hint:S,toggleColor:E,centerPlaceholder:N,rows:k,error:A,customHeight:D,hideValueOnDisable:O,resizable:L,fontSize:P}=e,[G,B]=l.useState(!1);return r.jsx(Ca,{enterDelay:1e3,enterNextDelay:1e3,disableHoverListener:!S,disableFocusListener:!0,disableTouchListener:!0,slotProps:{tooltip:{sx:{backgroundColor:f("revertBackdrop"),color:f("background")}}},PopperProps:{modifiers:[{name:"offset",options:{offset:[0,-8]}}]},title:S,children:r.jsx(D6,{justifyContent:x?"space-between":"flex-start",width:x?"100%":"fit-content",flex:x?1:void 0,children:r.jsx(F6,{autoFocus:v,ref:m,sx:{width:y,flex:x&&!y?1:void 0,backgroundColor:E?f("toggleBackground"):"transparent","& .MuiInputBase-input":{textAlign:R?"center":void 0,resize:L?"vertical":"none",fontSize:P??16,"&::placeholder":{textOverflow:"ellipsis !important",opacity:"1 !important",color:`${f("toggleTextDisabled")} !important`,fontSize:14,fontWeight:500,textAlign:N?"center":void 0},"&.Mui-disabled::placeholder":{WebkitTextFillColor:f("toggleTextDisabled"),fontWeight:500}},padding:w?"0 0 0 12px !important":void 0,borderWidth:1,"&:hover":{borderColor:E&&c?"transparent":f(A?"destructive":c?"inputBorderDefault":G?"inputBorderPressed":"inputBorderHover")},borderColor:E&&c?"transparent":f(A?"destructive":c?"inputBorderDefault":G?"inputBorderPressed":"inputBorderDefault"),height:D??void 0},disabled:c,value:c&&O?"":o,onChange:M=>{i(M.target.value)},onFocus:M=>{B(!0),h&&(M.target.select(),setTimeout(()=>M.target.select(),150)),u==null||u(M)},onBlur:M=>{d==null||d(M.target.value),B(!1)},onKeyDown:M=>{M.stopPropagation(),(M.code==="Enter"||M.code==="NumpadEnter")&&!M.shiftKey&&(M.preventDefault(),M.currentTarget.blur())},multiline:_,endAdornment:w,type:s?"number":a?"tel":void 0,placeholder:I,maxRows:k?void 0:4,rows:k,inputProps:{onSelect:p,onMouseUp:p,ref:g,spellCheck:"false"}})})})},D6=b(C)({display:"flex",alignItems:"center"}),F6=b(Wc)(()=>({color:f("inputValue"),fontSize:16,minHeight:32,borderRadius:8,paddingLeft:12,paddingRight:12,paddingTop:7.5,paddingBottom:7.5,"& .MuiInputBase-input":{padding:0},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:f("secondary")},borderStyle:"solid"})),ms=t=>{var _,w;const{logic:e,style:n}=t,{value:o,label:i,onChange:a,marks:s,range:c,onCommit:d,step:u}=e,{size:h,height:p,disabled:g,twoRows:m,singleColor:v,vertical:x,customColor:y}=n??{};return r.jsx(rf,{width:x?void 0:"100%",sx:m?{flexDirection:"column"}:void 0,children:r.jsx(rf,{sx:{height:p?`${p}px`:void 0,paddingLeft:s&&((_=s[0])!=null&&_.label)?2:0,paddingRight:s&&((w=s[s.length-1])!=null&&w.label)?2:0,width:x?void 0:"100%"},children:r.jsx(z6,{sx:{height:x?h:8,width:x?8:h,color:(y==null?void 0:y.color)??f(v?"sliderRail":"sliderColor"),padding:x?"0 16px !important":"16px 0 !important","& .MuiSlider-rail":{backgroundColor:(y==null?void 0:y.rail)??f("sliderRail")},"& .MuiSlider-thumb":{backgroundColor:y!=null&&y.thumb?`${y.thumb} !important`:void 0}},value:o,min:c==null?void 0:c.min,max:c==null?void 0:c.max,step:u,marks:s,disabled:g,onChange:(I,R)=>{uc&&I.type==="mousedown"||a(R)},onChangeCommitted:(I,R)=>{uc&&I.type==="mouseup"||(a(R),d==null||d(R))},orientation:x?"vertical":"horizontal",valueLabelDisplay:i?"auto":"off",valueLabelFormat:()=>i})})})},rf=b(C)({display:"flex"}),z6=b(Wf)(()=>({"& .MuiSlider-thumb":{height:24,width:24,borderWidth:1,borderStyle:"solid",backgroundColor:f("sliderThumbDefault"),borderColor:f("sliderThumbBorderDefault"),boxShadow:`${f("sliderThumbBoxShadowDefault")} !important`,"&:focus":{backgroundColor:f("sliderThumbHover"),borderColor:f("sliderThumbBorderHover"),boxShadow:`${f("sliderThumbBoxShadowHover")} !important`},"&:hover":{backgroundColor:f("sliderThumbHover"),borderColor:f("sliderThumbBorderHover"),boxShadow:`${f("sliderThumbBoxShadowHover")} !important`},"&.Mui-active":{backgroundColor:f("sliderThumbPressed"),borderColor:f("sliderThumbBorderPressed"),boxShadow:`${f("sliderThumbBoxShadowHover")} !important`},"&::before":{boxShadow:"none"}},"& .MuiSlider-valueLabel":{fontSize:14,backgroundColor:f("tooltip"),color:f("tooltipText"),borderRadius:8},"& .MuiSlider-track":{border:"none",height:8},"& .MuiSlider-rail":{opacity:1},"& .MuiSlider-markLabel":{color:f("primary"),fontSize:11,fontWeight:200,top:"30px !important"},"& .MuiSlider-mark.MuiSlider-markActive":{color:f("sliderColor"),backgroundColor:f("sliderColor"),opacity:1},"& .MuiSlider-mark":{color:f("sliderMarker"),backgroundColor:f("sliderMarker"),opacity:1,width:1,height:8,borderRadius:0,"&:focus":{color:f("sliderMarker"),backgroundColor:f("sliderMarker")}}})),U6=t=>{var y;const{onClose:e,src:n,privateImage:o,editParentInfo:i}=t,{hasAccessToEditor:a}=l.useContext(ge),{setGenerationInput:s,generationInput:c,openEditor:d,handleDescribeImage:u,loadingDescription:h,generationInputMode:p}=l.useContext(ye),g=Ee(),[m,v]=l.useState(((y=c.variation_input)==null?void 0:y.image_weight)??50),x=l.useCallback(_=>{const w={...c,variation_input:{...c.variation_input,image_weight:_}};s(w)},[c,s]);return r.jsxs(C,{display:"flex",flexDirection:"column",alignItems:"center",children:[r.jsx(G1,{badgeContent:r.jsxs(z1,{children:[r.jsx(Yt,{nonTransparent:!0,onClick:e,icon:r.jsx(wt,{color:f("quietButtonText")})}),a&&r.jsxs(r.Fragment,{children:[r.jsx(C,{height:8}),r.jsx(Yt,{nonTransparent:!0,onClick:()=>{g({eventKey:"EDIT_CLICK_FROM_REMIX"}),d({responseId:i.parent_response_id,imageId:i.parent_image_id,defaultPrivate:o,parentInfo:i})},icon:r.jsx(fs,{color:f("quietButtonText")})})]}),r.jsx(C,{height:8}),r.jsx(Yt,{nonTransparent:!0,disabled:!!h,onClick:()=>{g({eventKey:"DESCRIBE_FROM_REMIX"}),u()},icon:h===i.parent_image_id||h===i.parent_response_id?r.jsx(co,{size:16,sx:{color:f("quietButtonText"),width:16,height:16}}):r.jsx(ti,{color:f("quietButtonText")})})]}),overlap:"rectangular",children:r.jsx(U1,{sx:{background:`url(${n})`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundColor:f("border")}})}),p!=="upscale"&&r.jsxs(r.Fragment,{children:[r.jsx(C,{height:8}),r.jsxs(to,{children:[r.jsx(ro,{label:"Image weight",freeWidth:!0}),r.jsx(Io,{style:{inputWidth:52,center:!0},logic:{value:m?m.toString():"",onChange:_=>{let w=parseInt(_||"0");w>100?w=100:w<0&&(w=0),v(w),w<=100&&w>=1&&x(w)},onBlur:_=>{_||(v(1),x(1))},number:!0,autoSelect:!0}})]}),r.jsx(ms,{logic:{value:m,onChange:_=>v(_===0?1:_),onCommit:_=>{g({eventKey:"SLIDE_FINE_GRAINED_IMAGE_WEIGHT",metaData:{value:_}}),x(_===0?1:_)},step:10,marks:[{value:50}]}})]})]})},z1=b(C)({width:40,display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"center",height:"max-content",marginTop:22}),U1=b("div")(()=>({borderRadius:8,objectFit:"contain",width:160,height:160})),G1=b(qc)({"& .MuiBadge-badge":{alignItems:"flex-start !important",alignContent:"flex-start !important"}});function H1({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M15.87 2.669l4.968 4.968a2.25 2.25 0 010 3.182l-8.681 8.68 6.098.001a.75.75 0 01.743.648l.006.102a.75.75 0 01-.648.743l-.102.007-8.41.001a2.244 2.244 0 01-1.714-.655l-4.968-4.969a2.25 2.25 0 010-3.182l9.526-9.526a2.25 2.25 0 013.182 0zM5.709 11.768l-1.487 1.488a.75.75 0 000 1.06l4.969 4.969c.146.146.338.22.53.22l.029-.005.039.002a.747.747 0 00.463-.217l1.486-1.487-6.03-6.03zm8.04-8.039l-6.98 6.978 6.03 6.03 6.979-6.978a.75.75 0 000-1.061l-4.969-4.969a.75.75 0 00-1.06 0z"})})}const q1=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{handleClearClick:n}=l.useContext(Et);return r.jsx(Be,{onClick:n,icon:r.jsx(H1,{color:f("quietButtonText")}),tooltip:"Clear text",tooltipPlacement:e?"bottom":"left"})},G6=()=>{const{hasPrevPrompt:t,hasNextPrompt:e}=l.useContext(ye),{inputRef:n,renderInputOnly:o,setNextPrompt:i,setPreviousPrompt:a}=l.useContext(Et);return l.useEffect(()=>{const s=c=>{(n==null?void 0:n.current)===document.activeElement&&!o||(c.code==="ArrowDown"?(c.stopPropagation(),c.preventDefault(),i()):c.code==="ArrowUp"&&(c.stopPropagation(),c.preventDefault(),a()))};return document.addEventListener("keydown",s,!1),()=>{document.removeEventListener("keydown",s)}},[a,o,n,i]),r.jsxs(H6,{flexDirection:"column",children:[r.jsx(q1,{}),(t||e)&&r.jsxs(r.Fragment,{children:[r.jsx(C,{height:4,width:8}),r.jsx(Be,{disabled:!t,onClick:a,icon:r.jsx(Gd,{color:f(t?"quietButtonText":"quietButtonTextDisabled")}),tooltip:r.jsx(Tc,{description:t?"Previous prompt":"Reached end of prompt history",shortcutProps:t?{keyName:"up"}:void 0}),tooltipPlacement:"left"})]}),e&&r.jsxs(r.Fragment,{children:[r.jsx(C,{height:4,width:8}),r.jsx(Be,{disabled:!e,onClick:i,icon:r.jsx(Ud,{color:f(e?"quietButtonText":"quietButtonTextDisabled")}),tooltip:r.jsx(Tc,{description:"Next prompt",shortcutProps:{keyName:"down"}}),tooltipPlacement:"left"})]})]})},H6=b(C)({display:"flex",alignItems:"center"}),q6=()=>{const[t,e]=l.useState("");return l.useEffect(()=>{const n=setInterval(()=>{const o=["",".","..","..."];e(i=>{const s=(o.indexOf(i)+1)%o.length;return o[s]})},300);return()=>clearInterval(n)},[e]),t},W6=t=>{const e=we(),n=xe(e.breakpoints.down("md")),o=q6(),{singleRow:i}=t,{showEmptyPromptWarning:a,hasImagePrompt:s,isRetryInpaint:c,setGenerationInput:d,generationInput:u,loadingDescription:h,generationInputMode:p}=l.useContext(ye),{setPrompt:g,prompt:m,handleGenerate:v,handleOpen:x,inputRef:y,renderInputOnly:_,currentDescriptionId:w,autoFocus:I}=l.useContext(Et),[R,S]=l.useState(!1);return l.useEffect(()=>{a&&(S(!0),setTimeout(()=>S(!1),300))},[a]),l.useEffect(()=>{var E;!_&&!n&&((E=y==null?void 0:y.current)==null||E.focus())},[y,_,n]),r.jsxs($6,{sx:{cursor:w?void 0:"text"},onClick:()=>{var E;w||(E=y==null?void 0:y.current)==null||E.focus()},children:[r.jsx(V6,{placeholder:a?"Describe what you want to see. Your prompt cannot be empty.":h?`Describing image ${o}`:`Describe what you want to see ${p==="upscale"?" (Optional)":""}`,value:m,multiline:!0,maxRows:i?1:void 0,minRows:n?3:1,onPaste:E=>{const N=E.clipboardData.items;Array.from(N).some(A=>{var D;return(D=A==null?void 0:A.type)==null?void 0:D.startsWith("image/")})?E.preventDefault():E.stopPropagation()},inputProps:{sx:{overflow:i?"hidden !important":"auto !important",whiteSpace:i?"nowrap":void 0,maxHeight:n?void 0:s||c?"30dvh":"50dvh","&::placeholder":{color:f(R&&a?"secondary":"informative"),opacity:1}},ref:y},onBlur:()=>d({...u,prompt:m}),onChange:E=>{x(),g(E.target.value)},onKeyDown:E=>{(E.code==="Enter"||E.code==="NumpadEnter")&&!E.shiftKey&&(E.preventDefault(),v())},autoFocus:n||I}),!_&&!h&&w&&r.jsx(E1,{descriptionId:w})]})},$6=b(C)({flex:1,height:"100%",width:"100%",display:"flex",flexDirection:"column"}),V6=b(Wc)(()=>({"&::placeholder":{color:f("informative"),opacity:1},width:"100%",caretColor:f("primary"),color:f("secondary"),paddingTop:0,paddingBottom:0,display:"flex",flexDirection:"column",fontSize:16})),K6=()=>{const{handleDismissImagePrompt:t}=l.useContext(Et),{isRetryInpaint:e,generationInput:n}=l.useContext(ye),o=l.useMemo(()=>{if(n.retry_inpaint_data)return Fg(n.retry_inpaint_data.request_id)},[n.retry_inpaint_data]);return!e||!o?null:r.jsx(J6,{children:r.jsx(G1,{badgeContent:r.jsx(z1,{children:r.jsx(Yt,{nonTransparent:!0,onClick:t,icon:r.jsx(wt,{color:f("quietButtonText")})})}),overlap:"rectangular",children:r.jsx(U1,{sx:{background:`url(${o})`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundColor:f("border")}})})})},J6=b(C)({position:"relative"}),W1=()=>{var g,m,v,x,y,_,w,I;const t=we(),e=xe(t.breakpoints.down("md")),{renderInputOnly:n,prompt:o,inputBottomRef:i,handleDismissImagePrompt:a}=l.useContext(Et),{generationInput:s,hasImagePrompt:c,isRetryInpaint:d,promptErrorData:u}=l.useContext(ye),[h,p]=l.useState(!1);return l.useEffect(()=>{u&&u.prompt===o&&p(!1)},[u,p,o]),r.jsxs(r.Fragment,{children:[!n&&r.jsxs(r.Fragment,{children:[r.jsx(M6,{}),r.jsx(B6,{})]}),r.jsx(A6,{}),r.jsxs(X6,{flexDirection:e?"column":"row",children:[r.jsxs(Y6,{children:[r.jsx(W6,{singleRow:n}),r.jsx(C,{ref:i}),c&&!n&&r.jsxs(r.Fragment,{children:[r.jsx(C,{height:24}),r.jsx(U6,{src:(g=s==null?void 0:s.variation_input)!=null&&g.image_id?Pt((m=s==null?void 0:s.variation_input)==null?void 0:m.image_id,"balanced","edit"):(v=s==null?void 0:s.variation_input)!=null&&v.response_id?Pt((x=s==null?void 0:s.variation_input)==null?void 0:x.response_id,"balanced","response"):"",privateImage:!!((y=s==null?void 0:s.variation_input)!=null&&y.private),editParentInfo:(_=s==null?void 0:s.variation_input)!=null&&_.image_id?{parent_image_id:s==null?void 0:s.variation_input.image_id,aspect_ratio:s.aspectRatio??"1:1"}:{parent_request_id:(w=s==null?void 0:s.variation_input)==null?void 0:w.request_id,parent_response_id:(I=s==null?void 0:s.variation_input)==null?void 0:I.response_id,aspect_ratio:s.aspectRatio??"1:1"},onClose:a})]}),d&&!n&&r.jsxs(r.Fragment,{children:[r.jsx(C,{height:24}),r.jsx(K6,{})]}),!n&&!!u&&u.prompt===o&&r.jsxs(Q6,{children:["Our AI moderator thinks this prompt didn't follow our content policy. We are still learning. Is this an error?"," ",h?r.jsx(r.Fragment,{children:"Thank you."}):r.jsx(Z6,{onClick:()=>{gS(u.rejectedPromptId),p(!0)},children:"Yes"})]})]}),!e&&!n&&r.jsx(G6,{})]})]})},X6=b(C)({display:"flex",width:"100%",height:"100%",flex:1,alignItems:"flex-start"}),Y6=b(C)({display:"flex",flexDirection:"column",width:"100%",height:"100%",alignItems:"flex-start",flex:1}),Q6=b(le)(()=>({fontSize:14,color:f("staticContent")})),Z6=b("span")({cursor:"pointer",textDecoration:"underline"});function eO({width:t,height:e,color:n}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",stroke:"none",viewBox:"0 0 24 24",children:[r.jsx("path",{fill:n??"inherit",fillRule:"evenodd",d:"M10.5 14.5a.75.75 0 01.75.75c0 .063.03.16.158.263.13.103.336.187.592.187a.955.955 0 00.592-.187c.128-.103.158-.2.158-.263a.75.75 0 011.5 0c0 1.224-1.172 1.95-2.25 1.95s-2.25-.726-2.25-1.95a.75.75 0 01.75-.75z",clipRule:"evenodd"}),r.jsx("path",{fill:n??"inherit",fillRule:"evenodd",d:"M12 20.5a8.5 8.5 0 100-17 8.5 8.5 0 000 17zm0 1.5c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",clipRule:"evenodd"}),r.jsx("path",{fill:n??"inherit",d:"M7.082 14.864a.703.703 0 01-.256-.343l-.205-.63a.82.82 0 00-.513-.515l-.62-.202A.718.718 0 015 12.497a.715.715 0 01.482-.676l.629-.204a.812.812 0 00.5-.512l.202-.62a.715.715 0 011.348-.013l.206.634a.814.814 0 00.513.51l.62.202a.713.713 0 01.024 1.354l-.634.206a.823.823 0 00-.511.514l-.201.619a.716.716 0 01-1.096.353zM16.082 14.864a.702.702 0 01-.256-.343l-.205-.63a.82.82 0 00-.513-.515l-.62-.202a.717.717 0 01-.488-.677.715.715 0 01.482-.676l.629-.204a.812.812 0 00.5-.512l.202-.62a.715.715 0 011.348-.013l.206.634a.814.814 0 00.513.51l.62.202a.712.712 0 01.024 1.354l-.634.206a.823.823 0 00-.511.514l-.201.619a.716.716 0 01-1.096.353z"})]})}function tO({width:t,height:e,color:n}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",stroke:"none",viewBox:"0 0 24 24",children:[r.jsx("path",{fill:n??"inherit",fillRule:"evenodd",d:"M17.5 14.5a3 3 0 100 6 3 3 0 000-6zm0-1.5a4.5 4.5 0 100 9 4.5 4.5 0 000-9z",clipRule:"evenodd"}),r.jsx("path",{fill:n??"inherit",d:"M16.113 9.5a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z"}),r.jsx("path",{fill:n??"inherit",fillRule:"evenodd",d:"M2.431 10.932a.75.75 0 01-.32-1.011l1.681-3.239a1.75 1.75 0 012.495-.668L8.44 7.389a.25.25 0 00.357-.096l1.177-2.267a1.75 1.75 0 012.495-.669l2.153 1.375a.25.25 0 00.357-.095l1.68-3.238a.75.75 0 011.332.69L16.31 6.33a1.75 1.75 0 01-2.495.668l-2.153-1.375a.25.25 0 00-.357.095l-1.177 2.268a1.75 1.75 0 01-2.495.668L5.48 7.278a.25.25 0 00-.357.095l-1.68 3.239a.75.75 0 01-1.012.32zM12.892 10.27a.75.75 0 01.206.721l-2.423 9.702a.75.75 0 01-1.249.358l-7.194-6.949a.75.75 0 01.315-1.26l9.617-2.754a.75.75 0 01.728.182zm-3.358 8.8l1.794-7.182-7.12 2.038 5.326 5.144z",clipRule:"evenodd"})]})}function nO({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",stroke:"none",children:r.jsx("path",{fill:n??"inherit",d:"M6.75 2a4.75 4.75 0 000 9.5h4a.75.75 0 00.75-.75v-4A4.75 4.75 0 006.75 2zM3.5 6.75a3.25 3.25 0 116.5 0V10H6.75A3.25 3.25 0 013.5 6.75zM6.75 22a4.75 4.75 0 110-9.5h4a.75.75 0 01.75.75v4A4.75 4.75 0 016.75 22zM3.5 17.25a3.25 3.25 0 006.5 0V14H6.75a3.25 3.25 0 00-3.25 3.25zM22 6.75a4.75 4.75 0 10-9.5 0v4c0 .414.336.75.75.75h4A4.75 4.75 0 0022 6.75zM17.25 3.5a3.25 3.25 0 010 6.5H14V6.75a3.25 3.25 0 013.25-3.25zm0 18.5a4.75 4.75 0 100-9.5h-4a.75.75 0 00-.75.75v4A4.75 4.75 0 0017.25 22zm3.25-4.75a3.25 3.25 0 01-6.5 0V14h3.25a3.25 3.25 0 013.25 3.25z"})})}function oO({width:t,height:e,color:n}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",stroke:"none",children:[r.jsx("g",{clipPath:"url(#clip0_296_7631)",children:r.jsxs("g",{fill:n??"inherit",fillRule:"evenodd",clipPath:"url(#clip1_296_7631)",clipRule:"evenodd",children:[r.jsx("path",{d:"M3.871 16.614l-.199 1.13a2 2 0 00.737 1.922l-.538-3.052zM10.625 21l5.502.97a2 2 0 002.317-1.622l.19-1.08a1.99 1.99 0 01-1.006.498l-.624.11-.037.212a.5.5 0 01-.58.405l-1.443-.254-4.319.761zm7.716-8.705l1.056-5.991a.5.5 0 00-.405-.58l-1.867-.329-.278-1.572 2.405.424a2 2 0 011.623 2.317l-1.772 10.05-.762-4.32zm-7.716-9.569L8.42 2.337A2 2 0 006.242 3.5l4.383-.773z"}),r.jsx("path",{d:"M17.5 13.67l1.098-6.223a1 1 0 00-.812-1.158L16.148 6l1.352 7.67z"}),r.jsx("path",{d:"M14.763 3.52L3.93 5.43a.5.5 0 00-.406.58l2.43 13.783a.5.5 0 00.58.405l10.833-1.91a.5.5 0 00.406-.579l-2.43-13.784a.5.5 0 00-.58-.405zM3.67 3.953A2 2 0 002.047 6.27l2.43 13.783a2 2 0 002.318 1.623l10.833-1.91a2 2 0 001.622-2.317L16.82 3.665a2 2 0 00-2.318-1.622L3.67 3.953z"}),r.jsx("path",{d:"M5.838 7.217l1.354 7.68 7.679-1.355-1.354-7.68-7.68 1.355zm-.753-1.39a1 1 0 00-.811 1.158L5.8 15.649a1 1 0 001.159.811l8.664-1.528a1 1 0 00.811-1.158L14.907 5.11a1 1 0 00-1.158-.811L5.085 5.826z"})]})}),r.jsxs("defs",{children:[r.jsx("clipPath",{id:"clip0_296_7631",children:r.jsx("path",{fill:"#fff",d:"M0 0H24V24H0z"})}),r.jsx("clipPath",{id:"clip1_296_7631",children:r.jsx("path",{fill:"#fff",d:"M0 0H21.89V22.591H0z",transform:"translate(1.7 2)"})})]})]})}function rO({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",stroke:"none",children:r.jsx("path",{fill:n??"inherit",fillRule:"evenodd",d:"M11.91 2.102a.75.75 0 01.756 0l8.539 4.98a.75.75 0 01.372.649v8.538a.75.75 0 01-.372.648l-8.539 4.98a.75.75 0 01-.755 0l-8.539-4.98A.75.75 0 013 16.27V7.731a.75.75 0 01.372-.648l8.539-4.98zM4.5 9.037v6.801l7.039 4.106v-6.802L4.5 9.037zm8.539 4.105v6.802l7.038-4.105V9.037l-7.039 4.105zm6.3-5.411l-7.05 4.112-7.05-4.112 7.05-4.113 7.05 4.113z",clipRule:"evenodd"})})}function iO({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n??"inherit",viewBox:"0 0 24 24",stroke:"none",children:r.jsx("path",{fill:n??"inherit",d:"M8.664 15.735c.245.173.537.265.836.264v-.004a1.442 1.442 0 001.327-.872l.613-1.864a2.872 2.872 0 011.817-1.812l1.778-.578a1.443 1.443 0 00-.052-2.74l-1.755-.57a2.876 2.876 0 01-1.822-1.823l-.578-1.777a1.446 1.446 0 00-2.732.022l-.583 1.792a2.877 2.877 0 01-1.77 1.786l-1.777.571a1.444 1.444 0 00.017 2.734l1.754.569a2.887 2.887 0 011.822 1.826l.578 1.775c.099.283.283.528.527.7zm-.374-4.25a4.054 4.054 0 00-.363-.413h.003a4.394 4.394 0 00-1.72-1.063l-1.6-.508 1.611-.524a4.4 4.4 0 001.69-1.065 4.448 4.448 0 001.041-1.708l.515-1.582.516 1.587a4.374 4.374 0 002.781 2.773l1.62.522-1.59.515a4.379 4.379 0 00-2.774 2.775l-.515 1.582-.515-1.585a4.368 4.368 0 00-.7-1.306zm8.041 9.297a1.123 1.123 0 01-.41-.549l-.328-1.007a1.293 1.293 0 00-.821-.823l-.991-.323A1.148 1.148 0 0113 16.997a1.143 1.143 0 01.771-1.08l1.006-.326a1.3 1.3 0 00.8-.819l.324-.992a1.143 1.143 0 012.157-.021l.329 1.014a1.3 1.3 0 00.82.816l.992.323a1.141 1.141 0 01.039 2.165l-1.014.329a1.3 1.3 0 00-.818.822l-.322.989c-.078.23-.226.43-.425.57a1.14 1.14 0 01-1.328-.005zm-1.03-3.783A2.789 2.789 0 0117 18.708a2.794 2.794 0 011.7-1.7 2.813 2.813 0 01-1.718-1.708A2.806 2.806 0 0115.3 17z"})})}const sO=[{id:"AUTO",name:"Auto",icon:r.jsx(iO,{})},{id:"DEFAULT",name:"General",icon:r.jsx(nO,{})},{id:"PHOTO",name:"Realistic",icon:r.jsx(oO,{})},{id:"ILLUSTRATION",name:"Design",icon:r.jsx(tO,{})},{id:"RENDER_3D",name:"3D",icon:r.jsx(rO,{})},{id:"ANIME",name:"Anime",icon:r.jsx(eO,{})}],aO=()=>{const{generationInput:t,setGenerationInput:e}=l.useContext(ye),n=l.useMemo(()=>t.style_expert===void 0?"AUTO":t.style_expert,[t.style_expert]);return r.jsx(r.Fragment,{children:r.jsx(uO,{children:sO.map(o=>{const{id:i,name:a,icon:s}=o;return r.jsxs(dO,{onClick:()=>{i!==n&&e({...t,style_expert:i})},sx:{...n===i?{color:f("InteractiveActive"),borderColor:f("inputBorderPressed"),background:f("toggleButtonPressed"),fill:f("InteractiveActive"),stroke:f("InteractiveActive")}:{borderColor:f("inputBorderDefault"),color:f("Interactive"),background:f("toggleButtonRest"),fill:f("Interactive"),stroke:f("Interactive"),"&:hover":{color:f("InteractiveHover"),borderColor:f("inputBorderHover"),background:f("toggleButtonHover"),fill:f("InteractiveHover"),stroke:f("InteractiveHover")},"&:active":{color:f("InteractiveActive"),borderColor:f("inputBorderPressed"),background:f("toggleButtonPressed"),fill:f("InteractiveActive"),stroke:f("InteractiveActive")}}},children:[r.jsx(cO,{children:s}),r.jsx(lO,{children:a})]},i)})})})},lO=b(le)(()=>({paddingRight:12,fontSize:14,fontWeight:600,lineHeight:"20px",letterSpacing:"-0.28px",whiteSpace:"nowrap"})),cO=b(C)(()=>({width:40,height:40,display:"flex",justifyContent:"center",alignItems:"center"})),dO=b(C)(()=>({borderWidth:1,borderStyle:"solid",borderRadius:8,display:"flex",flexDirection:"row",alignItems:"center",overflow:"hidden",position:"relative",cursor:"pointer"})),uO=b(C)({display:"flex",flexDirection:"row",alignItems:"center",gap:8,flexWrap:"wrap"}),$1=()=>{const{generationInput:t,generationInputMode:e}=l.useContext(ye);return!rs(t.model_version)&&e!=="upscale"?r.jsx(aO,{}):r.jsx(YI,{})},V1=()=>{const t=Ee(),{setImageUploadLocalSrc:e}=l.useContext(ye);return r.jsx(Be,{onClick:()=>{t({eventKey:"UPLOAD_BACK_CLICK"}),e(null)},icon:r.jsx(Uo,{color:f("quietButtonText")}),tooltip:"Back"})},Dl=b(co)(()=>({color:f("outlinedButtonTextDisabled"),height:14,width:14,fontSize:14})),hO=()=>{const t=Ee(),e=we(),n=xe(e.breakpoints.down("md")),{wrapSetting:o,handleClose:i}=l.useContext(Et),{imageUploadLocalSrc:a,setImageUploadLocalSrc:s,handleDescribeImage:c,loadingDescription:d,setGenerationInput:u,generationInput:h,uploadedImageId:p,setUploadError:g,setShowRemixAspectRatioWarning:m,imageDescription:v,describeError:x,setGenerationInputMode:y,handleSubmitGeneration:_}=l.useContext(ye),{profileLink:w}=l.useContext(ge),[I,R]=l.useState(!1),[S,E]=l.useState(null);l.useEffect(()=>{S&&(p&&(S==="describe"?v||x?(E(null),R(!1)):(c({image_id:p}),n&&s(null)):(S==="remix"||S==="upscale")&&(Da(p).then(L=>{y(S==="upscale"?"upscale":"remix");const P={...h,variation_input:{image_id:p,private:!0},prompt:void 0,imageParent:L};u(P),S!=="upscale"&&c({image_id:p}),s(null),R(!1)}),E(null))),R(!0))},[R,p,S,c,x,h,u,E,v,n,_,i,w,s,m,y,g]);const N=l.useRef(null);l.useEffect(()=>{S&&(N.current=S)},[S]);const[k,A]=l.useState(!1),[D,O]=l.useState(!0);return l.useEffect(()=>{if(!a)return;const L=new Image;L.onload=()=>{O(L.width*L.height<i6),A(!0)},L.onerror=()=>{O(!1),A(!0)},L.src=a},[A,a,O]),!a||!k?null:r.jsxs(gO,{children:[r.jsx(C,{width:"100%",children:r.jsx(fO,{style:{maxWidth:n?void 0:o?224:356},src:a})}),r.jsxs(pO,{children:[r.jsx(It,{disabled:!!d,label:(d||I)&&N.current==="describe"?r.jsx(Dl,{size:14}):"Describe",fullWidth:!0,onClick:()=>{t({eventKey:"UPLOAD_DESCRIBE_CLICK"}),E("describe")}}),r.jsx(C,{width:8}),r.jsx(It,{label:I&&N.current==="remix"?r.jsx(Dl,{size:14}):"Remix",fullWidth:!0,onClick:()=>{t({eventKey:"UPLOAD_REMIX_CLICK"}),E("remix")}}),r.jsx(C,{width:8}),D?r.jsx(It,{label:I&&N.current==="upscale"?r.jsx(Dl,{size:14}):"Upscale",fullWidth:!0,onClick:()=>{t({eventKey:"UPLOAD_UPSCALE_CLICK"}),E("upscale")}}):r.jsx(Rt,{content:gs,children:r.jsx("span",{style:{flex:1},children:r.jsx(ht,{label:"Upscale",disabled:!0,fullWidth:!0})})})]})]})},pO=b(C)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",marginTop:16}),fO=b("img")(()=>({width:"100%",aspectRatio:1,borderRadius:8,outlineStyle:"solid",outlineWidth:.5,outlineColor:f("borderHighlight"),objectFit:"contain",backgroundColor:f("border")})),gO=b(C)({width:"100%",display:"flex",flexDirection:"column",position:"relative"}),K1=()=>{const{imageUploadLocalSrc:t}=l.useContext(ye);return r.jsxs(mO,{children:[r.jsx(C,{height:32}),t&&r.jsx(hO,{})]})},mO=b(C)({width:"100%",display:"flex",flexDirection:"column",paddingLeft:8,paddingRight:8}),xO=()=>{var c;const t=Ee(),{hasAccessToEditor:e,subscriptionStatus:n}=l.useContext(ge),{openEditor:o,generationInput:i}=l.useContext(ye),{showPayWallModel:a}=l.useContext(Et),s=l.useCallback(()=>{var d;t({eventKey:"OPEN_BLANK_EDITOR"}),o({defaultPrivate:i.private&&!!((d=n==null?void 0:n.subscriptionQuota)!=null&&d.privateGeneration)})},[i.private,o,(c=n==null?void 0:n.subscriptionQuota)==null?void 0:c.privateGeneration,t]);return r.jsx(Rt,{content:"Editor",size:"small",children:r.jsxs(C,{position:"relative",children:[r.jsx(Be,{onClick:()=>{t({eventKey:"GEN_BOX_EDITOR_BUTTON_CLICK"}),e?s():a("EDITOR")},icon:r.jsx(fs,{color:f("quietButtonText")})}),!e&&r.jsx(vO,{children:r.jsx(Wt,{})})]})})},vO=b(C)({position:"absolute",bottom:4,right:4,pointerEvents:"none"}),yO=()=>{const t=Ee(),{hasAccessToImageUpload:e}=l.useContext(ge),{setUploadError:n,handleUploadImage:o}=l.useContext(ye),{showPayWallModel:i}=l.useContext(Et),a=l.useRef(null),s=l.useCallback(()=>{t({eventKey:"UPLOAD_BROWSE_CLICK"}),a.current&&a.current.click(),n(null)},[n,t]),c=l.useCallback(()=>{var u,h;const d=(h=(u=a.current)==null?void 0:u.files)==null?void 0:h[0];o(d)},[o]);return r.jsxs(r.Fragment,{children:[r.jsx("input",{style:{display:"none"},type:"file",accept:"image/*",ref:a,onChange:c}),r.jsx(Rt,{content:"Upload image",size:"small",children:r.jsxs(C,{position:"relative",children:[r.jsx(Be,{onClick:()=>{t({eventKey:"UPLOAD_V2_CLICK"}),e?s():i("UPLOAD")},icon:r.jsx(g1,{color:f("quietButtonText")})}),!e&&r.jsx(wO,{children:r.jsx(Wt,{})})]})})]})},wO=b(C)({position:"absolute",bottom:4,right:4,pointerEvents:"none"}),J1=()=>r.jsxs(bO,{children:[r.jsx(xO,{}),r.jsx(yO,{})]}),bO=b(C)({display:"flex",gap:"8px",flexDirection:"row",alignItems:"center",justifyContent:"center"}),sf={members:[{colorHex:"#D90452",colorWeight:.1},{colorHex:"#303440",colorWeight:.05},{colorHex:"#D98D62",colorWeight:.05},{colorHex:"#D95959",colorWeight:.05},{colorHex:"#BF045B",colorWeight:.05}]},uo=l.createContext({anchorEl:null,setAnchorEl:()=>{},colorPickerAnchorEl:null,setColorPickerAnchorEl:()=>{},isDisabled:!0,customColorPalette:{members:[]},customColorEditingIndexRef:{current:0},updateCustomColorByPicker:()=>{},deleteCustomColor:()=>{},setColorPalette:()=>{},inlineColorPaletteOption:{members:[]},setColorWithCode:()=>{},colorBrickSize:24,colorPalettePresets:[],customColorPaletteHexCode:void 0,setCustomColorPaletteHexCode:()=>{}}),Bc=5,CO=t=>{var k;const{children:e}=t,n=we(),o=xe(n.breakpoints.down("md")),[i,a]=l.useState(null),[s,c]=l.useState(null),d=l.useRef(0),{generationInput:u,setGenerationInput:h,customColorPalette:p,setCustomColorPalette:g}=l.useContext(ye),[m,v]=l.useState((k=p.members)==null?void 0:k.map(A=>A.colorHex).join(" ")),{colorPalettePresets:x}=C1(),y=l.useMemo(()=>o?36:24,[o]),_=l.useMemo(()=>u.model_version!=="V_1_5",[u.model_version]),w=l.useCallback(A=>{var D,O;p.members?(D=p.members)!=null&&D[d.current]?p.members[d.current].colorHex=A:p.members&&p.members.length<Bc&&p.members.push({colorHex:A,colorWeight:-1}):p.members=[{colorHex:A,colorWeight:-1}],g({...p}),v((O=p.members)==null?void 0:O.map(L=>L.colorHex).join(" "))},[p,g]),I=l.useCallback(()=>{var L,P;const A=d.current;if(!((L=p.members)!=null&&L[A]))return;const D=p.members.slice(0,A).concat(p.members.slice(A+1)),O={...p,members:D};g(O),h({...u,color_palette:O}),v((P=O.members)==null?void 0:P.map(G=>G.colorHex).join(" ")),c(null)},[p,u,g,h]),R=l.useRef(),S=l.useCallback(A=>{A&&(R.current=A),h({...u,color_palette:A})},[u,h]),E=l.useMemo(()=>u.color_palette?u.color_palette:R.current&&R.current.members&&R.current.members.length>1||R.current&&R.current.members&&R.current.members.length===1&&Ut.isEqual(R.current,p)?R.current:(x==null?void 0:x[0])??sf,[x,p,u.color_palette]),N=l.useCallback(A=>{if(A.length===0){g({members:[]}),S(x[0]??sf);return}const D=A.split(" ").slice(0,Bc).map(O=>O.charAt(0)==="#"?/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(O)?O:"#FFFFFF":/^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(O)?`#${O}`:"#FFFFFF").map(O=>({colorHex:O,colorWeight:-1}));g({members:D}),S({members:D})},[x,S,g]);return l.useEffect(()=>{i&&c(null)},[i]),l.useEffect(()=>{var A,D;u.color_palette!==void 0&&((D=(A=u.color_palette)==null?void 0:A.members)==null?void 0:D.length)===0&&h({...u,color_palette:void 0})},[u,h]),r.jsx(uo.Provider,{value:{anchorEl:i,setAnchorEl:a,colorPickerAnchorEl:s,setColorPickerAnchorEl:c,isDisabled:_,customColorPalette:p,customColorEditingIndexRef:d,updateCustomColorByPicker:w,deleteCustomColor:I,setColorPalette:S,inlineColorPaletteOption:E,setColorWithCode:N,colorBrickSize:y,colorPalettePresets:x,customColorPaletteHexCode:m,setCustomColorPaletteHexCode:v},children:e})},_O=()=>{var e;const{inlineColorPaletteOption:t}=l.useContext(uo);return r.jsx(SO,{children:(e=t.members)==null?void 0:e.map((n,o)=>r.jsx(IO,{sx:{background:n.colorHex}},`inline-color-${o}`))})},IO=b(C)({width:16,height:16}),SO=b(C)({display:"flex",alignItems:"center",borderRadius:"2px",overflow:"hidden"}),RO=()=>{const{anchorEl:t,setAnchorEl:e,isDisabled:n,setColorPalette:o,inlineColorPaletteOption:i}=l.useContext(uo),{generationInput:a}=l.useContext(ye);return r.jsxs(to,{children:[r.jsx(ro,{disabled:n,label:"Color palette",tooltip:n?{content:r.jsx(tr,{children:"Only model 2.0 supports Color palette."}),type:"info"}:{content:r.jsx(tr,{children:"Choose your preferred image colors. Colors listed first will have more influence."}),type:"info"}}),r.jsxs(Zo,{width:no,exclusive:!0,size:"small",color:"primary",value:a.color_palette?"on":"off",disabled:n,children:[r.jsx(on,{value:"off",sx:{marginLeft:"0 !important"},onClick:()=>o(),disableRipple:!0,children:"Auto"}),r.jsx(on,{value:"on",sx:{marginLeft:"2px !important"},onClick:()=>o(i),disableRipple:!0,children:r.jsx(_O,{})}),r.jsx(TO,{children:r.jsx(Be,{pressed:!!t,customBorderRadius:"6px",size:{width:32,height:36},customPressedButtonColor:f("quietButtonHover"),disabled:n,icon:r.jsx($n,{color:f(n?"toggleTextDisabled":"primary"),width:16,height:16}),onClick:s=>e(s.currentTarget),largeTooltip:!0})})]})]})},TO=b("div")({display:"flex",alignItems:"center",justifyContent:"center",width:32,transform:"rotate(180deg)",marginLeft:2}),EO=t=>{const{colorPalette:e}=t,{name:n,members:o}=e,i=we(),a=xe(i.breakpoints.down("md")),{colorBrickSize:s}=l.useContext(uo);return r.jsxs(Z1,{children:[r.jsx(Q1,{sx:{minWidth:a?118:86},children:n}),r.jsx(Y1,{children:o==null?void 0:o.map(c=>r.jsx(X1,{width:s,height:s,sx:{background:c.colorHex}},`${n}_${c.colorHex}`))})]})},X1=b(C)({borderRadius:"2px"}),Y1=b(C)({display:"flex",gap:2,alignItems:"center",flex:1}),Q1=b(le)(()=>({color:"inherit",fontSize:14,fontWeight:400,lineHeight:"20px",minWidth:86,textAlign:"left"})),Z1=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingRight:16,flex:1}),kO=()=>{var x,y;const t=we(),e=xe(t.breakpoints.down("md")),n=l.useRef(null),{setColorPickerAnchorEl:o,customColorPalette:i,customColorEditingIndexRef:a,setColorWithCode:s,colorBrickSize:c,setColorPalette:d,customColorPaletteHexCode:u,setCustomColorPaletteHexCode:h}=l.useContext(uo),{generationInput:p}=l.useContext(ye),{hasAccessToCustomColorPalette:g}=l.useContext(ge),m=l.useCallback(_=>{a.current=_,o(n.current)},[a,o]),v=l.useMemo(()=>{var _;return((_=i.members)==null?void 0:_.length)??0},[(x=i.members)==null?void 0:x.length]);return r.jsx(r.Fragment,{children:r.jsxs(MO,{ref:n,children:[r.jsxs(PO,{sx:{minHeight:e?52:40},children:[r.jsxs(Z1,{children:[r.jsx(Q1,{sx:{minWidth:e?118:86},children:"Custom"}),r.jsxs(Y1,{children:[(y=i.members)==null?void 0:y.map((_,w)=>r.jsx(C,{onClick:()=>{g&&(m(w),d(i))},children:r.jsx(X1,{sx:{width:c,height:c,background:_.colorHex}})},`custom_color_${w}`)),v<Bc&&r.jsx(jO,{sx:{width:c,height:c},onClick:()=>{g&&(m(v),d(i))},children:r.jsx(Ko,{width:16,height:16})})]})]}),r.jsx(Lc,{children:g?Ut.isEqual(i,p.color_palette)?r.jsx(or,{width:16,height:16}):null:r.jsx(Wt,{})})]}),r.jsx(AO,{children:r.jsx(Io,{style:{fullWidth:!0,fontSize:14},logic:{autoSelect:!0,value:u??"",onChange:_=>{g&&(s(_),h(_))},onBlur:()=>{var _;return h((_=i.members)==null?void 0:_.map(w=>w.colorHex).join(" "))}}})})]})})},AO=b(C)({marginTop:8,marginBottom:12}),jO=b(C)(()=>({borderRadius:"2px",border:`1px solid ${f("borderHighlight")}`,fill:f("iconPrimary"),display:"flex",alignItems:"center",justifyContent:"center"})),PO=b(C)({display:"flex",alignItems:"center"}),MO=b(C)({width:"100%",display:"flex",flexDirection:"column",alignItems:"stretch"}),ex=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{generationInput:n}=l.useContext(ye),{setColorPalette:o,customColorPalette:i,colorPalettePresets:a}=l.useContext(uo),{hasAccessToCustomColorPalette:s}=l.useContext(ge),{showPayWallModel:c}=$t(),d=l.useMemo(()=>({color:`${f("InteractiveActive")} !important`,fill:`${f("InteractiveActive")} !important`}),[]);return r.jsxs(OO,{children:[r.jsxs(Fl,{disableRipple:!0,sx:{...n.color_palette?{}:d,minHeight:e?52:40,padding:e?"6px 8px 6px 12px":"8px 8px 8px 12px"},onClick:()=>o(void 0),children:["Auto"," ",r.jsx(Lc,{children:!n.color_palette&&r.jsx(or,{width:16,height:16})})]}),a.map((u,h)=>{const p=Ut.isEqual(u,n.color_palette);return r.jsxs(Fl,{disableRipple:!0,onClick:()=>o(u),sx:{...p?d:{},minHeight:e?52:40,padding:e?"6px 8px 6px 12px":"8px 8px 8px 12px"},children:[r.jsx(EO,{colorPalette:u}),r.jsx(Lc,{children:p&&r.jsx(or,{width:16,height:16})})]},`palette_${h}`)}),r.jsx(Fl,{disableRipple:!0,sx:{...Ut.isEqual(i,n.color_palette)?d:{},padding:e?"6px 8px 6px 12px":"8px 8px 8px 12px"},onClick:()=>{var u;s?i.members&&((u=i.members)==null?void 0:u.length)>0&&o(i):c("CUSTOM_COLOR_PAETTE")},children:r.jsx(kO,{})})]})},Lc=b(C)({width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center"}),OO=b(C)({width:"100%",display:"flex",flexDirection:"column",alignItems:"stretch",minWidth:no}),Fl=b(gt)(()=>({display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:10,"&:hover":{fill:f("InteractiveHover"),color:f("InteractiveHover"),backgroundColor:f("menuActionHover")},width:"100%",fill:f("Interactive"),color:f("Interactive"),fontFamily:"Manrope",fontSize:"14px",fontWeight:400,lineHeight:"20px"})),tx=()=>{var u,h;const t=we(),e=xe(t.breakpoints.down("md")),{updateCustomColorByPicker:n,customColorPalette:o,customColorEditingIndexRef:i,deleteCustomColor:a}=l.useContext(uo),s=l.useCallback(()=>{const p="#"+Math.floor(Math.random()*16777215).toString(16).padStart(6,"0").toUpperCase();return n(p),p},[n]),[c,d]=l.useState(((h=(u=o.members)==null?void 0:u[i.current])==null?void 0:h.colorHex)??s);return r.jsxs(DO,{sx:{padding:e?"16px 12px 12px 12px":0},children:[r.jsx(ss,{width:e?"100%":239,children:r.jsx(s1,{color:c,onChange:p=>{d(p),n(p)},style:{width:"100%",height:"100%"}})}),r.jsxs(NO,{children:[r.jsxs(LO,{children:[r.jsx(BO,{sx:{background:c}}),r.jsx(Io,{style:{inputWidth:98},logic:{autoSelect:!0,value:c,onChange:p=>{if(p.length&&p.charAt(0)==="#")d(p),n(p);else{const g=`#${p}`;d(g),n(g)}},onBlur:p=>{const m=/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(p.trim())?p.trim():"#FFFFFF";d(m),n(m)}}})]}),r.jsx(Be,{icon:r.jsx(ps,{color:f("iconPrimary")}),onClick:a})]})]})},BO=b(C)({width:40,height:40,borderRadius:8}),LO=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:4}),NO=b(C)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}),DO=b(C)({width:"100%",display:"flex",flexDirection:"column",alignItems:"stretch",gap:24}),FO=()=>{const{colorPickerAnchorEl:t,setColorPickerAnchorEl:e}=l.useContext(uo);return r.jsx(zO,{anchorEl:t,open:!!t,onClose:()=>e(null),disablePortal:!0,sx:{zIndex:n=>n.zIndex.drawer+160},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:r.jsx(tx,{})})},zO=b(So)(()=>({"& .MuiList-root":{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:0,paddingBottom:0,position:"relative"},"& .MuiPaper-root":{backgroundColor:f("menuBackground"),borderRadius:12,outlineColor:f("border"),outlineStyle:"solid",outlineWidth:1,overflow:"hide",padding:16,marginLeft:-12},minHeight:"101dvh",overscrollBehavior:"contain"})),UO=()=>{const{anchorEl:t,setAnchorEl:e}=l.useContext(uo);return r.jsxs(r.Fragment,{children:[r.jsx(GO,{anchorEl:t,open:!!t,onClose:()=>e(null),disablePortal:!0,sx:{zIndex:n=>n.zIndex.drawer+160},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:r.jsx(ex,{})}),r.jsx(FO,{})]})},GO=b(So)(()=>({"& .MuiList-root":{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:0,paddingBottom:0,position:"relative"},"& .MuiPaper-root":{backgroundColor:f("menuBackground"),marginTop:8,borderRadius:12,outlineColor:f("border"),outlineStyle:"solid",outlineWidth:1,overflow:"hide",padding:4},marginRight:-8,minHeight:"101dvh",overscrollBehavior:"contain"})),HO=()=>{const{setAnchorEl:t,colorPickerAnchorEl:e,setColorPickerAnchorEl:n}=l.useContext(uo),o=l.useMemo(()=>e?"Custom color":"Palette",[e]);return r.jsxs(WO,{children:[e?r.jsx(Be,{icon:r.jsx(Uo,{color:f("iconPrimary")}),onClick:()=>n(null)}):r.jsx($f,{width:40}),r.jsx(qO,{children:o}),r.jsx(Be,{icon:r.jsx(wt,{color:f("iconPrimary")}),onClick:()=>t(null)})]})},qO=b(le)(()=>({color:f("Interactive"),fontSize:14,fontWeight:600,lineHeight:"20px",letterSpacing:"-0.28px"})),WO=b($f)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:4,width:"100%"}),$O=l.forwardRef(function(e,n){return r.jsx(rr,{direction:"up",ref:n,...e})}),VO=()=>{const{anchorEl:t,setAnchorEl:e,colorPickerAnchorEl:n}=l.useContext(uo);return r.jsxs(KO,{fullWidth:!0,TransitionComponent:$O,open:!!t,onClose:()=>e(null),hideBackdrop:!0,sx:{zIndex:o=>o.zIndex.drawer+137},onClick:o=>o.stopPropagation(),children:[r.jsx(HO,{}),n?r.jsx(tx,{}):r.jsx(ex,{})]})},KO=b(Wn)(()=>({backgroundColor:f("transparentSurface"),display:"flex",flexDirection:"column",justifyContent:"flex-end","& .MuiModal-backdrop":{background:f("transparentSurface")},"& .MuiPaper-root":{flexDirection:"column",alignItems:"center",margin:0,backgroundColor:f("menuBackground"),borderRadius:0,borderTopLeftRadius:16,borderTopRightRadius:16,maxHeight:"96dvh",minWidth:"100dvw",overscrollBehavior:"contain",overflow:"scroll","::-webkit-scrollbar":{width:0,background:"transparent",display:"none"},alignSelf:"flex-end",boxShadow:"0px 1px 2px 0px rgba(9, 9, 11, 0.05)",borderTop:`1px solid ${f("border")})`,padding:4},overscrollBehavior:"contain",userSelect:"none"})),JO=()=>{const t=we(),e=xe(t.breakpoints.down("md"));return r.jsxs(CO,{children:[r.jsx(RO,{}),e?r.jsx(VO,{}):r.jsx(UO,{})]})},XO=["9:16","1:1","16:9"],$s={height:1024,width:1024,aspectRatio:"1:1"},io=l.createContext({anchorEl:null,setAnchorEl:()=>{},getAspectRatioNumber:()=>0,selectedAspectRatio:$s,allAspectRatios:[],nonRestrictedResolution:[],inlineAspectRatioOptions:[],preDefinedAspectRatios:[],portraitAspectRatios:[],landscapeAspectRatios:[],squareAspectRatio:$s,setHoverAspectRatio:()=>{},demoAspectRatio:$s,setSelectedAspectRatio:()=>{},openCustomInput:!1,setOpenCustomInput:()=>{},activeCustomAspectRatioPanelTab:"dimensions",setActiveCustomAspectRatioPanelTab:()=>{},customAspectRatioSelected:!1,showAdjustedMessage:!1,setShowAdjustedMessage:()=>{},isAspectRatioAvailable:()=>!1}),YO=t=>{const{children:e,value:n}=t,o=we(),i=xe(o.breakpoints.down("md")),{generationInput:a,setGenerationSetting:s,setGenerationInput:c}=l.useContext(ye),d=l.useRef(null),[u,h]=l.useState(null),[p,g]=l.useState(!1),[m,v]=l.useState("dimensions"),[x,y]=l.useState(!1),{allAspectRatios:_,getAspectRatioNumber:w,aspectRatioDict:I,nonRestrictedResolution:R}=_1({}),S=l.useMemo(()=>(_==null?void 0:_.filter(z=>z.isBasic))??[],[_]),E=l.useMemo(()=>S.filter(z=>z.resolutionObject.height>z.resolutionObject.width).sort((z,F)=>w(z.resolutionObject)-w(F.resolutionObject)),[S,w]),N=l.useMemo(()=>S.filter(z=>z.resolutionObject.width>z.resolutionObject.height).sort((z,F)=>w(F.resolutionObject)-w(z.resolutionObject)),[S,w]),k=l.useMemo(()=>{var z;return((z=S.find(F=>F.resolutionObject.width===F.resolutionObject.height))==null?void 0:z.resolutionObject)??$s},[S]),A=l.useMemo(()=>n??a.selected_aspect_ratio_v2??k,[a.selected_aspect_ratio_v2,k,n]),D=l.useCallback(z=>!!I[z],[I]),O=l.useMemo(()=>{const z=d.current??A;if(z.aspectRatio===k.aspectRatio||!D(z.aspectRatio))return _.filter(Z=>XO.includes(Z.resolutionObject.aspectRatio));const F=z.aspectRatio,T=nc(F);let j=[F,"1:1",T];return z.width>z.height&&(j=[T,"1:1",F]),j.map(Z=>I[Z])},[_,I,D,A,k.aspectRatio]),[L,P]=l.useState(null),G=l.useMemo(()=>i?A:L??A,[L,i,A]),B=l.useCallback((z,F)=>{z.aspectRatio!==k.aspectRatio&&(d.current=z),F?c({...a,selected_aspect_ratio_v2:Ut.cloneDeep(z)}):s({selected_aspect_ratio_v2:Ut.cloneDeep(z)})},[a,c,s,k.aspectRatio]),M=l.useMemo(()=>I[A.aspectRatio]&&!I[A.aspectRatio].isBasic,[I,A.aspectRatio]);return l.useEffect(()=>{u||g(!1)},[u]),r.jsx(io.Provider,{value:{anchorEl:u,setAnchorEl:h,getAspectRatioNumber:w,selectedAspectRatio:A,allAspectRatios:_,nonRestrictedResolution:R,inlineAspectRatioOptions:O,preDefinedAspectRatios:S,portraitAspectRatios:E,landscapeAspectRatios:N,squareAspectRatio:k,setHoverAspectRatio:P,demoAspectRatio:G,setSelectedAspectRatio:B,openCustomInput:p,setOpenCustomInput:g,activeCustomAspectRatioPanelTab:m,setActiveCustomAspectRatioPanelTab:v,customAspectRatioSelected:M,showAdjustedMessage:x,setShowAdjustedMessage:y,isAspectRatioAvailable:D},children:e})},QO=()=>{const{selectedAspectRatio:t,setSelectedAspectRatio:e,nonRestrictedResolution:n,setShowAdjustedMessage:o}=l.useContext(io),i=l.useMemo(()=>n.length,[n.length]),a=l.useMemo(()=>n.findIndex(s=>s.resolutionObject.aspectRatio===t.aspectRatio)+1,[n,t.aspectRatio]);return r.jsx(ms,{style:{singleColor:!0},logic:{value:a,onChange:s=>{e(n[s-1].resolutionObject,!0),o(!1)},onCommit:s=>{e(n[s-1].resolutionObject),o(!1)},step:1,range:{min:1,max:i}}})},nx=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{demoAspectRatio:n,getAspectRatioNumber:o,setOpenCustomInput:i}=l.useContext(io),{subscriptionStatus:a}=l.useContext(ge),{generationInput:s}=l.useContext(ye),c=l.useMemo(()=>o(n),[n,o]),d=l.useMemo(()=>e?123:s.model_version==="V_0_3"?164:275,[s.model_version,e]),u=l.useMemo(()=>!!(a!=null&&a.activeSubscription)&&["V_1_5","V_2_1"].includes(s.model_version),[s.model_version,a==null?void 0:a.activeSubscription]);return r.jsxs(ZO,{sx:e?{justifyContent:"flex-start",width:"100%",alignSelf:"stretch",padding:"24px 32px 16px 32px",borderBottom:`1px solid ${f("border")}`,gap:1}:{justifyContent:"space-between",gap:3,padding:"24px 8px 18px 24px",minHeight:"100%",flex:1},children:[r.jsx(ss,{width:d,children:r.jsxs(e8,{children:[r.jsx(t8,{sx:{width:c>=1?d:(d??0)*c,height:c<=1?d:(d??0)/c}}),r.jsx(n8,{children:n.aspectRatio})]})}),r.jsx(QO,{}),r.jsxs(ox,{children:[r.jsxs(Qi,{children:[r.jsx(Yi,{children:"Width"}),r.jsxs(af,{sx:u?{cursor:"text","&:hover":{borderColor:f("inputBorderHover")}}:{},onClick:()=>{u&&i(!0)},children:[n.width," px"]})]}),r.jsxs(Qi,{children:[r.jsx(Yi,{children:"Height"}),r.jsxs(af,{sx:u?{cursor:"text","&:hover":{borderColor:f("inputBorderHover")}}:{},onClick:()=>{u&&i(!0)},children:[n.height," px"]})]})]})]})},af=b(le)(()=>({fontSize:14,fontWeight:400,lineHeight:"24px",color:f("secondary"),padding:"8px 12px",width:80,borderStyle:"solid",borderWidth:.5,borderColor:"transparent",borderRadius:8})),Yi=b(le)(()=>({fontSize:14,fontWeight:600,lineHeight:"20px",letterSpacing:"-0.28px",color:f("primary")})),Qi=b(C)({display:"flex",alignItems:"center",gap:8}),ox=b(C)({display:"flex",flexDirection:"row",alignItems:"center",gap:16}),ZO=b(C)({display:"flex",flexDirection:"column",alignItems:"center"}),e8=b(C)({minHeight:"100%",minWidth:"100%",position:"relative"}),t8=b(C)(()=>({borderWidth:1,borderStyle:"solid",borderColor:f("inputBorderPressed"),borderRadius:2,position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",zIndex:1})),n8=b(C)(()=>({color:f("primary"),fontSize:16,fontWeight:600,lineHeight:"24px",letterSpacing:"-0.32px",position:"absolute",top:0,bottom:0,left:0,right:0,margin:"auto",textAlign:"center",blockSize:"fit-content",width:"fit-content"}));function o8({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??20,height:e??20,fill:"none",viewBox:"0 0 20 20",children:r.jsx("rect",{width:"15",height:"8",x:"2.5",y:"6",stroke:n??"inherit",rx:"1"})})}function r8({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??20,height:e??20,fill:"none",viewBox:"0 0 20 20",children:r.jsx("rect",{width:"15",height:"8",x:"14",y:"2.5",stroke:n??"inherit",opacity:"0.9",rx:"1",transform:"rotate(90 14 2.5)"})})}const rx=()=>{const t=we(),e=xe(t.breakpoints.down("md"));return r.jsx(i8,{sx:e?{paddingTop:"24px"}:{padding:"0 24px 24px 24px"},children:r.jsxs(s8,{children:[r.jsx(C,{marginY:"2px",children:r.jsx(ai,{color:f("iconPrimary"),width:16,height:16})}),r.jsxs(a8,{children:["Adjusted to the nearest supported size. For higher resolutions, ",!e&&r.jsx("br",{})," ","you can upscale your image after it’s generated."]})]})})},i8=b(C)({width:"100%",alignSelf:"stretch"}),s8=b(C)(()=>({width:"100%",display:"flex",padding:"8px 16px 8px 12px",alignItems:"flex-start",gap:8,alignSelf:"stretch",borderRadius:8,border:`1px solid ${f("border")}`,background:f("infoCardBackground")})),a8=b(le)(()=>({color:f("secondary"),fontSize:14,fontWeight:400,lineHeight:"20px"})),ix=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{portraitAspectRatios:n,landscapeAspectRatios:o,squareAspectRatio:i,setHoverAspectRatio:a,setSelectedAspectRatio:s,selectedAspectRatio:c,setOpenCustomInput:d,customAspectRatioSelected:u,setShowAdjustedMessage:h,showAdjustedMessage:p}=l.useContext(io),{subscriptionStatus:g}=l.useContext(ge),{generationInput:m}=l.useContext(ye),{showPayWallModel:v}=$t(),x=l.useMemo(()=>({color:`${f("InteractiveActive")} !important`,backgroundColor:`${f("toggleButtonPressed")} !important`}),[]),y=l.useMemo(()=>["V_1_5","V_2_1"].includes(m.model_version),[m.model_version]);return r.jsxs(d8,{onMouseLeave:()=>a(null),sx:e?{overflow:"scroll"}:{},children:[r.jsxs(c8,{children:[r.jsxs(df,{children:[r.jsxs(lf,{sx:e?{backgroundColor:f("menuBackground"),position:"sticky",top:0,zIndex:1}:{},children:[r.jsx(r8,{color:f("iconPrimary")}),r.jsx(cf,{children:"Portrait"})]}),n.map(_=>r.jsxs(Ls,{onClick:()=>{_.isRestricted?v("BASIC_ASPECT_RATIO"):(h(!1),s(_.resolutionObject))},onMouseEnter:()=>a(_.resolutionObject),disableRipple:!0,sx:c.aspectRatio===_.resolutionObject.aspectRatio?x:{},children:[_.resolutionObject.aspectRatio," ",_.isRestricted&&r.jsx(Wt,{})]},_.resolutionObject.aspectRatio))]}),r.jsxs(df,{children:[r.jsxs(lf,{sx:e?{backgroundColor:f("menuBackground"),position:"sticky",top:0,zIndex:1}:{},children:[r.jsx(o8,{color:f("iconPrimary")}),r.jsx(cf,{children:"Landscape"})]}),o.map(_=>r.jsxs(Ls,{onClick:()=>{_.isRestricted?v("BASIC_ASPECT_RATIO"):(h(!1),s(_.resolutionObject))},onMouseEnter:()=>a(_.resolutionObject),disableRipple:!0,sx:c.aspectRatio===_.resolutionObject.aspectRatio?x:{},children:[_.resolutionObject.aspectRatio," ",_.isRestricted&&r.jsx(Wt,{})]},_.resolutionObject.aspectRatio))]})]}),r.jsxs(l8,{children:[r.jsxs(Ls,{onClick:()=>{h(!1),s(i)},onMouseEnter:()=>a(i),onMouseLeave:()=>a(null),sx:{justifyContent:"center !important",...c.aspectRatio===i.aspectRatio?x:{}},disableRipple:!0,children:[i.aspectRatio," (Square)"]}),y&&r.jsx(Ls,{sx:{justifyContent:"center !important",...u?x:{}},onClick:()=>{g!=null&&g.activeSubscription?d(!0):v("CUSTOM_ASPECT_RATIO")},disableRipple:!0,children:u?`${c.aspectRatio} (Custom)`:r.jsxs(r.Fragment,{children:["Custom"," ",!(g!=null&&g.activeSubscription)&&r.jsx(Wt,{})]})})]}),e&&p&&r.jsx(rx,{})]})},l8=b(C)(()=>({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",width:"100%"})),Ls=b(gt)(()=>({fontFamily:"Manrope",fontSize:14,fontWeight:400,lineHeight:"20px",color:f("Interactive"),flex:1,backgroundColor:"transparent",borderStyle:"none",borderWidth:0,borderRadius:"8px !important",transition:"0.1s",height:36,minHeight:36,maxHeight:36,textWrap:"nowrap",justifyContent:"flex-start","&:hover":{color:f("InteractiveHover"),backgroundColor:f("toggleButtonHover")},width:"100%",padding:"8px 16px",marginTop:4,gap:4})),lf=b(C)(()=>({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",paddingLeft:16,paddingBottom:8,gap:8,paddingTop:20,width:"100%"})),cf=b(le)(()=>({color:f("tertiary"),fontSize:14,fontWeight:600,lineHeight:"20px",letterSpacing:"-0.28px"})),df=b(C)({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",flex:1,minWidth:86}),c8=b(C)({display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"center",gap:4,width:"100%"}),d8=b(C)({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",padding:16,paddingTop:0,width:"100%"}),sx=()=>{const{setActiveCustomAspectRatioPanelTab:t,activeCustomAspectRatioPanelTab:e}=l.useContext(io);return r.jsxs(u8,{children:[r.jsx(uf,{onClick:()=>t("dimensions"),sx:{color:f(e==="dimensions"?"InteractiveActive":"tertiary")},children:"Dimensions"}),r.jsx(uf,{onClick:()=>t("aspect_ratio"),sx:{color:f(e==="aspect_ratio"?"InteractiveActive":"tertiary")},children:"Aspect ratio"})]})},uf=b(le)(()=>({fontSize:14,fontWeight:600,lineHeight:"48px",letterSpacing:"-0.28px",cursor:"pointer","&:hover":{color:f("InteractiveHover")},height:48})),u8=b(C)(()=>({display:"flex",width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",paddingLeft:24,paddingRight:16,borderBottom:`1px solid ${f("border")}`,gap:24})),h8=t=>/^\d{1,6}:\d{1,6}$/.test(t),p8=t=>{const e=we(),n=xe(e.breakpoints.down("md")),{aspectRatioValue:o,setAspectRatioValue:i}=t,{selectedAspectRatio:a}=l.useContext(io);return r.jsx(f8,{children:r.jsxs(Qi,{children:[r.jsx(Yi,{children:"Aspect ratio"}),r.jsx(Io,{style:{inputWidth:n?void 0:80,fontSize:14,customHeight:40},logic:{value:o,onChange:s=>{i(s)},autoSelect:!0,onBlur:()=>{h8(o)||i(a.aspectRatio)},number:!0,autoFocus:!0}})]})})},f8=b(C)({display:"flex",flexDirection:"row",alignItems:"center",width:"100%"}),g8=t=>{const e=we(),n=xe(e.breakpoints.down("md")),{widthValue:o,setWidthValue:i,heightValue:a,setHeightValue:s}=t,c=l.useRef(!1),d=l.useRef(null),u=l.useRef(null),h=l.useRef(null),p=l.useRef(null);l.useEffect(()=>{const x=()=>{!c.current&&h.current&&(h.current.focus(),h.current.setSelectionRange(0,h.current.value.length-3))},y=()=>{!c.current&&p.current&&p.current.focus()},_=d.current,w=u.current;return _==null||_.addEventListener("mouseover",x),w==null||w.addEventListener("mouseover",y),setTimeout(()=>c.current=!0,100),()=>{_==null||_.removeEventListener("mouseover",x),w==null||w.removeEventListener("mouseover",y)}},[]);const g=l.useCallback(x=>{const y=x.currentTarget;y.setSelectionRange(0,y.value.length-3)},[]),m=l.useCallback(x=>{const y=x.currentTarget,_=y.selectionStart,w=y.selectionEnd,R=y.value.length-3;(_&&_>R||w&&w>R)&&y.setSelectionRange(Math.min(_??R,R),R)},[]),v=l.useCallback(x=>x===" px"||x.length<=3?0:Math.min(9999,parseFloat(x.slice(0,4))),[]);return r.jsxs(ox,{children:[r.jsxs(Qi,{children:[r.jsx(Yi,{children:"Width"}),r.jsx(Io,{style:{inputWidth:n?void 0:80,fontSize:14,customHeight:40},logic:{value:`${o?o.toString():""} px`,onChange:x=>{i(v(x))},onBlur:()=>{o===0&&i(1)},number:!0,parentRef:d,ref:h,onSelect:m,onFocus:g,autoFocus:!0}})]}),r.jsxs(Qi,{children:[r.jsx(Yi,{children:"Height"}),r.jsx(Io,{style:{inputWidth:n?void 0:80,fontSize:14,customHeight:40},logic:{value:`${a?a.toString():""} px`,onChange:x=>{s(v(x))},onBlur:()=>{a===0&&s(1)},number:!0,parentRef:u,ref:p,onSelect:m,onFocus:g}})]})]})},ax=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{generationsApi:n}=l.useContext(ge),{generationInput:o}=l.useContext(ye),{activeCustomAspectRatioPanelTab:i,setOpenCustomInput:a,setSelectedAspectRatio:s,selectedAspectRatio:c,setActiveCustomAspectRatioPanelTab:d,setShowAdjustedMessage:u}=l.useContext(io),[h,p]=l.useState(c.width),[g,m]=l.useState(c.height),[v,x]=l.useState(c.aspectRatio),y=l.useCallback(async I=>{if(!n)return;const{height:R,width:S}=I;if(R<=0||S<=0)return;const E=await n.validateResolution({validateResolutionRequest:{modelVersion:o.model_version,height:R,width:S}}),N=E.validatedResolution;s(N),u(E.modified)},[o.model_version,n,s,u]),_=l.useCallback(async I=>{if(!n)return;const R=await n.validateAspectRatio({validateAspectRatioRequest:{modelVersion:o.model_version,aspectRatio:I}}),S=R.validatedResolution;s(S),u(R.modified)},[o.model_version,n,s,u]),w=l.useCallback(async()=>{i==="dimensions"?await y({width:h,height:g}):await _(v),a(!1)},[i,v,g,_,y,a,h]);return r.jsxs(x8,{onKeyDown:I=>{(I.code==="Enter"||I.code==="NumpadEnter")&&(I.stopPropagation(),w())},sx:e?{flexDirection:"column",gap:"32px"}:{flexDirection:"row"},children:[i==="aspect_ratio"?r.jsx(p8,{aspectRatioValue:v,setAspectRatioValue:x}):r.jsx(g8,{widthValue:h,setWidthValue:p,heightValue:g,setHeightValue:m}),r.jsxs(m8,{width:e?"100%":void 0,children:[r.jsx(It,{label:"Cancel",fullWidth:e,onClick:()=>{a(!1),d("dimensions")}}),r.jsx(ht,{label:"Save",fullWidth:e,onClick:w})]})]})},m8=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",height:40,gap:8}),x8=b(C)(()=>({display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between",padding:"18px 16px 18px 24px"})),v8=()=>{const{openCustomInput:t,setOpenCustomInput:e,setActiveCustomAspectRatioPanelTab:n}=l.useContext(io);return r.jsxs(r.Fragment,{children:[r.jsx(xr,{in:t,mountOnEnter:!0,unmountOnExit:!0,children:r.jsx(w8,{onClick:()=>{e(!1),n("dimensions")}})}),r.jsx(xr,{in:t,mountOnEnter:!0,unmountOnExit:!0,children:r.jsxs(y8,{onKeyDown:o=>{o.key!=="Escape"&&o.stopPropagation()},children:[r.jsx(sx,{}),r.jsx(ax,{})]})})]})},y8=b(C)(()=>({position:"absolute",width:"100%",bottom:0,display:"flex",flexDirection:"column",backgroundColor:f("background"),zIndex:2})),w8=b(C)(()=>({position:"absolute",width:"100%",height:"100%",backgroundColor:f("transparentSurface"),zIndex:1})),b8=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{anchorEl:n,setAnchorEl:o,showAdjustedMessage:i}=l.useContext(io);return r.jsxs(_8,{anchorEl:n,open:!!n,onClose:()=>o(null),disablePortal:!0,sx:{zIndex:a=>a.zIndex.drawer+160},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[r.jsxs(C8,{flexDirection:e?"column":"row",children:[r.jsx(nx,{}),r.jsx(ix,{}),r.jsx(v8,{})]}),i&&r.jsx(rx,{})]})},C8=b(C)({display:"flex",alignItems:"stretch",justifyContent:"center",width:"100%"}),_8=b(So)(()=>({"& .MuiList-root":{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:0,paddingBottom:0,position:"relative"},"& .MuiPaper-root":{backgroundColor:f("menuBackground"),marginTop:8,borderRadius:8,outlineColor:f("border"),outlineStyle:"solid",outlineWidth:1,overflow:"hide"},marginRight:-8,minHeight:"101dvh",overscrollBehavior:"contain"})),I8=({aspectRatioNumber:t,color:e})=>r.jsx(C,{sx:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(C,{sx:{borderRadius:"2px",borderWidth:1.5,borderColor:e??f("primary"),width:t<=1?16*t:16,height:t>=1?16/t:16}})}),S8=()=>{const{selectedAspectRatio:t,inlineAspectRatioOptions:e,getAspectRatioNumber:n,anchorEl:o,setAnchorEl:i,setSelectedAspectRatio:a,setShowAdjustedMessage:s,squareAspectRatio:c}=l.useContext(io);return l.useEffect(()=>{if(!e.map(d=>d.resolutionObject.aspectRatio).includes(t.aspectRatio)){let d=c;if(t.width>t.height){const u=e.find(h=>h.resolutionObject.width>h.resolutionObject.height);u&&(d=u.resolutionObject)}else if(t.width<t.height){const u=e.find(h=>h.resolutionObject.width<h.resolutionObject.height);u&&(d=u.resolutionObject)}a(d)}},[e,t.aspectRatio,t.height,t.width,a,c]),r.jsxs(Zo,{width:no,exclusive:!0,size:"small",color:"primary",value:t.aspectRatio??"1:1",children:[e.map((d,u)=>r.jsxs(on,{value:d.resolutionObject.aspectRatio,sx:{maxWidth:"63px",minWidth:"63px",marginLeft:u==0?"0 !important":"2px !important"},onClick:()=>{s(!1),a(d.resolutionObject)},disableRipple:!0,children:[r.jsx(I8,{aspectRatioNumber:n(d.resolutionObject)}),d.resolutionObject.aspectRatio]},d.resolutionObject.aspectRatio)),r.jsx(R8,{children:r.jsx(Be,{pressed:!!o,customBorderRadius:"6px",size:{width:32,height:36},customPressedButtonColor:f("quietButtonHover"),icon:r.jsx($n,{color:f("primary"),width:16,height:16}),onClick:d=>i(d.currentTarget),largeTooltip:!0})})]})},R8=b("div")({display:"flex",alignItems:"center",justifyContent:"center",width:32,transform:"rotate(180deg)",marginLeft:2}),T8=()=>{const{openCustomInput:t,setAnchorEl:e,setOpenCustomInput:n}=l.useContext(io);return r.jsxs(E8,{children:[t?r.jsx(Be,{icon:r.jsx(Uo,{color:f("iconPrimary")}),onClick:()=>n(!1)}):r.jsx(C,{width:40}),r.jsx(k8,{children:t?"Custom":"Aspect ratio"}),r.jsx(Be,{icon:r.jsx(wt,{color:f("iconPrimary")}),onClick:()=>e(null)})]})},E8=b(C)({width:"100%",padding:4,display:"flex",alignItems:"center",justifyContent:"space-between"}),k8=b(le)(()=>({fontSize:14,fontWeight:600,lineHeight:"20px",letterSpacing:"-0.28px",color:f("Interactive")})),A8=l.forwardRef(function(e,n){return r.jsx(rr,{direction:"up",ref:n,...e})}),j8=()=>{const{anchorEl:t,setAnchorEl:e,openCustomInput:n}=l.useContext(io);return r.jsxs(P8,{fullWidth:!0,TransitionComponent:A8,open:!!t,onClose:()=>e(null),hideBackdrop:!0,sx:{zIndex:o=>o.zIndex.drawer+137},onClick:o=>o.stopPropagation(),children:[r.jsx(T8,{}),n?r.jsxs(r.Fragment,{children:[r.jsx(sx,{}),r.jsx(ax,{})]}):r.jsxs(r.Fragment,{children:[r.jsx(nx,{}),r.jsx(ix,{})]})]})},P8=b(Wn)(()=>({backgroundColor:f("transparentSurface"),display:"flex",flexDirection:"column",justifyContent:"flex-end","& .MuiModal-backdrop":{background:f("transparentSurface")},"& .MuiPaper-root":{flexDirection:"column",alignItems:"center",margin:0,padding:0,backgroundColor:f("menuBackground"),borderRadius:0,borderTopLeftRadius:16,borderTopRightRadius:16,maxHeight:"96dvh",minWidth:"100dvw",overscrollBehavior:"contain",overflow:"scroll","::-webkit-scrollbar":{width:0,background:"transparent",display:"none"},alignSelf:"flex-end",boxShadow:"0px 1px 2px 0px rgba(9, 9, 11, 0.05)",borderTop:`1px solid ${f("border")})`},overscrollBehavior:"contain",userSelect:"none"})),M8=()=>{const t=we(),e=xe(t.breakpoints.down("md"));return r.jsxs(YO,{children:[r.jsx(S8,{}),e?r.jsx(j8,{}):r.jsx(b8,{})]})},O8=()=>{const t=Ee(),{generationInput:e,setGenerationInput:n}=l.useContext(ye),[o,i]=l.useState(e.upscale_details_weight??50),a=l.useCallback(s=>{const c={...e,upscale_details_weight:s};n(c)},[e,n]);return r.jsxs(to,{children:[r.jsx(ro,{label:"Detail"}),r.jsxs(B8,{width:no,children:[r.jsx(ms,{logic:{value:o,onChange:s=>i(s===0?1:s),onCommit:s=>{t({eventKey:"UPSCALE_SLIDE_DETAIL",metaData:{value:s}}),a(s===0?1:s)},step:10,marks:[{value:50}]}}),r.jsx(Io,{style:{inputWidth:52,center:!0},logic:{value:o?o.toString():"",onChange:s=>{let c=parseInt(s||"0");c>100?c=100:c<0&&(c=0),i(c),c<=100&&c>=1&&a(c)},onBlur:s=>{s||(i(1),a(1))},number:!0,autoSelect:!0}})]})]})},B8=b(C)({display:"flex",alignItems:"center",justifyContent:"center",height:38,gap:16}),L8=()=>{const{setGenerationSetting:t,generationInput:e}=l.useContext(ye),n=Ee(),o=l.useMemo(()=>[{optionName:"Auto",optionId:"AUTO",onSelect:()=>{n({eventKey:"GENERATION_SETTING_AUTOPROMPT_AUTO_CLICK"}),t({private:!!e.private,model_version:e.model_version,use_autoprompt:"AUTO",aspectRatio:e.aspectRatio})}},{optionName:"On",optionId:"ON",onSelect:()=>{n({eventKey:"GENERATION_SETTING_AUTOPROMPT_ON_CLICK"}),t({use_autoprompt:"ON"})}},{optionName:"Off",optionId:"OFF",onSelect:()=>{n({eventKey:"GENERATION_SETTING_AUTOPROMPT_OFF_CLICK"}),t({use_autoprompt:"OFF"})}}],[n,t,e.private,e.model_version,e.aspectRatio]);return r.jsxs(to,{children:[r.jsx(ro,{label:"Magic Prompt",tooltip:{content:r.jsxs(tr,{fontSize:14,children:[r.jsx("b",{color:f("primary"),children:"Magic Prompt"})," enhances your initial prompt to improve image variety and richness. It can also translate to English."]}),type:"info"}}),r.jsx(is,{options:o,currentSelection:e.use_autoprompt??"auto"})]})},N8=()=>{const t=Ee(),{hasAccessToModel21:e,isFeatureEnabled:n}=l.useContext(ge),{generationInput:o,setGenerationSetting:i}=l.useContext(ye),a=l.useMemo(()=>{const c=n(Bt.model_2_1)?(bo==null?void 0:bo.variant(Ui.model_2_1_release).value)==="on"?"2a":"2a (beta)":"2a (preview)";return[...e?[{optionId:"2.1",optionName:c,optionSelectedName:c,onSelect:()=>{t({eventKey:"GENERATION_SETTING_V3_CLICK"}),i({model_version:"V_2_1"})}}]:[],{optionId:"2.0",optionName:"2.0 (latest)",optionSelectedName:"2.0",onSelect:()=>{t({eventKey:"GENERATION_SETTING_V3_CLICK"}),i({model_version:"V_1_5"})}},{optionId:"1.0",optionName:"1.0",optionSelectedName:"1.0",onSelect:()=>{t({eventKey:"GENERATION_SETTING_V3_CLICK"}),i({model_version:"V_0_3"})}}]},[n,e,t,i]),s=l.useMemo(()=>o.model_version==="V_0_2"?"0.2":o.model_version==="V_1_5"?"2.0":o.model_version==="V_2_1"?"2.1":"1.0",[o.model_version]);return r.jsxs(to,{children:[r.jsx(ro,{label:"Model"}),r.jsx(Wg,{options:a,currentSelection:s,width:no})]})},D8=()=>{const{hasAccessToAdvancedFeatures:t}=l.useContext(ge),{generationInput:e,setGenerationInput:n}=l.useContext(ye),{showPayWallModel:o}=l.useContext(Et),{negative_prompt:i}=e,a=l.useCallback(u=>{Yn(e.model_version)&&t&&n({...e,negative_prompt:u&&u.length?u:void 0})},[e,n,t]),s=l.useMemo(()=>!Yn(e.model_version)||e.model_version==="V_2_1",[e.model_version]),c=l.useMemo(()=>s?r.jsx(tr,{children:"Only model 2.0 and 1.0 support negative prompt."}):null,[s]),d=l.useMemo(()=>!t&&!s,[s,t]);return r.jsxs(to,{onClick:()=>{d&&o("NEGATIVE_PROMPT")},children:[r.jsx(ro,{label:"Negative prompt",disabled:s,tooltip:{content:c,type:"info"},showGradientLockIcon:d}),r.jsx(Io,{style:{inputWidth:no,placeholder:"Things to avoid",multiline:!0,toggleColor:!0,centerPlaceholder:!0,hideValueOnDisable:!0},logic:{value:i??"",onChange:a,disabled:s}})]})},F8=()=>{var s;const t=Ee(),{generationInput:e,setGenerationInput:n}=l.useContext(ye),[o,i]=l.useState(((s=e.variation_input)==null?void 0:s.image_weight)??100),a=l.useCallback(c=>{const d={...e,variation_input:{...e.variation_input,image_weight:c}};n(d)},[e,n]);return r.jsxs(to,{children:[r.jsx(ro,{label:"Resemblance"}),r.jsxs(z8,{width:no,children:[r.jsx(ms,{logic:{value:o,onChange:c=>i(c===0?1:c),onCommit:c=>{t({eventKey:"UPSCALE_SLIDE_RESEMBLANCE",metaData:{value:c}}),a(c===0?1:c)},step:10,marks:[{value:50}]}}),r.jsx(Io,{style:{inputWidth:52,center:!0},logic:{value:o?o.toString():"",onChange:c=>{let d=parseInt(c||"0");d>100?d=100:d<0&&(d=0),i(d),d<=100&&d>=1&&a(d)},onBlur:c=>{c||(i(1),a(1))},number:!0,autoSelect:!0}})]})]})},z8=b(C)({display:"flex",alignItems:"center",justifyContent:"center",height:38,gap:16}),U8=()=>{const{hasAccessToAdvancedFeatures:t}=l.useContext(ge),{generationInput:e,setGenerationInput:n}=l.useContext(ye),{showPayWallModel:o}=l.useContext(Et),{seed:i}=e,a=l.useMemo(()=>i!==void 0?i.toString():"",[i]),s=l.useCallback(c=>{if(t)if(!c.length)n({...e,seed:void 0});else{let d=parseInt(c);if(Number.isNaN(d))return;d>2147483647?d=2147483647:d<0&&(d=0),n({...e,seed:d})}},[e,n,t]);return r.jsxs(to,{onClick:()=>{t||o("SEED")},children:[r.jsx(ro,{label:"Seed number",showGradientLockIcon:!t}),r.jsx(Io,{style:{inputWidth:no,placeholder:"Auto",center:!0,toggleColor:!0},logic:{value:a,onChange:s,number:!0}})]})};function G8({size:t,color:e,secondaryColor:n}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,fill:"none",viewBox:"0 0 230 230",children:[r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"29.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"86.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"143.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"86.5",stroke:e,rx:"2"})]})}function H8({size:t,color:e,secondaryColor:n}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,fill:"none",viewBox:"0 0 230 230",children:[r.jsx("rect",{width:"57",height:"57",x:"29.5",y:"29.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"29.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"143.5",y:"29.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"29.5",y:"86.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"86.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"143.5",y:"86.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"29.5",y:"143.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"143.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"143.5",y:"143.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"86.5",stroke:e,rx:"2"})]})}function q8({size:t,color:e,secondaryColor:n}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,fill:"none",viewBox:"0 0 230 230",children:[r.jsx("rect",{width:"57",height:"57",x:"1",y:"29.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"58",y:"29.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"115",y:"29.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"29.5",y:"86.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"86.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"143.5",y:"86.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"58",y:"143.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"115",y:"143.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"172",y:"143.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"86.5",stroke:e,rx:"2"})]})}function W8({size:t,color:e}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,fill:"none",viewBox:"0 0 230 230",children:r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"86.5",stroke:e,rx:"2"})})}function $8({size:t,color:e,secondaryColor:n}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,fill:"none",viewBox:"0 0 230 230",children:[r.jsx("rect",{width:"57",height:"57",x:"29.5",y:"86.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"86.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"143.5",y:"86.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"86.5",stroke:e,rx:"2"})]})}function V8({size:t,color:e,secondaryColor:n}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,fill:"none",viewBox:"0 0 230 230",children:[r.jsx("rect",{width:"57",height:"57",x:"29.5",y:"1",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"29.5",y:"58",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"29.5",y:"115",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"29.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"86.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"143.5",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"143.5",y:"58",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"143.5",y:"115",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"143.5",y:"172",stroke:n,strokeDasharray:"2 2",rx:"2"}),r.jsx("rect",{width:"57",height:"57",x:"86.5",y:"86.5",stroke:e,rx:"2"})]})}const K8=b("a")(()=>({color:f("tooltipText"),textDecoration:"underline",textDecorationStyle:"dashed"})),J8=b(le)(()=>({fontSize:16,fontWeight:700,marginBottom:4,color:f("tooltipText")})),X8=()=>{var k;const{subscriptionStatus:t,hasAccessToTiling:e}=l.useContext(ge),{generationInput:n,setGenerationInput:o}=l.useContext(ye),{showPayWallModel:i}=l.useContext(Et),a=Nt(),s=l.useRef(null),[c,d]=l.useState(null),[u,h]=l.useState(null),p=l.useMemo(()=>n.tiling_preset??"OFF",[n.tiling_preset]),g=l.useMemo(()=>u??p,[p,u]),m=l.useCallback(()=>{d(null)},[d]),v=Math.min(((k=s.current)==null?void 0:k.offsetHeight)??320,window.innerWidth-180),x=l.useMemo(()=>new Map([["OFF",r.jsx(W8,{size:v,color:f("secondary")},"OFF")],["GRID",r.jsx(H8,{size:v,color:f("secondary"),secondaryColor:f("borderHighlight")},"GRID")],["VERTICAL_BRICK",r.jsx(V8,{size:v,color:f("secondary"),secondaryColor:f("borderHighlight")},"VERTICAL_BRICK")],["HORIZONTAL_BRICK",r.jsx(q8,{size:v,color:f("secondary"),secondaryColor:f("borderHighlight")},"HORIZONTAL_BRICK")],["COLUMN",r.jsx(G8,{size:v,color:f("secondary"),secondaryColor:f("borderHighlight")},"COLUMN")],["ROW",r.jsx($8,{size:v,color:f("secondary"),secondaryColor:f("borderHighlight")},"ROW")]]),[v]),y=l.useMemo(()=>n.model_version!=="V_0_3",[n.model_version]),_=l.useCallback(A=>{p!==A&&e&&!(!Yn(n.model_version)&&A!=="OFF")&&o({...n,tiling_preset:A==="OFF"?void 0:A})},[o,n,p,e]);l.useEffect(()=>{y&&_("OFF")},[_,y]);const w=l.useMemo(()=>({optionId:"OFF",optionName:"Off",optionSelectedName:"Off",onSelect:()=>{Xe({eventKey:"TILE_SELECT_OFF"}),_("OFF")}}),[_]),[I,R]=l.useState(n.tiling_preset??"GRID"),S=l.useMemo(()=>[w,{optionId:"GRID",optionName:"Grid",optionSelectedName:"Grid",optionIcon:r.jsx(v1,{color:f(y?"toggleTextDisabled":"toggleTextRest")}),onSelect:()=>{Xe({eventKey:"TILE_SELECT_GRID"}),R("GRID"),_("GRID")}},{optionId:"VERTICAL_BRICK",optionName:"Vertical brick",optionSelectedName:"V. brick",optionIcon:r.jsx(b1,{color:f(y?"toggleTextDisabled":"toggleTextRest")}),onSelect:()=>{Xe({eventKey:"TILE_SELECT_VERTICAL_BRICK"}),R("VERTICAL_BRICK"),_("VERTICAL_BRICK")}},{optionId:"HORIZONTAL_BRICK",optionName:"Horizontal brick",optionSelectedName:"H. brick",optionIcon:r.jsx(y1,{color:f(y?"toggleTextDisabled":"toggleTextRest")}),onSelect:()=>{Xe({eventKey:"TILE_SELECT_HORIONTAL_BRICK"}),R("HORIZONTAL_BRICK"),_("HORIZONTAL_BRICK")}},{optionId:"COLUMN",optionName:"Column",optionSelectedName:"Column",optionIcon:r.jsx(x1,{color:f(y?"toggleTextDisabled":"toggleTextRest")}),onSelect:()=>{Xe({eventKey:"TILE_SELECT_COLUMN"}),R("COLUMN"),_("COLUMN")}},{optionId:"ROW",optionName:"Row",optionSelectedName:"Row",optionIcon:r.jsx(w1,{color:f(y?"toggleTextDisabled":"toggleTextRest")}),onSelect:()=>{Xe({eventKey:"TILE_SELECT_ROW"}),R("ROW"),_("ROW")}}],[_,y,w]),E=l.useMemo(()=>[w,S.find(A=>A.optionId===I)],[w,I,S]),N=l.useMemo(()=>y?t!=null&&t.activeSubscription?r.jsx(tr,{children:"Only model 1.0 supports Tile."}):r.jsxs(C,{children:[r.jsx(J8,{children:"Upgrade your plan"}),r.jsxs(tr,{children:["Get"," ",r.jsx(K8,{href:oe.PRICING,target:"_blank",onClick:A=>{A.preventDefault(),a({newTab:!0,conversionReason:lt.TileInputTooltip})},children:"Ideogram Basic or above"})," ","to use rendering settings."]})]}):null,[y,t==null?void 0:t.activeSubscription,a]);return r.jsxs(to,{onClick:()=>{e||i("TILE")},children:[r.jsx(ro,{disabled:y,label:"Tile",tooltip:y&&N?{content:N,type:"info"}:{content:r.jsx(tr,{children:"Create seamless repeating patterns."}),type:"info"},showGradientLockIcon:!e}),r.jsxs(r.Fragment,{children:[r.jsxs(Zo,{width:no,exclusive:!0,size:"small",color:"primary",value:p,disabled:y,children:[E.map((A,D)=>r.jsxs(on,{value:A.optionId,sx:{marginLeft:D===0?"0 !important":"2px !important"},onClick:A.onSelect,disableRipple:!0,children:[A.optionIcon&&r.jsxs(r.Fragment,{children:[A.optionIcon,r.jsx(C,{width:4})]}),A.optionSelectedName]},A.optionId)),r.jsx(Q8,{children:r.jsx(Be,{pressed:!!c,customBorderRadius:"6px",size:{width:32,height:36},customPressedButtonColor:f("quietButtonHover"),disabled:y,icon:r.jsx($n,{color:f(y?"toggleTextDisabled":"primary"),width:16,height:16}),onClick:A=>e&&Yn(n.model_version)&&d(A.currentTarget)})})]}),r.jsxs(Y8,{anchorEl:c,open:!!c,onClose:()=>m(),keepMounted:!0,disablePortal:!0,sx:{zIndex:A=>A.zIndex.drawer+160},slotProps:{paper:{sx:{backgroundColor:f("menuBackground"),padding:1,paddingX:1,marginTop:1,borderRadius:2,outlineColor:f("border"),outlineStyle:"solid",outlineWidth:.5}}},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[r.jsx(ss,{width:v,children:r.jsx(Z8,{children:x.get(g)})}),r.jsx(C,{width:8}),r.jsx(ld,{ref:s,orientation:"vertical",value:p,onMouseLeave:()=>h(null),children:S.map((A,D)=>r.jsx(on,{value:A.optionId,onClick:()=>{A.onSelect(),m()},onMouseEnter:()=>h(A.optionId),disableRipple:!0,sx:{marginTop:D===0?"0 !important":"2px !important",justifyContent:"flex-start"},children:A.optionName},A.optionId))})]})]})]})},Y8=b(So)({"& .MuiList-root":{display:"flex",alignItems:"center",justifyContent:"center",paddingTop:0,paddingBottom:0},marginRight:-8,minHeight:"101dvh",overscrollBehavior:"contain"}),Q8=b("div")({display:"flex",alignItems:"center",justifyContent:"center",width:32,transform:"rotate(180deg)",marginLeft:2}),Z8=b(C)({width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),eB=()=>{var s,c;const{setGenerationSetting:t,generationInput:e}=l.useContext(ye),{subscriptionStatus:n}=l.useContext(ge),{showPayWallModel:o}=l.useContext(Et),i=Ee(),a=l.useMemo(()=>[{optionName:"Public",optionId:"public",onSelect:()=>{i({eventKey:"GENERATION_SETTING_PUBLIC_CLICK"}),t({private:!1})}},{optionName:"Private",optionId:"private",onSelect:()=>{var d;i({eventKey:"GENERATION_SETTING_PRIVATE_CLICK"}),(d=n==null?void 0:n.subscriptionQuota)!=null&&d.privateGeneration&&t({private:!0})}}],[i,t,(s=n==null?void 0:n.subscriptionQuota)==null?void 0:s.privateGeneration]);return r.jsxs(to,{onClick:()=>{var d;(d=n==null?void 0:n.subscriptionQuota)!=null&&d.privateGeneration||o("VISIBILITY")},children:[r.jsx(ro,{label:"Visibility",showGradientLockIcon:!((c=n==null?void 0:n.subscriptionQuota)!=null&&c.privateGeneration)}),r.jsx(is,{width:no,options:a,currentSelection:e.private?"private":"public"})]})},lx=()=>{const{setGenerationSetting:t,generationInput:e,hasImagePrompt:n}=l.useContext(ye),{showAdvancedFeatures:o,generationInputMode:i,isRetryInpaint:a}=l.useContext(ye),s=l.useCallback(d=>{t({aspectRatio:d})},[t]),c=l.useMemo(()=>e.model_version==="V_2_1"||e.model_version==="V_1_5"||e.model_version==="V_0_3",[e.model_version]);return r.jsxs(tB,{children:[i!=="upscale"&&r.jsxs(r.Fragment,{children:[r.jsx(L8,{}),r.jsx(C,{height:12})]}),i==="generate"&&!n&&!a&&r.jsxs(to,{paddingBottom:"12px",children:[r.jsx(ro,{label:"Aspect ratio"}),c?r.jsx(M8,{}):r.jsx(Ng,{onChange:s})]}),r.jsx(eB,{}),i!=="upscale"&&!a&&r.jsxs(r.Fragment,{children:[r.jsx(C,{height:12}),r.jsx(N8,{})]}),i!=="upscale"&&e.model_version==="V_1_5"&&!a&&r.jsxs(r.Fragment,{children:[r.jsx(C,{height:12}),r.jsx(JO,{})]}),i!=="upscale"&&e.model_version==="V_0_3"&&!a&&r.jsxs(r.Fragment,{children:[r.jsx(C,{height:12}),r.jsx(X8,{})]}),i==="upscale"&&r.jsxs(r.Fragment,{children:[r.jsx(C,{height:12}),r.jsx(F8,{}),r.jsx(C,{height:12}),r.jsx(O8,{})]}),o&&!a&&r.jsxs(r.Fragment,{children:[i!=="upscale"&&r.jsxs(r.Fragment,{children:[r.jsx(C,{height:12}),r.jsx(y7,{})]}),r.jsx(C,{height:12}),r.jsx(U8,{}),i!=="upscale"&&r.jsxs(r.Fragment,{children:[r.jsx(C,{height:12}),r.jsx(D8,{})]})]})]})},tB=b(C)({display:"flex",flexDirection:"column",alignItems:"flex-start"}),cx=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{handleGenerate:n}=l.useContext(Et),{generationThrottle:o,generationThrottleCountDown:i,isSubmitDisabled:a,isRetryInpaint:s}=l.useContext(ye),c=l.useMemo(()=>o&&i>0?od(i):s?"Magic Fill":"Generate",[s,o,i]);return r.jsx(ht,{label:c,onClick:d=>{d.stopPropagation(),n()},disabled:a,minWidth:e?120:168})},dx=()=>{var x,y,_,w;const t=we(),e=xe(t.breakpoints.down("md")),n=Ee(),{handleGenerate:o}=l.useContext(Et),{generationThrottle:i,generationThrottleCountDown:a,isSubmitDisabled:s,generationInputMode:c,setGenerationInputMode:d,generationInput:u}=l.useContext(ye),{hasAccessToSuperRes:h}=l.useContext(ge),p=l.useMemo(()=>i&&a>0?od(a):c==="upscale"?"Upscale":"Remix",[i,a,c]),{showPayWallModel:g}=$t(),m=l.useCallback(I=>{var E,N,k,A;I.stopPropagation();const R=((E=u.variation_input)==null?void 0:E.response_id)??"",S=(k=(N=u.imageParent)==null?void 0:N.responses)==null?void 0:k.find(D=>D.response_id===R);n({eventKey:c==="upscale"?"GENERATE_UPSCALE_CLICK":"GENERATE_REMIX_CLICK",metaData:{modelVariant:(S==null?void 0:S.model_variant)??"",experiment:((A=u.imageParent)==null?void 0:A.experiment)??""}}),c==="upscale"&&!h?g("SUPER_RES"):o()},[(x=u.variation_input)==null?void 0:x.response_id,(y=u.imageParent)==null?void 0:y.responses,(_=u.imageParent)==null?void 0:_.experiment,n,c,h,g,o]),v=l.useMemo(()=>{var I;return((I=u.imageParent)==null?void 0:I.can_upscale)===!1},[(w=u.imageParent)==null?void 0:w.can_upscale]);return r.jsx(ht,{label:p,onClick:m,disabled:s,minWidth:e?120:168,dropdownClickEvent:"IMAGE_PROMPT_GENERATE_BUTTON_DROPDOWN_CLICK",dropdownOptions:[{menuButton:r.jsxs(pf,{disableRipple:!0,onClick:()=>{n({eventKey:"IMAGE_PROMPT_GENERATE_REMIX_SELECT"}),d("remix")},children:[r.jsx(hf,{children:c==="remix"&&r.jsx(or,{color:f("primary")})}),r.jsxs(ff,{children:[r.jsx(gf,{children:"Remix"}),r.jsx(mf,{children:"Create an image that draws reference from a starting image."})]})]})},{menuButton:r.jsxs(pf,{disableRipple:!0,disabled:v,onClick:()=>{n({eventKey:"IMAGE_PROMPT_GENERATE_UPSCALE_SELECT"}),h?d("upscale"):g("SUPER_RES")},children:[r.jsx(hf,{children:c==="upscale"&&r.jsx(or,{color:f("primary")})}),r.jsxs(ff,{children:[r.jsxs(gf,{children:[r.jsx("span",{style:{color:v?f("quietButtonTextDisabled"):void 0},children:"Upscale"}),!h&&!v&&r.jsxs(r.Fragment,{children:[r.jsx(C,{width:4}),r.jsx(Wt,{})]})]}),r.jsx(mf,{children:r.jsx("span",{style:{color:v?f("quietButtonTextDisabled"):void 0},children:v?gs:"Create a higher resolution version of a starting image."})})]})]})}]})},hf=b(C)({width:24}),pf=b(gt)(()=>({display:"flex",alignItems:"center",justifyContent:"flex-start",borderRadius:8,"&:hover":{backgroundColor:f("menuActionHover")},width:"100%",minWidth:140,padding:"12px","&.Mui-disabled":{cursor:"not-allowed",pointerEvents:"auto",backgroundColor:"transparent"}})),ff=b(C)({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",marginLeft:16}),gf=b(le)(()=>({fontSize:16,fontWeight:600,color:f("primary"),display:"flex",alignItems:"center"})),mf=b(le)(()=>({fontSize:14,fontWeight:400,color:f("secondary"),whiteSpace:"normal",textAlign:"left",maxWidth:296})),nB=()=>{const{creditCost:t}=l.useContext(ye);return t?r.jsxs(oB,{children:[r.jsxs(rB,{children:["Uses ",t," credit",t>1?"s":""]}),r.jsx(Rt,{content:r.jsxs(r.Fragment,{children:["Generations use a different number of credits based on your Model and Rendering settings."," ",r.jsx(iB,{href:On.credit_system,target:"_blank",children:"Learn more"})]}),children:r.jsx("div",{children:r.jsx(ai,{color:f("primary")})})})]}):null},oB=b(C)({display:"flex",alignItems:"center",gap:2}),rB=b(le)(()=>({color:f("iconPrimary"),textAlign:"center",fontSize:12,fontWeight:600,lineHeight:"20px",letterSpacing:"-0.24px"})),iB=b("a")({fontSize:14,fontWeight:600,lineHeight:"20px",letterSpacing:"-0.28px",textDecorationLine:"underline"}),sB=()=>{const{hasImagePrompt:t}=l.useContext(ye);return r.jsxs(aB,{children:[r.jsx(nB,{}),t?r.jsx(dx,{}):r.jsx(cx,{})]})},aB=b(C)(()=>({display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%",gap:12,position:"sticky",bottom:"0",backgroundColor:f("menuBackground"),padding:"12px 12px 16px 12px",marginBottom:-16,marginRight:-12}));function lB({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M12 2.001a7.25 7.25 0 017.25 7.25c0 2.096-.9 4.02-2.663 5.742a.751.751 0 00-.175.265l-.032.103-1.13 4.895a2.25 2.25 0 01-2.02 1.737l-.173.007h-2.114a2.25 2.25 0 01-2.147-1.577l-.045-.167-1.13-4.895a.75.75 0 00-.206-.368c-1.68-1.64-2.577-3.463-2.659-5.443L4.75 9.25l.004-.239A7.25 7.25 0 0112 2.002zM14.115 18.5H9.884l.329 1.42a.75.75 0 00.627.574l.103.007h2.114a.75.75 0 00.7-.482l.03-.1.328-1.419zM12 3.501a5.75 5.75 0 00-5.746 5.53l-.004.22.007.277c.076 1.564.8 3.02 2.206 4.392.264.258.46.576.571.926l.049.178.455 1.975h4.923l.458-1.976a2.25 2.25 0 01.493-.969l.127-.134c1.404-1.372 2.128-2.828 2.204-4.392l.007-.277-.004-.22A5.75 5.75 0 0012 3.5z"})})}const ux=()=>{const t=Ee(),e=Nt(),n=we(),o=xe(n.breakpoints.down("md")),{subscriptionStatus:i}=l.useContext(ge),{generationThrottle:a,generationThrottleCountDown:s,generationBlocked:c,serverErrorReason:d,priorityCredit:u}=l.useContext(ye),{wrapSetting:h}=l.useContext(Et),p=l.useMemo(()=>(u==null?void 0:u.total)??0,[u==null?void 0:u.total]),[g,m]=l.useState(!1),v=l.useMemo(()=>a&&s>0&&(i!=null&&i.noActiveSubscription)?r.jsxs(r.Fragment,{children:[r.jsxs(zl,{children:["Skip the wait with"," ",r.jsx(xf,{children:"Ideogram Basic or above"}),"."]}),h&&r.jsx(C,{height:8}),r.jsx(ht,{label:"Compare plans",onClick:()=>{t({eventKey:"OPEN_SUBSCRIPTION_FROM_INTERVAL_INFO_TEXT"}),e({newTab:!0,conversionReason:lt.GenerationInputWaitTimeBox})},size:"small"})]}):a&&s>0&&p<=0?r.jsxs(r.Fragment,{children:[r.jsx(zl,{children:"Skip the wait with a priority queue top-up."}),h&&r.jsx(C,{height:8}),r.jsx(ht,{label:"Top up now",onClick:()=>{t({eventKey:"OPEN_TOPUP_FROM_INTERVAL_INFO_TEXT"}),m(!0)},size:"small"})]}):c&&(i!=null&&i.noActiveSubscription)&&(d===qn.LimitReached||d===qn.InsufficientFunds)?r.jsxs(r.Fragment,{children:[r.jsxs(zl,{children:["Generate more with"," ",r.jsx(xf,{children:"Ideogram Basic or above"}),"."]}),h&&r.jsx(C,{height:8}),r.jsx(ht,{label:"Compare plans",onClick:()=>{t({eventKey:"OPEN_SUBSCRIPTION_FROM_LIMIT_INFO_TEXT"}),e({newTab:!0,conversionReason:lt.GenerationInputDailyLimitBox})},size:"small"})]}):null,[a,s,i==null?void 0:i.noActiveSubscription,p,c,d,h,t,e]);return v?r.jsxs(r.Fragment,{children:[r.jsxs(dB,{marginLeft:h?"4px":0,maxWidth:o?"100%":h?232:372,marginBottom:o?0:1,marginTop:o?2:0,children:[!h&&r.jsx(lB,{color:f("quietButtonText")}),r.jsx(cB,{flexDirection:h?"column":"row",alignItems:h?"flex-end":"center",children:v})]}),r.jsx(yr,{open:g,onClose:()=>m(!1),disablePortal:!0,topUpReason:vr.GenerationBoxPromptLimitTopUp})]}):r.jsx(yr,{open:g,onClose:()=>m(!1),disablePortal:!0,topUpReason:vr.PromptLimitTopUp})},cB=b(C)({display:"flex"}),zl=b(le)(()=>({color:f("infoCardText"),fontSize:15,flex:1,paddingRight:8,paddingLeft:8})),xf=b("span")(()=>({color:f("infoCardLink"),fontSize:15,fontWeight:500})),dB=b(C)(()=>({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",outlineStyle:"solid",outlineWidth:.5,outlineColor:f("infoCardBorder"),backgroundColor:f("infoCardBackground"),borderRadius:8,padding:"12px 16px 12px 12px"})),hx=()=>{const{uploadError:t}=l.useContext(ye),e=l.useRef(),[n,o]=l.useState(64),i=l.useCallback(()=>{e.current&&o(e.current.clientHeight)},[o]);return l.useEffect(()=>(i(),window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}),[i]),t?r.jsxs(C,{position:"relative",width:"100%",children:[r.jsx(C,{height:n}),r.jsx(uB,{ref:e,children:t==="UNEXPECTED"?"Sorry, something went wrong. Please check your file and try again.":t==="FILE_SIZE"?`The selected image is too large. Please choose a file size less than ${Gi} MB.`:"The selected file is not a supported type. Please pick an image in .jpg, .png, or .webp."})]}):null},uB=b(C)(()=>({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",outlineStyle:"solid",outlineWidth:.5,outlineColor:f("infoCardBorder"),backgroundColor:f("infoCardBackground"),borderRadius:8,padding:"8px 8px 8px 12px",color:f("primary"),fontSize:16,width:"100%",wordBreak:"break-word",position:"absolute",bottom:0})),hB=()=>{const{showAdvancedFeatures:t,setShowAdvancedFeatures:e,isRetryInpaint:n}=l.useContext(ye),o=Ee();return n?null:r.jsx(Be,{onClick:()=>{o({eventKey:"EXPEND_GENERATION_SETTING_CLICK"}),e(!t)},icon:r.jsx(C,{sx:{transform:t?void 0:"rotate(180deg)"},children:r.jsx($n,{color:f(t?"outlinedButtonTextPressed":"outlinedButtonText")})})})},pB=()=>{const t=we(),e=xe(t.breakpoints.down("md"));return r.jsxs(r.Fragment,{children:[r.jsxs(fB,{children:[r.jsx(C,{height:12}),!e&&r.jsx(hx,{}),r.jsx(C,{height:12}),r.jsx(lx,{})," ",r.jsx(C,{height:12}),r.jsx(hB,{})]}),r.jsx(C,{height:24}),r.jsx(ux,{}),r.jsx(sB,{})]})},fB=b(C)({display:"flex",flexDirection:"column",alignItems:"center",width:"100%",flex:1,paddingLeft:8}),gB=728,mB=()=>{const t=l.useRef(null),{imageUploadLocalSrc:e}=l.useContext(ye),{renderInputOnly:n,wrapSetting:o,setWrapSetting:i,inputRef:a}=l.useContext(Et),s=l.useCallback(()=>{t.current&&(t.current.clientWidth<gB&&!n?i(!0):i(!1))},[i,n]);return l.useEffect(()=>(s(),window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}),[s]),r.jsxs(vB,{ref:t,children:[r.jsxs(yB,{sx:n?void 0:{borderRightStyle:"solid",borderRightWidth:.5,borderRightColor:f("border")},children:[r.jsx(bB,{minHeight:n?0:274,onClick:()=>{var c;return(c=a==null?void 0:a.current)==null?void 0:c.focus()},padding:"12px 12px 16px 16px",children:r.jsx(W1,{})}),!n&&r.jsx(CB,{children:r.jsx($1,{})})]}),!n&&r.jsxs(wB,{sx:{flex:o?0:"none",minWidth:o?272:396},children:[r.jsxs(xB,{children:[e?r.jsx(V1,{}):r.jsx(J1,{}),r.jsx(m1,{})]}),e?r.jsx(K1,{}):r.jsx(pB,{})]})]})},xB=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"}),vB=b(C)({width:"100%",display:"flex",flexDirection:"row"}),yB=b(C)({display:"flex",flexDirection:"column",flex:1,minHeight:"100%"}),wB=b(C)({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-between",padding:"12px 12px 16px 12px",minHeight:"100%"}),bB=b(C)({flex:1,display:"flex",flexDirection:"column",cursor:"text"}),CB=b(C)({display:"flex",flexDirection:"column",justifyContent:"flex-start",padding:16,position:"sticky",bottom:0}),_B=()=>{const{creditCost:t}=l.useContext(ye);return t?r.jsx(Rt,{content:`Uses ${t} credit${t>1?"s":""}`,children:r.jsxs(IB,{children:[r.jsx(za,{color:f("iconPrimary"),width:20,height:20}),r.jsx(SB,{children:t})]})}):null},IB=b(C)({display:"flex",alignItems:"center"}),SB=b(le)(()=>({color:f("secondary"),fontSize:14,fontWeight:700,lineHeight:"20px",letterSpacing:"-0.42px"})),RB=()=>{const t=we(),e=xe(t.breakpoints.down(360)),{showAdvancedFeatures:n,setShowAdvancedFeatures:o,hasPrevPrompt:i,hasNextPrompt:a,uploadError:s,imageUploadLocalSrc:c,hasImagePrompt:d}=l.useContext(ye),{setPreviousPrompt:u,setNextPrompt:h,handleClearClick:p}=l.useContext(Et),g=l.useRef(null),m=l.useMemo(()=>i||a,[i,a]),v=l.useMemo(()=>m&&e,[m,e]);return r.jsxs(TB,{children:[r.jsx(MB,{children:c?r.jsx(vf,{justifyContent:"flex-start",children:r.jsx(V1,{})}):r.jsx(r.Fragment,{children:r.jsxs(vf,{justifyContent:"space-between",children:[r.jsxs(yf,{children:[r.jsx(m1,{}),r.jsx(C,{width:8}),r.jsx(J1,{}),!v&&r.jsxs(r.Fragment,{children:[r.jsx(C,{width:8}),r.jsx(q1,{})]}),m&&r.jsxs(r.Fragment,{children:[r.jsx(C,{width:8}),r.jsx(di,{horizontal:!0,forcePopup:!0,options:[[{icon:r.jsx(Gd,{color:f(i?"menuAction":"menuActionDisabled")}),text:"Previous prompt",onClick:u,disabled:!i},{icon:r.jsx(Ud,{color:f(a?"menuAction":"menuActionDisabled")}),text:"Next prompt",onClick:h,disabled:!a},...v?[{icon:r.jsx(H1,{color:f("menuAction")}),text:"Clear text",onClick:p}]:[]]]})]})]}),r.jsxs(yf,{gap:"12px",children:[r.jsx(_B,{}),d?r.jsx(dx,{}):r.jsx(cx,{})]})]})})}),c?r.jsx(OB,{children:r.jsx(K1,{})}):r.jsxs(r.Fragment,{children:[r.jsxs(EB,{children:[s&&r.jsxs(r.Fragment,{children:[r.jsx(hx,{}),r.jsx(C,{height:12})]}),r.jsx(W1,{}),r.jsx(ux,{})]}),r.jsx(kB,{children:r.jsx($1,{})}),r.jsxs(AB,{children:[r.jsx(lx,{}),r.jsx(jB,{children:r.jsx(PB,{ref:g,onClick:()=>{var x;o(!n),(x=g.current)==null||x.scrollIntoView(),setTimeout(()=>{var y;return(y=g.current)==null?void 0:y.scrollIntoView({behavior:"smooth"})},100)},disableRipple:!0,sx:{transform:n?void 0:"rotate(180deg)"},children:r.jsx($n,{color:f("quietButtonText")})})})]})]})]})},TB=b(C)({width:"100%",display:"flex",flexDirection:"column"}),EB=b(C)({padding:"12px 16px",minHeight:306,display:"flex",flexDirection:"column"}),kB=b(C)({padding:16}),AB=b(C)({padding:16}),jB=b(C)({paddingTop:8,display:"flex",alignItems:"center",justifyContent:"center"}),PB=b(Yo)(()=>({width:40,height:40,borderRadius:8,backgroundColor:f("quietButton"),"&:hover":{backgroundColor:f("quietButtonHover")}})),MB=b(C)(()=>({width:"100%",position:"sticky",top:0,backgroundColor:f("solid"),zIndex:2,borderBottomStyle:"solid",borderBottomWidth:1,borderBottomColor:f("border")})),vf=b(C)(()=>({padding:8,display:"flex",alignItems:"center",width:"100%",backgroundColor:f("solid"),zIndex:2})),yf=b(C)({display:"flex",alignItems:"center"}),OB=b(C)({paddingLeft:16,paddingRight:16}),px=t=>{const e=we(),n=xe(e.breakpoints.down("md"));return r.jsx(u7,{...t,children:n?r.jsx(RB,{}):r.jsx(mB,{})})},BB=t=>{const{setGenBoxFocus:e,stickingTop:n}=t,o=Ee(),i=Nt(),{isSubmitDisabled:a,generationThrottle:s,generationThrottleCountDown:c,handleSubmitGeneration:d,generationInput:u,generationInputMode:h,isRetryInpaint:p,setShowGenerationPreview:g}=l.useContext(ye),{subscriptionStatus:m}=l.useContext(ge),v=l.useCallback(()=>{o({eventKey:"V2_GENERATION"}),g(!0),d({prompt:u.prompt,callback:()=>{e(!1)}})},[o,g,d,u.prompt,e]),x=l.useMemo(()=>s&&c>0?od(c):h==="upscale"?"Upscale":h==="remix"?"Remix":p?"Magic Fill":"Generate",[s,c,h,p]),y=l.useMemo(()=>({borderRadius:"12px",borderTopLeftRadius:0,borderBottomLeftRadius:0,paddingLeft:1,paddingRight:2,fontWeight:400,minWidth:148,fontSize:16,height:48}),[]);return r.jsxs(FB,{disableRipple:!0,onClick:_=>{e(!0),a||(_.stopPropagation(),v())},sx:{...a||s&&c>0?{color:f("secondary"),backgroundColor:f("primaryButtonDisable"),"&:hover":{color:f("secondary"),backgroundColor:f("primaryButtonDisable")}}:{backgroundColor:f("primaryButton"),color:f("primaryButtonText"),"&:hover":{color:f("primaryButtonTextHover"),backgroundColor:f("primaryButtonHover")}},...y},children:[x,r.jsx(xr,{in:n&&s&&c>0&&(m==null?void 0:m.noActiveSubscription),children:r.jsx(LB,{onClick:_=>{_.preventDefault(),_.stopPropagation(),o({eventKey:"FLOATING_SKIP_WAIT_UPGRADE_CLICK"}),i({newTab:!0,conversionReason:lt.WaitTimeButtonFloatingText})},children:r.jsxs(NB,{children:[r.jsx(DB,{href:oe.PRICING,onClick:_=>{_.preventDefault()},children:"Upgrade"})," ","to skip the wait."]})})})]})},LB=b(C)({position:"absolute",bottom:-24}),NB=b(le)({fontSize:12,lineHeight:"20px",whiteSpace:"nowrap"}),DB=b("a")(()=>({fontWeight:600,textDecoration:"underline",textDecorationStyle:"dotted",textUnderlineOffset:2,letterSpacing:"-0.24px",pointerEvents:"auto",cursor:"pointer",color:f("primary")})),FB=b(gt)({position:"relative",alignSelf:"center"}),Nc=48,zB=t=>{const{hide:e,inHeader:n}=t,{generationInput:o,setGenerationInputOpen:i,loadingDescription:a,promptErrorData:s,setSelectedInputBox:c}=l.useContext(ye),{subscriptionStatus:d,isBasicSubscriber:u}=l.useContext(ge),h=l.useRef(null),[p,g]=l.useState(!1),[m,v]=l.useState(!1),x=l.useRef(0),[y,_]=l.useState(!0);l.useEffect(()=>{const S=()=>{if(_(window.scrollY===0),"ontouchstart"in window||navigator.maxTouchPoints>0)return;const E=window.scrollY;Math.abs(E-x.current)>0&&g(!1),x.current=E};return window.addEventListener("scroll",S),()=>{window.removeEventListener("scroll",S)}},[]),l.useEffect(()=>i(p),[p,i]);const w=l.useRef(!0);l.useEffect(()=>{if(e){w.current=!0;return}if(w.current){w.current=!1;return}c("generate"),g(!0)},[o.timestamp,a,e,c]),l.useEffect(()=>{e&&g(!1)},[e,g]);const[I,R]=l.useState(o.prompt??"");return l.useEffect(()=>{R(o.prompt??"")},[R,o.prompt]),l.useEffect(()=>{s&&s.prompt===I&&g(!0)},[I,s]),r.jsxs(UB,{sx:{zIndex:S=>S.zIndex.drawer+135,display:e?"none":void 0,transition:"height 0.2s ease, width 0.2s ease"},onDragOver:S=>{S.preventDefault(),S.dataTransfer.types.includes("Files")&&v(!0)},onDragLeave:()=>v(!1),onDrop:S=>{S.preventDefault(),v(!1)},children:[r.jsx(Qd,{teasingDrop:m,setTeasingDrop:v}),r.jsx(ri,{onClick:()=>g(!1),open:p,sx:{backgroundColor:"transparent",zIndex:S=>S.zIndex.drawer+134}}),r.jsxs(HB,{onWheel:S=>S.stopPropagation(),onMouseDown:S=>{S.stopPropagation()},elevation:0,ref:h,sx:{maxHeight:n?"95dvh":"72dvh",zIndex:S=>S.zIndex.drawer+135,overflow:p?"auto":"visible",...p?{}:{height:Nc,cursor:"pointer"},...n&&(d!=null&&d.noActiveSubscription||u)?{position:"absolute",top:0}:{position:"relative"}},children:[r.jsx(GB,{onClick:()=>g(!0),children:r.jsx(px,{handleOpen:()=>g(!0),handleClose:()=>g(!1),renderInputOnly:!p||e,prompt:I,setPrompt:R,autoFocus:!n})}),!p&&r.jsx(BB,{setGenBoxFocus:g,stickingTop:!!y})]})]})},UB=b(C)({maxHeight:Nc,minHeight:Nc,maxWidth:"100%",flex:1,overflow:"visible",position:"relative",transition:"width 0.2s ease"}),GB=b(C)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"}),HB=b(Ir)(()=>({display:"flex",flexDirection:"row",justifyContent:"center",backgroundColor:f("promptBoxColor"),borderWidth:0,overflow:"auto",outlineColor:f("borderHighlight"),outlineStyle:"solid",outlineWidth:.5,overscrollBehavior:"contain",width:"100%",borderRadius:"12px",alignItems:"flex-start"})),qB=t=>{const{buttonLabel:e="Upgrade",customTheme:n}=t,o=_a(),{subscriptionStatus:i,isBasicSubscriber:a}=l.useContext(ge),{slowCredit:s}=l.useContext(ye),{showPayWallModel:c}=$t(),d=Nt(),u=l.useMemo(()=>(i==null?void 0:i.noActiveSubscription)&&s,[s,i==null?void 0:i.noActiveSubscription]),h=l.useMemo(()=>(i==null?void 0:i.noActiveSubscription)||a,[a,i==null?void 0:i.noActiveSubscription]),p=l.useCallback(()=>{Xe({eventKey:"DESKTOP_HEADER_UPGRADE_CLICK"}),(i==null?void 0:i.noActiveSubscription)?d({conversionReason:lt.DesktopHeaderUpgrade}):c("HEADER")},[c,d,i==null?void 0:i.noActiveSubscription]),g=l.useMemo(()=>n==="light"?{color:"#E51B46",background:"#FFEFEE",border:"#FFD0CE"}:{color:f("IdeogramPinkText"),background:f("IdeogramPinkSurface"),border:f("IdeogramPinkBorder")},[n,o]);return h?u?r.jsxs(wf,{onClick:p,disableRipple:!0,sx:{gap:"6px",border:`1px solid ${g.border}`,background:g.background,"&:hover":{background:g.border}},children:[r.jsxs($B,{children:[r.jsx(Vi,{color:g.color,height:16,width:16}),r.jsx(Ul,{color:g.color,children:s.total})]}),r.jsx(WB,{sx:{borderLeft:`1px solid ${g.color}`}}),r.jsx(Ul,{color:g.color,children:e})]}):r.jsxs(wf,{onClick:p,disableRipple:!0,sx:{gap:"4px",border:`1px solid ${g.border}`,background:g.background,"&:hover":{background:g.border}},children:[r.jsx(Vi,{color:g.color}),r.jsx(Ul,{color:g.color,children:e})]}):null},WB=b("div")(()=>({width:0,height:16})),Ul=b(le)(()=>({fontSize:12,fontWeight:600,lineHeight:"20px",letterSpacing:"-0.48px"})),wf=b(gt)(()=>({display:"flex",height:48,padding:"6px 12px 6px 8px",justifyContent:"center",alignItems:"center",borderRadius:12})),$B=b(C)({display:"flex",alignItems:"center",justifyContent:"center"}),VB=t=>{const{renderFullHeader:e,autoScrolled:n}=t,{bannerHeight:o}=l.useContext(zo),{subscriptionStatus:i,isBasicSubscriber:a}=l.useContext(ge),s=Rn(),[c,d]=l.useState(window.innerWidth>1500);l.useEffect(()=>{const p=()=>{d(window.innerWidth>1500)};return window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[]);const u=l.useMemo(()=>Bn(s.pathname),[s.pathname]),h=l.useMemo(()=>(i==null?void 0:i.noActiveSubscription)||a,[a,i==null?void 0:i.noActiveSubscription]);return r.jsxs(KB,{sx:{top:o,zIndex:p=>p.zIndex.drawer+132,justifyContent:h?"space-between":"center"},onMouseDown:p=>p.stopPropagation(),children:[h&&c&&r.jsx(C,{width:96}),r.jsx(xr,{in:e,timeout:u&&n?300:0,children:r.jsx(C,{flex:1,maxWidth:1152,children:r.jsx(zB,{hide:!e,inHeader:!0})})}),r.jsx(qB,{})]})},KB=b(C)(()=>({paddingY:1,userSelect:"none",display:"flex",flexDirection:"row",alignItems:"center",minHeight:"72px !important",paddingLeft:24,paddingRight:24,gap:12,position:"sticky",width:"100%",backgroundColor:f("background")})),JB=l.forwardRef(function(e,n){return r.jsx(rr,{direction:"up",ref:n,...e})}),fx=t=>{const e=we(),n=xe(e.breakpoints.down("md")),{renderTriggerButton:o,openTimestamp:i}=t,{generationInput:a,generationThrottle:s,generationThrottleCountDown:c,imageDescription:d,loadingDescription:u,promptErrorData:h,generationInputOpen:p,setGenerationInputOpen:g}=l.useContext(ye),[m,v]=l.useState(!1),x=Ee(),[y,_]=l.useState(p),w=l.useRef(!0);l.useEffect(()=>{(i||p)&&_(!0)},[i,p]),l.useEffect(()=>{if(w.current){w.current=!1;return}_(!0)},[a.timestamp,u]);const[I,R]=l.useState(a.prompt??"");return l.useEffect(()=>{R(a.prompt??"")},[R,a.prompt]),l.useEffect(()=>{g(y)},[y,g]),l.useEffect(()=>{d&&_(!0)},[d,_]),l.useEffect(()=>{u&&_(!0)},[u]),l.useEffect(()=>{h&&h.prompt===I&&_(!0)},[I,h]),n?r.jsxs(r.Fragment,{children:[r.jsxs(XB,{fullWidth:!0,TransitionComponent:JB,open:y,onClose:()=>_(!1),hideBackdrop:!0,sx:{zIndex:S=>S.zIndex.drawer+137},PaperProps:{sx:{flexDirection:"column",alignItems:"center",margin:0,padding:0,paddingBottom:6,backgroundColor:f("solid"),borderRadius:0,minHeight:"100dvh",minWidth:"100dvw",overscrollBehavior:"contain",overflow:"scroll","::-webkit-scrollbar":{width:0,background:"transparent",display:"none"},alignSelf:"flex-end"}},onClick:S=>S.stopPropagation(),onDragOver:S=>{S.preventDefault(),S.dataTransfer.types.includes("Files")&&v(!0)},onDragLeave:()=>v(!1),onDrop:S=>{S.preventDefault(),v(!1)},children:[r.jsx(Qd,{teasingDrop:m,setTeasingDrop:v}),r.jsx(C,{width:"100%",paddingX:0,minHeight:"101dvh",children:r.jsx(px,{handleClose:()=>_(!1),handleOpen:()=>_(!0),prompt:I,setPrompt:R})})]}),o&&r.jsx(YB,{onClick:()=>{x({eventKey:"OPEN_INPUT_MODAL_CLICK"}),_(!y)},children:s&&c>0?vI(c):r.jsx(Xd,{sx:{width:24,height:24},htmlColor:f("solid")})})]}):null},XB=b(Wn)(()=>({backgroundColor:"transparent",display:"flex",flexDirection:"column",justifyContent:"flex-end","& .MuiModal-backdrop":{background:f("backdrop")},overscrollBehavior:"contain",userSelect:"none"})),YB=b(Yo)(()=>({backgroundColor:f("primary"),boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2), 0px 3px 4px 0px rgba(0,0,0,0.14), 0px 1px 8px 0px rgba(0,0,0,0.12)","&:hover":{backgroundColor:f("primary")},width:40,height:40,fontSize:14,fontWeight:600,color:f("background")})),QB=t=>{var Y,q,V;const{stickingTop:e}=t,n=Ee(),o=we(),i=xe(o.breakpoints.down("md")),{tab:a}=an(),{navigate:s,getBrowsingData:c,setHomePageTab:d}=l.useContext($e),{promptErrorData:u,inSessionGenerations:h,generatedInSession:p}=l.useContext(ye),{isTeamBillingEnabled:g,userProfileState:m,chosenOrganization:v}=l.useContext(ge),{externalPhotoUrl:x,badge:y}=m??{},_=Rn(),[w,I]=l.useState(((Y=c())==null?void 0:Y.yPosition)===0?e:!1),[R,S]=l.useState(((q=c())==null?void 0:q.yPosition)===0);l.useEffect(()=>{setTimeout(()=>S(!0),100)},[]),l.useEffect(()=>{R&&I(e)},[e,I,R]);const E=l.useMemo(()=>h.filter(Q=>!(Q.stage===Ft.INTERMEDIATE&&!Q.data.generation.has_started&&Q.data.generation.job_id)).length,[h]),N=l.useMemo(()=>!!pt(oe.NOTIFICATIONS,_.pathname),[_.pathname]),[k,A]=l.useState(!1),D=l.useMemo(()=>!!k,[k]),O=l.useMemo(()=>Bn(_.pathname)&&a===Ae.explore,[_.pathname,a]),L=l.useCallback(()=>{O||(Bn(window.location.pathname)?d(Ae.explore):s(oe.HOME_TAB.replace(":tab",Ae.explore)))},[O,s,d]),P=l.useMemo(()=>Bn(_.pathname)&&a===Ae.my_images,[_.pathname,a]),G=l.useMemo(()=>a===Ae.labelling,[a]),B=l.useCallback(()=>{P||(Bn(window.location.pathname)?d(Ae.my_images):s(oe.HOME_TAB.replace(":tab",Ae.my_images)))},[P,s,d]),[M,z]=l.useState(!!((V=c())!=null&&V.notificationState));l.useEffect(()=>{const Q=()=>{var K;z(!!((K=c())!=null&&K.notificationState))};return window.addEventListener("popstate",Q),()=>{window.removeEventListener("popstate",Q)}},[c]);const F=l.useRef(null),{notificationState:T,notificationCount:j,loadingNextPageNotification:Z,loadNotificationNextPage:ee,notificationPageEndReached:te,resetNotificationState:$,isFetchingNotifications:X}=J0({openNotification:M}),W=l.useMemo(()=>E>0||!w||!!(u!=null&&u.prompt)||!O&&!P&&!G||p,[p,E,O,G,P,u==null?void 0:u.prompt,w]);return r.jsxs(r.Fragment,{children:[i?r.jsx(iL,{elevation:3,sx:{zIndex:Q=>Q.zIndex.drawer+132},children:r.jsxs(sL,{children:[r.jsx(wi,{disableRipple:!0,icon:r.jsx(yi,{children:r.jsx(oL,{active:O})}),onClick:()=>L()}),r.jsx(wi,{disableRipple:!0,icon:r.jsx(yi,{children:r.jsx(tL,{active:P})}),onClick:()=>B()}),r.jsx(rL,{children:r.jsx(fx,{renderTriggerButton:!0})}),r.jsx(wi,{disableRipple:!0,icon:r.jsx(yi,{children:r.jsx(aL,{badgeContent:j>99?"99+":j,overlap:"circular",children:r.jsx(ZB,{active:N})})}),onClick:()=>{pt(oe.NOTIFICATIONS,window.location.pathname)?$():s(oe.NOTIFICATIONS)}}),g?r.jsx(wi,{disableRipple:!0,icon:r.jsx(yi,{children:r.jsx(Ec,{chosenOrganization:v,externalPhotoUrl:x,badge:y})}),onClick:()=>{n({eventKey:"SETTING_NAV_CLICK"}),A(Q=>!Q)}}):r.jsx(wi,{disableRipple:!0,icon:r.jsx(yi,{children:r.jsx(eL,{active:D})}),onClick:()=>{n({eventKey:"SETTING_NAV_CLICK"}),A(Q=>!Q)}})]})}):r.jsx(VB,{renderFullHeader:W,autoScrolled:R}),!i&&M&&r.jsx(K0,{open:M,close:()=>{M&&n({eventKey:"NOTIFICATION_CLOSE"}),z(!1)},notificationBellButtonRef:F,notifications:T,loadingNextPageNotification:Z,loadNotificationNextPage:ee,notificationPageEndReached:te,isFetchingNotifications:X}),!!k&&(g?r.jsx(w0,{children:r.jsx(j0,{open:k,close:()=>{A(!1)}})}):r.jsx(A0,{open:k,close:()=>{A(!1)}}))]})},ZB=t=>{const e=Ee(),{active:n}=t;return n?r.jsx("div",{onClick:()=>{e({eventKey:"NOTIFICATION_BELL_ICON_CLICK"}),window.scrollTo({top:0,behavior:"smooth"})},children:r.jsx(r7,{color:f("iconPrimary")})}):r.jsx(x0,{color:f("iconPrimary")})},eL=t=>{const{active:e}=t;return e?r.jsx("div",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),children:r.jsx(v0,{color:f("iconPrimary")})}):r.jsx(y0,{color:f("iconPrimary")})},tL=t=>{const e=Ee(),{active:n}=t,{inSessionGenerations:o}=l.useContext(ye),i=l.useMemo(()=>o.filter(a=>!a.data.generation.job_id||a.data.generation.has_started).length?r.jsx(nL,{children:r.jsx(Y0,{})}):null,[o]);return n?r.jsxs(C,{position:"relative",onClick:()=>{e({eventKey:"MY_IMAGES_NAV_CLICK"}),window.scrollTo({top:0,behavior:"smooth"})},children:[i,r.jsx(t1,{color:f("iconPrimary")})]}):r.jsxs(C,{position:"relative",onClick:()=>e({eventKey:"MY_IMAGES_NAV_CLICK"}),children:[i,r.jsx(e1,{color:f("iconPrimary")})]})},nL=b(C)(()=>({position:"absolute",width:22,height:22,borderRadius:11,backgroundColor:f("promptBoxColor"),display:"flex",justifyContent:"center",alignItems:"center",top:-8,right:-8,zIndex:1})),oL=t=>{const e=Ee(),{active:n}=t;return n?r.jsx("div",{onClick:()=>{e({eventKey:"HOME_NAV_CLICK"}),window.scrollTo({top:0,behavior:"smooth"})},children:r.jsx(Q0,{color:f("iconPrimary")})}):r.jsx("div",{onClick:()=>e({eventKey:"HOME_NAV_CLICK"}),children:r.jsx(Z0,{color:f("iconPrimary")})})},yi=b(C)({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:8,paddingTop:20,paddingBottom:20}),rL=b(C)({zIndex:1,flex:1,display:"flex",justifyContent:"center",alignItems:"center",position:"relative",paddingLeft:16,paddingRight:16}),wi=b(pv)(()=>({color:f("informative"),"&.Mui-selected":{color:f("primary")},minWidth:0})),iL=b(Ir)({position:"fixed",left:0,right:0,bottom:0,zIndex:1330,opacity:.98}),sL=b(C)(()=>({backgroundColor:f("promptBoxColor"),borderTopStyle:"solid",borderTopColor:f("border"),borderTopWidth:1,display:"flex",flexDirection:"row",justifyContent:"center"})),aL=b(qc)(()=>({"& .MuiBadge-badge":{color:"#fff",backgroundColor:f("active"),width:20,height:20,borderRadius:10,fontSize:10,fontFamily:"Manrope, sans-serif",fontWeight:600,lineHeight:"20px",letterSpacing:"-0.36px",top:4,right:4,minWidth:0}})),lL=b(C)({display:"flex",padding:8,alignItems:"center",gap:"12px"}),cL=b(le)(()=>({color:"#FAFAFA",fontSize:14,fontWeight:700,lineHeight:"20px",letterSpacing:"-0.56px"})),dL=b(le)(()=>({color:"#D4D4D8",fontSize:14,fontWeight:400,lineHeight:"20px",letterSpacing:"-0.14px"}));b("span")(()=>({fontWeight:600,lineHeight:"20px",letterSpacing:"-0.56px"}));const uL="#27272A",hL=()=>r.jsxs(lL,{children:[r.jsx(cL,{children:r.jsx(Qo,{i18nKey:"bulk_download.error.network.title"})}),r.jsx(dL,{children:r.jsx(Qo,{i18nKey:"bulk_download.error.network.message"})})]}),Ro=l.createContext({selectionModeActivated:!1,setSelectionModeActivated:()=>{},toggleSelectImage:()=>{},toggleSelectRequest:()=>{},selectedRequests:new Map,selectedImages:new Map,selectedCount:0,dragSelect:void 0,showMaximumSnack:!1,setShowMaximumSnack:()=>{},downloadSelectedImages:()=>new Promise(t=>t())}),$o=250,pL=t=>{const{children:e,areaRef:n}=t,{tab:o,uhandle:i}=an(),a=Ee(),[s,c]=l.useState(!1),[d,u]=l.useState(new Map),[h,p]=l.useState(new Map),{userProfileState:g,isFeatureEnabled:m}=l.useContext(ge),{imageEditState:v}=l.useContext(ye),[x,y]=l.useState(),[_,w]=l.useState(!1),[I,R]=l.useState(),{setAlertContent:S}=l.useContext(Tn),E=l.useCallback(async j=>{const Z=d.size*(j?1:4)+h.size,ee=!1;a({eventKey:"BULK_DOWNLOAD",metaData:{imageCount:Z,useNewBulkDownloadEndpoint:ee,coverOnly:j,response_ids:j?Array.from(d.values()).map(te=>te.coverResponseId):Array.from(d.values()).flatMap(te=>te.responseIds)}}),R("Preparing download..."),await iu({request_ids:Array.from(d.values()).map(te=>te.requestId),cover_only:j,image_ids:Array.from(h.values()).map(te=>te.imageId)},te=>R(`Downloading (${te}%)`)).catch(te=>{let $;te instanceof Error?$=te.message:$=String(te),a({eventKey:"BULK_DOWNLOAD_ERROR",metaData:{imageCount:Z,useNewBulkDownloadEndpoint:ee,coverOnly:j,response_ids:j?Array.from(d.values()).map(X=>X.coverResponseId):Array.from(d.values()).flatMap(X=>X.responseIds),error:$}}),S(r.jsx(hL,{}),{backgroundColor:uL})}),R(void 0)},[h,d,S,a]),N=l.useMemo(()=>h.size+d.size,[h,d]),k=h1();l.useEffect(()=>{var j,Z;return(o==="generated"||o==="private"||o==="pinned")&&v.url===!1&&i===(g==null?void 0:g.displayHandle)&&Ba(window.location.pathname)&&k&&matchMedia("(pointer:fine)").matches&&(n!=null&&n.current)||v.url===!1&&o===Ae.my_images&&matchMedia("(pointer:fine)").matches?x===void 0&&(window.getSelection?(j=window.getSelection())==null||j.removeAllRanges():document.getSelection&&((Z=document.getSelection())==null||Z.empty()),y(ee=>ee||new qv({draggability:!1,immediateDrag:!1,autoScrollSpeed:24,overflowTolerance:{x:0,y:24},customStyles:!0,area:(n==null?void 0:n.current)??void 0}))):x&&(x.stop(!1),y(void 0)),()=>{x&&(x.stop(!1),y(void 0))}},[o,x,g==null?void 0:g.displayHandle,i,v.url,k,m,n]),l.useEffect(()=>{const j=Z=>{Z.code==="Escape"&&(Z.stopPropagation(),Z.preventDefault(),c(!1))};return matchMedia("(pointer:fine)").matches&&document.addEventListener("keydown",j,!1),()=>{document.removeEventListener("keydown",j)}},[n]),l.useEffect(()=>{s||(u(new Map),p(new Map))},[s,u,p]),l.useEffect(()=>{N===0&&c(!1)},[N]);const A=l.useCallback(j=>{h.has(j.imageId)?h.delete(j.imageId):N<$o?h.set(j.imageId,j):w(!0),p(new Map(h))},[h,p,N]),D=l.useCallback(j=>{const{coverResponseId:Z}=j;d.has(Z)?d.delete(Z):N<$o?d.set(Z,j):w(!0),u(new Map(d))},[d,u,N]),O=l.useCallback(j=>{N<$o?h.set(j.imageId,j):w(!0),p(new Map(h))},[h,p,N]),L=l.useCallback(j=>{N<$o?d.set(j.coverResponseId,j):w(!0),u(new Map(d))},[d,u,N]),P=l.useCallback(j=>{h.delete(j),p(new Map(h))},[h,p]),G=l.useCallback(j=>{d.delete(j),u(new Map(d))},[d,u]),B=l.useRef(null),M=l.useRef(null),z=l.useCallback(j=>{var W,Y,q;if(B.current===null)return;const Z=j.item.getAttribute("data-request-id"),ee=j.item.getAttribute("data-cover-response-id"),te=(W=j.item.getAttribute("data-response-ids"))==null?void 0:W.split(","),$=j.item.getAttribute("data-image-id"),X=j.item.getAttribute("data-download-name");c(!0),ee?!B.current.selectedRequests.has(ee)&&M.current&&M.current.selectedRequests.size+M.current.selectedImages.size<$o&&((Y=M.current)==null||Y.selectedRequests.set(ee,{requestId:Z,coverResponseId:ee,responseIds:te,downloadName:X}),L({requestId:Z,coverResponseId:ee,responseIds:te,downloadName:X})):$&&!B.current.selectedImages.has($)&&M.current&&M.current.selectedRequests.size+M.current.selectedImages.size<$o&&((q=M.current)==null||q.selectedImages.set($,{imageId:$,downloadName:X}),O({imageId:$,downloadName:X}))},[c,L,O]),F=l.useCallback(j=>{var $,X,W;if(B.current===null)return;const Z=j.item.getAttribute("data-cover-response-id"),ee=($=j.item.getAttribute("data-response-ids"))==null?void 0:$.split(","),te=j.item.getAttribute("data-image-id");Z&&ee?B.current.selectedRequests.has(Z)||(G(Z),(X=M.current)==null||X.selectedRequests.delete(Z)):te&&(B.current.selectedImages.has(te)||(P(te),(W=M.current)==null||W.selectedImages.delete(te)))},[P,G]),T=l.useCallback(j=>{var Z,ee;x&&(j.items.length>1&&(u(new Map((Z=M.current)==null?void 0:Z.selectedRequests)),p(new Map((ee=M.current)==null?void 0:ee.selectedImages))),B.current=null,M.current=null,x.getSelection().length&&a({eventKey:"BULK_ACTION_DRAG_SELECT",metaData:{dragSelectSize:x.getSelection().length}}),x.clearSelection())},[x,a]);return l.useEffect(()=>{if(!x)return;const j=Z=>{window.scrollY===0&&window.scrollBy(0,1),Z.items.length>0?x.break():(B.current={selectedRequests:new Map(d),selectedImages:new Map(h)},M.current={selectedRequests:new Map(d),selectedImages:new Map(h)})};return x.subscribe("DS:start",j),x.subscribe("DS:select",z),x.subscribe("DS:unselect",F),x.subscribe("DS:end",T),()=>{x.unsubscribe("DS:start",j),x.unsubscribe("DS:select",z),x.unsubscribe("DS:unselect",F),x.unsubscribe("DS:end",T)}},[x,z,F,c,d,h,T]),r.jsx(Ro.Provider,{value:{selectionModeActivated:s,setSelectionModeActivated:c,toggleSelectRequest:D,toggleSelectImage:A,selectedRequests:d,selectedImages:h,selectedCount:N,dragSelect:x,showMaximumSnack:_,setShowMaximumSnack:w,downloadSelectedImages:E,downloadLoading:I},children:e})},Ns=1,mo={title:"Sorry, something went wrong.",message:"Please check your file and try again."},fL="DISMISSED_BATCH_SUBMITTED_MESSAGE",gL={".csv":"text/csv",".xls":"application/vnd.ms-excel",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".ods":"application/vnd.oasis.opendocument.spreadsheet"},mL=l.createContext({uploadError:{},setUploadError:()=>{},parsedSuccessfully:!1,setParsedSuccessfully:()=>{},inCSVCheckingProgress:!1,setInCSVCheckingProgress:()=>{},fileUploadLocalSrc:null,setFileUploadLocalSrc:()=>{},filePreviewData:{},fileInformation:{filename:"",fileType:""},generationJobs:[],setGenerationJobs:()=>{},numberOfPriorityCredits:0,startBatchGeneration:()=>{},totalJobsInfo:{hasMoreJobs:!1,totalJobs:0},currentPage:0,isRefreshingHistory:!1,setCurrentPage:()=>{},triggerDownloadZipJobFile:()=>{},loadingStatuses:{},changeStatus:()=>{},showEffect:{isShowing:!1,jobId:""},jobCreditSituation:{},teasingDrop:!1,setTeasingDrop:()=>{},verifySpreadsheetFile:()=>{},shouldShowBatchSubmittedMessage:!1,setShouldShowBatchSubmittedMessage:()=>{}}),xL=({children:t})=>{const[e,n]=l.useState({}),[o,i]=l.useState(!1),[a,s]=l.useState(!1),[c,d]=l.useState({}),[u,h]=l.useState(null),[p,g]=l.useState({hasMoreJobs:!1,totalJobs:0}),[m,v]=l.useState(0),{generationsApi:x,jobsApi:y,hasAccessToBatchGeneration:_}=l.useContext(ge),{refetchQueuedRequestStats:w,refetchRequestsInFlight:I,priorityCredit:R}=l.useContext(ye),[S,E]=l.useState(!1),[N,k]=l.useState({filename:"",fileType:""}),{setAlertText:A}=l.useContext(Tn),[D,O]=l.useState(!1),[L,P]=l.useState({}),[G,B]=l.useState([]),[M,z]=l.useState(!1),[F,T]=l.useState({}),[j,Z]=l.useState({isShowing:!1,jobId:""}),ee=Rn(),te=l.useMemo(()=>new URLSearchParams(ee.search),[ee.search]),{navigate:$}=l.useContext($e),X=te.get("jobId"),W=Ee();l.useEffect(()=>{X&&y&&y.getPageForJob({generationJobId:X}).then(ne=>{(ne==null?void 0:ne.page)>=0&&(v(ne.page),Z({isShowing:!0,jobId:X}),setTimeout(()=>{Z({isShowing:!1,jobId:""}),te.delete("jobId");const ue=te.toString(),fe=`${ee.pathname}${ue?`?${ue}`:""}`;ee.pathname===window.location.pathname&&$(fe)},2e3))})},[y,te,ee.pathname,X,$]);const Y=l.useRef((R==null?void 0:R.total)??0);l.useEffect(()=>{Y.current=(R==null?void 0:R.total)??0},[R==null?void 0:R.total]);const q=l.useCallback(ne=>{if(k({filename:"",fileType:""}),u&&URL.revokeObjectURL(u),h(""),!Object.values(gL).includes(ne.type)){n({errorType:"FILE_TYPE",details:{title:"File type not supported.",message:"Please choose a file in .xlsx, .xls, .csv or .ods."},isGenericError:!1});return}if(ne.size/1e3/1e3>Ns){n({errorType:"FILE_SIZE",details:{title:"File too large.",message:`Please upload an image under ${Ns} MB.`},isGenericError:!1});return}h(URL.createObjectURL(ne)),k({filename:ne.name,fileType:ne.type})},[u]),V=l.useCallback(async ne=>{const ue=ne.file.size/1e3/1e3;if(ue>Ns)return{success:!1,error_message:[`Uploaded ${ue.toFixed(1)} MB, max ${Ns} MB`]};try{if(x){const Se=await(await x.postValidateBatchGenerateFromFileRaw({jobFile:ne.file})).value();return{success:!0,priority_credits_needed:Se.creditsConsumed,job_size:Se.numberOfGenerations,preview:Se.preview}}}catch(fe){if(fe instanceof Yr){const Se=await fe.response.json();return{success:!1,error_message:Zu(Se).errors||[]}}return{success:!1,error_details:mo,isGenericError:!0}}},[x]),{mutateAsync:Q}=wo({mutationFn:async ne=>await V(ne),retryDelay:200,retry:(ne,ue)=>ue.status===403&&ne<5}),K=l.useCallback(ne=>{Q(ne).then(ue=>{if(!(ue!=null&&ue.success)){s(!1),h(null),ue!=null&&ue.error_message&&ue.error_message.length>0?n({errorType:"UNEXPECTED",details:{title:"There were issues with your file.",message:"Please fix them and try re-uploading.",errorList:ue.error_message},isGenericError:!1}):n({errorType:"UNEXPECTED",details:mo,isGenericError:!0});return}if(!ue.preview||Object.keys(ue.preview).length===0){n({errorType:"INVALID_FORMAT",details:{title:"Invalid format.",message:"The file must have at least a header row and one data row."},isGenericError:!1}),s(!1);return}ue.success?(n({}),d({rowPreview:ue.preview,batchSummary:{number_of_generations:`${ue.job_size} (${(ue.job_size||0)*4} images)`,priority_credits_needed:ue.priority_credits_needed,priority_credits_available:Y.current}}),i(!0)):(h(null),n({errorType:"UNEXPECTED",details:mo,isGenericError:!0})),s(!1)}).catch(ue=>{s(!1),ue.status===403&&Lt(),h(null),n({errorType:"UNEXPECTED",details:mo,isGenericError:!0})})},[Q]),ae=l.useCallback(async()=>{if(E(!0),!y)return[];try{const ue=await(await y.getGenerationJobsRaw({page:m})).value();if(g({hasMoreJobs:(ue==null?void 0:ue.hasMoreJobs)||!1,totalJobs:(ue==null?void 0:ue.totalJobs)||0}),B((ue==null?void 0:ue.jobs)||[]),E(!1),ue!=null&&ue.jobs&&ue.jobs.length>0&&_){const fe=await y.getGenerationJobsRequiresCredit();T(fe)}return(ue==null?void 0:ue.jobs)??[]}catch{n({errorType:"UNEXPECTED",details:mo,isGenericError:!0}),E(!1)}},[m,_,y]);Ve(["generationJobs",m],ae,{onError:()=>{n({errorType:"UNEXPECTED",details:mo,isGenericError:!0}),E(!1)},refetchInterval:5e3,enabled:!a}),l.useEffect(()=>{_&&(d({}),i(!1),u&&(s(!0),Le(u).then(ne=>{if(!ne.ok)throw new Error(`HTTP error! status: ${ne.status}`);return ne.blob()}).then(ne=>{K({file:new File([ne],N.filename)})}).catch(()=>{s(!1),h(null),n({errorType:"UNEXPECTED",details:mo,isGenericError:!0})})))},[N.filename,u,K,_]);const ce=l.useCallback(async ne=>{try{if(x)return await x.postBatchGenerateFromFileRaw({jobFile:ne.file}),localStorage.getItem(fL)!=="true"?O(!0):A("Batch submitted",{showClose:!1,autoDismissMs:2e3}),s(!1),h(null),i(!1),ae(),{success:!0}}catch(ue){if(ue instanceof Yr){const fe=await ue.response.json(),Se=Zu(fe);return{success:!1,error_message:Se.errors&&Se.errors[0]}}return s(!1),{success:!1,error_details:mo,isGenericError:!0}}},[ae,x,A]),ve=l.useCallback(()=>{u?(W({eventKey:"START_BATCH_GENERATION_CLICKED"}),s(!0),Le(u).then(ne=>{if(!ne.ok)throw new Error(`HTTP error! status: ${ne.status}`);return ne.blob()}).then(ne=>{ce({file:new File([ne],N.filename)}).then(()=>{w==null||w(),I==null||I()})}).catch(()=>{s(!1),h(null),n({errorType:"UNEXPECTED",details:mo,isGenericError:!0})})):n({errorType:"UNEXPECTED",details:mo,isGenericError:!0})},[N.filename,u,ce,w,I,W]),se=l.useCallback(async ne=>{var ue;P(fe=>{var Se;return{...fe,[ne]:{isDownloading:!0,isChangingStatus:((Se=fe[ne])==null?void 0:Se.isChangingStatus)||!1}}}),A("Downloading file",{showClose:!1,autoDismissMs:5e3});try{const fe=await(y==null?void 0:y.getDownloadJobResultsRaw({generationJobId:ne}));if(!fe)return;const Se=parseInt(fe.raw.headers.get("Content-Length-Estimation")??"0"),je=(ue=fe.raw.body)==null?void 0:ue.getReader();if(!je)return;let qe=0;const De=[],Ye=async()=>{await(je==null?void 0:je.read().then(async({done:nt,value:ct})=>{if(nt){const he=new Uint8Array(qe);let Fe=0;for(const st of De)he.set(st,Fe),Fe+=st.length;const Ge=new Blob([he]);ru(Ge,`fish_${ne}_results.zip`);return}if(De.push(ct),qe+=ct.length,Se){const he=Math.min(99,Math.floor(qe/Se*100));P(Fe=>{var Ge;return{...Fe,[ne]:{isDownloading:!0,isChangingStatus:((Ge=Fe[ne])==null?void 0:Ge.isChangingStatus)||!1,progress:he}}})}await Ye()}))};await Ye(),P(nt=>{var ct;return{...nt,[ne]:{isDownloading:!1,isChangingStatus:((ct=nt[ne])==null?void 0:ct.isChangingStatus)||!1}}})}catch{P(Se=>{var je;return{...Se,[ne]:{isDownloading:!1,isChangingStatus:((je=Se[ne])==null?void 0:je.isChangingStatus)||!1}}}),n({errorType:"UNEXPECTED",details:{title:"Error downloading job results",message:"Please try again later."}})}},[y,A,n]),H=l.useCallback(async(ne,ue)=>{if(!(!ne||!ue)){P(fe=>{var Se;return{...fe,[ne]:{isDownloading:((Se=fe[ne])==null?void 0:Se.isDownloading)||!1,isChangingStatus:!0}}});try{await(y==null?void 0:y.updateJobStatusRaw({generationJobId:ne,updateJobStatusRequest:{jobStatus:ue}})),P(fe=>{var Se;return{...fe,[ne]:{isDownloading:((Se=fe[ne])==null?void 0:Se.isDownloading)||!1,isChangingStatus:!1}}}),B(fe=>fe.map(Se=>Se.jobId===ne?{...Se,jobStatus:ue}:Se))}catch{n({errorType:"UNEXPECTED",details:{title:"Error resuming job",message:"Please try again later."}}),P(Se=>{var je;return{...Se,[ne]:{isDownloading:((je=Se[ne])==null?void 0:je.isDownloading)||!1,isChangingStatus:!1}}})}}},[y,n]),me={uploadError:e,setUploadError:n,parsedSuccessfully:o,setParsedSuccessfully:i,inCSVCheckingProgress:a,setInCSVCheckingProgress:s,fileUploadLocalSrc:u,setFileUploadLocalSrc:h,filePreviewData:c,setFilePreviewData:d,fileInformation:N,generationJobs:G,setGenerationJobs:B,numberOfPriorityCredits:Y.current,startBatchGeneration:ve,totalJobsInfo:p,currentPage:m,setCurrentPage:v,isRefreshingHistory:S,triggerDownloadZipJobFile:se,loadingStatuses:L,changeStatus:H,showEffect:j,jobCreditSituation:F,teasingDrop:M,setTeasingDrop:z,verifySpreadsheetFile:q,shouldShowBatchSubmittedMessage:D,setShouldShowBatchSubmittedMessage:O};return r.jsx(mL.Provider,{value:me,children:t})};function gx({width:t,height:e}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??64,height:e??56,fill:"none",viewBox:"0 0 64 56",children:[r.jsx("g",{filter:"url(#filter0_dd_1578_2460)",children:r.jsx("path",{fill:"url(#paint0_linear_1578_2460)",d:"M28.35 5.571a14.362 14.362 0 00-16.766-.394C4.05 10.33 3.173 21.113 9.775 27.417L30.849 47.54a1.667 1.667 0 002.302 0l21.07-20.122c6.603-6.304 5.725-17.087-1.81-22.241a14.362 14.362 0 00-16.77.398L32 8.328l-3.65-2.757z"})}),r.jsxs("defs",{children:[r.jsxs("filter",{id:"filter0_dd_1578_2460",width:"77.335",height:"69.332",x:"-6.669",y:"0.669",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[r.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),r.jsx("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),r.jsx("feMorphology",{in:"SourceAlpha",radius:"4",result:"effect1_dropShadow_1578_2460"}),r.jsx("feOffset",{dy:"4"}),r.jsx("feGaussianBlur",{stdDeviation:"3"}),r.jsx("feComposite",{in2:"hardAlpha",operator:"out"}),r.jsx("feColorMatrix",{values:"0 0 0 0 0.0352941 0 0 0 0 0.0352941 0 0 0 0 0.0431373 0 0 0 0.1 0"}),r.jsx("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1578_2460"}),r.jsx("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),r.jsx("feMorphology",{in:"SourceAlpha",radius:"3",result:"effect2_dropShadow_1578_2460"}),r.jsx("feOffset",{dy:"10"}),r.jsx("feGaussianBlur",{stdDeviation:"7.5"}),r.jsx("feComposite",{in2:"hardAlpha",operator:"out"}),r.jsx("feColorMatrix",{values:"0 0 0 0 0.0352941 0 0 0 0 0.0352941 0 0 0 0 0.0431373 0 0 0 0.1 0"}),r.jsx("feBlend",{in2:"effect1_dropShadow_1578_2460",result:"effect2_dropShadow_1578_2460"}),r.jsx("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1578_2460",result:"shape"})]}),r.jsxs("linearGradient",{id:"paint0_linear_1578_2460",x1:"15.333",x2:"32",y1:"2.667",y2:"48",gradientUnits:"userSpaceOnUse",children:[r.jsx("stop",{stopColor:"#F87171"}),r.jsx("stop",{offset:"0.5",stopColor:"#EF4444"}),r.jsx("stop",{offset:"1",stopColor:"#DC2626"})]})]})]})}const vL=()=>r.jsx(C,{sx:{position:"absolute",left:0,right:0,bottom:0,top:0,display:"flex",justifyContent:"center",alignItems:"center"},children:r.jsx(gx,{})}),yL="https://storage.googleapis.com/ideogram-static/assets/light-transparent-checker.svg",wL="https://storage.googleapis.com/ideogram-static/assets/dark-transparent-checker.svg",Xa=t=>{const{fillSpace:e,hideImage:n}=t,o=we(),i=xe(o.breakpoints.down("md")),{displayImageSrc:a,imageAspectRatioNumber:s,handleLikeGeneration:c,switchResponseIndex:d,isSuperRes:u,showDoubleTapIndicator:h}=l.useContext(Ln),{image_index:p}=an(),g=l.useRef(null),m=l.useRef(Date.now()),v=l.useCallback(E=>{const N=E.deltaX;Math.abs(N)>0&&E.preventDefault();const k=Date.now();if(p!==void 0&&k>m.current+150){const A=parseInt(p),D=12;N>D&&A<3?(d(Math.min(A+1,3)),m.current=k):N<-D&&A>=0&&(d(Math.max(A-1,0)),m.current=k)}},[p,d]),x=l.useRef(null),y=l.useCallback(E=>{if(E.touches.length>1){x.current=null;return}const N=E.touches[0];x.current=N.clientX},[]),_=l.useCallback(E=>{if(!p||E.touches.length>1||E.changedTouches.length>1||x.current===null)return;const k=E.changedTouches[0].clientX,A=parseInt(p),D=40;k-x.current>D?d((A+4-1)%4):k-x.current<-D&&d((A+4+1)%4)},[p,d]);l.useEffect(()=>{if(u)return;const E=g.current;return E==null||E.addEventListener("wheel",v),E==null||E.addEventListener("touchstart",y,{passive:!0}),E==null||E.addEventListener("touchend",_,{passive:!0}),()=>{E==null||E.removeEventListener("wheel",v),E==null||E.removeEventListener("touchstart",y),E==null||E.removeEventListener("touchend",_)}},[v,y,_,u]);const{onClick:w}=su(E=>{E.preventDefault(),E.stopPropagation(),c(!0)},200,{onSingleTap:E=>{E.preventDefault(),E.stopPropagation()}});l.useEffect(()=>{!g.current||!a||a.includes("lossless")||(g.current.setAttribute("src",""),g.current.setAttribute("src",a))},[a]);const[I,R]=l.useState(1024),S=l.useCallback(()=>{g.current&&R(g.current.getBoundingClientRect().width)},[]);return l.useEffect(()=>(S(),window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)),[S]),a?r.jsxs(r.Fragment,{children:[r.jsx(bL,{ref:g,src:a,sx:{opacity:n?0:1,...e?{minWidth:"100%",minHeight:"100%"}:{},aspectRatio:s,width:i?"100%":void 0,borderRadius:i?0:"4px",...a?ha(I):{visibility:"hidden"}},onMouseDown:E=>E.stopPropagation(),onClick:E=>{E.stopPropagation(),w(E)}}),h&&r.jsx(vL,{})]}):null},ha=t=>{const e=Math.round(t/18),n=e?t/e:18;return{background:`url(${os?wL:yL}) left top / ${n}px ${n}px repeat, linear-gradient(135deg, rgba(255, 159, 189, 0.20) 0%, rgba(246, 136, 194, 0.20) 20%, rgba(229, 115, 204, 0.20) 40%, rgba(200, 101, 219, 0.20) 60%, rgba(154, 94, 237, 0.20) 90%, rgba(61, 94, 255, 0.20) 100%), transparent`}},bL=b("img")(()=>({display:"flex",justifyContent:"center",alignItems:"center",maxHeight:"100%",maxWidth:"100%",cursor:"pointer"}));function CL({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("g",{children:r.jsx("path",{fill:n,d:"M12.5 2.75a.75.75 0 00-1.5 0v18.5a.75.75 0 001.5 0V2.75zM4.25 4A2.25 2.25 0 002 6.25v11.5A2.25 2.25 0 004.25 20H10v-1.5H4.25a.75.75 0 01-.75-.75V6.25a.75.75 0 01.75-.75H10V4H4.25zm15 14.5H13.5V20h5.75a2.25 2.25 0 002.25-2.25V6.25A2.25 2.25 0 0019.25 4H13.5v1.5h5.75a.75.75 0 01.75.75v11.5a.75.75 0 01-.75.75z"})})})}function _L({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",children:r.jsx("path",{fill:n,d:"M3 6.25A3.25 3.25 0 016.25 3h11.5A3.25 3.25 0 0121 6.25v11.5A3.25 3.25 0 0117.75 21H6.25A3.25 3.25 0 013 17.75V6.25zM6.25 4.5A1.75 1.75 0 004.5 6.25v11.5c0 .966.784 1.75 1.75 1.75h11.5a1.75 1.75 0 001.75-1.75V6.25a1.75 1.75 0 00-1.75-1.75H6.25z"})})}const IL=t=>{const{viewMode:e,setViewMode:n}=t,o=Ee();return r.jsx(Be,{icon:e==="none"?r.jsx(CL,{color:"#fff"}):r.jsx(_L,{color:"#fff"}),onClick:()=>{const i=e==="none"?"slide":"none";o({eventKey:"SUPER_RES_IMAGE_TOGGLE",metaData:{type:i}}),n(i)},tooltip:e==="none"?"Split view":"Single view",tooltipPlacement:"left"})};function SL({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??16,height:e??16,fill:n,viewBox:"0 0 16 16",children:r.jsx("path",{fill:n,d:"M5.354 5.854a.5.5 0 11-.708-.708l3-3a.5.5 0 01.708 0l3 3a.5.5 0 01-.708.708L8.5 3.707v8.586l2.146-2.147a.5.5 0 01.708.708l-3 3a.5.5 0 01-.708 0l-3-3a.5.5 0 01.708-.708L7.5 12.293V3.707L5.354 5.854z"})})}const RL=t=>{const{badgeName:e}=t,n=we(),o=xe(n.breakpoints.down("md")),i=l.useRef(null),a=l.useRef(null),s=l.useRef(null),{displayImageSrc:c,parentSrc:d,aspectRatioStyle:u}=l.useContext(Ln),[h,p]=l.useState(!1),[g,m]=l.useState(50);l.useEffect(()=>{const A=()=>{p(!1)};return document.addEventListener("mouseup",A),document.addEventListener("touchend",A),()=>{document.removeEventListener("mouseup",A),document.removeEventListener("touchend",A)}},[p]);const v=l.useCallback(A=>{if(h&&A.buttons>0){const D=A.currentTarget.getBoundingClientRect(),O=D.right-D.left,P=(A.clientX-D.left)/O*100;m(Math.min(100,Math.max(0,P)))}},[m,h]),x=l.useCallback(A=>{if(A.stopPropagation(),A.button===0){const D=A.currentTarget.getBoundingClientRect(),O=D.right-D.left,P=(A.clientX-D.left)/O*100;m(Math.min(100,Math.max(0,P))),setTimeout(()=>p(!0),60)}},[m,p]),y=l.useCallback(A=>{if(h){const D=A.currentTarget.getBoundingClientRect(),O=D.right-D.left,P=(A.touches[0].clientX-D.left)/O*100;m(Math.min(100,Math.max(0,P)))}},[m,h]),[_,w]=l.useState(!1),[I,R]=l.useState(!1);l.useEffect(()=>{if(s.current){if(i.current){const A=i.current.getBoundingClientRect().right;setTimeout(()=>{if(!s.current)return;const D=s.current.getBoundingClientRect().left;w(D<A)},100)}if(a.current){const A=a.current.getBoundingClientRect().left;setTimeout(()=>{if(!s.current)return;const D=s.current.getBoundingClientRect().right;R(D>A)},100)}}},[g]);const S=l.useRef(null),[E,N]=l.useState(1024),k=l.useCallback(()=>{S.current&&N(S.current.getBoundingClientRect().width)},[]);return l.useEffect(()=>(k(),window.addEventListener("resize",k),()=>window.removeEventListener("resize",k)),[k]),r.jsxs(EL,{sx:{aspectRatio:u},onMouseMove:v,onMouseLeave:v,onTouchMove:y,onMouseDown:x,onTouchStart:y,children:[r.jsx(jL,{src:d,sx:{borderRadius:o?0:"4px",clipPath:`polygon(0 0, ${g}% 0, ${g}% 100%, 0 100%)`,transition:h?void 0:"all 80ms",...d?ha(E):{visibility:"hidden"}}}),r.jsx(mx,{ref:S,src:c,sx:{aspectRatio:u,borderRadius:o?0:"4px",...c?ha(E):{visibility:"hidden"}}}),r.jsx(kL,{sx:{left:`${g}%`,transition:h?void 0:"all 80ms"},onMouseDown:A=>{A.stopPropagation(),p(!0)},onTouchStart:()=>p(!0),children:r.jsx(AL,{orientation:"vertical",ref:s})}),r.jsx(TL,{onMouseDown:A=>{A.stopPropagation(),p(!0)},onTouchStart:()=>p(!0),sx:{left:`${g}%`,transition:h?void 0:"all 80ms"},children:r.jsx(SL,{color:f("iconPrimary")})}),!!e&&r.jsxs(r.Fragment,{children:[r.jsx(bf,{sx:{bottom:8,left:8,opacity:_?0:1},ref:i,children:e.original}),r.jsx(bf,{sx:{bottom:8,right:8,opacity:I?0:1},ref:a,children:e.processed})]})]})},TL=b(C)(()=>({position:"absolute",top:0,bottom:0,margin:"auto",width:24,height:24,borderRadius:12,color:f("primary"),outlineColor:f("border"),outlineStyle:"solid",outlineWidth:.5,backgroundColor:f("menuBackground"),display:"flex",justifyContent:"center",alignItems:"center",transform:"translate(-12px, 0) rotate(90deg)",zIndex:2,cursor:"col-resize",touchAction:"none"})),EL=b(C)({position:"relative",width:"100%",height:"100%",maxHeight:"100%",maxWidth:"100%",cursor:"pointer"}),kL=b(C)({width:24,position:"absolute",height:"100%",top:0,zIndex:1,transform:"translate(-12px, 0)",display:"flex",justifyContent:"center",cursor:"col-resize",touchAction:"none"}),AL=b(Ra)({borderColor:"#fff",borderRightWidth:2,filter:"drop-shadow(0px 1px 2px rgba(9, 9, 11, 0.20)) drop-shadow(0px 1px 3px rgba(9, 9, 11, 0.20))"}),mx=b("img")(()=>({display:"flex",justifyContent:"center",alignItems:"center",WebkitUserDrag:"none",width:"100%",minHeight:"100%",minWidth:"100%"})),jL=b(mx)(()=>({top:0,left:0,maxHeight:"100%",maxWidth:"100%",position:"absolute",objectFit:"cover"})),bf=b(C)(()=>({fontFamily:"Manrope, sans-serif",position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:6,backgroundColor:`${f("solid")}cc`,border:`0.5px solid ${f("border")}`,color:f("inputValue"),fontSize:14,fontWeight:600,zIndex:1,padding:"2px 6px"})),xx=t=>{const{badgeName:e}=t,n=we(),o=xe(n.breakpoints.down("md")),{aspectRatioStyle:i,shouldHideParent:a}=l.useContext(Ln),[s,c]=l.useState("none"),d=l.useMemo(()=>s==="slide"&&!a?r.jsx(RL,{badgeName:e}):r.jsx(Xa,{}),[e,a,s]);return r.jsxs(ML,{children:[r.jsx(PL,{sx:{aspectRatio:i,minWidth:o?"100%":void 0},children:d}),!a&&r.jsx(OL,{onMouseDown:u=>u.stopPropagation(),children:r.jsx(IL,{viewMode:s,setViewMode:c})})]})},PL=b(C)({maxHeight:"100%",maxWidth:"100%",display:"flex",justifyContent:"center",alignItems:"center"}),ML=b(C)({width:"100%",height:"100%",flex:1,display:"flex",alignItems:"center",justifyContent:"center",position:"relative"}),OL=b(C)(()=>({position:"absolute",zIndex:1,backgroundColor:f("glassBackground"),"&:hover":{backgroundColor:f("glassBackgroundHover")},"&:active":{backgroundColor:f("glassBackgroundPressed")},borderRadius:8,top:8,right:8})),vx=()=>r.jsx(xx,{}),yx=()=>r.jsx(xx,{badgeName:{original:"Original",processed:"Upscaled"}});function wx({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",pointerEvents:"none",children:r.jsx("path",{fill:n,d:"M7 4a2 2 0 00-2 2v12a2 2 0 002 2h2a2 2 0 002-2V6a2 2 0 00-2-2H7zm8 0a2 2 0 00-2 2v12a2 2 0 002 2h2a2 2 0 002-2V6a2 2 0 00-2-2h-2z"})})}function bx({width:t,height:e,color:n}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??24,height:e??24,fill:n,viewBox:"0 0 24 24",pointerEvents:"none",children:r.jsx("path",{fill:n,d:"M19.222 10.685a1.5 1.5 0 010 2.628l-10 5.498A1.5 1.5 0 017 17.495V6.502a1.5 1.5 0 012.223-1.314l10 5.497z"})})}const Cx=5.2,BL=t=>{const{playing:e,setPlaying:n,tileCount:o,setTileCount:i}=t,a=Ee(),s=l.useMemo(()=>99/Math.sqrt(Cx),[]),c=l.useMemo(()=>99-s*Math.log2(o),[s,o]),d=l.useCallback(u=>Math.pow(2,(99-u)/s),[s]);return r.jsxs(LL,{onMouseDown:u=>u.stopPropagation(),children:[r.jsx(Cf,{children:r.jsx(Be,{onClick:()=>{a({eventKey:"TILE_PLAY_CLICK_FROM_ZOOM_IN_PAGE"}),n(!e)},icon:e?r.jsx(wx,{color:"#fff"}):r.jsx(bx,{color:"#fff"})})}),r.jsx(C,{height:8}),r.jsx(Cf,{paddingY:2,children:r.jsx(ms,{logic:{value:c,label:`${Math.floor(100/o)}%`,onChange:u=>i(d(u)),onCommit:u=>{const h=d(u);a({eventKey:"SLIDE_TILE_SIZE",metaData:{value:h}}),i(h)},step:1,range:{min:0,max:99}},style:{vertical:!0,size:96,customColor:{rail:f("tileControlGrey"),thumb:f("tileControlWhite"),color:"#fff"}}})})]})},LL=b(C)({position:"absolute",top:8,right:8,display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"center",zIndex:2}),Cf=b(C)(()=>({borderRadius:8,backgroundColor:f("glassBackground"),"&:hover":{backgroundColor:f("glassBackgroundHover")},"&:active":{backgroundColor:f("glassBackgroundPressed")}})),_f={x:0,y:0},_x=t=>{const{tileType:e,autoPlay:n,responseId:o,speed:i}=t,{setPlayingTileResponseId:a,playingTileResponseId:s}=l.useContext($e),{request_id:c}=an(),[d,u]=l.useState(!!n),[h,p]=l.useState(_f);l.useEffect(()=>p(_f),[c]);const g=l.useRef(),m=l.useMemo(()=>i==="slow"?2:3,[i]),v=l.useMemo(()=>e==="COLUMN"?0:-m*2,[e,m]),x=l.useMemo(()=>e==="ROW"?0:-m*(e==="COLUMN"?2:1),[e,m]);return l.useEffect(()=>{s!==o&&!n&&u(!1)},[s,o,n]),l.useEffect(()=>(d&&o&&e&&(a(o),clearInterval(g.current),g.current=window.setInterval(()=>p(y=>({x:y.x+v,y:y.y+x})),200)),()=>{clearInterval(g.current)}),[o,v,x,a,d,e]),{playing:d,setPlaying:u,backgroundPosition:h}},Ix=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{displayTiledImageSrc:n,generationData:o,targetResponseImage:i}=l.useContext(Ln),{playing:a,setPlaying:s,backgroundPosition:c}=_x({tileType:o==null?void 0:o.tiling_preset,autoPlay:!0,responseId:i==null?void 0:i.response_id}),d=l.useMemo(()=>((o==null?void 0:o.width)??1024)*((o==null?void 0:o.tiling_preset)==="COLUMN"?1:2),[o==null?void 0:o.width,o==null?void 0:o.tiling_preset]),u=l.useMemo(()=>((o==null?void 0:o.height)??1024)*((o==null?void 0:o.tiling_preset)==="ROW"?1:2),[o==null?void 0:o.height,o==null?void 0:o.tiling_preset]),[h,p]=l.useState(e&&(o==null?void 0:o.tiling_preset)==="COLUMN"?d/window.innerWidth:Math.sqrt(Cx*(e?2:1))),g=l.useMemo(()=>1/h*d,[h,d]),m=l.useMemo(()=>1/h*u,[h,u]),v=l.useMemo(()=>(o==null?void 0:o.tiling_preset)==="COLUMN"?Math.min(e?window.innerWidth:window.innerWidth-420,g):"100%",[o==null?void 0:o.tiling_preset,g,e]),x=l.useMemo(()=>(o==null?void 0:o.tiling_preset)==="ROW"?m:"100%",[o==null?void 0:o.tiling_preset,m]);return r.jsxs(FL,{children:[r.jsx(DL,{onMouseDown:y=>y.stopPropagation(),sx:{height:x,width:v,borderRadius:e?0:2,background:`url(${n})`,backgroundSize:g,backgroundPosition:(o==null?void 0:o.tiling_preset)==="ROW"?`${c.x}px center`:(o==null?void 0:o.tiling_preset)==="COLUMN"?`center ${c.y}px`:`${c.x}px ${c.y}px`}}),r.jsx(NL,{onMouseDown:y=>y.stopPropagation(),sx:{height:x,width:v},children:r.jsx(Xa,{fillSpace:!0,hideImage:!0})}),r.jsx(BL,{playing:a,setPlaying:s,tileCount:h,setTileCount:p})]})},NL=b("div")({height:"100%",width:"100%",cursor:"pointer",position:"absolute",objectFit:"contain",userSelect:"none",MozWindowDragging:"no-drag",WebkitUserDrag:"none",zIndex:1,maxHeight:"100%",maxWidth:"100%"}),DL=b("div")({cursor:"pointer",backgroundRepeat:"repeat",transition:"background-position 201ms linear",zIndex:0,maxHeight:"100%",maxWidth:"100%"}),FL=b(C)({width:"100%",height:"100%",position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),zL=()=>{const{back:t}=l.useContext($e),{bannerHeight:e}=l.useContext(zo);return r.jsx(UL,{sx:{top:84+e,left:104},children:r.jsx(Be,{icon:r.jsx(Uo,{color:"#fff"}),onClick:()=>{t()}})})},UL=b(C)({position:"fixed",zIndex:2,backgroundColor:f("glassBackground"),"&:hover":{backgroundColor:f("glassBackgroundHover")},"&:active":{backgroundColor:f("glassBackgroundPressed")},borderRadius:8}),Sx=()=>{var z;const{imageFileData:t,handleRemixImageFile:e,handleEditImageFile:n,handleShareImageFile:o,handleImageFilePrivateToggle:i,handleDeleteImageFile:a,handleDescribeImageFile:s,handleCanvasImageFile:c,isCreator:d,creator:u,isSuperResDisabled:h,feedData:p,isSuperRes:g,isBgRemovedImage:m,isEditedImage:v,isUploadedImage:x,isMagicFillResultImage:y,handleImageFileRemoveBg:_}=l.useContext(Ln),{loadingDescription:w,setGenerationInputMode:I,createCanvasLocked:R}=l.useContext(ye),{userProfileState:S,subscriptionStatus:E,hasAccessToSuperRes:N,hasAccessToEditor:k,hasAccessToRemoveBg:A}=l.useContext(ge),[D,O]=l.useState(!1),L=()=>{Xe({eventKey:"BLOCK_USER_CLICK_FROM_COLUMN_VIEW",metaData:{}})},{menuOption:P}=lu({user_id:t==null?void 0:t.user.user_id,user_handle:t==null?void 0:t.user.display_handle,trackEvent:L}),{menuOption:G}=au({getTileFileDownloadName:void 0,assetId:t==null?void 0:t.image_id,assetType:"image",modelVariant:"",modelVariantExperiment:"",loadingCallback:void 0}),{showPayWallModel:B}=$t(),M=l.useMemo(()=>{var F,T,j;return[[{icon:r.jsx(Va,{color:f("menuAction"),width:18,height:18}),text:"Remix",onClick:()=>{Xe({eventKey:"REMIX_CLICK_FROM_ZOOMIN_VIEW_MENU",metaData:{selfGeneration:d}}),I("remix"),e()}},{hidden:!!w,icon:w?r.jsx(co,{size:18,sx:{color:f("menuActionDisabled")}}):r.jsx(ti,{color:f("menuAction"),width:18,height:18}),text:w?"Describing...":"Describe",onClick:()=>{Xe({eventKey:"DESCRIBE_FROM_ZOOM_IN_PAGE"}),s()}},{icon:r.jsx($a,{color:f(h?"menuActionDisabled":"menuAction"),width:18,height:18}),text:"Upscale",onClick:()=>{Xe({eventKey:"UPSCALE_CLICK_FROM_ZOOM_IN_PAGE"}),N?(I("upscale"),e()):B("SUPER_RES")},paywallLock:!N,disabled:h,tooltipContent:h?gs:void 0},m?{icon:r.jsx(ni,{color:f("menuAction"),width:18,height:18}),text:"Edit background",onClick:()=>{Xe({eventKey:"EDIT_BG_CLICK",metaData:{from:"ZOOM_IN_PAGE"}}),A?c("edit_bg"):B("REMOVE_BACKGROUND")},paywallLock:!A,new:!0}:{icon:r.jsx(ni,{color:f("menuAction"),width:18,height:18}),text:"Remove background",onClick:()=>{Xe({eventKey:"REMOVE_BG_CLICK",metaData:{from:"ZOOM_IN_PAGE"}}),A?_():B("REMOVE_BACKGROUND")},paywallLock:!A,new:!0},{icon:r.jsx(hs,{color:f("menuAction"),width:18,height:18}),text:"Open in Canvas",onClick:()=>{Xe({eventKey:"CANVAS_CLICK_FROM_ZOOM_IN"}),c()},beta:!0,paywallLock:R},{icon:r.jsx(fs,{color:f("menuAction"),width:18,height:18}),text:"Edit in Editor",onClick:()=>{if(Xe({eventKey:"GENERATION_EDIT_CLICK_FROM_ZOOM_IN",metaData:{selfGeneration:d}}),!k){B("EDITOR");return}n()},paywallLock:!k}],...d&&((F=E==null?void 0:E.subscriptionQuota)!=null&&F.privateGeneration)?[[{icon:t!=null&&t.private?r.jsx(us,{color:f("menuAction"),width:18,height:18}):r.jsx(Ka,{color:f("menuAction"),width:18,height:18}),text:t!=null&&t.private?"Make public":"Make private",onClick:()=>{i()}}]]:[],[G,{icon:r.jsx(j1,{color:f("menuAction"),width:18,height:18}),text:"Share",onClick:()=>{o()}}],...(t==null?void 0:t.user.display_handle)===(S==null?void 0:S.displayHandle)?[]:[[P]],...(T=E==null?void 0:E.subscriptionQuota)!=null&&T.privateGeneration&&d?[[{hidden:!((j=E==null?void 0:E.subscriptionQuota)!=null&&j.privateGeneration&&d),icon:r.jsx(ps,{color:f("menuAction"),width:18,height:18}),text:"Delete",onClick:()=>{O(!0)},danger:!0}]]:[]]},[h,N,m,A,R,k,w,d,(z=E==null?void 0:E.subscriptionQuota)==null?void 0:z.privateGeneration,t==null?void 0:t.private,t==null?void 0:t.user.display_handle,G,S==null?void 0:S.displayHandle,P,I,e,B,_,c,n,s,i,o]);return r.jsxs(r.Fragment,{children:[r.jsxs(GL,{children:[r.jsx(If,{children:u&&(p==null?void 0:p.creation_time_float)&&r.jsx(B1,{creator:u,creationTimeFloat:p.creation_time_float,isEditedImage:v,isUploadedImage:x,isSuperRes:g,isBgRemovedImage:m,isMagicFillResultImage:y})}),r.jsx(If,{children:r.jsx(di,{options:M,horizontal:!0})})]}),r.jsx(Ja,{open:D,onCancel:()=>O(!1),onConfirm:()=>{O(!1),a()}})]})},GL=b(C)({width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",minHeight:40}),If=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"}),Rx=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{imageFileData:n,imageAspectRatioNumber:o,handleDescribeImageFile:i,handleRemixImageFile:a,isSuperResDisabled:s,isCreator:c,handleImageFilePrivateToggle:d,handleCanvasImageFile:u,handleImageFileRemoveBg:h,description:p,useDescriptionAsPrompt:g,parentSrc:m,shouldHideParent:v}=l.useContext(Ln),{setGenerationInput:x,generationInput:y,setGenerationInputMode:_}=l.useContext(ye),{navigate:w,getBrowsingData:I}=l.useContext($e),R=Ee(),[S,E]=l.useState(!1),{aspect_ratio:N,edit_parent:k}=n??{},A=l.useMemo(()=>{var P,G;return k!=null&&k.upload_parent?oe.IMAGE.replace(":image_id",k==null?void 0:k.upload_parent.image_id):(P=k==null?void 0:k.variation_parent)!=null&&P.request_id?oe.GENERATION.replace(":request_id",(G=k==null?void 0:k.variation_parent)==null?void 0:G.request_id).replace(":image_index","0"):void 0},[k==null?void 0:k.variation_parent,k==null?void 0:k.upload_parent]),D=l.useMemo(()=>N,[N]),O=l.useMemo(()=>{if(n!=null&&n.width&&(n!=null&&n.height))return`(${n==null?void 0:n.width} x ${n==null?void 0:n.height})`},[n==null?void 0:n.width,n==null?void 0:n.height]);l.useEffect(()=>{var P;e||(P=I())!=null&&P.yPosition||window.scrollTo(0,0)},[e,I]);const L=l.useCallback(()=>{p&&(R({eventKey:"COPY_DESCRIPTION_FROM_ZOOMIN_VIEW"}),navigator.clipboard.writeText(p),E(!0),setTimeout(()=>E(!1),2e3))},[p,R]);return n?r.jsxs(WL,{children:[!e&&r.jsxs(r.Fragment,{children:[r.jsx(C,{minHeight:16}),r.jsx(Sx,{}),r.jsx(C,{minHeight:16}),r.jsx(ua,{isCreator:c,isPrivate:!!n.private,isSuperResDisabled:s,isGeneration:!1,handleDescribe:i,handleRemix:()=>{_("remix"),a()},handleUpscale:()=>{_("upscale"),a()},toggleVisibility:d,handleOpenInCanvas:u,handleMagicFill:()=>u("magic_fill"),handleExtend:()=>u("extend"),handleRemoveBg:h,handleEditBg:()=>u("edit_bg"),handleUsePrompt:p?g:void 0,isEditBackgroundDisabled:v,isBackgroundRemovedImage:n.upload_type==="background_removed_image"})]}),p&&r.jsxs(r.Fragment,{children:[r.jsxs(Ri,{marginTop:4,children:[r.jsx(Sf,{children:r.jsx(Xt,{children:"Description"})}),r.jsxs(Sf,{children:[r.jsx(Yt,{onClick:()=>{R({eventKey:"RETRY_DESCRIPTION_CLICK_FROM_ZOOMIN_VIEW",metaData:{response_id:(n==null?void 0:n.image_id)??""}}),x({...y,prompt:p,timestamp:Date.now()})},icon:r.jsx(Ko,{color:f("outlinedButtonText")}),tooltip:"Use"}),r.jsx(C,{width:8}),r.jsx(Yt,{onClick:()=>L(),icon:S?r.jsx($L,{}):r.jsx(qr,{color:f("outlinedButtonText")}),tooltip:S?"Copied":"Copy"})]})]}),r.jsx(Ti,{defaultExpanded:!0,showRatingActions:!0,content:p}),r.jsx(lr,{})]}),!!m&&!!A&&r.jsxs(r.Fragment,{children:[r.jsx(Xt,{marginTop:4,children:"Parent"}),r.jsx(HL,{href:A,onClick:P=>{var G;P.preventDefault(),!v&&(R({eventKey:"PARENT_CLICK"}),w({...mt(A),loadingGenerationState:{aspectRatioNumber:o,initialResponseId:(G=k==null?void 0:k.variation_parent)==null?void 0:G.response_id}}))},children:r.jsx(qL,{src:m,sx:{cursor:v?"not-allowed":"pointer"}})})]}),r.jsx(Xt,{marginTop:4,children:"Resolution"}),r.jsxs(Mn,{marginTop:1,children:[D," ",r.jsx(T1,{children:O})]}),!!n.creation_time_float&&r.jsxs(r.Fragment,{children:[r.jsx(Xt,{marginTop:4,children:"Date created"}),r.jsx(Mn,{marginTop:1,children:nd(n.creation_time_float)})]}),r.jsx(C,{height:40})]}):null},HL=b("a")({position:"relative",width:"fit-content"}),qL=b("img")(()=>({width:64,height:64,marginTop:8,borderRadius:4,backgroundColor:f("border"),objectFit:"cover"})),WL=b(C)({width:"100%",flex:1,display:"flex",flexDirection:"column",padding:16,paddingTop:0,maxHeight:"100%",overflow:"auto"}),Sf=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",alignSelf:"center"}),$L=b(eu)(()=>({fontSize:16,color:f("primary")})),VL=t=>{const{marginBottom:e,callback:n}=t;l.useEffect(()=>{const o=()=>{window.innerHeight+window.scrollY>=document.documentElement.scrollHeight-(e??16)&&n()};return window.addEventListener("scroll",o),()=>{window.removeEventListener("scroll",o)}},[n,e])},Rf=10,KL=(t=()=>{},e=300)=>{const n=l.useRef(null),o=l.useRef(!1),i=l.useRef(0),a=l.useRef(0),s=l.useCallback(u=>{if(u.touches.length===1){const{clientX:h,clientY:p}=u.touches[0];i.current=h,a.current=p,o.current=!0,n.current=setTimeout(()=>{o.current&&t()},e)}},[t,e]),c=l.useCallback(u=>{if(u.touches.length===1){const{clientX:h,clientY:p}=u.touches[0],g=Math.abs(h-i.current),m=Math.abs(p-a.current);(g>Rf||m>Rf)&&(o.current=!1,n.current&&clearTimeout(n.current))}},[]),d=l.useCallback(()=>{o.current=!1,n.current&&clearTimeout(n.current)},[]);return l.useEffect(()=>()=>{n.current&&clearTimeout(n.current)},[]),{onTouchStart:s,onTouchMove:c,onTouchEnd:d}},Nn=l.createContext({imageData:void 0,imageId:void 0,activeResponseId:void 0,activeResponse:void 0,backgroundPosition:{x:0,y:0},setPlaying:()=>{},playing:!1,handleLike:()=>{},handleAutoLike:()=>{},showDoubleTapIndicator:!1,hover:!1,setHover:()=>{},handleRemix:()=>{},isImageOwner:!1,handleImageDataUpdate:()=>{},isCompletedImage:!1,isImageSelected:!1,isBackgroundRemovedImage:!1,handleSelect:()=>{},handleUsePrompt:()=>{},showCreatorProfile:!1,selectable:!1,height:0,handleRemoveBackgroundClick:()=>{}}),JL=t=>{var H;const{imageData:e,activeResponseIndex:n,showCreatorProfile:o,selectable:i,children:a,height:s,hoverToolbar:c,showAllImages:d}=t,{decorateGeneration:u,setGenerationDecoration:h,navigate:p}=l.useContext($e),{setGenerationInputMode:g,addImagePrompt:m,setGenerationInput:v,generationInput:x,setSuggestions:y,openCanvas:_}=l.useContext(ye),{userProfileState:w,visionApi:I,hasAccessToRemoveBg:R}=l.useContext(ge),{selectedImages:S,selectedRequests:E,toggleSelectImage:N,toggleSelectRequest:k,setSelectionModeActivated:A}=l.useContext(Ro),D=Ee(),{setBackdropLoading:O}=l.useContext(Do),{showPayWallModel:L}=$t(),[P,G]=l.useState(u(e)),[B,M]=l.useState(!1),[z,F]=l.useState(!1);l.useEffect(()=>{G(u(e))},[u,e]);const T=l.useMemo(()=>P==null?void 0:P.image_id,[P==null?void 0:P.image_id]),j=l.useMemo(()=>{if(n!==void 0&&(P!=null&&P.responses)&&(P!=null&&P.responses[n]))return P==null?void 0:P.responses[n].response_id;if(P!=null&&P.cover_response_id)return P==null?void 0:P.cover_response_id},[n,P==null?void 0:P.cover_response_id,P==null?void 0:P.responses]),Z=l.useMemo(()=>{var me;if(j)return(me=P.responses)==null?void 0:me.find(ne=>ne.response_id===j)},[j,P.responses]),{playing:ee,setPlaying:te,backgroundPosition:$}=_x({tileType:P==null?void 0:P.tiling_preset,responseId:j,speed:"slow"}),X=l.useMemo(()=>{var me;return!!(w!=null&&w.userId)&&(w==null?void 0:w.userId)===((me=P==null?void 0:P.user)==null?void 0:me.user_id)},[(H=P==null?void 0:P.user)==null?void 0:H.user_id,w==null?void 0:w.userId]),W=l.useMemo(()=>P.upload_type==="background_removed_image",[P.upload_type]),Y=l.useCallback(me=>{h(me),G(me)},[h]),{handleLikeGeneration:q}=R1({generationData:j?P:void 0,targetResponseId:j,onLikeCompleted:({generationData:me,liked:ne})=>{ne&&(F(!0),setTimeout(()=>F(!1),1500)),Y(me)},eventKey:"LIKE_CLICK_FROM_COLUMN_VIEW"}),V=l.useCallback(()=>{X||q(!0)},[q,X]),Q=l.useCallback(()=>{D({eventKey:"REMIX_CLICK_FROM_COLUMN_VIEW"}),j?(V(),g("remix"),m({response_id:j,parent:P})):T&&(g("remix"),v({...x,variation_input:{image_id:T,private:!!P.private},aspectRatio:P.aspect_ratio,timestamp:Date.now(),imageParent:P}))},[j,m,x,V,P,T,v,g,D]),K=l.useMemo(()=>!!T||!!(j&&P.is_completed),[j,P.is_completed,T]),ae=l.useMemo(()=>!!(P!=null&&P.cover_response_id)&&E.has(P.cover_response_id)||!!T&&S.has(T),[P==null?void 0:P.cover_response_id,T,S,E]),ce=l.useCallback(()=>{var me;A(!0),P!=null&&P.request_id&&(P!=null&&P.cover_response_id)&&(P!=null&&P.responses)&&k({requestId:P.request_id,coverResponseId:P.cover_response_id,responseIds:(me=P==null?void 0:P.responses)==null?void 0:me.map(ne=>ne.response_id),downloadName:dd(P.user_prompt)}),T&&N({imageId:T,downloadName:T})},[P,T,A,N,k]),ve=l.useCallback(()=>{if(!P||!Z)return;V();const me=Z.prompt??P.user_prompt;if(me&&rs(x.model_version)){const ne=La(me);y(ne.styles),v({...x,prompt:ne.prompt,timestamp:Date.now()})}else v({...x,prompt:me,timestamp:Date.now()})},[Z,x,V,P,v,y]),se=l.useCallback(async()=>{if(!R){L("REMOVE_BACKGROUND");return}if(I){if(O(!0),W)T&&_({imageId:T,title:P.user_prompt},"edit_bg");else try{let me;if(j?(V(),me={postRemoveImageBackgroundRequest:{assetType:Qr.Response,assetId:j}}):T&&(me={postRemoveImageBackgroundRequest:{assetType:Qr.Upload,assetId:T}}),!me)throw new Error;const ne=await(I==null?void 0:I.removeImageBackground(me));if(ne!=null&&ne.backgroundRemovedImageId){const ue=oe.IMAGE.replace(":image_id",ne.backgroundRemovedImageId);p({...mt(ue)})}else throw new Error("remove bg failed")}catch{D({eventKey:"BG_REMOVAL_FAILURE"})}O(!1)}},[j,V,R,P.user_prompt,T,W,p,_,O,L,D,I]);return r.jsx(Nn.Provider,{value:{...t,imageId:T,activeResponseId:j,activeResponse:Z,backgroundPosition:$,setPlaying:te,playing:ee,imageData:P,showDoubleTapIndicator:z,handleLike:q,handleAutoLike:V,handleRemix:Q,hover:B,setHover:M,isImageOwner:X,handleImageDataUpdate:Y,isCompletedImage:K,isImageSelected:ae,handleSelect:ce,handleUsePrompt:ve,showCreatorProfile:o,selectable:i,height:s,hoverToolbar:c,showAllImages:d,isBackgroundRemovedImage:W,handleRemoveBackgroundClick:se},children:a})};function XL({width:t,height:e,color:n}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??22,height:e??22,fill:"none",viewBox:"0 0 22 22",children:[r.jsx("g",{children:n?r.jsx("path",{fill:n,d:"M2.75 5.73a2.98 2.98 0 012.98-2.98h10.54a2.98 2.98 0 012.98 2.98v10.54a2.98 2.98 0 01-2.98 2.98H5.73a2.98 2.98 0 01-2.98-2.98V5.73zm2.98-1.605c-.887 0-1.605.718-1.605 1.604v10.542c0 .886.718 1.604 1.604 1.604h10.542c.886 0 1.604-.718 1.604-1.604V5.729c0-.886-.718-1.604-1.604-1.604H5.729z"}):r.jsx("g",{filter:"url(#filter0_d_1674_2703)",children:r.jsx("path",{fill:"#fff",d:"M2.75 5.73a2.98 2.98 0 012.98-2.98h10.54a2.98 2.98 0 012.98 2.98v10.54a2.98 2.98 0 01-2.98 2.98H5.73a2.98 2.98 0 01-2.98-2.98V5.73zm2.98-1.605c-.887 0-1.605.718-1.605 1.604v10.542c0 .886.718 1.604 1.604 1.604h10.542c.886 0 1.604-.718 1.604-1.604V5.729c0-.886-.718-1.604-1.604-1.604H5.729z"})})}),r.jsx("defs",{children:r.jsxs("filter",{id:"filter0_d_1674_2703",width:"16.5",height:"17.5",x:"2.75",y:"2.75",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[r.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),r.jsx("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),r.jsx("feOffset",{dy:"1"}),r.jsx("feComposite",{in2:"hardAlpha",operator:"out"}),r.jsx("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.54 0"}),r.jsx("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1674_2703"}),r.jsx("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_1674_2703",result:"shape"})]})})]})}function YL({width:t,height:e}){return r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??22,height:e??22,fill:"none",viewBox:"0 0 22 22",children:r.jsxs("g",{children:[r.jsx("path",{fill:"#FF3D59",d:"M5.73 2.75a2.98 2.98 0 00-2.98 2.98v10.54a2.98 2.98 0 002.98 2.98h10.54a2.98 2.98 0 002.98-2.98V5.73a2.98 2.98 0 00-2.98-2.98H5.73z"}),r.jsx("path",{fill:"#fff",d:"M9.649 14.69l6.191-6.183a.687.687 0 00-.972-.973l-5.705 5.698-2.03-2.03a.687.687 0 10-.973.971l2.517 2.517a.688.688 0 00.972 0z"})]})})}const xs=t=>{const{label:e,onClick:n,fitContentWidth:o,disablePadding:i,selected:a}=t,{hoverToolbar:s}=l.useContext(Nn);return r.jsx(QL,{disableRipple:!0,onClick:n,sx:{width:o?"fix-content":40,padding:i?0:"8px",...s?{color:"#fff",fill:"#fff"}:{backgroundColor:a?"#DCDCFF21":"transparent",backdropFilter:a?"blur(3px)":void 0}},children:e})},QL=b(gt)({minHeight:0,minWidth:0,height:40,borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"auto","&:hover":{backgroundColor:"#DCDCFF21",backdropFilter:"blur(3px)"},maxWidth:"100%"}),ZL=()=>{const t=Ee(),{selectionModeActivated:e}=l.useContext(Ro),{hover:n,isCompletedImage:o,isImageSelected:i,handleSelect:a}=l.useContext(Nn);return!o||!i&&!e&&!n&&!matchMedia("(hover: none)").matches||!i&&!e&&matchMedia("(hover: none)").matches?null:r.jsx(eN,{children:r.jsx(xs,{onClick:s=>{s.stopPropagation(),s.preventDefault(),t({eventKey:"CHECKBOX_SELECT_CLICK_FROM_COLUMN"}),a()},label:i?r.jsx(YL,{}):r.jsx(XL,{})})})},eN=b("div")({position:"absolute",top:4,left:4}),tN=()=>{const t=Ee(),{imageData:e,playing:n,setPlaying:o,isCompletedImage:i,isImageSelected:a}=l.useContext(Nn),{selectionModeActivated:s}=l.useContext(Ro);return!(e!=null&&e.tiling_preset)||!i||a||s?null:r.jsx(nN,{children:r.jsx(xs,{onClick:c=>{c.stopPropagation(),c.preventDefault(),t({eventKey:"TILE_PLAY_CLICK_FROM_COLUMN"}),o(!n)},label:n?r.jsx(wx,{color:"#fff"}):r.jsx(bx,{color:"#fff"})})})},nN=b("div")({position:"absolute",top:4,right:4}),oN=()=>{const{showDoubleTapIndicator:t}=l.useContext(Nn);return t?r.jsx(rN,{children:r.jsx(gx,{})}):null},rN=b("div")({position:"absolute",left:0,right:0,bottom:0,top:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:"none"}),Tx=()=>{var h,p,g;const t=Ee(),e=we(),n=xe(e.breakpoints.down("md")),{navigate:o}=l.useContext($e),{imageData:i,hoverToolbar:a}=l.useContext(Nn),s=l.useMemo(()=>{var m,v;return(m=i==null?void 0:i.user)!=null&&m.badge?(v=i==null?void 0:i.user)==null?void 0:v.badge:void 0},[(h=i==null?void 0:i.user)==null?void 0:h.badge]),c=l.useMemo(()=>{var m;return(m=i==null?void 0:i.user)==null?void 0:m.photo_url},[(p=i==null?void 0:i.user)==null?void 0:p.photo_url]),d=l.useMemo(()=>{var m;return(m=i==null?void 0:i.user)==null?void 0:m.display_handle},[(g=i==null?void 0:i.user)==null?void 0:g.display_handle]),u=l.useMemo(()=>i!=null&&i.creation_time_float?td(i==null?void 0:i.creation_time_float,n):"",[i==null?void 0:i.creation_time_float,n]);return r.jsx(xs,{fitContentWidth:!0,disablePadding:!0,onClick:m=>{m.stopPropagation(),m.preventDefault(),t({eventKey:"USER_PROFILE_CLICK_FROM_COLUMN_VIEW"}),d&&o(oe.PROFILE.replace(":uhandle",d))},label:r.jsxs(iN,{sx:{paddingRight:n?0:"8px"},children:[r.jsx(ci,{src:c,size:"sm",badge:s}),r.jsxs(sN,{sx:a?{color:"#FFF",textShadow:"0.5px 1px 0px rgba(0, 0, 0, 0.42)"}:{color:f("primary")},children:[r.jsx(aN,{children:d}),r.jsx(lN,{children:u})]})]})})},iN=b(C)({display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:8,paddingLeft:"4px",maxWidth:"100%"}),sN=b(C)({display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0}),aN=b(le)({fontSize:14,fontWeight:600,lineHeight:"20px",letterSpacing:"-0.56px",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:"100%",minWidth:0}),lN=b(le)({fontSize:12,fontWeight:400,lineHeight:"18px",letterSpacing:"-0.12px",marginTop:-4});function cN({width:t,height:e}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??22,height:e??22,fill:"none",viewBox:"0 0 22 22",children:[r.jsx("g",{filter:"url(#filter0_d_1779_39116)",children:r.jsx("path",{fill:"#FF3D59",d:"M11.752 5.115l-.753.754-.754-.755a4.927 4.927 0 00-6.968 6.968l7.237 7.237a.688.688 0 00.972 0l7.243-7.238a4.931 4.931 0 00-6.978-6.966z"})}),r.jsx("defs",{children:r.jsxs("filter",{id:"filter0_d_1779_39116",width:"18.837",height:"16.852",x:"1.833",y:"3.669",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[r.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),r.jsx("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),r.jsx("feOffset",{dx:"0.5",dy:"1"}),r.jsx("feComposite",{in2:"hardAlpha",operator:"out"}),r.jsx("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.42 0"}),r.jsx("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1779_39116"}),r.jsx("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_1779_39116",result:"shape"})]})})]})}function dN({width:t,height:e}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??22,height:e??22,fill:"none",viewBox:"0 0 22 22",children:[r.jsx("g",{children:r.jsx("g",{filter:"url(#filter0_d_1709_283)",children:r.jsx("path",{fill:"#fff",d:"M11.752 5.115l-.753.754-.754-.755a4.927 4.927 0 00-6.968 6.968l7.237 7.237a.688.688 0 00.972 0l7.243-7.238a4.931 4.931 0 00-6.978-6.966zm6.002 5.996L11 17.861 4.25 11.11a3.552 3.552 0 015.023-5.024l1.245 1.245a.688.688 0 00.983-.012l1.224-1.232a3.556 3.556 0 015.03 5.024z"})})}),r.jsx("defs",{children:r.jsxs("filter",{id:"filter0_d_1709_283",width:"18.337",height:"16.852",x:"1.833",y:"3.669",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[r.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),r.jsx("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),r.jsx("feOffset",{dy:"1"}),r.jsx("feComposite",{in2:"hardAlpha",operator:"out"}),r.jsx("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.42 0"}),r.jsx("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1709_283"}),r.jsx("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_1709_283",result:"shape"})]})})]})}const Ex=()=>{const{handleLike:t,activeResponse:e,isCompletedImage:n,hoverToolbar:o}=l.useContext(Nn);return!e||!n?null:r.jsx(Rt,{content:e!=null&&e.self_like?"Liked":"Like",size:"small",children:r.jsx(C,{position:"relative",children:r.jsx(xs,{fitContentWidth:!0,onClick:i=>{i.stopPropagation(),i.preventDefault(),t()},label:r.jsxs(uN,{children:[e.num_likes>0&&r.jsx(hN,{sx:o?{color:"#fff",textShadow:"0px 1px 0px rgba(0, 0, 0, 0.54)"}:{},children:_0(e.num_likes)}),e!=null&&e.self_like?o?r.jsx(cN,{width:22,height:22}):r.jsx(Dd,{width:22,height:22,color:f("IdeogramPink")}):o?r.jsx(dN,{width:22,height:22}):r.jsx(A1,{width:22,height:22,color:f("quietButtonText")})]})})})})},uN=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:2}),hN=b(le)(()=>({fontSize:12,fontWeight:600,lineHeight:"14px",letterSpacing:"-0.28px",textAlign:"center"}));function pN({width:t,height:e}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t??22,height:e??22,fill:"none",viewBox:"0 0 22 22",children:[r.jsx("g",{children:r.jsx("g",{filter:"url(#filter0_d_1709_4263)",children:r.jsx("path",{fill:"#fff",d:"M7.104 11a1.604 1.604 0 11-3.208 0 1.604 1.604 0 013.208 0zm5.5 0a1.604 1.604 0 11-3.208 0 1.604 1.604 0 013.208 0zm3.896 1.604a1.604 1.604 0 100-3.208 1.604 1.604 0 000 3.208z"})})}),r.jsx("defs",{children:r.jsxs("filter",{id:"filter0_d_1709_4263",width:"14.208",height:"4.208",x:"3.896",y:"9.396",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[r.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),r.jsx("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),r.jsx("feOffset",{dy:"1"}),r.jsx("feComposite",{in2:"hardAlpha",operator:"out"}),r.jsx("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.42 0"}),r.jsx("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1709_4263"}),r.jsx("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_1709_4263",result:"shape"})]})})]})}const kx=()=>{var De,Ye,nt,ct,he;const t=Ee(),{showPayWallModel:e}=$t(),{hasAccessToSuperRes:n,hasAccessToEditor:o,subscriptionStatus:i,hasAccessToRemoveBg:a}=l.useContext(ge),{handleRemix:s,imageData:c,activeResponseId:d,imageId:u,isImageOwner:h,activeResponse:p,handleLike:g,handleImageDataUpdate:m,isCompletedImage:v,hover:x,handleUsePrompt:y,hoverToolbar:_,isBackgroundRemovedImage:w,handleRemoveBackgroundClick:I,handleAutoLike:R}=l.useContext(Nn),{loadingDescription:S,handleDescribeImage:E,setGenerationInputMode:N,addImagePrompt:k,generationInput:A,setGenerationInput:D,openEditor:O,openCanvas:L,createCanvasLocked:P}=l.useContext(ye),[G,B]=l.useState(!1),[M,z]=l.useState(!1),F=l.useMemo(()=>(c==null?void 0:c.tiling_preset)==="COLUMN"||(c==null?void 0:c.tiling_preset)==="ROW",[c==null?void 0:c.tiling_preset]),T=l.useCallback(Fe=>{if(Fe===hn.X1)return"1 x 1";if(Fe===hn.X2)return`2 x ${F?1:2}`;if(Fe===hn.X4)return`4 x ${F?1:4}`;if(Fe===hn.X8)return`8 x ${F?1:8}`},[F]),j=l.useMemo(()=>d??u,[d,u]),Z=l.useMemo(()=>d?c!=null&&c.tiling_preset?"tile":"generation":"image",[d,c==null?void 0:c.tiling_preset]),ee=(De=c==null?void 0:c.responses)==null?void 0:De.find(Fe=>Fe.response_id===d),te=(ee==null?void 0:ee.model_variant)??"",$=(c==null?void 0:c.experiment)??"",{menuOption:X}=au({getTileFileDownloadName:T,assetId:j,assetType:Z,modelVariant:te,modelVariantExperiment:$,loadingCallback:void 0,handleAutoLikeGeneration:R}),{menuOption:W}=lu({user_id:(Ye=c==null?void 0:c.user)==null?void 0:Ye.user_id,user_handle:(nt=c==null?void 0:c.user)==null?void 0:nt.display_handle,trackEvent:()=>{t({eventKey:"BLOCK_USER_CLICK_FROM_COLUMN_VIEW",metaData:{}})}}),Y=l.useMemo(()=>(c==null?void 0:c.can_upscale)===!1,[c==null?void 0:c.can_upscale]),q=l.useCallback(()=>{if(t({eventKey:"UPSCALE_CLICK_FROM_COLUMN_VIEW"}),!n){e("SUPER_RES");return}if(d&&c)h||g(!0),N("upscale"),k({response_id:d,parent:c});else if(u&&c){N("upscale");const Fe={...A,variation_input:{image_id:u,private:!!c.private},aspectRatio:c.aspect_ratio,imageParent:c,timestamp:Date.now()};D(Fe)}},[t,n,d,c,u,e,h,N,k,g,A,D]),V=l.useCallback(()=>{t({eventKey:"CANVAS_CLICK_FROM_COLUMN"}),d&&(c!=null&&c.request_id)?(R(),L({requestId:c.request_id,responseId:d,title:c.user_prompt})):u&&L({imageId:u,title:c==null?void 0:c.user_prompt})},[d,R,c==null?void 0:c.request_id,c==null?void 0:c.user_prompt,u,L,t]),Q=l.useCallback(()=>{var Fe,Ge;if(t({eventKey:"GENERATION_EDIT_CLICK_FROM_COLUMN"}),!o){e("EDITOR");return}d&&c?(R(),O({responseId:d,defaultPrivate:!!c.private&&!!((Fe=i==null?void 0:i.subscriptionQuota)!=null&&Fe.privateGeneration),parentInfo:{parent_request_id:c.request_id,parent_response_id:d,aspect_ratio:c.aspect_ratio??"1:1"}})):u&&c&&O({imageId:u,defaultPrivate:!!c.private&&!!((Ge=i==null?void 0:i.subscriptionQuota)!=null&&Ge.privateGeneration),parentInfo:{parent_image_id:u,aspect_ratio:c.aspect_ratio??"1:1"}})},[d,R,o,c,u,O,e,(ct=i==null?void 0:i.subscriptionQuota)==null?void 0:ct.privateGeneration,t]),K=l.useCallback(()=>{t({eventKey:"DESCRIBE_FROM_COLUMN"}),d?(R(),E({response_id:d})):u&&E({image_id:u})},[d,R,E,u,t]),ae=l.useCallback(async()=>{var st;if(!p||!c)return;const Fe=Ut.cloneDeep(c),Ge=(st=Fe==null?void 0:Fe.responses)==null?void 0:st.find(bt=>bt.response_id===d);if(Ge&&c.request_id){Ge.pin_on_profile=!Ge.pin_on_profile,t({eventKey:Ge.pin_on_profile?"PIN_CLICK_FROM_COLUMN":"UNPIN_CLICK_FROM_COLUMN",metaData:{modelVariant:te,experiment:$}});const bt={...Fe,private:Ge.pin_on_profile?!1:Fe.private};m(bt),await Gg({request_id:c.request_id,response_id:Ge.response_id,pin:Ge.pin_on_profile})}},[p,d,m,c,te,$,t]),ce=l.useCallback(()=>{!c||!p||(!localStorage.getItem(cu)&&c.private&&!p.pin_on_profile?B(!0):ae())},[p,ae,c]),ve=l.useCallback(async()=>{var Fe;if(c!=null&&c.request_id&&d){const Ge=Ut.cloneDeep(c),st={...Ge,private:!c.private,responses:(Fe=Ge.responses)==null?void 0:Fe.map(bt=>({...bt,pin_on_profile:!1}))};m(st),await pd({make_public:!!c.private,request_ids:[c.request_id]})}else if(u&&c){const st={...Ut.cloneDeep(c),private:!c.private};m(st),await gd({make_public:!!c.private,image_ids:[u]})}},[d,m,c,u]),se=l.useCallback(()=>{c!=null&&c.request_id?fd({request_ids:[c.request_id]}).then(()=>{m({...c,deleted:!0}),z(!1)}):u&&md({image_ids:[u]}).then(()=>{m({...c,deleted:!0}),z(!1)})},[m,c,u]),{handleRetryGeneration:H,isRetryBlockForNonSubscriptionReason:me,getRetryBlockedReason:ne}=ou({generationData:c}),ue=l.useCallback(()=>{!c||!d||H(c,d)},[c,d,H]),fe=l.useMemo(()=>c&&d?ne():void 0,[d,ne,c]),Se=l.useMemo(()=>{var Fe,Ge;return[[{icon:r.jsx(nu,{color:f("menuAction"),width:24,height:24}),text:"Retry",onClick:ue,hidden:!!u||!h||!!fe&&me(fe),paywallLock:!!fe},{hidden:!!u,icon:r.jsx(tu,{color:f("menuAction"),width:24,height:24}),text:"Use prompt",onClick:y},{icon:r.jsx("div",{children:r.jsx(Va,{width:24,height:24,color:f("menuAction")})}),text:"Remix",onClick:()=>s()},{hidden:!!S,icon:r.jsx(ti,{color:f("menuAction")}),text:"Describe",onClick:K},{icon:r.jsx($a,{width:24,height:24,color:f(Y?"menuActionDisabled":"menuAction")}),text:"Upscale",onClick:q,paywallLock:!n,disabled:Y,tooltipContent:Y?gs:void 0},{icon:r.jsx(ni,{width:24,height:24,color:f("menuAction")}),text:w?"Edit background":"Remove background",onClick:I,paywallLock:!a,new:!0},{icon:r.jsx(hs,{color:f("menuAction")}),text:"Open in Canvas",onClick:V,beta:!0,paywallLock:P},{icon:r.jsx(fs,{color:f("menuAction")}),text:"Edit in Editor",onClick:Q,paywallLock:!o}],[X],...h&&p&&c?[[{icon:p.pin_on_profile?r.jsx(M1,{color:f("menuAction")}):r.jsx(P1,{color:f("menuAction")}),text:p.pin_on_profile?"Unpin":"Pin",onClick:ce,confirmation:r.jsx(L1,{open:G,onCancel:()=>B(!1),onConfirm:()=>{ae(),B(!1)}})},{hidden:!((Fe=i==null?void 0:i.subscriptionQuota)!=null&&Fe.privateGeneration),icon:c.private?r.jsx(us,{color:f("menuAction")}):r.jsx(Ka,{color:f("menuAction")}),text:c!=null&&c.private?"Make public":"Make private",onClick:ve}]]:[],...h?[]:[[W]],...h&&((Ge=i==null?void 0:i.subscriptionQuota)!=null&&Ge.privateGeneration)?[[{icon:r.jsx(ps,{color:f("menuAction")}),text:"Delete",onClick:()=>{z(!0)},confirmation:r.jsx(Ja,{open:M,onCancel:()=>z(!1),onConfirm:se})}]]:[]]},[p,W,P,X,V,se,K,Q,s,I,ue,ae,ce,ve,q,y,o,a,n,c,u,w,h,me,S,M,G,fe,(he=i==null?void 0:i.subscriptionQuota)==null?void 0:he.privateGeneration,Y]),[je,qe]=l.useState(!1);return v?r.jsx(di,{onToggle:Fe=>qe(Fe),horizontal:!0,options:Se,buttonComponent:x||!window.matchMedia("(pointer: fine)").matches||!_?r.jsx(Rt,{content:"More",size:"small",children:r.jsx("div",{children:r.jsx(xs,{selected:je,onClick:()=>{},label:_?r.jsx(pN,{}):r.jsx(I0,{color:f("iconPrimary")})})})}):r.jsx("div",{})}):null},fN=()=>{const{isImageSelected:t,hover:e,isCompletedImage:n,showCreatorProfile:o,customBorderRadius:i}=l.useContext(Nn),{selectionModeActivated:a}=l.useContext(Ro);return a||t?null:r.jsxs(gN,{sx:{borderRadius:i,background:e&&n?"linear-gradient(180deg, rgba(0, 0, 0, 0.00) 0%, rgba(0, 0, 0, 0.02) 15%, rgba(0, 0, 0, 0.04) 25%, rgba(0, 0, 0, 0.16) 60%, rgba(0, 0, 0, 0.32) 100%)":void 0},children:[r.jsx(Tf,{children:o&&e?r.jsx(Tx,{}):r.jsx("div",{})}),r.jsxs(Tf,{children:[r.jsx(kx,{}),r.jsx(Ex,{})]})]})},gN=b(C)({position:"absolute",width:"100%",padding:4,right:0,bottom:0,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingTop:"48px",transition:"background 1000ms linear",pointerEvents:"none"}),Tf=b(C)({display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"}),mN=()=>{const{showCreatorProfile:t}=l.useContext(Nn);return r.jsxs(xN,{children:[r.jsx(Ef,{minWidth:0,justifyContent:"center",children:t?r.jsx(Tx,{}):r.jsx("div",{})}),r.jsxs(Ef,{justifyContent:"flex-start",children:[r.jsx(kx,{}),r.jsx(Ex,{})]})]})},xN=b(C)({position:"absolute",width:"100%",padding:4,paddingLeft:0,paddingRight:0,right:0,bottom:-48,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",transition:"background 1000ms linear",pointerEvents:"none",borderRadius:4}),Ef=b(C)({display:"flex",flexDirection:"row",alignItems:"center"}),vN=()=>{var u,h,p,g;const t=Ee(),{navigate:e}=l.useContext($e),{imageData:n,imageId:o,height:i,isImageSelected:a}=l.useContext(Nn),s=l.useMemo(()=>!!o||(n==null?void 0:n.request_type)==="SUPER_RES",[n==null?void 0:n.request_type,o]),c=l.useMemo(()=>o?[{link:oe.IMAGE.replace(":image_id",o),src:Pt(o,"balanced","edit")}]:[...Array(4).keys()].map(m=>{var v,x,y,_;return n!=null&&n.latest_intermediate_image_seconds&&!n.is_completed&&n.request_id?{src:Na(n.request_id,n.latest_intermediate_image_seconds,m)}:{link:n!=null&&n.request_id?oe.GENERATION.replace(":request_id",n.request_id).replace(":image_index",m.toString()):void 0,src:(x=(v=n==null?void 0:n.responses)==null?void 0:v[m])!=null&&x.response_id?Pt((_=(y=n==null?void 0:n.responses)==null?void 0:y[m])==null?void 0:_.response_id,"balanced","response"):void 0}})??[],[n==null?void 0:n.is_completed,n==null?void 0:n.latest_intermediate_image_seconds,n==null?void 0:n.request_id,n==null?void 0:n.responses,o]),d=l.useCallback(m=>{var x;t({eventKey:"GENERATION_GRID_CLICK"});const v=(x=c[m])==null?void 0:x.link;v&&e({...mt(v),generation:n??void 0})},[n,e,c,t]);return c?r.jsx(C,{width:"100%",height:i,children:r.jsxs(yN,{sx:{padding:a?"24px":0},children:[s&&r.jsx(bi,{onClick:()=>d(0),src:c[0].src,sx:{borderRadius:"4px",cursor:n!=null&&n.is_completed||o?"pointer":"progress",transition:a?"all 0.1s ease":"all 0.1s ease, background-position 201ms linear",backgroundColor:a?f("bulkSelectBackground"):"transparent"}}),!s&&r.jsxs(r.Fragment,{children:[r.jsxs(kf,{children:[r.jsx(Ds,{children:r.jsx(bi,{onClick:()=>d(0),src:(u=c[0])==null?void 0:u.src,sx:{borderRadius:0,borderTopLeftRadius:"4px",cursor:n!=null&&n.is_completed||o?"pointer":"progress",transition:a?"all 0.1s ease":"all 0.1s ease, background-position 201ms linear"}})}),r.jsx(Ds,{children:r.jsx(bi,{onClick:()=>d(1),src:(h=c[1])==null?void 0:h.src,sx:{borderRadius:0,borderBottomLeftRadius:"4px",cursor:n!=null&&n.is_completed||o?"pointer":"progress",transition:a?"all 0.1s ease":"all 0.1s ease, background-position 201ms linear"}})})]}),r.jsxs(kf,{children:[r.jsx(Ds,{children:r.jsx(bi,{onClick:()=>d(2),src:(p=c[2])==null?void 0:p.src,sx:{borderRadius:0,borderTopRightRadius:"4px",cursor:n!=null&&n.is_completed||o?"pointer":"progress",transition:a?"all 0.1s ease":"all 0.1s ease, background-position 201ms linear"}})}),r.jsx(Ds,{children:r.jsx(bi,{onClick:()=>d(3),src:(g=c[3])==null?void 0:g.src,sx:{borderRadius:0,borderBottomRightRadius:"4px",cursor:n!=null&&n.is_completed||o?"pointer":"progress",transition:a?"all 0.1s ease":"all 0.1s ease, background-position 201ms linear"}})})]})]})]})}):null},yN=b(C)(()=>({width:"100%",height:"100%",transition:"all 0.1s ease",borderRadius:4,display:"flex",alignItems:"stretch",justifyContent:"center",gap:2})),kf=b(C)({minHeight:"100%",flex:1,display:"flex",flexDirection:"column",alignItems:"stretch",justifyContent:"center",gap:2}),Ds=b(C)({width:"100%",flex:1,display:"flex",alignItems:"center",justifyContent:"center"}),bi=b("img")(()=>({objectFit:"cover",userSelect:"none",width:"100%",height:"100%",display:"block",flex:1,backgroundColor:f("bulkSelectBackground")})),wN=()=>{const{height:t,customBorderRadius:e,hoverToolbar:n}=l.useContext(Nn),o=l.useMemo(()=>e??(n?"2px":"4px"),[e,n]);return r.jsx(qa,{variant:"rectangular",sx:{minWidth:"100%",height:t,borderRadius:o,cursor:"wait"}})},bN=()=>{const t=Ee(),{imageData:e,activeResponseIndex:n,imageId:o,activeResponseId:i,backgroundPosition:a,height:s,handleLike:c,isImageSelected:d,handleSelect:u,hoverToolbar:h,customBorderRadius:p}=l.useContext(Nn),{navigate:g}=l.useContext($e),{selectionModeActivated:m}=l.useContext(Ro),v=l.useMemo(()=>{if(d&&(e!=null&&e.width)&&e.height)return(e==null?void 0:e.width)>e.height?(e==null?void 0:e.tiling_preset)==="ROW"?"200% auto":"100% auto":(e==null?void 0:e.tiling_preset)==="COLUMN"?"auto 200%":"auto 100%";if(e!=null&&e.is_completed){if(e.tiling_preset==="COLUMN")return"100% 200%";if(e.tiling_preset==="ROW")return"200% 100%";if(e.tiling_preset)return"100% 100%"}else return"100% 100%";return"100% 100%"},[e==null?void 0:e.height,e==null?void 0:e.is_completed,e==null?void 0:e.tiling_preset,e==null?void 0:e.width,d]),x=l.useMemo(()=>d?"center":`${a.x}px ${a.y}px`,[a.x,a.y,d]),y=l.useMemo(()=>{const{latest_intermediate_image_seconds:E,is_completed:N,request_id:k,tiling_preset:A}=e??{};if(E&&!N&&k)return Na(k,E,n??0);if(o)return Pt(o,"balanced","edit");if(A&&N&&i)return Pt(i,"balanced","tile");if(i&&N)return Pt(i,"balanced","response")},[e,o,i,n]),_=l.useMemo(()=>{var E;if(o)return oe.IMAGE.replace(":image_id",o);if(e!=null&&e.request_id&&e.is_completed){let N=n??((E=e.responses)==null?void 0:E.findIndex(k=>k.response_id===e.cover_response_id));return(!N||N<0)&&(N=0),oe.GENERATION.replace(":request_id",e.request_id).replace(":image_index",N.toString())}},[n,e==null?void 0:e.cover_response_id,e==null?void 0:e.is_completed,e==null?void 0:e.request_id,e==null?void 0:e.responses,o]),{onClick:w}=su(E=>{E.preventDefault(),E.stopPropagation(),t({eventKey:"DOUBLE_CLICK_LIKE_FROM_COLUMN_VIEW"}),i&&(e!=null&&e.is_completed)&&c(!0)},200,{onSingleTap:E=>{E.preventDefault(),E.stopPropagation(),t({eventKey:"GENERATION_GRID_CLICK"}),_&&g({...mt(_),generation:e??void 0})}}),[I,R]=l.useState(!1);l.useEffect(()=>{y&&(R(!1),No(y).then(()=>R(!0)))},[y]);const S=l.useMemo(()=>p??(h?"2px":"4px"),[p,h]);return y?r.jsx(C,{width:"100%",height:s,children:r.jsx(CN,{sx:{borderRadius:S,padding:d?"24px":0},children:r.jsx(RN,{sx:{borderRadius:S,...I?ha((e==null?void 0:e.width)??1024):void 0},children:r.jsx(SN,{sx:{borderRadius:S,background:`url(${y})`,backgroundSize:v,backgroundPosition:x,cursor:e!=null&&e.is_completed||o?"pointer":"progress",transition:d?"all 0.1s ease":"all 0.1s ease, background-position 201ms linear"},onError:()=>t({eventKey:"COLUMN_IMG_LOADING_FAILURE"}),onClick:m?u:w,children:r.jsx(IN,{href:_,onClick:E=>E.preventDefault(),children:r.jsx(_N,{src:y})})})})})}):r.jsx(wN,{})},CN=b(C)(()=>({width:"100%",height:"100%",transition:"all 0.1s ease",backgroundColor:f("bulkSelectBackground")})),_N=b("img")({width:"100%",height:"100%",position:"absolute",opacity:0,top:0,left:0}),IN=b("a")({width:"100%",height:"100%",display:"block",position:"relative"}),SN=b("div")({objectFit:"cover",userSelect:"none",width:"100%",height:"100%",display:"block"}),RN=b("div")({width:"100%",height:"100%"}),TN=()=>{const{imageData:t,activeResponseId:e,imageId:n,onCollapsed:o,setHover:i,isCompletedImage:a,handleSelect:s,selectable:c,hoverToolbar:d,showAllImages:u}=l.useContext(Nn),{clearGenerationInCurrentListData:h,markGenerationCollapsed:p,isGenerationCollapsed:g}=l.useContext($e),{dragSelect:m}=l.useContext(Ro),v=KL(s,500),x=l.useMemo(()=>{var E;if(!t)return!1;const S=window.location.pathname;if(pt(oe.HOME_TAB,S)||pt(oe.HOME_TAB_FILTER,S)){if(S.includes("/my-images")){if(S.includes("/pinned")&&!((E=t.responses)!=null&&E.find(N=>N.pin_on_profile)))return!0;if(S.includes("/private")&&!t.private)return!0;if(S.includes("/public")&&t.private===!0)return!0}else if(S.includes("/explore")&&t.private===!0)return!0}return!!t.deleted},[t]),[y,_]=l.useState(!1),w=l.useMemo(()=>(t==null?void 0:t.request_id)??n,[t==null?void 0:t.request_id,n]);l.useEffect(()=>{if(x){if(setTimeout(()=>{_(!0)},300),!w)return;setTimeout(()=>{o==null||o(),h(w),p(w)},600)}},[x,_,h,p,e,o,w]);const I=l.useRef(null);l.useEffect(()=>{const S=I.current;if(!(!S||!m||!a||!n&&(t!=null&&t.responses)&&t.responses.length>1))return m.addSelectables(S,!1,!1),()=>{m.removeSelectables(S,!1,!1)}},[m,t==null?void 0:t.responses,n,a]);const R=l.useMemo(()=>({"data-request-id":t==null?void 0:t.request_id,"data-cover-response-id":t==null?void 0:t.cover_response_id,"data-response-ids":t!=null&&t.responses?t==null?void 0:t.responses.map(S=>S.response_id).join(","):void 0,"data-download-name":t!=null&&t.user_prompt?dd(t.user_prompt):n,"data-image-id":n,ref:I}),[t==null?void 0:t.cover_response_id,t==null?void 0:t.request_id,t==null?void 0:t.responses,t==null?void 0:t.user_prompt,n]);return w&&g(w)?null:r.jsxs(EN,{sx:{opacity:y?.9:1},in:!y,timeout:300,onMouseEnter:()=>{matchMedia("(hover: none)").matches||i(!0)},onMouseLeave:()=>{matchMedia("(hover: none)").matches||i(!1)},...c?v:{},...c?R:{},children:[u?r.jsx(vN,{}):r.jsx(bN,{}),!u&&r.jsxs(r.Fragment,{children:[r.jsx(oN,{}),c&&r.jsx(ZL,{}),r.jsx(tN,{}),d?r.jsx(fN,{}):r.jsx(mN,{})]})]})},EN=b(Ni)({width:"100%",position:"relative"}),kN=t=>r.jsx(JL,{...t,children:r.jsx(TN,{})}),AN=t=>{const{virtualColumnData:e,selectable:n,showCreatorProfile:o,hoverToolbar:i,showAllImages:a}=t,{top:s,left:c,width:d,height:u,columnEntry:h}=e,p=l.useRef(null),{dragSelect:g}=l.useContext(Ro);l.useEffect(()=>{const v=p.current;if(!(!v||!g||!h.is_completed))return g.addSelectables(v,!1,!1),()=>{g.removeSelectables(v,!1,!1)}},[g,h.is_completed]);const m=l.useMemo(()=>({"data-request-id":h==null?void 0:h.request_id,"data-cover-response-id":h==null?void 0:h.cover_response_id,"data-response-ids":h!=null&&h.responses?h==null?void 0:h.responses.map(v=>v.response_id).join(","):void 0,"data-download-name":h!=null&&h.user_prompt?dd(h.user_prompt):h.image_id,"data-image-id":h.image_id,ref:p}),[h==null?void 0:h.cover_response_id,h.image_id,h==null?void 0:h.request_id,h==null?void 0:h.responses,h.user_prompt]);return r.jsx(jN,{sx:{transform:`translateX(${c}px) translateY(${s}px)`},width:d,height:u,...m,children:r.jsx(kN,{imageData:h,showCreatorProfile:o,selectable:n,hoverToolbar:i,showAllImages:a,height:u})},h.cover_response_id??h.image_id)},jN=b(C)({position:"absolute",top:0,left:0}),PN=t=>{const{singleColumnData:e,selectable:n,showCreatorProfile:o,hoverToolbar:i,showAllImages:a}=t;return e.map(s=>s.visible?r.jsx(AN,{virtualColumnData:s,selectable:n,showCreatorProfile:o,hoverToolbar:i,showAllImages:a},s.columnEntry.cover_response_id??s.columnEntry.image_id):null)},MN=1366,ON=t=>{const e=we(),n=xe(e.breakpoints.down("sm")),o=xe(e.breakpoints.down("md")),i=xe(e.breakpoints.down("lg")),a=xe(e.breakpoints.down("xl")),s=l.useCallback(()=>t?n?1:o||i?2:3:n?2:o||i?3:4,[t,n,o,i,a]),c=l.useMemo(()=>o?16:128,[o]),d=l.useCallback(()=>{const g=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0);let m=g-c;m=Math.min(m,MN);const v=s();return{viewportWidth:g,containerWidth:m,columnCount:v}},[c,s]),[u,h]=l.useState(d()),p=l.useCallback(()=>{h(d)},[d,h]);return l.useEffect(()=>(p(),window.removeEventListener("resize",p),window.addEventListener("resize",p),()=>{window.removeEventListener("resize",p)}),[p,n]),{columnCount:n?t?1:2:u.columnCount,containerWidth:u.containerWidth}},BN=t=>{var M;const e=we(),n=xe(e.breakpoints.down("md")),{columnData:o,containerRef:i,containerWidth:a,columnCount:s,hoverToolbar:c,showAllImages:d}=t,{isGenerationCollapsed:u,latestCollapseTimestamp:h,getBrowsingData:p,getBrowsingKey:g,saveFeedVirtualColumnData:m}=l.useContext($e),{userProfileState:v}=l.useContext(ge),{data:x}=Ve(["userProfile",v==null?void 0:v.displayHandle],()=>Oa(v.displayHandle),{enabled:!!(v!=null&&v.displayHandle),staleTime:1/0,retry:!1}),y=100,_=2,w=l.useMemo(()=>c||d?0:n?48:40,[c,n,d]),I=l.useRef(Date.now()),R=l.useCallback((z,F)=>{const T=i.current?Math.max(window.scrollY-i.current.offsetTop,0):window.scrollY,j=T+window.innerHeight,Z=T-window.innerHeight,ee=j+window.innerHeight,te=z,$=te+F;return te<ee&&te>Z||$<ee&&$>Z},[i]),S=l.useCallback(z=>{const F=new Map;return z.forEach((T,j)=>{const Z=T==null?void 0:T.at(-1),ee=Z?Z.top+Z.height:0;F.has(ee)||F.set(ee,j)}),F},[]),E=l.useCallback(z=>{const F=S(z);return F.get(Math.min(...F.keys()))??0},[S]),N=l.useCallback(z=>{const F=S(z);return Math.max(...F.keys())},[S]),k=l.useCallback(z=>{var j;if(s===0)return[];const F=((j=i.current)==null?void 0:j.getBoundingClientRect().width)??a,T=Array.from({length:s},()=>[]);return z==null||z.filter(Z=>Z.image_id?!u(Z.image_id):Z.request_id?!u(Z.request_id):!0).forEach(Z=>{let ee=Z.width,te=Z.height;if(!ee||!te){const K=Z.aspect_ratio.split(":");ee=parseFloat(K[0]),te=parseFloat(K[1])}const $=s-1,X=(F-_*$)/s,W=X/ee*te,Y=E(T),q=T.at(Y),V=q==null?void 0:q.at(-1),Q=(X+_)*Y;if(V){const K=V.top+V.height+_+w,ae={columnEntry:Z,height:W,width:X,top:K,left:Q,visible:R(K,W)};q.push(ae)}else{const K={columnEntry:Z,height:W,width:X,top:0,left:Q,visible:R(0,W)};q.push(K)}}),T},[s,i,_,E,R,u,a,w]),[A,D]=l.useState(((M=p())==null?void 0:M.feedVirtualColumnData)??(o?k(o):void 0)),O=l.useCallback(()=>{if(o===void 0){D(void 0);return}D(k(o))},[o,k]);l.useEffect(()=>{h&&O()},[h,O]);const L=l.useRef(!0);l.useEffect(()=>(L.current||O(),L.current=!1,window.removeEventListener("resize",O),window.removeEventListener("orientationchange",O),window.addEventListener("resize",O),window.addEventListener("orientationchange",O),()=>{window.removeEventListener("resize",O),window.removeEventListener("orientationchange",O)}),[O]);const P=l.useCallback(()=>{Date.now()-I.current<y||(I.current=Date.now(),D(z=>z==null?void 0:z.map(F=>F.map(T=>({...T,visible:R(T.top,T.height)})))))},[R]);l.useEffect(()=>(window.removeEventListener("scroll",P),window.addEventListener("scroll",P),()=>{window.removeEventListener("scroll",P)}),[P]),l.useEffect(()=>{A&&m(A,g())},[A,g,m]);const G=l.useMemo(()=>{if(A&&A.length)return N(A)},[A,N]);return l.useMemo(()=>({columnDataWithHeightAndPosition:A,containerHeight:G,isVirtualColumnDataReady:!!x}),[A,G,x])},LN=t=>{const{columnData:e,showCreatorProfile:n,loadingNewPage:o,selectable:i,hoverToolbar:a,showAllImages:s,emptyState:c}=t,d=we(),u=xe(d.breakpoints.down("md")),{columnCount:h,containerWidth:p}=ON(s),{setSelectionModeActivated:g}=l.useContext(Ro),m=l.useRef(null),{columnDataWithHeightAndPosition:v,containerHeight:x,isVirtualColumnDataReady:y}=BN({columnData:e,containerRef:m,containerWidth:p,columnCount:h,hoverToolbar:!!a,showAllImages:!!s}),_=l.useMemo(()=>e===void 0||!y,[e,y]);return l.useEffect(()=>{_&&g(!1)},[_,g]),r.jsxs(r.Fragment,{children:[r.jsx(Ni,{in:_,appear:!0,children:r.jsx(C,{display:"flex",justifyContent:"center",paddingTop:1,children:r.jsx(co,{size:24,sx:{color:f("primary")}})})}),r.jsxs(NN,{ref:m,marginX:u?0:1,width:p,position:"relative",height:x,children:[(e==null?void 0:e.length)===0&&!_&&!o&&(c||r.jsx(DN,{children:"No generations yet."})),v==null?void 0:v.map((w,I)=>r.jsx(PN,{singleColumnData:w,selectable:i,showCreatorProfile:n,hoverToolbar:a,showAllImages:s},`column-${I}`))]}),r.jsx(Ni,{in:o,appear:!0,children:r.jsx(C,{display:"flex",justifyContent:"center",paddingTop:4,paddingBottom:4,children:r.jsx(co,{size:24,sx:{color:f("primary")}})})})]})},NN=b(C)({display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"center",minHeight:"100dvh",paddingBottom:48}),DN=b(le)(()=>({textAlign:"center",marginTop:32,fontSize:12,color:f("informative")})),Ax=t=>{var R;const e=we(),n=xe(e.breakpoints.down("md")),o=Ee(),{creatorUserHandle:i,currentRequestId:a,profilePhoto:s,badge:c}=t,{getBrowsingKey:d,saveCurrentGenerationListData:u,getBrowsingData:h,navigate:p}=l.useContext($e),{request_id:g}=an(),[m,v]=l.useState((R=h())==null?void 0:R.generationList);l.useEffect(()=>{var S,E;(S=h())!=null&&S.generationList&&a===g&&v((E=h())==null?void 0:E.generationList)},[g,a,h]);const x=l.useMemo(()=>oe.PROFILE.replace(":uhandle",i),[i]),{data:y,refetch:_}=Ve(["userGenerations",i],()=>uh(i,0),{staleTime:1/0,retry:3,onError:S=>{S.status===403&&Lt()}});l.useEffect(()=>{v(void 0),_()},[_,i]),l.useEffect(()=>{m&&u(m,d())},[m,d,u]),l.useEffect(()=>{y&&v(y)},[y,g,v]);const{loadNextPage:w,loadingNewPage:I}=Cm({loadPage:m!==void 0?({page:S})=>uh(i,S):void 0,onNewPageLoaded:S=>{m!==void 0&&v([...m,...S])}});return VL({marginBottom:window.innerHeight*1.5,callback:()=>{!I&&m&&m.length>0&&(w==null||w())}}),r.jsxs(FN,{paddingX:1,sx:{cursor:"default",backgroundColor:n?f("solid"):"transparent"},onClick:S=>S.stopPropagation(),children:[r.jsxs(C,{display:"flex",alignItems:"center",paddingBottom:6,paddingTop:n?4:12,children:[r.jsx(Af,{paddingRight:1,children:"More from"}),r.jsxs(zN,{href:x,onClick:S=>{S.preventDefault(),p(x),o({eventKey:"USER_PROFILE_CLICK_FROM_MORE_FROM_CREATOR"})},children:[r.jsx(ci,{src:s,size:"md",badge:c}),r.jsx(Af,{paddingLeft:1,children:i})]})]}),r.jsx(LN,{columnData:m,loadingNewPage:I,hoverToolbar:!0})]})},FN=b(C)({display:"flex",flexDirection:"column",alignItems:"center",width:"100%"}),Af=b(le)(()=>({fontWeight:600,color:f("primary"),fontSize:14})),zN=b("a")({textDecoration:"none",fontWeight:700,display:"flex",alignItems:"center"}),UN=()=>{const{back:t}=l.useContext($e),{generationData:e,imageFileData:n,switchResponseIndex:o,creator:i,isTileImage:a,isSuperRes:s,isBgRemovedImage:c}=l.useContext(Ln),{generationInputOpen:d}=l.useContext(ye),{bannerHeight:u}=l.useContext(zo),[h,p]=l.useState(window.innerHeight-72-u),g=l.useCallback(()=>{p(window.innerHeight-72-u)},[u]);l.useEffect(()=>(g(),window.removeEventListener("resize",g),window.removeEventListener("load",g),window.addEventListener("resize",g),window.addEventListener("load",g),()=>{window.removeEventListener("resize",g),window.removeEventListener("load",g)}),[g]);const{image_index:m}=an();return l.useEffect(()=>{const v=x=>{if(x.stopPropagation(),x.code==="Escape"&&pt(oe.GENERATION,location.pathname))t();else if(m&&!d&&!s){const y=parseInt(m);x.code==="ArrowRight"?o((y+4+1)%4):x.code==="ArrowLeft"&&o((y+4-1)%4)}};return document.addEventListener("keydown",v,!1),()=>{document.removeEventListener("keydown",v)}},[t,m,d,s,o]),r.jsxs(C,{sx:{width:"100%"},children:[r.jsxs(WN,{sx:{height:h},children:[r.jsx(zL,{}),r.jsx(GN,{onMouseDown:v=>{v.button===0&&t()},children:c?r.jsx(vx,{}):s?r.jsx(yx,{}):a?r.jsx(Ix,{}):r.jsx(Xa,{})}),r.jsx(HN,{children:r.jsx(qN,{children:e?r.jsx(F1,{}):n?r.jsx(Rx,{}):null})})]}),(i==null?void 0:i.display_handle)&&i.photo_url&&r.jsx(Ax,{creatorUserHandle:i.display_handle,currentRequestId:e==null?void 0:e.request_id,profilePhoto:i.photo_url,badge:i.badge??void 0})]})},GN=b(C)(()=>({minHeight:"100%",display:"flex",alignItems:"center",justifyContent:"center",flex:1,background:f("background"),padding:16,paddingTop:4,position:"relative",cursor:"zoom-out"})),HN=b(C)({paddingTop:4,paddingBottom:16}),qN=b(C)(()=>({minHeight:"100%",maxHeight:"100%",overflow:"auto",display:"flex",flexDirection:"column",alignItems:"center",width:364,background:f("metadataPanel"),borderStyle:"solid",borderRightStyle:"none",borderWidth:.5,borderColor:f("border"),borderTopLeftRadius:8,borderBottomLeftRadius:8,scrollbarColor:"transparent transparent","&:hover":{scrollbarColor:"#5a5a5f transparent"}})),WN=b(C)(()=>({width:"100%",color:f("primary"),display:"flex",flexDirection:"row","::-webkit-scrollbar":{width:0,background:"transparent",display:"none"},overflow:"auto"})),$N=()=>{const{back:t}=l.useContext($e),{bannerHeight:e}=l.useContext(zo),{isSuperRes:n}=l.useContext(Ln);return r.jsxs(r.Fragment,{children:[r.jsx(VN,{sx:{top:8+e},children:r.jsx(Be,{icon:r.jsx(Uo,{color:"#fff"}),onClick:()=>{t()}})}),!n&&r.jsx(KN,{children:r.jsx(k1,{})})]})},VN=b(C)(()=>({position:"fixed",left:8,zIndex:2,backgroundColor:f("glassBackground"),"&:hover":{backgroundColor:f("glassBackgroundHover")},"&:active":{backgroundColor:f("glassBackgroundPressed")},borderRadius:8})),KN=b(C)(()=>({minHeight:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-evenly",width:"100%",background:f("solid"),paddingTop:6,paddingBottom:16})),JN=()=>{const{request_id:t,image_id:e}=an(),{generationData:n,imageFileData:o,isCreator:i,creator:a,isTileImage:s,isSuperRes:c,isBgRemovedImage:d,handleUseGenerationPrompt:u,handleDescribeGeneration:h,handleRemixGeneration:p,isSuperResDisabled:g,handleDescribeImageFile:m,handleRemixImageFile:v,handleImageFilePrivateToggle:x,handleGenerationPrivateToggle:y,handleCanvasGeneration:_,handleCanvasImageFile:w,handleGenerationRemoveBg:I,handleImageFileRemoveBg:R,description:S,useDescriptionAsPrompt:E,targetResponseImage:N}=l.useContext(Ln),{getBrowsingData:k}=l.useContext($e),{setGenerationInputMode:A}=l.useContext(ye);return l.useEffect(()=>{var D;(D=k())!=null&&D.yPosition||(window.scrollTo({top:0}),setTimeout(()=>{window.scrollTo({top:0})},100))},[t,e,k]),!n&&!o?null:r.jsxs(tD,{children:[s?r.jsx(ZN,{children:r.jsx(Ix,{})}):r.jsx(QN,{children:d?r.jsx(vx,{}):c?r.jsx(yx,{}):r.jsx(Xa,{})}),r.jsx($N,{}),r.jsx(YN,{children:n?r.jsx(N1,{}):o?r.jsx(Sx,{}):null}),r.jsxs(XN,{children:[r.jsx(C,{minHeight:2}),n?r.jsx(ua,{isPrivate:!!n.private,isCreator:i,isGeneration:!0,isSuperResDisabled:g,generationData:n,handleUsePrompt:u,handleDescribe:h,handleRemix:()=>{A("remix"),p()},handleUpscale:()=>{A("upscale"),p()},toggleVisibility:y,handleOpenInCanvas:_,handleMagicFill:()=>_("magic_fill"),handleExtend:()=>_("extend"),handleRemoveBg:I,isBackgroundRemovedImage:!1,targetResponseId:N==null?void 0:N.response_id}):o?r.jsx(ua,{isCreator:i,isPrivate:!!o.private,isSuperResDisabled:g,isGeneration:!1,handleDescribe:m,handleRemix:()=>{A("remix"),v()},handleUpscale:()=>{A("upscale"),v()},toggleVisibility:x,handleOpenInCanvas:w,handleMagicFill:()=>w("magic_fill"),handleExtend:()=>w("extend"),handleRemoveBg:R,handleUsePrompt:S?E:void 0,isBackgroundRemovedImage:o.upload_type==="background_removed_image"}):null]}),r.jsx(eD,{children:n?r.jsx(F1,{}):o?r.jsx(Rx,{}):null}),(a==null?void 0:a.display_handle)&&a.photo_url&&r.jsx(Ax,{creatorUserHandle:a.display_handle,currentRequestId:n==null?void 0:n.request_id,profilePhoto:a.photo_url,badge:a.badge??void 0})]})},XN=b(C)(()=>({width:"100%",flex:1,display:"flex",flexDirection:"column",justifyContent:"center",padding:16,paddingTop:0,backgroundColor:f("solid")})),YN=b(C)(()=>({width:"100%",flex:1,display:"flex",flexDirection:"column",padding:16,paddingTop:12,paddingBottom:12,position:"sticky",bottom:0,backgroundColor:`${f("solid")}EE`,zIndex:1})),QN=b(C)({minWidth:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",padding:0,position:"relative"}),ZN=b(C)({minWidth:"100%",height:"calc(100vh - 64px)",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",padding:0}),eD=b(C)(()=>({minHeight:"100%",display:"flex",flexDirection:"column",alignItems:"center",width:"100%",background:f("solid"),padding:0})),tD=b(C)(()=>({width:"100dvw",display:"flex",flexDirection:"column",backgroundColor:f("solid")})),nD=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{userProfileState:n}=l.useContext(ge),[o,i]=l.useState(!1);return n?r.jsxs(oD,{onDragOver:a=>{a.preventDefault(),a.dataTransfer.types.includes("Files")&&i(!0)},onDragLeave:()=>i(!1),onDrop:a=>{a.preventDefault(),i(!1)},children:[r.jsx(Qd,{teasingDrop:o,setTeasingDrop:i}),r.jsx(z7,{children:e?r.jsx(JN,{}):r.jsx(UN,{})}),e&&r.jsx(fx,{}),e&&r.jsx(p1,{})]}):r.jsx(Un,{})},oD=b(C)(()=>({background:f("background")}));let sF=function(t){return t.PENDING="PENDING",t.CANCELLED="CANCELLED",t.ACCEPTED="ACCEPTED",t.REMOVED="REMOVED",t}({});const aF=100,rD=l.createContext({handleManageBilling:()=>{},isOwner:!1,teamInfo:{requestorRole:"WRITER",memberCount:0,activeInviteCount:0,organization:{organizationId:"",name:""},billingInfo:{}},teamMembers:[],refreshTeamMembers:()=>{},isGettingMembers:!1,inviteMemberError:{},setInviteMemberError:()=>{},setTeamInfo:()=>{},isGettingOrganizationInformation:!1}),iD=t=>{const{children:e}=t,{organizationApi:n,userProfileState:o,chosenOrganization:i}=l.useContext(ge),{setBackdropLoading:a}=l.useContext(Do),s=l.useMemo(()=>(i==null?void 0:i.chosenOrganizationId)??"",[i==null?void 0:i.chosenOrganizationId]),[c,d]=l.useState([]),[u,h]=l.useState({requestorRole:"WRITER",memberCount:0,activeInviteCount:0,organization:{organizationId:"",name:""},billingInfo:{}}),[p,g]=l.useState(!1),[m,v]=l.useState({}),[x,y]=l.useState(!1),_=l.useCallback(async()=>{if(s&&n)try{const E=await n.getOrganization({organizationId:s});h(E),g(E.requestorRole==="OWNER"),a(!1),y(!1)}catch{a(!1),y(!1)}},[s,n,a]);l.useEffect(()=>{a(!0),y(!0),s&&n&&_()},[n,s,_,a]);const{isLoading:w,data:I,refetch:R}=Ve(["organizationMembers",s,i==null?void 0:i.chosenOrganizationId],()=>n==null?void 0:n.getOrganizationMembers({organizationId:s}),{enabled:!!s&&!!n});l.useEffect(()=>{if(I&&I.members){const E=I.members,[N,k]=es.partition(E,D=>D.userId===(o==null?void 0:o.userId));d([...N,...k]),E.filter(D=>!D.inviteStatus).length!==u.memberCount&&!x&&_()}},[I,o==null?void 0:o.userId,u.memberCount,_,x]);const S=l.useCallback(()=>{p&&(a(!0),kg(oe.TEAM_BILLING).then(({portal_url:E})=>window.location.href=E))},[p,a]);return r.jsx(rD.Provider,{value:{handleManageBilling:S,isOwner:p,teamMembers:c,refreshTeamMembers:R,teamInfo:u,setTeamInfo:h,isGettingMembers:w,inviteMemberError:m,setInviteMemberError:v,isGettingOrganizationInformation:x},children:e})},sD=()=>{var L,P,G;const t=we(),e=xe(t.breakpoints.down("md")),n=Ee(),{tab:o,filter:i}=an(),{selectionModeActivated:a,setSelectionModeActivated:s,selectedRequests:c,selectedImages:d,selectedCount:u,showMaximumSnack:h,setShowMaximumSnack:p,downloadSelectedImages:g,downloadLoading:m}=l.useContext(Ro),{showAllImage:v,setColumnDataDirty:x}=l.useContext($e),{subscriptionStatus:y}=l.useContext(ge),[_,w]=l.useState(!1),[I,R]=l.useState(!1),[S,E]=l.useState(!1),N=l.useCallback(()=>{u===0&&(R(!0),setTimeout(()=>R(!1),300))},[R,u]),k=l.useCallback(()=>{var B;if(E(!1),(B=y==null?void 0:y.subscriptionQuota)!=null&&B.privateGeneration&&u>0){w(!0);const M=[];c.size>0&&M.push(fd({request_ids:Array.from(c.values()).map(z=>z.requestId)})),d.size>0&&M.push(md({image_ids:Array.from(d.keys())})),n({eventKey:"BULK_DELETE",metaData:{selectedCount:u}}),Promise.all(M).then(()=>{x(!0),s(!1),w(!1)})}},[(L=y==null?void 0:y.subscriptionQuota)==null?void 0:L.privateGeneration,u,c,d,n,x,s]),A=l.useCallback(B=>{var M;if(u===0){N();return}if((M=y==null?void 0:y.subscriptionQuota)!=null&&M.privateGeneration&&u>0){w(!0);const z=[];c.size>0&&z.push(pd({make_public:B,request_ids:Array.from(c.values()).map(F=>F.requestId)})),d.size>0&&z.push(gd({make_public:B,image_ids:Array.from(d.keys())})),n({eventKey:"BULK_TOOGLE_PRIVATE_OR_PUBLIC",metaData:{selectedCount:u,make_public:o==="private"}}),Promise.all(z).then(()=>{x(!0),s(!1),w(!1)})}},[u,(P=y==null?void 0:y.subscriptionQuota)==null?void 0:P.privateGeneration,N,c,d,n,o,x,s]),D=Rn(),O=l.useMemo(()=>{const B={icon:r.jsx(us,{color:f("menuAction")}),text:"Make public",onClick:()=>A(!0)},M={icon:r.jsx(Ka,{color:f("menuAction")}),text:"Make private",onClick:()=>A(!1)},z={icon:r.jsx(ps,{color:f("menuAction")}),text:"Delete",onClick:()=>{if(u===0){N();return}E(!0)}};if(Bn(D.pathname)&&o===Ae.my_images){if(i==="private")return[B,z];if(i==="public")return[M,z];if(i==="pinned")return[M];if(!i)return[B,M,z]}else if(Ba(D.pathname)){if(o==="private")return[B,z];if(o==="generated")return[M,z];if(o==="pinned")return[M]}return[]},[N,i,A,D.pathname,u,o]);return r.jsxs(C,{sx:{zIndex:B=>B.zIndex.drawer+140,position:"relative"},children:[r.jsx(rr,{direction:"up",in:a,mountOnEnter:!0,unmountOnExit:!0,children:r.jsxs(cD,{sx:e?{bottom:0,left:0,right:0,margin:"auto",height:72,borderRadius:0,backgroundColor:f("solid")}:{bottom:16,left:0,right:0,margin:"auto",width:480,borderRadius:8,backgroundColor:`${f("solid")}EE`},children:[r.jsxs(jf,{children:[r.jsx(Be,{icon:r.jsx(wt,{color:f("quietButtonText")}),onClick:()=>s(!1),tooltip:"Cancel",round:!0,size:{width:48,height:48}}),r.jsx(C,{width:8}),r.jsx(lD,{color:f(I?"informative":"primary"),children:u===0?"Select items":`${u} selected ${u>=$o?e?"(max)":"(max reached)":""}`})]}),r.jsxs(jf,{children:[((G=y==null?void 0:y.subscriptionQuota)==null?void 0:G.privateGeneration)&&r.jsxs(r.Fragment,{children:[r.jsx(di,{direction:"up",forcePopup:!0,horizontal:!0,disableScrollLock:!0,options:[[...O]]}),r.jsx(C,{width:8})]}),r.jsxs(aD,{disableRipple:!0,variant:"contained",onClick:async()=>{u===0?N():(w(!0),await g(o!==Ae.my_images&&(o==="pinned"||!v)),w(!1))},children:[r.jsx(O1,{color:f("background")}),r.jsx(C,{width:4}),"Download",r.jsx(C,{width:4})]})]})]})}),r.jsx(Jr,{anchorOrigin:{vertical:"top",horizontal:"center"},open:h,autoHideDuration:1e4,onClose:()=>p(!1),message:r.jsxs(le,{fontSize:13,textAlign:"center",width:"100%",children:["Please select ",r.jsxs("b",{children:["less than ",$o]})," items each time"]})}),r.jsx(as,{open:_,infoText:m}),r.jsx(Ja,{open:S,onCancel:()=>E(!1),onConfirm:k})]})},aD=b(gt)(()=>({color:f("background"),background:f("primary"),"&:hover":{background:f("primary")},borderRadius:24,padding:12,minWidth:0,fontSize:14,lineHeight:"20px"})),jf=b(C)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"}),lD=b(le)({fontSize:16,fontWeight:500,"::selection":{backgroundColor:"transparent"}}),cD=b(Ir)({position:"fixed",display:"flex",justifyContent:"space-between",alignItems:"center",flexDirection:"row",padding:8}),dD=tt.lazy(()=>oo(()=>import("./index-D0sGnqN2.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),uD=tt.lazy(()=>oo(()=>import("./index-DyXaKhdw.js"),__vite__mapDeps([15,1,2,4,5,6,16,17,11,9,7,8,10,3,12,13,14]))),hD=tt.lazy(()=>oo(()=>import("./index-CNE0KrKr.js"),__vite__mapDeps([18,1,2,9,19,20,21,11,7,8,10,3,12,13,14]))),pD=tt.lazy(()=>oo(()=>import("./index-7hJG_jAH.js"),__vite__mapDeps([22,1,2,9,23,20,19,11,17,5,6,10,7,8,3,12,13,14]))),fD=tt.lazy(()=>oo(()=>import("./LoginPage-DF0PUR-Q.js"),__vite__mapDeps([24,1,2,7,8,9,10,11,3,12,13,14]))),gD=tt.lazy(()=>oo(()=>import("./index-DVQHcyoJ.js"),__vite__mapDeps([25,1,2,9,23,19,26,3,6,7,8,10,11,12,13,14]))),mD=tt.lazy(()=>oo(()=>import("./NotificationsPage-Ce484bdf.js"),__vite__mapDeps([27,1,2,7,8,9,10,11,3,12,13,14]))),xD=tt.lazy(()=>oo(()=>import("./index-Cy5V2TLW.js"),__vite__mapDeps([28,1,2,3,11,9,21,7,8,10,12,13,14]))),vD=tt.lazy(()=>oo(()=>import("./index-tpoRgakq.js"),__vite__mapDeps([29,1,2,7,8,9,10,11,3,12,13,14]))),yD=tt.lazy(()=>oo(()=>import("./index-BGRKHBNP.js"),__vite__mapDeps([30,1,2,9,7,8,10,11,3,12,13,14]))),wD=tt.lazy(()=>oo(()=>import("./index-wcSO3IJ7.js"),__vite__mapDeps([31,1,2,9,26,7,8,10,11,3,12,13,14]))),bD=tt.lazy(()=>oo(()=>import("./TosUpdatePopup-CvYR5-L6.js"),__vite__mapDeps([32,1,2,7,8,9,10,11,3,12,13,14]))),CD=()=>{const t=we(),e=xe(t.breakpoints.down("md")),{modalContent:n}=l.useContext(Tt),{autoCloseTimerRef:o,backgroundColor:i,showClose:a}=l.useContext(Tn),s=l.useRef(null),{isFeatureEnabled:c,userAuthStateLoading:d,userProfileState:u,isBatchGenerationEnabled:h,isTeamBillingEnabled:p}=l.useContext(ge),{bannerHeight:g}=l.useContext(zo),{inflightRequestStateSynced:m,queuedRequestStatsLoading:v}=l.useContext(ye),{scrolledToTop:x}=dE({marginTop:108-g}),y=l.useMemo(()=>c(Bt.api_management_access),[c]);CE(),cE(),HT();const _=l.useMemo(()=>r.jsxs(r.Fragment,{children:[r.jsx(C,{ref:s,height:0,sx:{backgroundColor:f("background")}}),r.jsx(QB,{stickingTop:x}),r.jsx(p1,{}),r.jsx(GM,{})]}),[x]),w=l.useMemo(()=>r.jsx(WP,{}),[]),I=l.useMemo(()=>!m||v?r.jsx(Un,{}):r.jsx(l.Suspense,{fallback:r.jsx(Un,{}),children:r.jsxs(Es,{verticalAppNavigation:w,children:[!d&&!!u&&_,r.jsx(hD,{stickingTop:x})]})}),[_,m,x,v,d,u,w]),R=l.useRef(null),S=l.useMemo(()=>r.jsx(l.Suspense,{fallback:r.jsx(Un,{}),children:r.jsxs(Es,{verticalAppNavigation:w,children:[!d&&u&&_,r.jsxs(pL,{areaRef:R,children:[r.jsx(pD,{dragAreaRef:R}),r.jsx(sD,{}),r.jsx(Gp,{})]})]})}),[_,d,u,w]),E=l.useMemo(()=>r.jsx(l.Suspense,{fallback:r.jsx(Un,{}),children:r.jsxs(Es,{verticalAppNavigation:w,children:[!d&&e&&_,r.jsx(yD,{})]})}),[_,e,d,w]),N=l.useMemo(()=>r.jsxs(Es,{verticalAppNavigation:w,children:[!e&&!d&&u&&_,r.jsx(nD,{}),r.jsx(Gp,{})]}),[w,e,d,u,_]);return u!=null&&u.tosAcceptanceRequired?r.jsx(bD,{}):r.jsxs(r.Fragment,{children:[r.jsx($M,{autoCloseTimerRef:o,backgroundColor:i,showClose:a}),r.jsx(_A,{}),n,r.jsxs(Ny,{children:[r.jsx(Kt,{path:oe.HOME,element:I}),r.jsx(Kt,{path:oe.HOME_TAB,element:I}),r.jsx(Kt,{path:oe.HOME_TAB_FILTER,element:I}),r.jsx(Kt,{path:oe.PROFILE,element:S}),r.jsx(Kt,{path:oe.PROFILE_TAB,element:S}),h&&r.jsx(Kt,{path:oe.BATCH_GENERATION,element:r.jsx(xL,{children:E})}),r.jsx(Kt,{path:oe.GENERATION,element:N}),r.jsx(Kt,{path:oe.IMAGE,element:N}),y&&r.jsx(Kt,{path:oe.API_MANAGEMENT,element:r.jsx(l.Suspense,{fallback:r.jsx(Un,{}),children:r.jsx(dD,{})})}),r.jsx(Kt,{path:oe.LOGIN,element:r.jsx(l.Suspense,{fallback:r.jsx(Un,{}),children:r.jsx(fD,{})})}),r.jsx(Kt,{path:oe.WELCOME,element:r.jsx(l.Suspense,{fallback:r.jsx(Un,{}),children:r.jsx(uD,{})})}),r.jsx(Kt,{path:oe.PRICING,element:r.jsx(l.Suspense,{fallback:r.jsx(Un,{}),children:r.jsx(gD,{})})}),e&&r.jsx(Kt,{path:oe.NOTIFICATIONS,element:r.jsxs(l.Suspense,{fallback:r.jsx(Un,{}),children:[!d&&u&&_,r.jsx(mD,{})]})}),r.jsx(Kt,{path:oe.CANVAS,element:r.jsx(l.Suspense,{fallback:r.jsx(Un,{}),children:r.jsx(xD,{})})}),r.jsx(Kt,{path:oe.CANVAS_HOME,element:r.jsx(l.Suspense,{fallback:r.jsx(Un,{}),children:r.jsx(vD,{})})}),p&&r.jsx(Kt,{path:oe.TEAM_BILLING,element:r.jsx(l.Suspense,{fallback:r.jsx(Un,{}),children:r.jsx(iD,{children:r.jsx(wD,{})})})}),r.jsx(Kt,{path:"*",element:I})]})]})};function Dc(t){"@babel/helpers - typeof";return Dc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dc(t)}function jx(){return typeof XMLHttpRequest=="function"||(typeof XMLHttpRequest>"u"?"undefined":Dc(XMLHttpRequest))==="object"}function _D(t){return!!t&&typeof t.then=="function"}function ID(t){return _D(t)?t:Promise.resolve(t)}function SD(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Fc={exports:{}},Fs={exports:{}},Pf;function RD(){return Pf||(Pf=1,function(t,e){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof vo<"u"&&vo,o=function(){function a(){this.fetch=!1,this.DOMException=n.DOMException}return a.prototype=n,new a}();(function(a){(function(s){var c=typeof a<"u"&&a||typeof self<"u"&&self||typeof c<"u"&&c,d={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function u(B){return B&&DataView.prototype.isPrototypeOf(B)}if(d.arrayBuffer)var h=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],p=ArrayBuffer.isView||function(B){return B&&h.indexOf(Object.prototype.toString.call(B))>-1};function g(B){if(typeof B!="string"&&(B=String(B)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(B)||B==="")throw new TypeError('Invalid character in header field name: "'+B+'"');return B.toLowerCase()}function m(B){return typeof B!="string"&&(B=String(B)),B}function v(B){var M={next:function(){var z=B.shift();return{done:z===void 0,value:z}}};return d.iterable&&(M[Symbol.iterator]=function(){return M}),M}function x(B){this.map={},B instanceof x?B.forEach(function(M,z){this.append(z,M)},this):Array.isArray(B)?B.forEach(function(M){this.append(M[0],M[1])},this):B&&Object.getOwnPropertyNames(B).forEach(function(M){this.append(M,B[M])},this)}x.prototype.append=function(B,M){B=g(B),M=m(M);var z=this.map[B];this.map[B]=z?z+", "+M:M},x.prototype.delete=function(B){delete this.map[g(B)]},x.prototype.get=function(B){return B=g(B),this.has(B)?this.map[B]:null},x.prototype.has=function(B){return this.map.hasOwnProperty(g(B))},x.prototype.set=function(B,M){this.map[g(B)]=m(M)},x.prototype.forEach=function(B,M){for(var z in this.map)this.map.hasOwnProperty(z)&&B.call(M,this.map[z],z,this)},x.prototype.keys=function(){var B=[];return this.forEach(function(M,z){B.push(z)}),v(B)},x.prototype.values=function(){var B=[];return this.forEach(function(M){B.push(M)}),v(B)},x.prototype.entries=function(){var B=[];return this.forEach(function(M,z){B.push([z,M])}),v(B)},d.iterable&&(x.prototype[Symbol.iterator]=x.prototype.entries);function y(B){if(B.bodyUsed)return Promise.reject(new TypeError("Already read"));B.bodyUsed=!0}function _(B){return new Promise(function(M,z){B.onload=function(){M(B.result)},B.onerror=function(){z(B.error)}})}function w(B){var M=new FileReader,z=_(M);return M.readAsArrayBuffer(B),z}function I(B){var M=new FileReader,z=_(M);return M.readAsText(B),z}function R(B){for(var M=new Uint8Array(B),z=new Array(M.length),F=0;F<M.length;F++)z[F]=String.fromCharCode(M[F]);return z.join("")}function S(B){if(B.slice)return B.slice(0);var M=new Uint8Array(B.byteLength);return M.set(new Uint8Array(B)),M.buffer}function E(){return this.bodyUsed=!1,this._initBody=function(B){this.bodyUsed=this.bodyUsed,this._bodyInit=B,B?typeof B=="string"?this._bodyText=B:d.blob&&Blob.prototype.isPrototypeOf(B)?this._bodyBlob=B:d.formData&&FormData.prototype.isPrototypeOf(B)?this._bodyFormData=B:d.searchParams&&URLSearchParams.prototype.isPrototypeOf(B)?this._bodyText=B.toString():d.arrayBuffer&&d.blob&&u(B)?(this._bodyArrayBuffer=S(B.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):d.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(B)||p(B))?this._bodyArrayBuffer=S(B):this._bodyText=B=Object.prototype.toString.call(B):this._bodyText="",this.headers.get("content-type")||(typeof B=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):d.searchParams&&URLSearchParams.prototype.isPrototypeOf(B)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d.blob&&(this.blob=function(){var B=y(this);if(B)return B;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var B=y(this);return B||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else return this.blob().then(w)}),this.text=function(){var B=y(this);if(B)return B;if(this._bodyBlob)return I(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(R(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},d.formData&&(this.formData=function(){return this.text().then(D)}),this.json=function(){return this.text().then(JSON.parse)},this}var N=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function k(B){var M=B.toUpperCase();return N.indexOf(M)>-1?M:B}function A(B,M){if(!(this instanceof A))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');M=M||{};var z=M.body;if(B instanceof A){if(B.bodyUsed)throw new TypeError("Already read");this.url=B.url,this.credentials=B.credentials,M.headers||(this.headers=new x(B.headers)),this.method=B.method,this.mode=B.mode,this.signal=B.signal,!z&&B._bodyInit!=null&&(z=B._bodyInit,B.bodyUsed=!0)}else this.url=String(B);if(this.credentials=M.credentials||this.credentials||"same-origin",(M.headers||!this.headers)&&(this.headers=new x(M.headers)),this.method=k(M.method||this.method||"GET"),this.mode=M.mode||this.mode||null,this.signal=M.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&z)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(z),(this.method==="GET"||this.method==="HEAD")&&(M.cache==="no-store"||M.cache==="no-cache")){var F=/([?&])_=[^&]*/;if(F.test(this.url))this.url=this.url.replace(F,"$1_="+new Date().getTime());else{var T=/\?/;this.url+=(T.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}A.prototype.clone=function(){return new A(this,{body:this._bodyInit})};function D(B){var M=new FormData;return B.trim().split("&").forEach(function(z){if(z){var F=z.split("="),T=F.shift().replace(/\+/g," "),j=F.join("=").replace(/\+/g," ");M.append(decodeURIComponent(T),decodeURIComponent(j))}}),M}function O(B){var M=new x,z=B.replace(/\r?\n[\t ]+/g," ");return z.split("\r").map(function(F){return F.indexOf(`
`)===0?F.substr(1,F.length):F}).forEach(function(F){var T=F.split(":"),j=T.shift().trim();if(j){var Z=T.join(":").trim();M.append(j,Z)}}),M}E.call(A.prototype);function L(B,M){if(!(this instanceof L))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');M||(M={}),this.type="default",this.status=M.status===void 0?200:M.status,this.ok=this.status>=200&&this.status<300,this.statusText=M.statusText===void 0?"":""+M.statusText,this.headers=new x(M.headers),this.url=M.url||"",this._initBody(B)}E.call(L.prototype),L.prototype.clone=function(){return new L(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new x(this.headers),url:this.url})},L.error=function(){var B=new L(null,{status:0,statusText:""});return B.type="error",B};var P=[301,302,303,307,308];L.redirect=function(B,M){if(P.indexOf(M)===-1)throw new RangeError("Invalid status code");return new L(null,{status:M,headers:{location:B}})},s.DOMException=c.DOMException;try{new s.DOMException}catch{s.DOMException=function(M,z){this.message=M,this.name=z;var F=Error(M);this.stack=F.stack},s.DOMException.prototype=Object.create(Error.prototype),s.DOMException.prototype.constructor=s.DOMException}function G(B,M){return new Promise(function(z,F){var T=new A(B,M);if(T.signal&&T.signal.aborted)return F(new s.DOMException("Aborted","AbortError"));var j=new XMLHttpRequest;function Z(){j.abort()}j.onload=function(){var te={status:j.status,statusText:j.statusText,headers:O(j.getAllResponseHeaders()||"")};te.url="responseURL"in j?j.responseURL:te.headers.get("X-Request-URL");var $="response"in j?j.response:j.responseText;setTimeout(function(){z(new L($,te))},0)},j.onerror=function(){setTimeout(function(){F(new TypeError("Network request failed"))},0)},j.ontimeout=function(){setTimeout(function(){F(new TypeError("Network request failed"))},0)},j.onabort=function(){setTimeout(function(){F(new s.DOMException("Aborted","AbortError"))},0)};function ee(te){try{return te===""&&c.location.href?c.location.href:te}catch{return te}}j.open(T.method,ee(T.url),!0),T.credentials==="include"?j.withCredentials=!0:T.credentials==="omit"&&(j.withCredentials=!1),"responseType"in j&&(d.blob?j.responseType="blob":d.arrayBuffer&&T.headers.get("Content-Type")&&T.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(j.responseType="arraybuffer")),M&&typeof M.headers=="object"&&!(M.headers instanceof x)?Object.getOwnPropertyNames(M.headers).forEach(function(te){j.setRequestHeader(te,m(M.headers[te]))}):T.headers.forEach(function(te,$){j.setRequestHeader($,te)}),T.signal&&(T.signal.addEventListener("abort",Z),j.onreadystatechange=function(){j.readyState===4&&T.signal.removeEventListener("abort",Z)}),j.send(typeof T._bodyInit>"u"?null:T._bodyInit)})}return G.polyfill=!0,c.fetch||(c.fetch=G,c.Headers=x,c.Request=A,c.Response=L),s.Headers=x,s.Request=A,s.Response=L,s.fetch=G,s})({})})(o),o.fetch.ponyfill=!0,delete o.fetch.polyfill;var i=n.fetch?n:o;e=i.fetch,e.default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,t.exports=e}(Fs,Fs.exports)),Fs.exports}(function(t,e){var n;if(typeof fetch=="function"&&(typeof vo<"u"&&vo.fetch?n=vo.fetch:typeof window<"u"&&window.fetch?n=window.fetch:n=fetch),typeof SD<"u"&&typeof window>"u"){var o=n||RD();o.default&&(o=o.default),e.default=o,t.exports=e.default}})(Fc,Fc.exports);var Px=Fc.exports;const Mx=Jf(Px),Mf=Wv({__proto__:null,default:Mx},[Px]);function Of(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,o)}return n}function Bf(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Of(Object(n),!0).forEach(function(o){TD(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Of(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function TD(t,e,n){return(e=ED(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ED(t){var e=kD(t,"string");return _r(e)=="symbol"?e:e+""}function kD(t,e){if(_r(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e||"default");if(_r(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _r(t){"@babel/helpers - typeof";return _r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_r(t)}var Lo;typeof fetch=="function"&&(typeof global<"u"&&global.fetch?Lo=global.fetch:typeof window<"u"&&window.fetch?Lo=window.fetch:Lo=fetch);var Zi;jx()&&(typeof global<"u"&&global.XMLHttpRequest?Zi=global.XMLHttpRequest:typeof window<"u"&&window.XMLHttpRequest&&(Zi=window.XMLHttpRequest));var pa;typeof ActiveXObject=="function"&&(typeof global<"u"&&global.ActiveXObject?pa=global.ActiveXObject:typeof window<"u"&&window.ActiveXObject&&(pa=window.ActiveXObject));!Lo&&Mf&&!Zi&&!pa&&(Lo=Mx||Mf);typeof Lo!="function"&&(Lo=void 0);var zc=function(e,n){if(n&&_r(n)==="object"){var o="";for(var i in n)o+="&"+encodeURIComponent(i)+"="+encodeURIComponent(n[i]);if(!o)return e;e=e+(e.indexOf("?")!==-1?"&":"?")+o.slice(1)}return e},Lf=function(e,n,o,i){var a=function(d){if(!d.ok)return o(d.statusText||"Error",{status:d.status});d.text().then(function(u){o(null,{status:d.status,data:u})}).catch(o)};if(i){var s=i(e,n);if(s instanceof Promise){s.then(a).catch(o);return}}typeof fetch=="function"?fetch(e,n).then(a).catch(o):Lo(e,n).then(a).catch(o)},Nf=!1,AD=function(e,n,o,i){e.queryStringParams&&(n=zc(n,e.queryStringParams));var a=Bf({},typeof e.customHeaders=="function"?e.customHeaders():e.customHeaders);typeof window>"u"&&typeof global<"u"&&typeof global.process<"u"&&global.process.versions&&global.process.versions.node&&(a["User-Agent"]="i18next-http-backend (node/".concat(global.process.version,"; ").concat(global.process.platform," ").concat(global.process.arch,")")),o&&(a["Content-Type"]="application/json");var s=typeof e.requestOptions=="function"?e.requestOptions(o):e.requestOptions,c=Bf({method:o?"POST":"GET",body:o?e.stringify(o):void 0,headers:a},Nf?{}:s),d=typeof e.alternateFetch=="function"&&e.alternateFetch.length>=1?e.alternateFetch:void 0;try{Lf(n,c,i,d)}catch(u){if(!s||Object.keys(s).length===0||!u.message||u.message.indexOf("not implemented")<0)return i(u);try{Object.keys(s).forEach(function(h){delete c[h]}),Lf(n,c,i,d),Nf=!0}catch(h){i(h)}}},jD=function(e,n,o,i){o&&_r(o)==="object"&&(o=zc("",o).slice(1)),e.queryStringParams&&(n=zc(n,e.queryStringParams));try{var a;Zi?a=new Zi:a=new pa("MSXML2.XMLHTTP.3.0"),a.open(o?"POST":"GET",n,1),e.crossDomain||a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.withCredentials=!!e.withCredentials,o&&a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.overrideMimeType&&a.overrideMimeType("application/json");var s=e.customHeaders;if(s=typeof s=="function"?s():s,s)for(var c in s)a.setRequestHeader(c,s[c]);a.onreadystatechange=function(){a.readyState>3&&i(a.status>=400?a.statusText:null,{status:a.status,data:a.responseText})},a.send(o)}catch(d){console&&console.log(d)}},PD=function(e,n,o,i){if(typeof o=="function"&&(i=o,o=void 0),i=i||function(){},Lo&&n.indexOf("file:")!==0)return AD(e,n,o,i);if(jx()||typeof ActiveXObject=="function")return jD(e,n,o,i);i(new Error("No fetch and no xhr implementation found!"))};function oi(t){"@babel/helpers - typeof";return oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oi(t)}function Df(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,o)}return n}function Gl(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Df(Object(n),!0).forEach(function(o){Ox(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Df(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function MD(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OD(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Bx(o.key),o)}}function BD(t,e,n){return e&&OD(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ox(t,e,n){return(e=Bx(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bx(t){var e=LD(t,"string");return oi(e)=="symbol"?e:e+""}function LD(t,e){if(oi(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e||"default");if(oi(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ND=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(n){return JSON.parse(n)},stringify:JSON.stringify,parsePayload:function(n,o,i){return Ox({},o,i||"")},parseLoadPayload:function(n,o){},request:PD,reloadInterval:typeof window<"u"?!1:60*60*1e3,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},Lx=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};MD(this,t),this.services=e,this.options=n,this.allOptions=o,this.type="backend",this.init(e,n,o)}return BD(t,[{key:"init",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.services=n,this.options=Gl(Gl(Gl({},ND()),this.options||{}),i),this.allOptions=a,this.services&&this.options.reloadInterval){var s=setInterval(function(){return o.reload()},this.options.reloadInterval);oi(s)==="object"&&typeof s.unref=="function"&&s.unref()}}},{key:"readMulti",value:function(n,o,i){this._readAny(n,n,o,o,i)}},{key:"read",value:function(n,o,i){this._readAny([n],n,[o],o,i)}},{key:"_readAny",value:function(n,o,i,a,s){var c=this,d=this.options.loadPath;typeof this.options.loadPath=="function"&&(d=this.options.loadPath(n,i)),d=ID(d),d.then(function(u){if(!u)return s(null,{});var h=c.services.interpolator.interpolate(u,{lng:n.join("+"),ns:i.join("+")});c.loadUrl(h,s,o,a)})}},{key:"loadUrl",value:function(n,o,i,a){var s=this,c=typeof i=="string"?[i]:i,d=typeof a=="string"?[a]:a,u=this.options.parseLoadPayload(c,d);this.options.request(this.options,n,u,function(h,p){if(p&&(p.status>=500&&p.status<600||!p.status))return o("failed loading "+n+"; status code: "+p.status,!0);if(p&&p.status>=400&&p.status<500)return o("failed loading "+n+"; status code: "+p.status,!1);if(!p&&h&&h.message&&h.message.toLowerCase().indexOf("failed")>-1&&(h.message.indexOf("fetch")>-1||h.message.toLowerCase().indexOf("network")>-1))return o("failed loading "+n+": "+h.message,!0);if(h)return o(h,!1);var g,m;try{typeof p.data=="string"?g=s.options.parse(p.data,i,a):g=p.data}catch{m="failed parsing "+n+" to json"}if(m)return o(m,!1);o(null,g)})}},{key:"create",value:function(n,o,i,a,s){var c=this;if(this.options.addPath){typeof n=="string"&&(n=[n]);var d=this.options.parsePayload(o,i,a),u=0,h=[],p=[];n.forEach(function(g){var m=c.options.addPath;typeof c.options.addPath=="function"&&(m=c.options.addPath(g,o));var v=c.services.interpolator.interpolate(m,{lng:g,ns:o});c.options.request(c.options,v,d,function(x,y){u+=1,h.push(x),p.push(y),u===n.length&&typeof s=="function"&&s(h,p)})})}}},{key:"reload",value:function(){var n=this,o=this.services,i=o.backendConnector,a=o.languageUtils,s=o.logger,c=i.language;if(!(c&&c.toLowerCase()==="cimode")){var d=[],u=function(p){var g=a.toResolveHierarchy(p);g.forEach(function(m){d.indexOf(m)<0&&d.push(m)})};u(c),this.allOptions.preload&&this.allOptions.preload.forEach(function(h){return u(h)}),d.forEach(function(h){n.allOptions.ns.forEach(function(p){i.read(h,p,"read",null,null,function(g,m){g&&s.warn("loading namespace ".concat(p," for language ").concat(h," failed"),g),!g&&m&&s.log("loaded namespace ".concat(p," for language ").concat(h),m),i.loaded("".concat(h,"|").concat(p),g,m)})})})}}}])}();Lx.type="backend";const{slice:DD,forEach:FD}=[];function zD(t){return FD.call(DD.call(arguments,1),e=>{if(e)for(const n in e)t[n]===void 0&&(t[n]=e[n])}),t}const Ff=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,UD=(t,e,n)=>{const o=n||{};o.path=o.path||"/";const i=encodeURIComponent(e);let a=`${t}=${i}`;if(o.maxAge>0){const s=o.maxAge-0;if(Number.isNaN(s))throw new Error("maxAge should be a Number");a+=`; Max-Age=${Math.floor(s)}`}if(o.domain){if(!Ff.test(o.domain))throw new TypeError("option domain is invalid");a+=`; Domain=${o.domain}`}if(o.path){if(!Ff.test(o.path))throw new TypeError("option path is invalid");a+=`; Path=${o.path}`}if(o.expires){if(typeof o.expires.toUTCString!="function")throw new TypeError("option expires is invalid");a+=`; Expires=${o.expires.toUTCString()}`}if(o.httpOnly&&(a+="; HttpOnly"),o.secure&&(a+="; Secure"),o.sameSite)switch(typeof o.sameSite=="string"?o.sameSite.toLowerCase():o.sameSite){case!0:a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;case"none":a+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a},zf={create(t,e,n,o){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};n&&(i.expires=new Date,i.expires.setTime(i.expires.getTime()+n*60*1e3)),o&&(i.domain=o),document.cookie=UD(t,encodeURIComponent(e),i)},read(t){const e=`${t}=`,n=document.cookie.split(";");for(let o=0;o<n.length;o++){let i=n[o];for(;i.charAt(0)===" ";)i=i.substring(1,i.length);if(i.indexOf(e)===0)return i.substring(e.length,i.length)}return null},remove(t){this.create(t,"",-1)}};var GD={name:"cookie",lookup(t){let{lookupCookie:e}=t;if(e&&typeof document<"u")return zf.read(e)||void 0},cacheUserLanguage(t,e){let{lookupCookie:n,cookieMinutes:o,cookieDomain:i,cookieOptions:a}=e;n&&typeof document<"u"&&zf.create(n,t,o,i,a)}},HD={name:"querystring",lookup(t){var o;let{lookupQuerystring:e}=t,n;if(typeof window<"u"){let{search:i}=window.location;!window.location.search&&((o=window.location.hash)==null?void 0:o.indexOf("?"))>-1&&(i=window.location.hash.substring(window.location.hash.indexOf("?")));const s=i.substring(1).split("&");for(let c=0;c<s.length;c++){const d=s[c].indexOf("=");d>0&&s[c].substring(0,d)===e&&(n=s[c].substring(d+1))}}return n}};let Ci=null;const Uf=()=>{if(Ci!==null)return Ci;try{Ci=window!=="undefined"&&window.localStorage!==null;const t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{Ci=!1}return Ci};var qD={name:"localStorage",lookup(t){let{lookupLocalStorage:e}=t;if(e&&Uf())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupLocalStorage:n}=e;n&&Uf()&&window.localStorage.setItem(n,t)}};let _i=null;const Gf=()=>{if(_i!==null)return _i;try{_i=window!=="undefined"&&window.sessionStorage!==null;const t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{_i=!1}return _i};var WD={name:"sessionStorage",lookup(t){let{lookupSessionStorage:e}=t;if(e&&Gf())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupSessionStorage:n}=e;n&&Gf()&&window.sessionStorage.setItem(n,t)}},$D={name:"navigator",lookup(t){const e=[];if(typeof navigator<"u"){const{languages:n,userLanguage:o,language:i}=navigator;if(n)for(let a=0;a<n.length;a++)e.push(n[a]);o&&e.push(o),i&&e.push(i)}return e.length>0?e:void 0}},VD={name:"htmlTag",lookup(t){let{htmlTag:e}=t,n;const o=e||(typeof document<"u"?document.documentElement:null);return o&&typeof o.getAttribute=="function"&&(n=o.getAttribute("lang")),n}},KD={name:"path",lookup(t){var i;let{lookupFromPathIndex:e}=t;if(typeof window>"u")return;const n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(n)?(i=n[typeof e=="number"?e:0])==null?void 0:i.replace("/",""):void 0}},JD={name:"subdomain",lookup(t){var i,a;let{lookupFromSubdomainIndex:e}=t;const n=typeof e=="number"?e+1:1,o=typeof window<"u"&&((a=(i=window.location)==null?void 0:i.hostname)==null?void 0:a.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(o)return o[n]}};function XD(){return{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t}}class Nx{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,n)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e||{languageUtils:{}},this.options=zD(n,this.options||{},XD()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=i=>i.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=o,this.addDetector(GD),this.addDetector(HD),this.addDetector(qD),this.addDetector(WD),this.addDetector($D),this.addDetector(VD),this.addDetector(KD),this.addDetector(JD)}addDetector(e){return this.detectors[e.name]=e,this}detect(e){e||(e=this.options.order);let n=[];return e.forEach(o=>{if(this.detectors[o]){let i=this.detectors[o].lookup(this.options);i&&typeof i=="string"&&(i=[i]),i&&(n=n.concat(i))}}),n=n.map(o=>this.options.convertDetectedLanguage(o)),this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}cacheUserLanguage(e,n){n||(n=this.options.caches),n&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||n.forEach(o=>{this.detectors[o]&&this.detectors[o].cacheUserLanguage(e,this.options)}))}}Nx.type="languageDetector";Fv.use(Lx).use(Nx).use(zv).init({fallbackLng:"en",debug:!1,interpolation:{escapeValue:!1},backend:{loadPath:"/locales/{{lng}}/{{ns}}.json"}});function YD(){const t=l.useCallback(()=>fv({typography:{fontFamily:"Manrope, sans-serif",button:{textTransform:"none",userSelect:"none"}},palette:{primary:{main:f("primary")},secondary:{main:f("secondary")},success:{main:f("active")},error:{main:f("error")},action:{disabledBackground:f("informative"),disabled:f("secondary")}}}),[]),[e,n]=l.useState(t()),o=Ee();return l.useEffect(()=>(window.onerror=(i,a,s,c,d)=>(o({eventKey:"JS_ERROR",metaData:{message:i,source:a??"",lineno:s??-1,colno:c??-1,stack:(d==null?void 0:d.stack)??"",name:(d==null?void 0:d.name)??""}}),!0),()=>{window.onerror=null}),[o]),r.jsx($v,{FallbackComponent:LT,onError:(i,a)=>{Og()&&console.error(i),o({eventKey:"ERROR_BOUNDARY_TRIGGERED",metaData:{message:i.message,cause:i.cause,name:i.name,stack:i.stack,componentStack:a.componentStack,path:window.location.pathname}})},children:r.jsx(gv,{theme:e,children:r.jsx(Uy,{children:r.jsx(i5,{children:r.jsx(PI,{refreshTheme:()=>n(t()),children:r.jsx(NI,{children:r.jsx(_5,{children:r.jsx(HS,{children:r.jsx(wT,{children:r.jsx(AT,{children:r.jsx(XM,{children:r.jsx(CD,{})})})})})})})})})})})})}const QD={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_AMPLITUDE_API_KEY:"da0464495cb85fed194d60eee20539e6",VITE_APP_AMPLITUDE_EXPERIMENT_PROXY_URL:"https://ideogram.ai/amp-labs",VITE_APP_AMPLITUDE_FLAGS_PROXY_URL:"https://ideogram.ai/amp-flags",VITE_APP_AMPLITUDE_PROXY_URL:"https://ideogram.ai/amplitude",VITE_APP_CELLO_ATTRIBUTION_CDN_URL:"https://assets.cello.so/attribution/latest/cello-attribution.js",VITE_APP_CELLO_COMPONENT_CDN_URL:"https://assets.cello.so/app/latest/cello.js",VITE_APP_CELLO_PRODUCT_ID:"ideogram.ai",VITE_APP_FIREBASE_API_KEY:"AIzaSyBwq4bRiOapXYaKE-0Y46vLAw1-fzALq7Y",VITE_APP_FIREBASE_AUTH_DOMAIN:"ideogram-prod.firebaseapp.com",VITE_APP_FIREBASE_PROXY_AUTH_DOMAIN:"ideogram.ai",VITE_APP_GTAG:"G-44J8R31CP6",VITE_APP_TURNSTILE_SITE_KEY:"0x4AAAAAAAYMuk7BF-qKU-xo",VITE_EXTERNAL_API_BASE_URL:"https://api.ideogram.ai",VITE_STAGING_ENV:"0"},{VITE_APP_FIREBASE_API_KEY:ZD,VITE_APP_FIREBASE_AUTH_DOMAIN:e9,VITE_APP_FIREBASE_PROXY_AUTH_DOMAIN:Dx}=QD,t9={apiKey:ZD,authDomain:Dx},n9=wv(t9),Jn=bv(n9,{persistence:[Cv,_v],popupRedirectResolver:Iv}),o9=Vl.createRoot(document.getElementById("root"));let Hl=0;const r9=setInterval(()=>{Hl++,Xe({eventKey:"FIREBASE_READY_CHECK",metaData:{counter:Hl}}),Jn.authStateReady().then(()=>{Xe({eventKey:"FIREBASE_READY_CHECK_SUCCESS",metaData:{counter:Hl}}),clearInterval(r9)}).catch(t=>{Xe({eventKey:"FIREBASE_AUTH_STATE_READY_ERROR",metaData:{message:t==null?void 0:t.message,code:t==null?void 0:t.code}})})},3e3);Promise.all([_I(),document.fonts.ready,Jn.authStateReady()]).finally(()=>{o9.render(r.jsx(Lv,{client:new Nv({defaultOptions:{queries:{networkMode:"always"},mutations:{networkMode:"always"}}}),children:r.jsx(YD,{})}))});export{fd as $,ge as A,xp as B,$n as C,wt as D,SI as E,Bt as F,qg as G,_m as H,Rr as I,Wt as J,Ka as K,$P as L,Tt as M,P1 as N,It as O,ht as P,Be as Q,Yy as R,On as S,is as T,us as U,zo as V,Ro as W,dd as X,ou as Y,pd as Z,gd as _,q9 as a,hs as a$,md as a0,nu as a1,ps as a2,Ja as a3,YL as a4,XL as a5,I0 as a6,di as a7,kN as a8,ON as a9,Ko as aA,Or as aB,_0 as aC,ci as aD,Y3 as aE,Io as aF,I9 as aG,JA as aH,QA as aI,ZA as aJ,XA as aK,k9 as aL,A9 as aM,j9 as aN,dI as aO,E9 as aP,uI as aQ,P9 as aR,hI as aS,oo as aT,e3 as aU,ed as aV,Xe as aW,sI as aX,PT as aY,l5 as aZ,m5 as a_,Pt as aa,Rn as ab,Bn as ac,iF as ad,VL as ae,Ft as af,jT as ag,Qd as ah,zB as ai,pL as aj,LN as ak,sD as al,Gp as am,C0 as an,Yf as ao,Cm as ap,Oa as aq,hh as ar,F9 as as,ch as at,z9 as au,T9 as av,qa as aw,Tn as ax,l6 as ay,lu as az,G9 as b,Tc as b$,g1 as b0,$a as b1,ni as b2,b1 as b3,O1 as b4,D0 as b5,Uo as b6,b0 as b7,Al as b8,za as b9,sc as bA,$9 as bB,Gi as bC,hR as bD,Hi as bE,Ue as bF,xS as bG,hm as bH,In as bI,nF as bJ,Le as bK,yd as bL,ha as bM,Fg as bN,Qs as bO,io as bP,pm as bQ,I8 as bR,b8 as bS,uo as bT,_O as bU,UO as bV,sO as bW,YO as bX,CO as bY,er as bZ,ms as b_,ai as ba,bo as bb,Ui as bc,P5 as bd,Vg as be,mg as bf,W9 as bg,J0 as bh,RP as bi,vT as bj,fs as bk,vm as bl,D9 as bm,B9 as bn,L9 as bo,N9 as bp,rF as bq,kh as br,Jt as bs,iT as bt,Vo as bu,Re as bv,lc as bw,Yg as bx,ic as by,yh as bz,O9 as c,B1 as c$,H1 as c0,dc as c1,od as c2,q6 as c3,Mt as c4,Do as c5,fT as c6,No as c7,Zr as c8,S9 as c9,Va as cA,A7 as cB,k7 as cC,ud as cD,R1 as cE,hn as cF,au as cG,Ud as cH,Gd as cI,Oo as cJ,iO as cK,Ri as cL,TA as cM,EA as cN,eF as cO,Gg as cP,rs as cQ,La as cR,ua as cS,Dd as cT,A1 as cU,F7 as cV,j1 as cW,Nl as cX,cu as cY,M1 as cZ,L1 as c_,Da as ca,U9 as cb,rd as cc,gT as cd,vd as ce,KR as cf,tF as cg,Y9 as ch,oF as ci,Z9 as cj,K9 as ck,UR as cl,gr as cm,J9 as cn,vR as co,zR as cp,fr as cq,Zs as cr,V9 as cs,Mo as ct,Q9 as cu,Sh as cv,i7 as cw,Qr as cx,yS as cy,qr as cz,os as d,D1 as d0,yT as d1,Ws as d2,nd as d3,lr as d4,Xt as d5,Yt as d6,Ei as d7,Ti as d8,U7 as d9,R9 as dA,wx as dB,bx as dC,_9 as dD,uS as dE,gL as dF,fL as dG,rD as dH,Yr as dI,sF as dJ,aF as dK,xI as dL,pc as dM,kd as dN,aE as dO,E6 as da,R6 as db,Mn as dc,I6 as dd,Ao as de,jo as df,T1 as dg,nf as dh,um as di,yR as dj,Qg as dk,wR as dl,qR as dm,gm as dn,rT as dp,X9 as dq,s1 as dr,qB as ds,$v as dt,LT as du,Og as dv,Vi as dw,yr as dx,vr as dy,mL as dz,H9 as e,fh as f,f as g,Un as h,Lt as i,rn as j,oe as k,Ee as l,Hj as m,$e as n,ts as o,ye as p,an as q,Nt as r,$t as s,Ae as t,ja as u,M9 as v,Si as w,or as x,Rt as y,RI as z};
